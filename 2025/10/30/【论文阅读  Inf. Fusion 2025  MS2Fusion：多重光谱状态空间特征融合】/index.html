<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script><script class="next-config" data-name="main" type="application/json">{"hostname":"mjy.js.org","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":"ture","style":"default"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script><meta name="description" content="MS2Fusion：多重光谱状态空间特征融合"><meta property="og:type" content="article"><meta property="og:title" content="【论文阅读 | Inf. Fusion 2025 | MS2Fusion：多重光谱状态空间特征融合】"><meta property="og:url" content="https://mjy.js.org/2025/10/30/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20Inf.%20Fusion%202025%20%20MS2Fusion%EF%BC%9A%E5%A4%9A%E9%87%8D%E5%85%89%E8%B0%B1%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E3%80%91/index.html"><meta property="og:site_name" content="TranquilYu&#39;s Blog"><meta property="og:description" content="MS2Fusion：多重光谱状态空间特征融合"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mjy.js.org/images/image-20251029230125038-1761991594416-18.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251030092635833-1761991594416-19.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251030102737886-1761991594416-20.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251030104145257-1761991594416-21.png"><meta property="og:image" content="https://mjy.js.org/images/MS2Fusion-overreview-1761991594416-22.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251030142035432-1761991594416-23.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251030144143991-1761991594416-24.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251030151609728-1761991594416-25.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251030151823019-1761991594416-26.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251030152057669-1761991594416-27.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251031213920975-1761991594416-28.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251031214157371-1761991594416-29.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251031214216261-1761991594416-30.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251031214233322-1761991594416-31.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251031214255210-1761991594416-32.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251031214312729-1761991594416-33.png"><meta property="og:image" content="https://mjy.js.org/images/image-20251031214326873-1761991594416-34.png"><meta property="article:published_time" content="2025-10-30T00:00:00.000Z"><meta property="article:modified_time" content="2025-11-30T03:26:53.021Z"><meta property="article:author" content="MaJianyu"><meta property="article:tag" content="共享参数"><meta property="article:tag" content="多光谱目标检测"><meta property="article:tag" content="状态空间模型"><meta property="article:tag" content="跨参数交互"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://mjy.js.org/images/image-20251029230125038-1761991594416-18.png"><link rel="canonical" href="https://mjy.js.org/2025/10/30/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20Inf.%20Fusion%202025%20%20MS2Fusion%EF%BC%9A%E5%A4%9A%E9%87%8D%E5%85%89%E8%B0%B1%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E3%80%91/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://mjy.js.org/2025/10/30/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20Inf.%20Fusion%202025%20%20MS2Fusion%EF%BC%9A%E5%A4%9A%E9%87%8D%E5%85%89%E8%B0%B1%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E3%80%91/","path":"2025/10/30/【论文阅读  Inf. Fusion 2025  MS2Fusion：多重光谱状态空间特征融合】/","title":"【论文阅读 | Inf. Fusion 2025 | MS2Fusion：多重光谱状态空间特征融合】"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>【论文阅读 | Inf. Fusion 2025 | MS2Fusion：多重光谱状态空间特征融合】 | TranquilYu's Blog</title><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous" defer></script><script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/pjax.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script><script src="/js/third-party/search/local-search.js" defer></script><script src="/js/third-party/fancybox.js" defer></script><script src="/js/third-party/pace.js" defer></script><script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":"flase","tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/js/third-party/math/mathjax.js" defer></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous" referrerpolicy="no-referrer"><link rel="alternate" href="/atom.xml" title="TranquilYu's Blog" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">TranquilYu's Blog</p><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%91%98%E8%A6%81"><span class="nav-number">1.</span> <span class="nav-text">摘要</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-number">2.</span> <span class="nav-text">引言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%85%89%E8%B0%B1%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E4%BC%98%E5%8A%BF"><span class="nav-number">2.1.</span> <span class="nav-text">多光谱目标检测优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E6%A8%A1%E6%80%81%E7%BC%BA%E9%99%B7"><span class="nav-number">2.2.</span> <span class="nav-text">单模态缺陷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%88%E5%89%8D%E7%A0%94%E7%A9%B6%E7%9A%84%E4%B8%8D%E8%B6%B3"><span class="nav-number">2.3.</span> <span class="nav-text">先前研究的不足</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CNN%E4%B8%8ETransformer%E4%B9%8B%E7%BC%BA%E9%99%B7"><span class="nav-number">2.4.</span> <span class="nav-text">CNN与Transformer之缺陷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%B0%E9%98%B6%E6%AE%B5%E7%8A%B6%E5%86%B5"><span class="nav-number">2.5.</span> <span class="nav-text">现阶段状况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MS2Fusion%E7%9A%84%E6%8F%90%E5%87%BA"><span class="nav-number">2.6.</span> <span class="nav-text">MS2Fusion的提出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MS2Fusion%E7%9A%84%E4%BC%98%E5%8A%BF%E4%BD%93%E7%8E%B0"><span class="nav-number">2.7.</span> <span class="nav-text">MS2Fusion的优势体现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%AE%E5%9B%BE%E5%88%86%E6%9E%90"><span class="nav-number">2.7.1.</span> <span class="nav-text">据图分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#a-Transformer-based-fusion"><span class="nav-number">2.7.1.1.</span> <span class="nav-text">(a) Transformer-based fusion</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#b-Mamba-based-fusion"><span class="nav-number">2.7.1.2.</span> <span class="nav-text">(b) Mamba-based fusion</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#c-MS2Fusion%EF%BC%88%E4%BD%9C%E8%80%85%E6%8F%90%E5%87%BA%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%89"><span class="nav-number">2.7.1.3.</span> <span class="nav-text">(c) MS2Fusion（作者提出的方法）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MS2Fusion%E7%9A%84%E4%BC%98%E5%8A%BF%E6%9D%A5%E6%BA%90"><span class="nav-number">2.8.</span> <span class="nav-text">MS2Fusion的优势来源</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C"><span class="nav-number">3.</span> <span class="nav-text">相关工作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B"><span class="nav-number">3.1.</span> <span class="nav-text">目标检测</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%85%89%E8%B0%B1%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B"><span class="nav-number">3.2.</span> <span class="nav-text">多光谱目标检测</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mamba"><span class="nav-number">3.3.</span> <span class="nav-text">Mamba</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E8%A8%80%E6%80%BB%E7%BB%93"><span class="nav-number">4.</span> <span class="nav-text">引言总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A0%94%E7%A9%B6%E9%97%AE%E9%A2%98"><span class="nav-number">4.1.</span> <span class="nav-text">研究问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BA%E6%96%87%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3"><span class="nav-number">4.2.</span> <span class="nav-text">论文核心思想</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E8%B4%A1%E7%8C%AE"><span class="nav-number">4.3.</span> <span class="nav-text">主要贡献</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B4%E4%BD%93%E7%BB%84%E4%BB%B6%E6%A6%82%E8%A7%88"><span class="nav-number">5.</span> <span class="nav-text">整体组件概览</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MS2Fusion-%E6%80%BB%E4%BD%93%E6%A1%86%E6%9E%B6%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3"><span class="nav-number">5.1.</span> <span class="nav-text">MS2Fusion 总体框架流程详解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E5%88%9B%E6%96%B0%E7%82%B9"><span class="nav-number">5.2.</span> <span class="nav-text">关键创新点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B9%E6%B3%95"><span class="nav-number">6.</span> <span class="nav-text">方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B%EF%BC%88SSM%EF%BC%89"><span class="nav-number">6.1.</span> <span class="nav-text">状态空间模型（SSM）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SSM-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">6.1.1.</span> <span class="nav-text">SSM 是什么？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%A0%B8%E5%BF%83%E6%89%AB%E6%8F%8F%E7%AE%97%E5%AD%90%EF%BC%9ASelectiveScan"><span class="nav-number">6.1.2.</span> <span class="nav-text">(1) 核心扫描算子：SelectiveScan</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%8D%95%E6%A8%A1%E6%80%81-1D-SSM%EF%BC%9A%E4%BB%A3%E7%A0%81%E9%87%8C%E7%9A%84-SSM-SS2D"><span class="nav-number">6.1.3.</span> <span class="nav-text">(2) 单模态 1D SSM：代码里的 SSM &#x2F; SS2D</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%80%E6%8F%90%E5%87%BA%E7%9A%84%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84"><span class="nav-number">6.2.</span> <span class="nav-text">所提出的模型架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%85%89%E8%B0%B1%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%EF%BC%88MS2Fusion%EF%BC%89"><span class="nav-number">6.3.</span> <span class="nav-text">多光谱状态空间特征融合（MS2Fusion）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CP-SSM-%E6%A8%A1%E5%9D%97"><span class="nav-number">6.3.1.</span> <span class="nav-text">CP-SSM 模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SP-SSM-%E6%A8%A1%E5%9D%97"><span class="nav-number">6.3.2.</span> <span class="nav-text">SP-SSM 模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DBISSF-SS"><span class="nav-number">6.3.3.</span> <span class="nav-text">DBISSF_SS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FF-SSM-%E6%A8%A1%E5%9D%97"><span class="nav-number">6.3.4.</span> <span class="nav-text">FF-SSM 模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CMSSF-CM-Attention"><span class="nav-number">6.3.5.</span> <span class="nav-text">CMSSF + CM_Attention</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="nav-number">6.4.</span> <span class="nav-text">损失函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#YOLO-%E6%A1%86%E6%9E%B6%E4%B8%8B%E7%9A%84%E6%80%BB%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="nav-number">6.4.1.</span> <span class="nav-text">YOLO 框架下的总损失函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CoDetr-%E6%A1%86%E6%9E%B6%E4%B8%8B%E7%9A%84%E6%80%BB%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="nav-number">6.4.2.</span> <span class="nav-text">CoDetr 框架下的总损失函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C"><span class="nav-number">7.</span> <span class="nav-text">实验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%92%8C%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87"><span class="nav-number">7.1.</span> <span class="nav-text">数据集和评估指标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E8%AE%BE%E7%BD%AE"><span class="nav-number">7.2.</span> <span class="nav-text">实验设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SOTA%E6%AF%94%E8%BE%83"><span class="nav-number">7.3.</span> <span class="nav-text">SOTA比较</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FLIR-%E6%95%B0%E6%8D%AE%E9%9B%86%E6%AF%94%E8%BE%83"><span class="nav-number">7.3.1.</span> <span class="nav-text">FLIR 数据集比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LLVIP-%E6%95%B0%E6%8D%AE%E9%9B%86%E6%AF%94%E8%BE%83"><span class="nav-number">7.3.2.</span> <span class="nav-text">LLVIP 数据集比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#M3FD-%E6%95%B0%E6%8D%AE%E9%9B%86%E6%AF%94%E8%BE%83"><span class="nav-number">7.3.3.</span> <span class="nav-text">M3FD 数据集比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VEDAI-%E6%95%B0%E6%8D%AE%E9%9B%86%E6%AF%94%E8%BE%83"><span class="nav-number">7.3.4.</span> <span class="nav-text">VEDAI 数据集比较</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%9B%E5%8C%96%E5%88%B0%E5%85%B6%E4%BB%96%E5%A4%9A%E6%A8%A1%E6%80%81%E4%BB%BB%E5%8A%A1"><span class="nav-number">7.4.</span> <span class="nav-text">泛化到其他多模态任务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RGB-T-%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2"><span class="nav-number">7.4.1.</span> <span class="nav-text">RGB-T 语义分割</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RGB-T-%E6%98%BE%E8%91%97%E6%80%A7%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B-RGB-T-SOD"><span class="nav-number">7.4.2.</span> <span class="nav-text">RGB-T 显著性目标检测 (RGB-T SOD)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B6%88%E8%9E%8D%E7%A0%94%E7%A9%B6"><span class="nav-number">7.5.</span> <span class="nav-text">消融研究</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E6%A3%80%E6%B5%8B%E6%A1%86%E6%9E%B6%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="nav-number">7.5.1.</span> <span class="nav-text">不同检测框架的影响</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E9%AA%A8%E5%B9%B2%E7%BD%91%E7%BB%9C%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="nav-number">7.5.2.</span> <span class="nav-text">不同骨干网络的影响</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E6%A8%A1%E5%9D%97%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="nav-number">7.5.3.</span> <span class="nav-text">不同模块的影响</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E8%9E%8D%E5%90%88%E5%B1%82%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="nav-number">7.5.4.</span> <span class="nav-text">不同融合层的影响</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CP-SSM-%E7%9A%84%E8%AE%A8%E8%AE%BA"><span class="nav-number">7.5.5.</span> <span class="nav-text">CP-SSM 的讨论</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E8%BE%93%E5%85%A5%E6%A8%A1%E6%80%81%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-number">7.5.6.</span> <span class="nav-text">不同输入模态的比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FF-SSM-%E8%BE%93%E5%85%A5%E9%85%8D%E7%BD%AE%E5%88%86%E6%9E%90"><span class="nav-number">7.5.7.</span> <span class="nav-text">FF-SSM 输入配置分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E6%80%A7%E5%88%86%E6%9E%90"><span class="nav-number">7.6.</span> <span class="nav-text">定性分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90"><span class="nav-number">7.6.1.</span> <span class="nav-text">模型统计分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%83%AD%E5%9B%BE%E5%8F%AF%E8%A7%86%E5%8C%96-%E5%9B%BE10"><span class="nav-number">7.6.2.</span> <span class="nav-text">热图可视化 (图10)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E6%AF%94%E8%BE%83%E5%8F%AF%E8%A7%86%E5%8C%96-%E5%9B%BE11"><span class="nav-number">7.6.3.</span> <span class="nav-text">特征融合比较可视化 (图11)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%92%8C%E4%BA%92%E8%A1%A5%E7%89%B9%E5%BE%81%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E6%9E%90-%E5%9B%BE12"><span class="nav-number">7.6.4.</span> <span class="nav-text">共享和互补特征的可视化分析 (图12)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RGB-T-%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2%E6%A0%B7%E6%9C%AC%E5%8F%AF%E8%A7%86%E5%8C%96-%E5%9B%BE13"><span class="nav-number">7.6.5.</span> <span class="nav-text">RGB-T 语义分割样本可视化 (图13)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RGB-T-%E6%98%BE%E8%91%97%E6%80%A7%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E6%A0%B7%E6%9C%AC%E5%8F%AF%E8%A7%86%E5%8C%96-%E5%9B%BE14"><span class="nav-number">7.6.6.</span> <span class="nav-text">RGB-T 显著性目标检测样本可视化 (图14)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%80%E9%99%90%E6%80%A7-%E5%9B%BE15"><span class="nav-number">7.7.</span> <span class="nav-text">局限性 (图15)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">8.</span> <span class="nav-text">结论</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">MaJianyu</p><div class="site-description" itemprop="description">永远相信，美好的事情即将发生。</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">23</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">9</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">42</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/majianyu2007" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;majianyu2007" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/600064036" title="BiliBili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;600064036" rel="noopener me" target="_blank"><i class="fa-brands fa-bilibili fa-fw"></i>BiliBili</a></span></div><div class="cc-license animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://mjy.js.org/2025/10/30/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20Inf.%20Fusion%202025%20%20MS2Fusion%EF%BC%9A%E5%A4%9A%E9%87%8D%E5%85%89%E8%B0%B1%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E3%80%91/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="MaJianyu"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="TranquilYu's Blog"><meta itemprop="description" content="永远相信，美好的事情即将发生。"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="【论文阅读 | Inf. Fusion 2025 | MS2Fusion：多重光谱状态空间特征融合】 | TranquilYu's Blog"><meta itemprop="description" content="MS2Fusion：多重光谱状态空间特征融合"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">【论文阅读 | Inf. Fusion 2025 | MS2Fusion：多重光谱状态空间特征融合】</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2025-10-30 08:00:00" itemprop="dateCreated datePublished" datetime="2025-10-30T08:00:00+08:00">2025-10-30</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-11-30 11:26:53" itemprop="dateModified" datetime="2025-11-30T11:26:53+08:00">2025-11-30</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" itemprop="url" rel="index"><span itemprop="name">论文阅读</span></a> </span></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>44k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1:21</span></span></div><div class="post-description">MS2Fusion：多重光谱状态空间特征融合</div></div></header><div class="post-body" itemprop="articleBody"><p>[TOC]</p><p><img data-src="/./../images/image-20251029230125038-1761991594416-18.png" alt="image-20251029230125038"></p><p>题目：Multispectral State-Space Feature Fusion: Bridging Shared and Cross-Parametric Interactions for Object Detection</p><p>期刊：Inf. Fusion(Information Fusion)</p><p>论文链接：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2507.14643">Link</a></p><p>关键词：Multispectral Object Detection(多光谱目标检测), State Space Model(状态空间模型), Shared-Parameter(共享参数), Cross-Parameter Interaction(跨参数交互).</p><p>代码：<a target="_blank" rel="noopener" href="https://github.com/61s61min/MS2Fusion.git">GitHub</a></p><p>年份：2025</p><hr><h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>现代多光谱特征融合用于目标检测面临两个关键限制：</p><ul><li>过度偏好局部互补特征而非跨模态共享语义，这对泛化性能产生不利影响；</li><li>感受野大小与计算复杂度之间的权衡，成为可扩展特征建模的关键瓶颈。</li></ul><blockquote><p>感受野大小：模型中单个神经元（或特征图上的单个像素）在原始输入图像上能够 “感知” 到的区域大小</p></blockquote><p>为解决这些问题，基于<strong>状态空间模型（SSM）</strong>，提出了一种新颖的多光谱状态空间特征融合框架，称为<strong>MS2Fusion</strong>，该框架通过<strong>双路径参数交互机制</strong>实现高效且有效的融合。</p><p>具体而言：</p><ol><li><p>第一个交叉参数交互分支继承了交叉注意力在挖掘互补信息方面的优势，并结合了SSM中的跨模态隐藏状态解码；</p></li><li><p>第二个共享参数分支通过SSM中的参数共享，利用联合嵌入探索跨模态对齐，以获取跨模态的相似语义特征和结构；</p></li><li><p>最后，对这两条路径进行联合优化。通过SSM在统一框架中融合多光谱特征，使MS2Fusion能够兼具功能互补性和共享语义空间。</p></li></ol><p>得益于双分支SSM的设计，MS2Fusion<strong>同时继承了计算效率和全局感受野</strong>，显著提升了多光谱目标检测的性能。实验表明，MS2Fusion在强大的基线模型上持续表现更优：</p><ul><li>在目标检测（FLIR）中，<a href="mailto:&#109;&#x41;&#x50;&#64;&#x30;&#46;&#53;">mAP@0.5</a>提升了3.3%；</li><li>在RGB-T语义分割（MFNet）中，mIoU提高了2.8%；</li><li>在显著目标检测（VT5000）中，MAE降低了0.7%。</li></ul><p>值得注意的是，无需进行特定任务的修改，MS2Fusion就在多个多光谱感知任务上取得了新的最先进结果，展现出卓越的泛化能力。</p><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><h3 id="多光谱目标检测优势"><a href="#多光谱目标检测优势" class="headerlink" title="多光谱目标检测优势"></a>多光谱目标检测优势</h3><p>近年来多光谱目标检测得到了越来越多的关注，这得益于其通过融合多个光谱波段（如RGB和热波段（即IR)）的信息所实现的鲁棒性能。</p><h3 id="单模态缺陷"><a href="#单模态缺陷" class="headerlink" title="单模态缺陷"></a>单模态缺陷</h3><p>RGB图像通常具有高分辨率，颜色丰富和纹理特征细腻的特点。但在弱光、恶劣天气或遮挡等复杂场景下，其性能会急剧下降。相比之下，热图像能够有效克服这些环境限制，但在颜色和纹理细节方面存在明显不足。当前通用的单模态目标检测方法难以很好地应对上述挑战。然而，多光谱特征融合为在这类具有挑战性的条件下提供可靠的目标检测解决方案开辟了道路。</p><p><img data-src="/./../images/image-20251030092635833-1761991594416-19.png" alt="image-20251030092635833"></p><p>图1：RGB图像（左）和热成像图像（右）的优缺点；（a）两种模态提供互补信息，它们的融合能够实现更稳健的目标检测；（b）双模态共享特征变得至关重要，因为两种模态中没有一种具有绝对优势。（例如，纹理和热辐射等模态特定特征变得模糊，而物体轮廓和结构等跨模态一致特征有助于检测）</p><p>如图1a所示，现有研究普遍认为，当一种模态不足时，互补特征发挥着关键作用。例如，当热成像物体缺乏清晰轮廓时，RGB图像能提供具有区分性的颜色和纹理线索；而当RGB成像受到低光照或遮挡影响时，热成像图像则能提供热特征。</p><p>然而，如图1b所示，在两种模态均表现出较弱区分性特征的场景中（例如，RGB图像中的纹理模糊和热成像图像中的低对比度），仅靠互补信息无法解决问题。在这些情况下，跨模态一致的形状和结构模式等共享特征变得至关重要，因为它们能够捕捉模态不变的表征，以实现可靠的检测。因此，作者推测，一个强大的多光谱目标检测框架应该<strong>动态地利用互补特征和共享特征</strong>，以应对各种来自现实世界的挑战。</p><blockquote><p>互补特征：指不同光谱模态（如 RGB 与热成像）各自具备、可相互补充的独特信息。</p></blockquote><blockquote><p>共享特征：不同光谱模态间共有的、具备模态不变性的信息，通常对应物体的通用语义或结构属性，如物体的轮廓、形状、整体结构等。</p></blockquote><h3 id="先前研究的不足"><a href="#先前研究的不足" class="headerlink" title="先前研究的不足"></a>先前研究的不足</h3><p>先前的研究主要集中于跨模态的互补特征学习，往往忽视了对模态间共享特征表示或固有结构相似性的探索。</p><p><strong>概括：重互补而轻共享，导致了泛化能力不足</strong></p><p>此外，现有方法通常采用单一的融合策略来直接组合多模态输入，忽略了自适应或分层融合机制的潜在优势。这些方法没有充分探索或利用跨模态共享特征，忽视了提升单模态特征性能的潜在作用。这种融合模式在跨模态整合过程中常常会压制较弱但具有判别性的特征，导致大量信息丢失。</p><p><strong>概括：融合策略单一，没有自适应机制</strong></p><p>对于多光谱目标检测而言，共享特征表示在多模态融合中起着关键作用。它不仅能减轻跨模态差异，还能增强单模态特征，从而在复杂环境中显著提高特征表达能力和检测鲁棒性。</p><h3 id="CNN与Transformer之缺陷"><a href="#CNN与Transformer之缺陷" class="headerlink" title="CNN与Transformer之缺陷"></a>CNN与Transformer之缺陷</h3><p>大多数主流方法采用CNN或Transformer进行特征融合。尽管这些方法有效，但现有的基于CNN的方法由于感受野有限，往往难以捕捉跨模态的更广泛上下文信息。另一方面，尽管基于Transformer的方法在建模全局依赖关系方面表现出色，但随着输入序列变长，其性能可能会下降，并且随着模型复杂度的增加，计算成本也会更高。这些因素限制了它们在资源受限环境中的实用性，凸显了在多光谱目标检测中需要更高效的融合策略。</p><p><strong>概括：感受野有限，上下文有限，输入越大性能越低</strong></p><h3 id="现阶段状况"><a href="#现阶段状况" class="headerlink" title="现阶段状况"></a>现阶段状况</h3><ul><li><p>多光谱目标检测领域近年来取得了一些进展，但现有方法仍主要侧重于<strong>学习跨模态的互补特征</strong>，忽视了对共享特征表示和固有结构相似性的探索。</p></li><li><p>大多数现有方法采用单一且直接的融合策略，这往往会抑制具有辨别力但较弱的特征，并导致大量有效信息丢失。</p></li><li><p>基于CNN的方法在捕捉跨模态上下文时受限于感受野，而基于Transformer的技术则存在计算效率低下的问题，且在处理长序列时性能会下降。</p></li><li><p>在语音识别和图像压缩中，特征表示的效率直接决定了系统性能——这一原则同样适用于多光谱检测。因此要增强系统性能即需要提高特征表示的效率。</p></li></ul><p>这些局限性凸显了对一种更具适应性和效率的融合范式的需求，这种范式不仅要<strong>弥合模态差异</strong>，还要<strong>通过共享表示增强单模态特征</strong>，最终提高在复杂环境中的鲁棒性。</p><h3 id="MS2Fusion的提出"><a href="#MS2Fusion的提出" class="headerlink" title="MS2Fusion的提出"></a>MS2Fusion的提出</h3><p>序列建模领域的最新进展表明，基于SSM的方法通过将特征压缩为紧凑的隐藏状态而表现出色，能够以恒定时间进行全序列处理，实现高效推理。Mamba通过选择性状态空间增强了这一点，动态保留与任务相关的特征。Vision Mamba（Vim）进一步证明了其在视觉任务中的有效性，同时提升了效率和性能。</p><blockquote><p>序列建模领域：专注于处理具有时序或空间顺序数据（如文本序列、图像像素序列、多模态特征序列等）的技术领域，其核心目标是通过建模数据间的顺序依赖关系，实现对数据特征的有效提取、压缩与利用。</p></blockquote><p>受此启发，本文作者提出了<strong>MS2Fusion</strong>，这是一个新颖的框架，它能同时利用跨模态的互补特征和共享特征，同时克服卷积神经网络（CNN）和Transformer在多光谱特征融合方面的局限性。</p><h3 id="MS2Fusion的优势体现"><a href="#MS2Fusion的优势体现" class="headerlink" title="MS2Fusion的优势体现"></a>MS2Fusion的优势体现</h3><h4 id="据图分析"><a href="#据图分析" class="headerlink" title="据图分析"></a>据图分析</h4><p><img data-src="/./../images/image-20251030102737886-1761991594416-20.png" alt="image-20251030102737886"></p><p>这张图比较三种<strong>多模态特征融合方法</strong> （主要用于红外图像 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 与可见光图像 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 的融合）：</p><hr><h5 id="a-Transformer-based-fusion"><a href="#a-Transformer-based-fusion" class="headerlink" title="(a) Transformer-based fusion"></a>(a) Transformer-based fusion</h5><ul><li><strong>原理</strong>：将 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 和 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 输入到 Transformer 编码器，通过 <strong>多头注意力机制 (Multi-Head Attention)</strong> 实现信息交互。</li><li><strong>特点</strong>：能有效捕捉两种模态的互补特征，但计算开销较大。</li><li><strong>优点</strong>：融合充分，性能较好。</li><li><strong>缺点</strong>：注意力机制成本高，且可能对对齐和噪声敏感。</li></ul><hr><h5 id="b-Mamba-based-fusion"><a href="#b-Mamba-based-fusion" class="headerlink" title="(b) Mamba-based fusion"></a>(b) Mamba-based fusion</h5><ul><li><strong>原理</strong>：直接将 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 和 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 输入线性层生成状态空间模型 (SSM) 的参数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05017em">B</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi></mrow><annotation encoding="application/x-tex">\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord">Δ</span></span></span></span>)。</li><li><strong>特点</strong>：融合过程简洁，但缺乏细粒度的模态交互。</li><li><strong>缺点</strong>：容易出现<strong>模态错位（misalignment）<strong>与</strong>特征冗余（redundancy）</strong>。</li></ul><blockquote><p>模态错位（misalignment）：不同模态（例如红外图像和可见光图像）之间信息不对应、空间或语义不对齐的情况。两种模态“看”的不是同一个位置或语义点，融合错了对象。</p></blockquote><blockquote><p>特征冗余（redundancy）：指不同模态中存在重复或相似的特征信息，导致融合后的表示中有大量“重复内容”。即两种模态提供了“重复的信息”，融合后没增加有效信息量，反而增加噪声。</p></blockquote><hr><h5 id="c-MS2Fusion（作者提出的方法）"><a href="#c-MS2Fusion（作者提出的方法）" class="headerlink" title="(c) MS2Fusion（作者提出的方法）"></a>(c) MS2Fusion（作者提出的方法）</h5><ul><li><p><strong>步骤</strong>：</p><ol><li>对每个模态内部先进行 <strong>Intra-modal Interaction（模态内交互）</strong> → 加强自身特征；</li><li>提取 <strong>Shared features（共享特征）</strong>；</li><li>再进行 <strong>Cross-modal Interaction（模态间交互）</strong> → 实现深层融合；</li><li>输出统一融合特征 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F_{fused}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9694em;vertical-align:-.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10764em">f</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span></span></span></span>)。</li></ol></li><li><p><strong>特点</strong>：通过先内后外的双层交互机制（模态内→模态间），获得更好的模态对齐与特征统一。</p></li><li><p><strong>优势</strong>：融合更稳健、信息更充分，减少特征重复与模态偏差。</p></li></ul><hr><p>简单总结：Transformer融合注重全局注意力、Mamba融合侧重线性高效计算，而MS2Fusion通过“模态内增强 + 模态间共享”双阶段策略，实现了更精确、鲁棒的多模态特征融合。</p><hr><p>通过本图2与实验数据即可得出MS2Fusion的优势</p><p>图2显示，基于Transformer的方法（a）和现有的Mamba解决方案（b）未能充分利用跨模态共享特征。相比之下，MS2Fusion方法（c）通过三个关键组件<strong>明确地对互补性和共享性的跨模态交互进行建模</strong>：</p><ul><li><strong>跨参数状态空间模型 (CP-SSM)</strong>：通过在特定模态的状态空间之间交换输出矩阵来促进隐式的特征互补，从而在保留特定模态特征的同时实现跨模态特征丰富；</li><li><strong>共享参数状态空间模型 (SP-SSM)</strong>：通过参数共享学习一个统一的特征空间，对齐异构模态分布，以提取能够增强单一模态特征的、有区别性的共享表示；</li><li><strong>特征融合状态空间模型 (FF-SSM)</strong>：引入一种双向输入机制以扩展状态空间的有效感受野 (ERF)，在减轻特征衰减的同时，实现跨模态信息的自适应融合。</li></ul><p>有效感受野分析（ERF）也可表明MS2Fusion有效性</p><p><img data-src="/./../images/image-20251030104145257-1761991594416-21.png" alt="image-20251030104145257"></p><p>图3：基于CNN的融合方法（a）、基于Transformer的融合方法（b）以及所提出的MS2Fusion方法（c）的有效感受野可视化对比。定量分析表明，与其他方法相比，MS2Fusion实现了显著更广泛的感受野覆盖。</p><p>由图3可得知，与CNN和Transformer相比，MS2Fusion实现了更出色的空间覆盖范围，成功地将局部细节与全局语境相结合。</p><p>简单来说，MS2Fusion模块在保持高计算效率的同时，有效解决了CNN在建模长距离依赖关系方面的限制。实验表明（依据下表数据），与Transformer和CNN基线相比，MS2Fusion均能以更低的计算成本和参数量实现更高的检测精度（mAP50分别提升8.3和9.0个点），且处理速度与CNN相当，远快于Transformer。这些证据表明MS2Fusion成功打破了多光谱目标检测中传统的效率-精度权衡，确立了新的SOTA性能。</p><p>表1：不同多光谱特征融合方法的比较（YoloV5框架，FLIR数据集）</p><table><thead><tr><th align="center">模型</th><th align="center">GFLOPs</th><th align="center">Params (M)</th><th align="center">FPS</th><th align="center"><a href="mailto:&#x6d;&#65;&#80;&#64;&#48;&#x2e;&#53;">mAP@0.5</a></th><th align="center"><a href="mailto:&#109;&#x41;&#x50;&#64;&#48;&#46;&#55;&#x35;">mAP@0.75</a></th><th align="center">mAP</th></tr></thead><tbody><tr><td align="center">CNN</td><td align="center">190.3</td><td align="center">159.7</td><td align="center">30.8</td><td align="center">74.3</td><td align="center">23.8</td><td align="center">32.5</td></tr><tr><td align="center">Transformer</td><td align="center">421.9</td><td align="center">440.6</td><td align="center">19.2</td><td align="center">75.0</td><td align="center">24.1</td><td align="center">33.4</td></tr><tr><td align="center">MS2Fusion</td><td align="center">140.8</td><td align="center">130.3</td><td align="center">29.7</td><td align="center">83.3</td><td align="center">33.0</td><td align="center">40.3</td></tr></tbody></table><h3 id="MS2Fusion的优势来源"><a href="#MS2Fusion的优势来源" class="headerlink" title="MS2Fusion的优势来源"></a>MS2Fusion的优势来源</h3><p>MS2Fusion引入了一种新颖的状态空间框架。其<strong>CP-SSM</strong>捕捉了隐含的特征互补性，而<strong>SP-SSM</strong>增强了共享表示，在特定模态学习和跨模态学习之间实现了最佳平衡。</p><ul><li><p>出于将全局上下文建模与计算效率相结合的需求，FF-SSM机制独特地实现了Transformer级别的感受野，同时保持了类CNN的效率。这一突破解决了多模态系统中性能与计算成本之间长期存在的权衡问题。</p></li><li><p>MS2Fusion架构提供灵活的多模态集成，支持各种检测框架和骨干网络。它能无缝处理RGB、热成像和其他模态，无需更改架构即可在不同视觉任务中广泛应用。</p></li><li><p>MS2Fusion在基准数据集上实现了最先进的性能，包括RGB-T目标检测、语义分割和显著目标检测，验证了其在多光谱图像感知方面的有效性。</p></li></ul><h2 id="相关工作"><a href="#相关工作" class="headerlink" title="相关工作"></a>相关工作</h2><h3 id="目标检测"><a href="#目标检测" class="headerlink" title="目标检测"></a>目标检测</h3><ul><li><strong>主流方法</strong>：主要分为两大类：<ul><li><strong>两阶段检测器</strong> （如 Faster R-CNN）：先生成候选区域，再进行分类和边界框回归，通常精度较高。</li><li><strong>单阶段检测器</strong> （如 YOLO、SSD）：直接在图像上进行检测，速度更快。</li></ul></li><li><strong>边界框预测机制</strong>：<ul><li>**基于锚点（Anchor-based）**方法：利用预定义的锚点进行回归调整。</li><li>**无锚点（Anchor-free）**方法（如 FCOS）：直接预测边界或中心，简化流程，效率更高。</li></ul></li><li><strong>新兴的基于 Transformer 的方法</strong>：<ul><li><strong>DETR</strong>：引入 Transformer 实现完全端到端检测，将检测视为集合预测问题，消除了锚点和 NMS 等人工设计组件。但存在计算成本高和收敛慢的问题。</li></ul></li><li><strong>本文方法的优势</strong>：为验证所提方法（MS2Fusion，结合上下文推测）的有效性，选择了 <strong>YOLOv5</strong> 和 <strong>CoDetr</strong> 进行对比实验，结果显示该方法具有<strong>线性时间复杂度</strong> （高效率）和<strong>全局感受野</strong> （捕获更丰富上下文信息）两大优势。</li></ul><h3 id="多光谱目标检测"><a href="#多光谱目标检测" class="headerlink" title="多光谱目标检测"></a>多光谱目标检测</h3><ul><li><strong>早期方法</strong>：侧重于平衡特征集成，例如<strong>循环融合模块 (Cyclic Fusion Module)</strong> 显式建模模态间的互补性和一致性。</li><li><strong>注意力机制的引入</strong>：通过 <strong>引导注意力特征融合 (GAFF)</strong> 等方法，利用自适应的模态内和跨模态注意力动态加权特征，提高了融合性能。</li><li><strong>基于 Transformer 的架构</strong>：<strong>跨模态融合 Transformer (CFT)</strong> 和 <strong>CMX</strong> 等利用自注意力机制捕获跨模态的<strong>长距离依赖</strong>和全局上下文；后续的 <strong>ICAFusion</strong> 和 <strong>INSANet</strong> 等变体则通过参数共享或专用光谱注意力块优化了效率和灵活性。</li><li><strong>解决特定挑战的创新方法</strong>：<ul><li><strong>DAMSDet</strong> 使用可变形交叉注意力处理模态<strong>不对齐</strong>和动态互补特性。</li><li><strong>MS-DETR</strong> 引入<strong>参考约束融合</strong>改进 RGB-热成像对齐。</li><li><strong>轻量级设计</strong>，如 <strong>CPCF 模块</strong>，结合通道和块级交叉注意力实现高效融合。</li><li><strong>TFDet</strong> 采用融合-精修范式以自适应感受野抑制假阳性。</li><li><strong>MMFN</strong> 提出了一个全面的<strong>分层融合框架</strong>，整合了局部、全局和通道级交互。</li></ul></li><li><strong>本文方法的区别</strong>：所提出的方法采用一种<strong>新颖的状态空间模型 (SSM)</strong> 进行特征融合，这与以往使用 <strong>CNN</strong> 或 <strong>Transformer</strong> 进行特征融合的方法不同。</li></ul><h3 id="Mamba"><a href="#Mamba" class="headerlink" title="Mamba"></a>Mamba</h3><ul><li><strong>Mamba 模型</strong>：<ul><li>Mamba 是一种<strong>选择性结构化状态空间模型</strong>，专为高效的<strong>长序列建模</strong>设计。</li><li>它通过结合<strong>全局感知场</strong>和<strong>动态加权</strong>，克服了 CNN 的局限性，实现了与 Transformer 相当的高级建模能力，但避免了 Transformer 典型的<strong>二次复杂度</strong>。</li></ul></li><li><strong>Mamba 在视觉领域的应用</strong>：<ul><li><strong>VMamba</strong>：一种视觉状态空间模型，引入了<strong>交叉扫描模块 (CSM)</strong> 来提高跨维度扫描效率，在计算机视觉任务中性能超越了 CNN 和 ViT。</li><li><strong>VM-UNet</strong>：将 Mamba 集成到 UNet 框架中用于医学分割，利用视觉状态空间块捕获广泛的<strong>上下文信息</strong>。</li><li>Mamba 还被应用于多模态语义分割，通过<strong>暹罗编码器</strong>和创新融合机制，以<strong>线性复杂度</strong>增强了<strong>全局感受野</strong>覆盖。</li></ul></li><li><strong>本文提出的 MS2Fusion</strong>：<ul><li>受上述进展启发，本文基于 Mamba <strong>动态状态空间</strong>提出了 <strong>MS2Fusion</strong>。</li><li>该方法旨在有效利用模态间的<strong>共享特征和互补性</strong>，从而在<strong>降低模型复杂度</strong>的同时，<strong>提高目标检测的精度</strong>。</li></ul></li></ul><h2 id="引言总结"><a href="#引言总结" class="headerlink" title="引言总结"></a>引言总结</h2><h3 id="研究问题"><a href="#研究问题" class="headerlink" title="研究问题"></a>研究问题</h3><p>多光谱目标检测（RGB + 热红外）能在复杂场景下保持鲁棒性，但现有方法存在两大痛点：</p><ol><li><strong>偏重互补特征，忽略共享语义</strong>，导致泛化能力不足；</li><li><strong>感受野与效率权衡难</strong> —— CNN 看得近、Transformer 看得远但太慢。</li></ol><h3 id="论文核心思想"><a href="#论文核心思想" class="headerlink" title="论文核心思想"></a>论文核心思想</h3><p>作者提出 <strong>MS2Fusion（Multispectral State-Space Feature Fusion）</strong> 框架，利用**状态空间模型（SSM）**实现高效的多模态特征融合。它通过双路径结构：</p><ul><li>一条学习<strong>互补特征</strong>（不同模态的信息互补）</li><li>一条学习<strong>共享特征</strong>（模态间一致的语义）</li></ul><p>最终，融合结果既具有跨模态互补性，也具有共享语义一致性。</p><h3 id="主要贡献"><a href="#主要贡献" class="headerlink" title="主要贡献"></a>主要贡献</h3><ol><li>提出 <strong>双路径状态空间特征融合框架 MS2Fusion</strong>；</li><li>将 <strong>Mamba 动态状态空间结构</strong>引入多模态特征建模；</li><li>同时实现 <strong>Transformer 级感受野 + CNN 级效率</strong>；</li><li>在多任务上取得 <strong>SOTA 性能</strong>（检测、分割、显著目标识别）。</li></ol><h2 id="整体组件概览"><a href="#整体组件概览" class="headerlink" title="整体组件概览"></a>整体组件概览</h2><p><img data-src="/./../images/MS2Fusion-overreview-1761991594416-22.png" alt="img"></p><h3 id="MS2Fusion-总体框架流程详解"><a href="#MS2Fusion-总体框架流程详解" class="headerlink" title="MS2Fusion 总体框架流程详解"></a>MS2Fusion 总体框架流程详解</h3><p>整个网络包含三个阶段：</p><ol><li><strong>特征提取阶段</strong>：<ul><li>两个独立主干网络分别提取 RGB 与红外特征；</li></ul></li><li><strong>跨模态融合阶段</strong>：<ul><li>将三层特征（P3, P4, P5）分别送入 MS2Fusion 模块；</li></ul></li><li><strong>检测阶段</strong>：<ul><li>使用 YOLOv5 或 CoDetr Head 生成检测结果。</li></ul></li></ol><p>融合公式如下：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>F</mi><mrow><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow><mi>i</mi></msubsup><mo>=</mo><msub><mi>ϕ</mi><mrow><mi>M</mi><mi>S</mi><mn>2</mn><mi>F</mi><mi>u</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub><mo stretchy="false">(</mo><msubsup><mi>F</mi><mi>V</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mi>T</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_{fused}^i = \phi_{MS2Fusion}(F_V^i, F_T^i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2578em;vertical-align:-.3831em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8747em"><span style="top:-2.453em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10764em">f</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3831em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05764em">MS</span><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:.13889em">F</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8747em"><span style="top:-2.453em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8747em"><span style="top:-2.453em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>V</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">F_V^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-.2753em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8247em"><span style="top:-2.4247em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2753em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>T</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">F_T^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-.2753em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8247em"><span style="top:-2.4247em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2753em"><span></span></span></span></span></span></span></span></span></span> 分别为两模态特征，输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mrow><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">F_{fused}^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-.4192em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8247em"><span style="top:-2.4169em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10764em">f</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192em"><span></span></span></span></span></span></span></span></span></span> 为融合结果。</p><h3 id="关键创新点"><a href="#关键创新点" class="headerlink" title="关键创新点"></a>关键创新点</h3><p>MS2Fusion 流程的优势在于它通过双路径（CP-SSM+SP-SSM）机制实现了对多光谱特征的<strong>高效</strong>且<strong>全面</strong>的融合：</p><ul><li><strong>利用 SSM:</strong> SSM 模型能够有效地建模<strong>长程依赖关系</strong> （大感受野），同时保持<strong>与 CNN 相当的计算效率</strong>，打破了传统架构的局限性。</li><li><strong>双路径优势:</strong><ul><li><strong>CP-SSM:</strong> 捕捉互补特征。专注于<strong>互补性</strong>，确保两个模态的独特信息得到有效利用。</li><li><strong>SP-SSM:</strong> 学习共享语义。专注于<strong>共享语义</strong>，提高了模型的泛化能力和对齐度。</li><li><strong>联合优化:</strong> 以上两路径使得MS2Fusion模型能够兼顾<strong>功能互补性</strong>和<strong>共享语义空间</strong>。</li></ul></li></ul><p>也就是说：MS2Fusion 同时让模型“看到不同”和“理解相同”。</p><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><h3 id="状态空间模型（SSM）"><a href="#状态空间模型（SSM）" class="headerlink" title="状态空间模型（SSM）"></a>状态空间模型（SSM）</h3><p>SSM（状态空间模型）本身并不是本文作者发明的模块，它起源于控制理论，并在 Mamba 模型中被引入深度学习。<br>它的最大优势是：能像 Transformer 一样捕捉全局关系（具有大感受野），但计算复杂度只有线性级别（也就是和 CNN 一样高效）。</p><p>本文所提出模型 MS2Fusion 的创新点是：把 SSM 结构应用到多模态特征融合中，并设计了三种变体（CP、SP、FF）来分别建模互补信息与共享语义。这使得模型在保持高效率的同时，具备了强大的跨模态理解能力。</p><p>SSM结合了循环神经网络（RNNs）和卷积神经网络（CNNs）的优势，能够高效处理长依赖关系。它通过状态方程将输入序列(x(t))转换为中间状态(h(t))，然后通过输出方程生成输出(y(t))。SSM通常表示为一个线性常微分方程：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">A</mi><mo>⋅</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="bold">B</mi><mo>⋅</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">C</mi><mo>⋅</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="bold">D</mi><mo>⋅</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align} h&#x27;(t) &amp;= \mathbf{A} \cdot h(t) + \mathbf{B} \cdot x(t) \\ y(t) &amp;= \mathbf{C} \cdot h(t) + \mathbf{D} \cdot x(t) \end{align} \tag{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8019em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathbf">A</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathbf">B</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathbf">C</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathbf">D</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span><p>为了使状态空间模型（SSM）适应深度学习，需将其离散化如下：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>h</mi><mi>k</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mover accent="true"><mi mathvariant="bold">A</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>h</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mover accent="true"><mi mathvariant="bold">B</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>x</mi><mi>k</mi></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>y</mi><mi>k</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mover accent="true"><mi mathvariant="bold">C</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>h</mi><mi>k</mi></msub><mo>+</mo><mi mathvariant="bold">D</mi><mo>⋅</mo><msub><mi>x</mi><mi>k</mi></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>e</mi><mi>x</mi><msup><mi>p</mi><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="bold">A</mi></mrow></msup></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>B</mi><mo stretchy="true">‾</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi>e</mi><mi>x</mi><msup><mi>p</mi><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="bold">A</mi></mrow></msup><mo>−</mo><mi mathvariant="bold">I</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">Δ</mi><mi mathvariant="bold">A</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>C</mi><mo stretchy="true">‾</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">C</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align} h_k &amp;= \overline{\mathbf{A}} \cdot h_{k-1} + \overline{\mathbf{B}} \cdot x_k \\ y_k &amp;= \overline{\mathbf{C}} \cdot h_k + \mathbf{D} \cdot x_k \\ \overline{A} &amp;= exp^{\Delta \mathbf{A}} \\ \overline{B} &amp;= (exp^{\Delta \mathbf{A}} - \mathbf{I}) / \Delta \mathbf{A} \\ \overline{C} &amp;= \mathbf{C} \end{align} \tag{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.7421em;vertical-align:-3.6211em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1211em"><span style="top:-6.2349em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-4.6888em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.1356em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8833em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span></span></span><span style="top:-1.5823em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8833em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span></span></span><span style="top:-3.8033em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span></span></span><span style="top:-.0389em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8833em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span><span style="top:-3.8033em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6211em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1211em"><span style="top:-6.2349em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8861em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">A</span></span></span><span style="top:-3.8061em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8861em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">B</span></span></span><span style="top:-3.8061em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-4.6888em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8861em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">C</span></span></span><span style="top:-3.8061em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathbf">D</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.1356em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8933em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mathbf mtight">A</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.5823em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8933em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mathbf mtight">A</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathbf">I</span><span class="mclose">)</span><span class="mord">/Δ</span><span class="mord mathbf">A</span></span></span><span style="top:-.0389em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathbf">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6211em"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:7.7421em;vertical-align:-3.6211em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span><p>离散化后，SSM使用卷积操作进行并行计算。为了克服参数固定的问题，SSM引入了动态调整机制，使模型能够灵活处理复杂数据并改进长序列建模。</p><p>如图4所示，状态空间模型（SSM）通过由三项关键操作组成的结构化转换对输入序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>L</mi></msub><mo stretchy="false">}</mo><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>L</mi><mo>×</mo><mi>d</mi></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\{x_{1},x_{2},...,x_{L}\}\in \mathbb{R}^{L\times d})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">({</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8491em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>进行转化处理。</p><p><img data-src="/./../images/image-20251030142035432-1761991594416-23.png" alt="image-20251030142035432"></p><p><strong>图4：SSM（状态空间模型），其中红色、绿色和黑色的线分别对应于公式 (2) 的方程。</strong></p><h4 id="SSM-是什么？"><a href="#SSM-是什么？" class="headerlink" title="SSM 是什么？"></a>SSM 是什么？</h4><p>可以把 SSM 想成一个<strong>有记忆的滤波器</strong>：</p><ul><li>每一时刻（或者每一个像素位置）都有一个「隐藏状态」<code>h</code>，就像大脑里当前记着的东西</li><li>当前输入 <code>x</code>（图像的一小块特征）会和前面记住的 <code>h</code> 一起，算出新的 <code>h</code></li><li>然后根据这个新的 <code>h</code> 和当前 <code>x</code>，算出输出 <code>y</code>（更新后的特征）</li></ul><p>论文里连续时间的 SSM 一般写成类似这样：</p><blockquote><p>状态变化 &#x3D; A × 状态 + B × 输入<br>输出 &#x3D; C × 状态 + D × 输入</p></blockquote><ul><li><strong>A、B、C、D</strong>：可以理解成四张「参数表」，告诉模型：<ul><li>以前的记忆（h）是如何影响现在</li><li>当前输入（x）是如何影响现在</li><li>输出 y 怎么从记忆和输入里“读”出来</li></ul></li></ul><p>因为我们在电脑里是一步一步处理序列（像一串像素），所以会把上面的「连续方程」离散化成：</p><blockquote><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><msub><mi>h</mi><mi>k</mi></msub><mo>=</mo><mover accent="true"><mi mathvariant="bold">A</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>h</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mover accent="true"><mi mathvariant="bold">B</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>x</mi><mi>k</mi></msub><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">&gt; h_k = \overline{\mathbf{A}} \cdot h_{k-1} + \overline{\mathbf{B}} \cdot x_k \\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8861em"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8861em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">A</span></span></span><span style="top:-3.8061em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.9028em;vertical-align:-.2083em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.8861em"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8861em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">B</span></span></span><span style="top:-3.8061em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.5806em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span>> y_k = \overline{\mathbf{C}} \cdot h_k + \mathbf{D} \cdot x_k <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span>**SSM（State Space Model）** 是一种“记忆+预测”模型：</blockquote><ul><li>输入：序列特征（如图像 patch 序列）</li><li>输出：同维度特征</li><li>核心：四个矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo separator="true">,</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A,B,C,D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02778em">D</span></span></span></span> 控制信息流动：<ul><li><strong>A：</strong> 控制“记忆前面内容”；</li><li><strong>B：</strong> 决定“新信息如何进入”；</li><li><strong>C：</strong> 决定“输出什么特征”；</li><li><strong>D：</strong> 帮助防止梯度消失。</li></ul></li></ul><h4 id="1-核心扫描算子：SelectiveScan"><a href="#1-核心扫描算子：SelectiveScan" class="headerlink" title="(1) 核心扫描算子：SelectiveScan"></a>(1) 核心扫描算子：SelectiveScan</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> selective_scan_cuda_core <span class="keyword">as</span> selective_scan_cuda // 公式二调用</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SelectiveScan</span>(torch.autograd.Function):</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line"><span class="meta">    @torch.cuda.amp.custom_fwd(<span class="params">cast_inputs=torch.float32</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">ctx, u, delta, A, B, C, D=<span class="literal">None</span>, delta_bias=<span class="literal">None</span>, delta_softplus=<span class="literal">False</span>, nrows=<span class="number">1</span></span>):</span><br><span class="line">        <span class="keyword">assert</span> nrows <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">f&#x27;<span class="subst">&#123;nrows&#125;</span>&#x27;</span></span><br><span class="line">        <span class="keyword">assert</span> u.shape[<span class="number">1</span>] % (B.shape[<span class="number">1</span>] * nrows) == <span class="number">0</span>, <span class="string">f&#x27;<span class="subst">&#123;nrows&#125;</span>, <span class="subst">&#123;u.shape&#125;</span>, <span class="subst">&#123;B.shape&#125;</span>&#x27;</span></span><br><span class="line">        ctx.delta_softplus = delta_softplus</span><br><span class="line">        ctx.nrows = nrows</span><br><span class="line">        <span class="keyword">if</span> u.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            u = u.contiguous()</span><br><span class="line">        <span class="keyword">if</span> delta.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            delta = delta.contiguous()</span><br><span class="line">        <span class="keyword">if</span> D <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            D = D.contiguous()</span><br><span class="line">        <span class="keyword">if</span> B.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            B = B.contiguous()</span><br><span class="line">        <span class="keyword">if</span> C.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            C = C.contiguous()</span><br><span class="line">        <span class="keyword">if</span> B.dim() == <span class="number">3</span>:</span><br><span class="line">            B = B.unsqueeze(dim=<span class="number">1</span>)</span><br><span class="line">            ctx.squeeze_B = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> C.dim() == <span class="number">3</span>:</span><br><span class="line">            C = C.unsqueeze(dim=<span class="number">1</span>)</span><br><span class="line">            ctx.squeeze_C = <span class="literal">True</span></span><br><span class="line">        // 以下为公式二的代码实现</span><br><span class="line">        out, x, *rest = selective_scan_cuda.fwd(u, delta, A, B, C, D, delta_bias, delta_softplus, nrows) </span><br><span class="line">        // 公式二结束</span><br><span class="line">        ctx.save_for_backward(u, delta, A, B, C, D, delta_bias, x)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line"><span class="meta">    @torch.cuda.amp.custom_bwd</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">backward</span>(<span class="params">ctx, dout, *args</span>):</span><br><span class="line">        u, delta, A, B, C, D, delta_bias, x = ctx.saved_tensors</span><br><span class="line">        <span class="keyword">if</span> dout.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            dout = dout.contiguous()</span><br><span class="line">        du, ddelta, dA, dB, dC, *dD, ddelta_bias, rest = selective_scan_cuda.bwd(u, delta, A, B, C, D, delta_bias, dout, x, ctx.delta_softplus, <span class="number">1</span>)</span><br><span class="line">        dB = dB.squeeze(<span class="number">1</span>) <span class="keyword">if</span> <span class="built_in">getattr</span>(ctx, <span class="string">&#x27;squeeze_B&#x27;</span>, <span class="literal">False</span>) <span class="keyword">else</span> dB</span><br><span class="line">        dC = dC.squeeze(<span class="number">1</span>) <span class="keyword">if</span> <span class="built_in">getattr</span>(ctx, <span class="string">&#x27;squeeze_C&#x27;</span>, <span class="literal">False</span>) <span class="keyword">else</span> dC</span><br><span class="line">        <span class="keyword">return</span> (du, ddelta, dA, dB, dC, dD, ddelta_bias, <span class="literal">None</span>, <span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>此处代码对应公式(2)。</p><ul><li><code>u</code> 对应论文里的输入序列 xₖ</li><li><code>delta</code> 对应 Δ（时间步长）</li><li><code>A, B, C, D</code> 就是 SSM 参数</li><li>输出 <code>out</code> 对应 y 序列</li></ul><h4 id="2-单模态-1D-SSM：代码里的-SSM-SS2D"><a href="#2-单模态-1D-SSM：代码里的-SSM-SS2D" class="headerlink" title="(2) 单模态 1D SSM：代码里的 SSM &#x2F; SS2D"></a>(2) 单模态 1D SSM：代码里的 SSM &#x2F; SS2D</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x: torch.Tensor</span>):</span><br><span class="line">    selective_scan = selective_scan_fn_v1</span><br><span class="line">    B, L, d = x.shape        <span class="comment"># B=批大小, L=长度(H*W), d=通道数</span></span><br><span class="line">    x = x.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)   <span class="comment"># 变成 B, d, L</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 线性投影出 dt, B, C</span></span><br><span class="line">    x_dbl = <span class="variable language_">self</span>.x_proj(rearrange(x, <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>))</span><br><span class="line">    dt, B, C = torch.split(x_dbl, [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 把 dt 投影成每个通道的 Δ</span></span><br><span class="line">    dt = <span class="variable language_">self</span>.dt_proj.weight @ dt.t()</span><br><span class="line">    dt = rearrange(dt, <span class="string">&#x27;d (b l) -&gt; b d l&#x27;</span>, l=L)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 把 B、C reshape 回 B, d_state, L</span></span><br><span class="line">    A = -torch.exp(<span class="variable language_">self</span>.A_log.<span class="built_in">float</span>())</span><br><span class="line">    B = rearrange(B, <span class="string">&#x27;(b l) dstate -&gt; b dstate l&#x27;</span>, l=L).contiguous()</span><br><span class="line">    C = rearrange(C, <span class="string">&#x27;(b l) dstate -&gt; b dstate l&#x27;</span>, l=L).contiguous()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 跑 SelectiveScan，也就是公式(2)</span></span><br><span class="line">    y = selective_scan(x, dt, A, B, C, <span class="variable language_">self</span>.D.<span class="built_in">float</span>(),</span><br><span class="line">                       delta_bias=<span class="variable language_">self</span>.dt_proj.bias.<span class="built_in">float</span>(), delta_softplus=<span class="literal">True</span>)</span><br><span class="line">    y = rearrange(y, <span class="string">&#x27;b d l -&gt; b l d&#x27;</span>)</span><br><span class="line">    y = <span class="variable language_">self</span>.out_norm(y)</span><br><span class="line">    <span class="keyword">return</span> y </span><br></pre></td></tr></table></figure><p>对应关系（图4 &amp; 式(2)）：</p><ul><li>论文中 Linear(·) 生出 Δ、B、C<br>对应代码中 <code>self.x_proj(...)</code> + <code>torch.split(... dt, B, C ...)</code></li><li>论文中的 A、D<br>对应代码中 <code>self.A_log</code> 通过 <code>A = -exp(A_log)</code> 得到 A，<code>self.D</code> 就是 D 参数</li><li>论文中的「沿序列扫描」<br>对应代码中 <code>selective_scan(x, dt, A, B, C, D, ...)</code></li></ul><p>这个就是最基本的 <strong>单模态 Mamba&#x2F;SSM 单元</strong>。</p><hr><p>Mamba 的创新在于：这些矩阵是动态生成的，因此模型能根据输入自动调节“记忆与更新”的比例。</p><p>MS2Fusion 把这一机制应用到多模态特征上，实现了：</p><ul><li>线性复杂度（高效率）；</li><li>全局感受野（强语义建模能力）。</li></ul><h3 id="所提出的模型架构"><a href="#所提出的模型架构" class="headerlink" title="所提出的模型架构"></a>所提出的模型架构</h3><p><img data-src="/./../images/image-20251030144143991-1761991594416-24.png" alt="image-20251030144143991"></p><p><strong>图5：模型架构概述。</strong> 该模型由三个主要阶段构成：(1) 使用两个主干网络进行<strong>特征提取</strong>；(2) 通过 <strong>MS2Fusion 模块</strong>对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">P_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">P_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 层的特征进行<strong>跨模态特征融合</strong>；(3) 通过颈部（Neck）和头部（Head）层生成<strong>检测结果</strong>。</p><h3 id="多光谱状态空间特征融合（MS2Fusion）"><a href="#多光谱状态空间特征融合（MS2Fusion）" class="headerlink" title="多光谱状态空间特征融合（MS2Fusion）"></a>多光谱状态空间特征融合（MS2Fusion）</h3><p>如图5的下半部分所示，MS2Fusion模块由三个核心组件构成：跨参数状态空间模型（CP-SSM）、共享参数状态空间模型（SP-SSM）和特征融合状态空间模型（FF-SSM）。</p><p>下面对这几个模块进行分析。</p><p>在 <code>common.py</code> 里，真正对应 MS2Fusion 的模块名叫 <strong><code>SSF</code></strong>（Shared &amp; Cross SSM Fusion，可以理解成 S³Fusion）。</p><p>简化代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SSF</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">..., hidden_dim: <span class="built_in">int</span>=<span class="number">0</span>, Cross: <span class="built_in">bool</span>=<span class="literal">True</span>, scan: <span class="built_in">bool</span>=<span class="literal">False</span>, ...</span>):</span><br><span class="line">        ...</span><br><span class="line">        <span class="comment"># DBI 部分：做 CP-SSM + SP-SSM</span></span><br><span class="line">        <span class="variable language_">self</span>.dbi_fusion = DBISSF(..., Cross=Cross)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># CM 部分：做 FF-SSM（concat + Mamba 2D）</span></span><br><span class="line">        <span class="variable language_">self</span>.cm_fusion = CMSSF(...)</span><br><span class="line">        <span class="variable language_">self</span>.cm_fusion_rgb = CMSSF(...)</span><br><span class="line">        <span class="variable language_">self</span>.cm_fusion_e   = CMSSF(...) </span><br></pre></td></tr></table></figure><p><code>SSF.forward</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">    <span class="comment"># x = [x_rgb, x_e]</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.only_cm <span class="keyword">and</span> (<span class="keyword">not</span> <span class="variable language_">self</span>.only_dbi):</span><br><span class="line">        x_cross_rgb, x_share_rgb, x_cross_e, x_share_e = <span class="variable language_">self</span>.dbi_fusion(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 先各自 RGB / E 内部融合（FF-SSM）</span></span><br><span class="line">        x_fuse_rgb = [x_cross_rgb, x_share_rgb]</span><br><span class="line">        x_fuse_e   = [x_cross_e,   x_share_e]</span><br><span class="line">        x_rgb = <span class="variable language_">self</span>.cm_fusion_rgb(x_fuse_rgb)</span><br><span class="line">        x_e   = <span class="variable language_">self</span>.cm_fusion_e(x_fuse_e)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 再把两个模态一起再融合一次（FF-SSM 最后一层）</span></span><br><span class="line">        x_new = [x_rgb, x_e]</span><br><span class="line">        x_feat = <span class="variable language_">self</span>.cm_fusion(x_new)</span><br><span class="line">    <span class="keyword">return</span> x_feat</span><br></pre></td></tr></table></figure><p>对应论文式(3)：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>i</mi><mi>V</mi></msubsup></mrow><annotation encoding="application/x-tex">Fᵢ^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-.2587em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-2.4413em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2587em"><span></span></span></span></span></span></span></span></span></span> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">x_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">b</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>i</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">Fᵢ^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-.2587em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-2.4413em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2587em"><span></span></span></span></span></span></span></span></span></span> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">x_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5806em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>M</mi></msub><mi>S</mi><mn>2</mn><mi>F</mi><mi>u</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Φ_MS2Fusion</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span></span> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SSF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">SSF</span></span></span></span> 模块里的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>b</mi><msub><mi>i</mi><mi>f</mi></msub><mi>u</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">dbi_fusion</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9805em;vertical-align:-.2861em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span></span> + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>m</mi><mi>f</mi></msub><mi>u</mi><mi>s</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mo>∗</mo></msub></mrow><annotation encoding="application/x-tex">cm_fusion_*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9456em;vertical-align:-.2861em"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1757em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 整套</li><li>输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>f</mi></msub><mi>e</mi><mi>a</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">x_feat</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9012em;vertical-align:-.2861em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span></span></span></span> 就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>i</mi><mi>f</mi></msubsup><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Fᵢ^fused</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-.2769em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.967em"><span style="top:-2.4231em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.1809em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2769em"><span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mord mathnormal">se</span><span class="mord mathnormal">d</span></span></span></span>，接着会被送进 YOLOv5 的 neck&#x2F;head 继续预测</li></ul><h4 id="CP-SSM-模块"><a href="#CP-SSM-模块" class="headerlink" title="CP-SSM 模块"></a>CP-SSM 模块</h4><p><img data-src="/./../images/image-20251030151609728-1761991594416-25.png" alt="image-20251030151609728"></p><p>图 6 CP-SSM模块的细节 跨参数状态空间模型</p><p><strong>图注：</strong> CP-SSM 模块的细节图。特征图 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 首先通过行和列扫描被重塑为序列 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>V</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{Vi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5806em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Vi</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>T</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{Ti}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5806em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>)，并通过一个线性层（Linear layer）生成参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05017em">B</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi></mrow><annotation encoding="application/x-tex">\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord">Δ</span></span></span></span>。其次，作者通过交换两个分支的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 矩阵来执行跨模态互补特征的交互。最后，通过SSM模块进行跨模态互补特征交互，以生成输出 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>F</mi><mo>~</mo></mover><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{F}_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9202em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span></span><span style="top:-3.6023em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.1667em"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>F</mi><mo>~</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{F}_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9202em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span></span><span style="top:-3.6023em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.1667em"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>)。</p><p><strong>目标：</strong> 挖掘 RGB 与热成像间的互补特征。</p><p><strong>思路：</strong></p><ul><li>RGB 与热红外各自进入 SSM；</li><li>在计算时交换参数 C（相当于互换“视角”）；</li><li>让 RGB 学到热红外的“温度信息”，热红外学到 RGB 的“纹理信息”。</li></ul><p>在仓库中，此模块相关代码位于<code>common.py</code></p><p>在类<code>DBISSF_Attention.forward</code>中</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x_rgb, x_share_rgb, x_e, x_share_e</span>):</span><br><span class="line">    selective_scan = selective_scan_fn_v1</span><br><span class="line">    B, L, d = x_rgb.shape</span><br><span class="line">    <span class="comment"># 调整维度</span></span><br><span class="line">    x_rgb        = x_rgb.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    x_e          = x_e.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    x_share_rgb  = x_share_rgb.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    x_share_e    = x_share_e.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 线性投影，分别得到 RGB / E / share 的 dt, B, C</span></span><br><span class="line">    x_dbl_rgb   = <span class="variable language_">self</span>.x_proj_1(rearrange(x_rgb, <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>))</span><br><span class="line">    x_dbl_e     = <span class="variable language_">self</span>.x_proj_2(rearrange(x_e,   <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>))</span><br><span class="line">    x_dbl_share = <span class="variable language_">self</span>.x_proj_share(rearrange(torch.add(x_share_rgb, x_share_e),</span><br><span class="line">                                              <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    dt_rgb,   B_rgb,   C_rgb   = torch.split(x_dbl_rgb,   [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line">    dt_e,     B_e,     C_e     = torch.split(x_dbl_e,     [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line">    dt_share, B_share, C_share = torch.split(x_dbl_share, [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. dt 投影成 Δ</span></span><br><span class="line">    dt_rgb   = <span class="variable language_">self</span>.dt_proj_1.weight @ dt_rgb.t()</span><br><span class="line">    dt_e     = <span class="variable language_">self</span>.dt_proj_2.weight @ dt_e.t()</span><br><span class="line">    dt_share = <span class="variable language_">self</span>.dt_proj_share.weight @ dt_share.t()</span><br><span class="line">    ...</span><br><span class="line">    A_rgb   = -torch.exp(<span class="variable language_">self</span>.A_log_rgb.<span class="built_in">float</span>())</span><br><span class="line">    A_e     = -torch.exp(<span class="variable language_">self</span>.A_log_e.<span class="built_in">float</span>())</span><br><span class="line">    A_share = -torch.exp(<span class="variable language_">self</span>.A_log_share.<span class="built_in">float</span>())</span><br><span class="line">    D_rgb, D_e, D_share = <span class="variable language_">self</span>.D_rgb, <span class="variable language_">self</span>.D_e, <span class="variable language_">self</span>.D_share</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment"># 3. CP-SSM：在 Cross=True 时交换 C</span></span><br><span class="line">    <span class="keyword">if</span> <span class="variable language_">self</span>.Cross:</span><br><span class="line">        y_rgb = selective_scan(x_rgb, dt_rgb, A_rgb, B_rgb, C_e,      D_rgb,   ...)</span><br><span class="line">        y_e   = selective_scan(x_e,   dt_e,   A_e,   B_e,   C_rgb,    D_e,     ...)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        y_rgb = selective_scan(x_rgb, dt_rgb, A_rgb, B_rgb, C_rgb,    D_rgb,   ...)</span><br><span class="line">        y_e   = selective_scan(x_e,   dt_e,   A_e,   B_e,   C_e,      D_e,     ...)</span><br></pre></td></tr></table></figure><p>CP-SSM 的关键是：</p><ul><li>RGB 分支用自己的一套 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">A_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">B_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">D_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，但输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">y_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的时候用 <strong>红外那边的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">C_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></strong></li><li>红外分支用自己的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">A_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">B_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">D_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，但输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">y_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 时用 <strong>RGB 的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">C_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></strong></li></ul><p>公式(4) 就是在写这个「<strong>只交换 C</strong>」的过程。</p><p>对应关系：</p><ul><li>图6里的两条分支（RGB 和 T 模态） 👉 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">x_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">b</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">x_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5806em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></li><li>公式(4) 里各自的 Aᵢ, Bᵢ, Dᵢ 👉 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">A_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">b</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">B_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">b</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">D_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">b</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">A_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">B_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">D_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></li><li><strong>互换 C</strong>：<ul><li>RGB 分支用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">C_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></li><li>红外分支用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">C_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">b</span></span></span></span><br>这就是 CP-SSM 的“跨模态参数交互”。</li></ul></li></ul><p>注意：</p><ul><li>上面这一段 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">y_rgb, y_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的输出，就是论文中 CP-SSM 那条“互补特征路径”。</li><li>稍后 DBISSF_SS 会把这些结果 reshape 回 B×C×H×W 的二维特征。</li></ul><h4 id="SP-SSM-模块"><a href="#SP-SSM-模块" class="headerlink" title="SP-SSM 模块"></a>SP-SSM 模块</h4><p><img data-src="/./../images/image-20251030151823019-1761991594416-26.png" alt="image-20251030151823019"></p><p>图 7 SP-SSM模块的细节及流程叙述</p><p><strong>图注：</strong> SP-SSM模块的细节图。SP-SSM模块从具有共享参数的状态空间模型（SSM）中提取两种模态（RGB和热红外）的共享特征。输入特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 被组合以生成参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">B_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">C_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，同时输出特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>F</mi><mo>~</mo></mover><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{F}_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9202em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span></span><span style="top:-3.6023em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.1667em"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>F</mi><mo>~</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{F}_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9202em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span></span><span style="top:-3.6023em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.1667em"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 由这两个SSM进行重建。</p><p><strong>具体过程由公式描述：</strong></p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mi>i</mi></msub><mo>=</mo><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{F}_i = \varphi^{SSM} (\mathbf{F}_i, \Delta_s, \mathbf{B}_s, \mathbf{C}_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8361em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mi>s</mi></msub><mo stretchy="false">]</mo><mo>=</mo><msub><mi mathvariant="script">L</mi><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mi>V</mi></msub><mo>⊕</mo><msub><mi mathvariant="bold">F</mi><mi>T</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[\Delta_s, \mathbf{B}_s, \mathbf{C}_s] = \mathcal{L}_{Linear} (\mathbf{F}_V \oplus \mathbf{F}_T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo>∈</mo><mo stretchy="false">{</mo><mi>V</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{F}_i (i \in \{V, T\})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">})</span></span></span></span> 是共享特征，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{SSM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span></span></span></span></span></span></span></span> 是状态空间模型。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_s, \mathbf{B}_s, \mathbf{C}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8805em;vertical-align:-.1944em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是从加权融合特征中获得的参数。</p><p>SP-SSM模块构建了一种<strong>层次化的特征共享架构</strong>，通过参数共享和特征重建实现跨模态表示对齐。如图7所示，该模块的流程由两个精心设计的阶段组成：</p><p>在<strong>参数共享阶段</strong>，模块采用<strong>粗粒度的加法特征融合方法</strong>对RGB和热红外特征进行初步整合。然后，通过一个线性网络动态生成三组关键的共享参数。这些参数不仅编码了双模态的共同特征模式，而且保留了模态特定的调整能力。</p><p>在<strong>特征重建阶段</strong>，这些共享参数被注入到两个模态的SSM中。这种设计创建了一个双流耦合架构：一方面，共享参数约束了两种模态在状态空间中的演化轨迹，驱动异构特征收敛到共享特征空间；另一方面，每个模态保留了独立的初始化状态，确保了模态特定信息的完整性。通过这种共享参数计算范式，模块能够提取出不受光照条件和环境干扰等因素影响的<strong>深度共享特征</strong>。</p><p>简而言之：</p><p>SP-SSM 的目的：<strong>抓住两个模态共同的语义</strong>。</p><p>方法是：</p><ol><li><p>先把两路特征相加：</p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">F_share</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">re</span></span></span></span> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></li><li><p>用这个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">F_share</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">re</span></span></span></span> 去生成一套共享参数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">Δ_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">B_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">C_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>)</p></li><li><p>然后把这套共享参数用在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>G</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">RGB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05017em">RGB</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 两个分支上，跑同一套 SSM：</p></li></ol><p><strong>方法：</strong></p><ul><li>将 RGB 与热特征先相加（或拼接）成联合特征；</li><li>使用<strong>参数共享</strong>的 SSM 处理这两种输入；</li><li>因为参数相同，模型会倾向学习“共性信息”——比如物体轮廓、形状等。</li></ul><p>还是在类<code>DBISSF_Attention.forward</code>中，刚才看到share分支</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># share 输入：x_share_rgb, x_share_e</span></span><br><span class="line">x_dbl_share = <span class="variable language_">self</span>.x_proj_share(</span><br><span class="line">    rearrange(torch.add(x_share_rgb, x_share_e), <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>)</span><br><span class="line">)</span><br><span class="line">dt_share, B_share, C_share = torch.split(</span><br><span class="line">    x_dbl_share, [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">dt_share = <span class="variable language_">self</span>.dt_proj_share.weight @ dt_share.t()</span><br><span class="line">dt_share = rearrange(dt_share, <span class="string">&#x27;d (b l) -&gt; b d l&#x27;</span>, l=L)</span><br><span class="line"></span><br><span class="line">A_share = -torch.exp(<span class="variable language_">self</span>.A_log_share.<span class="built_in">float</span>())</span><br><span class="line">B_share = rearrange(B_share, <span class="string">&#x27;(b l) dstate -&gt; b dstate l&#x27;</span>, l=L).contiguous()</span><br><span class="line">C_share = rearrange(C_share, <span class="string">&#x27;(b l) dstate -&gt; b dstate l&#x27;</span>, l=L).contiguous()</span><br><span class="line">D_share = <span class="variable language_">self</span>.D_share.<span class="built_in">float</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SP-SSM：共享一套 (A_share, B_share, C_share, D_share)</span></span><br><span class="line">y_share_rgb = selective_scan(x_share_rgb, dt_share, A_share, B_share, C_share,</span><br><span class="line">                             D_share, delta_bias=<span class="variable language_">self</span>.dt_proj_share.bias.<span class="built_in">float</span>(), delta_softplus=<span class="literal">True</span>)</span><br><span class="line">y_share_e   = selective_scan(x_share_e,   dt_share, A_share, B_share, C_share,</span><br><span class="line">                             D_share, delta_bias=<span class="variable language_">self</span>.dt_proj_share.bias.<span class="built_in">float</span>(), delta_softplus=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>对应关系：</p><ul><li>论文里 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">F_share</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">re</span></span></span></span> &#x3D; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 对应 <code>torch.add(x_share_rgb, x_share_e)</code></li><li>论文里 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">Linear</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">in</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.02778em">r</span></span></span></span> 生成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">Δ_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">B_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">C_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 对应 <code>self.x_proj_share(...)</code> + <code>torch.split(... dt_share, B_share, C_share ...)</code></li><li>论文里「同一套 SSM 同时作用在两路」 对应 两个 <code>selective_scan</code> 调用：<ul><li>一个输入 <code>x_share_rgb</code></li><li>一个输入 <code>x_share_e</code><br>使用的都是同一组 <code>(A_share, B_share, C_share, D_share, dt_share)</code></li></ul></li></ul><h4 id="DBISSF-SS"><a href="#DBISSF-SS" class="headerlink" title="DBISSF_SS"></a>DBISSF_SS</h4><p>把 CP-SSM 和 SP-SSM 套在 2D 特征上（扫描方向）</p><p>刚才只是序列层面（L 维度）的 CP&#x2F;SP，需要再放回到 2D 特征图上，这部分对应图6 底下那种「按 H×W 扫描」的结构。</p><p>在 <code>DBISSF_SS.forward</code> 里大致是这样：</p><ol><li><p>输入是 <code>x_rgb, x_e</code>，形状 B×C×H×W</p></li><li><p>用 1×1 卷积变换到适合 SSM 的通道数：</p><p><code>x_rgb_conv</code>, <code>x_e_conv</code></p><p>再得到 share 分支 <code>x_share_rgb_conv</code>, <code>x_share_e_conv</code></p></li><li><p>把 H×W 摊平成一条长序列 L &#x3D; H×W</p><p>可能还会做 CrossScan：既沿着行扫、又沿着列扫，再加正向+反向（对应图6 中多方向扫描）</p></li><li><p>喂给 <code>CMA_ssm</code>（也就是 <code>DBISSF_Attention</code>）</p></li><li><p>如果 <code>scan=True</code>，再用 <code>CMA_ssm2</code> 沿着另一个维度再扫一遍（更丰富的空间关系）</p></li><li><p>最后把结果 reshape 回 B×C×H×W</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DBISSF_SS</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;\n    Cross Mamba Attention Fusion Selective Scan 2D Module with SSM\n    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_model=<span class="number">96</span>, d_state=<span class="number">16</span>, ssm_ratio=<span class="number">2</span>, dt_rank=<span class="string">&#x27;auto&#x27;</span>, Cross=<span class="literal">True</span>, learnableweight=<span class="literal">False</span>, scan=<span class="literal">False</span>, d_conv=<span class="number">3</span>, conv_bias=<span class="literal">True</span>, dropout=<span class="number">0.0</span>, bias=<span class="literal">False</span>, dt_min=<span class="number">0.001</span>, dt_max=<span class="number">0.1</span>, dt_init=<span class="string">&#x27;random&#x27;</span>, dt_scale=<span class="number">1.0</span>, dt_init_floor=<span class="number">0.0001</span>, softmax_version=<span class="literal">False</span>, **kwargs</span>):</span><br><span class="line">        factory_kwargs = &#123;<span class="string">&#x27;device&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;dtype&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="variable language_">self</span>.softmax_version = softmax_version</span><br><span class="line">        <span class="variable language_">self</span>.d_model = d_model</span><br><span class="line">        <span class="variable language_">self</span>.d_state = math.ceil(<span class="variable language_">self</span>.d_model / <span class="number">6</span>) <span class="keyword">if</span> d_state == <span class="string">&#x27;auto&#x27;</span> <span class="keyword">else</span> d_state</span><br><span class="line">        <span class="variable language_">self</span>.d_conv = d_conv</span><br><span class="line">        <span class="variable language_">self</span>.expand = ssm_ratio</span><br><span class="line">        <span class="variable language_">self</span>.d_inner = <span class="built_in">int</span>(<span class="variable language_">self</span>.expand * <span class="variable language_">self</span>.d_model)</span><br><span class="line">        <span class="variable language_">self</span>.dt_rank = math.ceil(<span class="variable language_">self</span>.d_model / <span class="number">16</span>) <span class="keyword">if</span> dt_rank == <span class="string">&#x27;auto&#x27;</span> <span class="keyword">else</span> dt_rank</span><br><span class="line">        <span class="variable language_">self</span>.Cross = Cross</span><br><span class="line">        <span class="variable language_">self</span>.learnableweight = learnableweight</span><br><span class="line">        <span class="variable language_">self</span>.in_proj = nn.Linear(<span class="variable language_">self</span>.d_model, <span class="variable language_">self</span>.d_inner, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.in_proj_modalx = nn.Linear(<span class="variable language_">self</span>.d_model, <span class="variable language_">self</span>.d_inner, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.in_proj_share = nn.Linear(<span class="variable language_">self</span>.d_model, <span class="variable language_">self</span>.d_inner, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="keyword">if</span> learnableweight:</span><br><span class="line">            <span class="variable language_">self</span>.learnableweight_rgb = LearnableWeights()</span><br><span class="line">            <span class="variable language_">self</span>.learnableweight_e = LearnableWeights()</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.d_conv &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="variable language_">self</span>.conv2d = nn.Conv2d(in_channels=<span class="variable language_">self</span>.d_inner, out_channels=<span class="variable language_">self</span>.d_inner, groups=<span class="variable language_">self</span>.d_inner, bias=conv_bias, kernel_size=d_conv, padding=(d_conv - <span class="number">1</span>) // <span class="number">2</span>, **factory_kwargs)</span><br><span class="line">            <span class="variable language_">self</span>.act = nn.SiLU()</span><br><span class="line">        <span class="variable language_">self</span>.out_proj_rgb = nn.Linear(<span class="variable language_">self</span>.d_inner, <span class="variable language_">self</span>.d_model, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.out_proj_e = nn.Linear(<span class="variable language_">self</span>.d_inner, <span class="variable language_">self</span>.d_model, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.out_proj_share = nn.Linear(<span class="variable language_">self</span>.d_inner, <span class="variable language_">self</span>.d_model, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.dropout_rgb = nn.Dropout(dropout) <span class="keyword">if</span> dropout &gt; <span class="number">0.0</span> <span class="keyword">else</span> nn.Identity()</span><br><span class="line">        <span class="variable language_">self</span>.dropout_e = nn.Dropout(dropout) <span class="keyword">if</span> dropout &gt; <span class="number">0.0</span> <span class="keyword">else</span> nn.Identity()</span><br><span class="line">        <span class="variable language_">self</span>.dropout_share = nn.Dropout(dropout) <span class="keyword">if</span> dropout &gt; <span class="number">0.0</span> <span class="keyword">else</span> nn.Identity()</span><br><span class="line">        <span class="variable language_">self</span>.CMA_ssm = DBISSF_Attention(d_model=<span class="variable language_">self</span>.d_model, d_state=<span class="variable language_">self</span>.d_state, ssm_ratio=ssm_ratio, dt_rank=dt_rank, Cross=Cross, dt_min=dt_min, dt_max=dt_max, dt_init=dt_init, dt_scale=dt_scale, dt_init_floor=dt_init_floor, **kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.scan = scan</span><br><span class="line">        <span class="keyword">if</span> scan:</span><br><span class="line">            <span class="variable language_">self</span>.CMA_ssm2 = DBISSF_Attention(d_model=<span class="variable language_">self</span>.d_model, d_state=<span class="variable language_">self</span>.d_state, ssm_ratio=ssm_ratio, dt_rank=dt_rank, Cross=Cross, dt_min=dt_min, dt_max=dt_max, dt_init=dt_init, dt_scale=dt_scale, dt_init_floor=dt_init_floor, **kwargs)</span><br></pre></td></tr></table></figure><p>这一大块就是<strong>把式(4)(5) 落到实际的二维特征上</strong>。</p><h4 id="FF-SSM-模块"><a href="#FF-SSM-模块" class="headerlink" title="FF-SSM 模块"></a>FF-SSM 模块</h4><p><img data-src="/./../images/image-20251030152057669-1761991594416-27.png" alt="image-20251030152057669"></p><p><strong>图注：</strong> FF-SSM 模块的细节图。该模块通过将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 以两种不同顺序组合来实现特征融合。在顶部分支中，输入特征以 1-2 的顺序（例如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_1, F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>）组合形成拼接特征，然后通过一个线性层（Linear layer）生成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">B_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\Delta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 参数，随后通过 SSM 执行跨特征交互。最终，将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">F_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">F_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 合并（merge）生成融合特征图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>F</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9202em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9202em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span></span><span style="top:-3.6023em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.1667em"><span class="mord">~</span></span></span></span></span></span></span></span></span></span>。</p><p><strong>模块流程叙述：</strong></p><p>FF-SSM 模块旨在解决 Mamba 固有的<strong>特征遗忘问题</strong>，同时实现<strong>彻底且自适应的跨模态特征融合</strong>。它通过引入<strong>双向架构</strong>，结合互补的前向和反向处理路径来系统性地弥补单向建模的局限性。</p><ol><li><p><strong>输入特征：</strong> 模块接收来自 CP-SSM 输出的特征图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>（例如，RGB 和热红外互补特征）。</p></li><li><p><strong>双向异构序列构建（Bidirectional Sequence Construction）：</strong> 模块采用双向异构序列构建策略，将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 以<strong>两种不同顺序</strong>进行拼接：</p><ul><li><strong>前向路径 (Top Path):</strong> 序列为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_1, \mathbf{F}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。</li><li><strong>反向路径 (Bottom Path):</strong> 序列为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_2, \mathbf{F}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。</li></ul></li><li><p><strong>参数生成：</strong></p><ul><li><strong>前向路径：</strong> 拼接序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_1, \mathbf{F}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 通过线性变换层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mn>1</mn><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{1}^{Linear}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-.2481em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-2.4519em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2481em"><span></span></span></span></span></span></span></span></span></span> 生成状态空间模型参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\Delta_1, \mathbf{B}_1, \mathbf{C}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。</li><li><strong>反向路径：</strong> 拼接序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_2, \mathbf{F}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 通过另一个线性变换层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mn>2</mn><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{2}^{Linear}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-.2481em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-2.4519em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2481em"><span></span></span></span></span></span></span></span></span></span> 生成状态空间模型参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\Delta_2, \mathbf{B}_2, \mathbf{C}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。</li></ul></li><li><p><strong>状态空间处理与特征交互：</strong></p><ul><li><strong>前向 SSM：</strong> 参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\Delta_1, \mathbf{B}_1, \mathbf{C}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 和序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_1, \mathbf{F}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 输入 SSM (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{SSM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span></span></span></span></span></span></span></span>) 得到输出特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">F_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>。</li><li><strong>反向 SSM：</strong> 参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\Delta_2, \mathbf{B}_2, \mathbf{C}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 和序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_2, \mathbf{F}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 输入 SSM (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{SSM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span></span></span></span></span></span></span></span>) 得到输出特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">F_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>。</li><li><strong>作用：</strong> 反向路径 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">F_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 专门用于捕获在前向传播中可能发生的特征损失，通过<strong>方向自适应参数生成</strong>来补偿单向建模的局限性。</li></ul></li><li><p><strong>最终融合（Adaptive Fusion）：</strong> 模块通过一个合并函数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mrow><mi>M</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\psi_{Merge}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9805em;vertical-align:-.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">M</span><span class="mord mathnormal mtight" style="margin-right:.02778em">er</span><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span></span></span></span>) 将来自双向 SSM 路径的输出特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">F_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">F_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 进行融合，生成最终的融合特征图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">F</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.923em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.923em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathbf">F</span></span><span style="top:-3.6051em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.1667em"><span class="mord">~</span></span></span></span></span></span></span></span></span></span>。</p></li></ol><p><strong>目标：</strong> 这种双路径机制能够更全面地捕获<strong>长距离跨模态依赖关系</strong>，动态地缓解特征遗忘，同时在不牺牲 Mamba 线性复杂度的前提下，确保更丰富、更精确的特征表示，显著提高检测精度。</p><p><strong>数学表达：</strong></p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi mathvariant="bold">F</mi><mo>~</mo></mover><mo>=</mo><msub><mi>ψ</mi><mrow><mi>M</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mn>12</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>21</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{F}} = \psi_{Merge} (\mathbf{F}_{12}, \mathbf{F}_{21})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.923em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.923em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathbf">F</span></span><span style="top:-3.6051em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.1667em"><span class="mord">~</span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">M</span><span class="mord mathnormal mtight" style="margin-right:.02778em">er</span><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>12</mn></msub><mo>=</mo><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup><mo stretchy="false">(</mo><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{F}_{12} = \varphi^{SSM} ([\mathbf{F}_1, \mathbf{F}_2], \Delta_1, \mathbf{B}_1, \mathbf{C}_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8361em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span></span></span></span></span><span class="mopen">([</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>21</mn></msub><mo>=</mo><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup><mo stretchy="false">(</mo><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{F}_{21} = \varphi^{SSM} ([\mathbf{F}_2, \mathbf{F}_1], \Delta_2, \mathbf{B}_2, \mathbf{C}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8361em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span></span></span></span></span><span class="mopen">([</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo>=</mo><msubsup><mi mathvariant="script">L</mi><mn>1</mn><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[\Delta_1, \mathbf{B}_1, \mathbf{C}_1] = \mathcal{L}_{1}^{Linear} (\mathbf{F}_1, \mathbf{F}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8913em"><span style="top:-2.453em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo>=</mo><msubsup><mi mathvariant="script">L</mi><mn>2</mn><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[\Delta_2, \mathbf{B}_2, \mathbf{C}_2] = \mathcal{L}_{2}^{Linear} (\mathbf{F}_2, \mathbf{F}_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8913em"><span style="top:-2.453em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><p>尽管CP-SSM模块能够捕获模态间隐式的互补关系，但它在特征融合层面上仍存在局限性。为了解决Mamba固有的<strong>特征遗忘问题</strong>，同时保持其计算效率，作者提出了一个结合<strong>互补前向</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_1, \mathbf{F}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8805em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 和<strong>反向</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_2, \mathbf{F}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8805em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 处理路径的<strong>双向架构</strong>。</p><p>这种创新设计通过<strong>方向自适应参数生成</strong>系统地弥补了单向建模的局限性，其中反向路径专门用于捕获前向传播中可能发生的特征损失。与传统Transformer因分块操作导致信息丢失不同，作者的方法不仅保持了Mamba原有的序列依赖和线性复杂度的优势，而且通过反向序列补偿显著增强了特征保留。双路径机制能够更全面地捕获<strong>长距离跨模态依赖关系</strong>，同时动态地缓解特征遗忘，在不牺牲效率的情况下实现了鲁棒的序列建模。</p><p>具体来说，给定CP-SSM输出的特征图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8361em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8361em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，该模块采用<strong>双向异构序列构建策略</strong>：以不同顺序 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_1, \mathbf{F}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8805em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_2, \mathbf{F}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8805em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>) 对特征进行拼接。这种设计不仅扩展了模型的感受野，还增强了特征表示的多样性。</p><p>在实现中，特征首先被展开并拼接成两个方向序列，然后通过线性变换层生成相应的状态空间模型参数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{B}_1, \mathbf{C}_1, \Delta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8805em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{B}_2, \mathbf{C}_2, \Delta_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8805em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>)。最后，通过融合来自双向SSM路径的输出特征 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8361em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8361em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>)，模块实现了彻底的跨模态特征交互和自适应融合，显著提高了检测精度。FF-SSM模块有效地保留了两种模态内的细节信息，确保了更丰富、更精确的特征表示，这在公式 (6) 中被描述：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>F</mi><mo stretchy="true">^</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>ψ</mi><mrow><mi>M</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>F</mi><mn>12</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>21</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>F</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msub><mrow><mo fence="true">(</mo><mo stretchy="false">[</mo><msub><mi>F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>F</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msub><mrow><mo fence="true">(</mo><mo stretchy="false">[</mo><msub><mi>F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>1</mn></msub><mo fence="true">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>Linear</mtext><mn>1</mn></msubsup><mrow><mo fence="true">(</mo><msub><mi>F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo fence="true">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>Linear</mtext><mn>2</mn></msubsup><mrow><mo fence="true">(</mo><msub><mi>F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(6)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align} \widehat{F} &amp;= \psi_{Merge} \left( F_{12}, F_{21} \right) \\ F_{12} &amp;= \varphi_{SSM} \left( [F_1, F_2], \Delta_1, B_1, C_1 \right) \\ F_{21} &amp;= \varphi_{SSM} \left( [F_2, F_1], \Delta_2, B_2, C_2 \right) \\ \left[ \Delta_1, B_1, C_1 \right] &amp;= L_{\text{Linear}}^1 \left( F_1, F_2 \right) \\ \left[ \Delta_2, B_2, C_2 \right] &amp;= L_{\text{Linear}}^2 \left( F_2, F_1 \right) \end{align} \tag{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.6315em;vertical-align:-3.5658em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0658em"><span style="top:-6.1424em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9233em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span></span><span class="svg-align" style="width:calc(100% - .1667em);margin-left:.1667em;top:-3.6833em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span><span style="top:-4.6424em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.1424em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.6183em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">]</span></span></span></span><span style="top:-.0942em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5658em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0658em"><span style="top:-6.1424em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">M</span><span class="mord mathnormal mtight" style="margin-right:.02778em">er</span><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span><span style="top:-4.6424em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span><span style="top:-3.1424em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0502em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span><span style="top:-1.6183em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641em"><span style="top:-2.453em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Linear</span></span></span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span><span style="top:-.0942em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641em"><span style="top:-2.453em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Linear</span></span></span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5658em"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:7.6315em;vertical-align:-3.5658em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6</span></span><span class="mord">)</span></span></span></span></span></span><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{SSM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">SSM</span></span></span></span></span></span></span></span></span></span></span></span> 表示图4中的SSM，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_1, \mathbf{F}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8805em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是特征图。</p><p>简而言之：</p><p>有了 CP-SSM 和 SP-SSM，我们得到两种特征：</p><ul><li>F₁：互补信息（差异）</li><li>F₂：共享信息（共性）</li></ul><p>FF-SSM 想干的是：</p><blockquote><p>把 F₁、F₂ 再“来回搅拌”，既考虑「先看 F₁ 再看 F₂」，也考虑「先看 F₂ 再看 F₁」，最后得到一个融合特征 F_fused。</p></blockquote><p>式(6) 的大致意思是：</p><ol><li>把 (F₁, F₂) 作为一对输入，喂进一个线性层，得到一组 (Δ₁, B₁, C₁)</li><li>把 (F₂, F₁) 再喂一次，得到 (Δ₂, B₂, C₂)</li><li>用这两组参数跑两次 SSM，得到两个方向的输出 F₁₂ 和 F₂₁</li><li>再把 F₁₂ 和 F₂₁ 结合起来就是 F_fused</li></ol><p>图8 就是把这些步骤画成了一个带两路输入、两路输出再融合的结构。</p><h4 id="CMSSF-CM-Attention"><a href="#CMSSF-CM-Attention" class="headerlink" title="CMSSF + CM_Attention"></a>CMSSF + CM_Attention</h4><p><code>CMSSF</code> 是一个「Concat Mamba 2D 融合模块」：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CMSSF</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Concat Mamba (ConMB) fusion, with 2d SSM&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, hidden_dim: <span class="built_in">int</span>=<span class="number">0</span>, ...</span>):</span><br><span class="line">        ...</span><br><span class="line">        <span class="variable language_">self</span>.op = CM_Attention(d_model=hidden_dim, ...)</span><br><span class="line">        <span class="variable language_">self</span>.drop_path = DropPath(drop_path)</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_forward</span>(<span class="params">self, x: torch.Tensor</span>):</span><br><span class="line">        x_rgb = x[<span class="number">0</span>]</span><br><span class="line">        x_e   = x[<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 用 CM_Attention 得到融合特征</span></span><br><span class="line">        <span class="comment"># 然后加上残差/MLP（略）</span></span><br></pre></td></tr></table></figure><p><code>CM_Attention</code> 的核心是 <code>forward_corev2_multimodal</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CM_Attention</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Multimodal Mamba Selective Scan 2D&quot;&quot;&quot;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward_corev2_multimodal</span>(<span class="params">self, x_rgb, x_e, nrows=-<span class="number">1</span></span>):</span><br><span class="line">        <span class="keyword">return</span> cross_selective_scan_multimodal_k2(</span><br><span class="line">            x_rgb, x_e,</span><br><span class="line">            <span class="variable language_">self</span>.x_proj_weight, <span class="literal">None</span>,</span><br><span class="line">            <span class="variable language_">self</span>.dt_projs_weight, <span class="variable language_">self</span>.dt_projs_bias,</span><br><span class="line">            <span class="variable language_">self</span>.A_logs, <span class="variable language_">self</span>.Ds,</span><br><span class="line">            <span class="built_in">getattr</span>(<span class="variable language_">self</span>, <span class="string">&quot;out_norm1&quot;</span>, <span class="literal">None</span>),</span><br><span class="line">            <span class="built_in">getattr</span>(<span class="variable language_">self</span>, <span class="string">&quot;out_norm2&quot;</span>, <span class="literal">None</span>),</span><br><span class="line">            <span class="variable language_">self</span>.softmax_version,</span><br><span class="line">            nrows=nrows</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x_rgb, x_e</span>):</span><br><span class="line">        <span class="comment"># 先把 tensor 排成 B,H,W,C</span></span><br><span class="line">        x_rgb = x_rgb.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>).contiguous()</span><br><span class="line">        x_e   = x_e.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>).contiguous()</span><br><span class="line">        <span class="comment"># 做一次 in_proj</span></span><br><span class="line">        x_rgb = <span class="variable language_">self</span>.in_proj(x_rgb)</span><br><span class="line">        x_e   = <span class="variable language_">self</span>.in_proj_modalx(x_e)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 深度卷积增强局部信息</span></span><br><span class="line">        ...</span><br><span class="line">        y_rgb, y_e = <span class="variable language_">self</span>.forward_corev2_multimodal(x_rgb_conv, x_e_conv)</span><br><span class="line">        ...</span><br><span class="line">        <span class="comment"># SE 类似的通道注意力，再 concat 两路</span></span><br><span class="line">        y = torch.concat([y_rgb, y_e], dim=-<span class="number">1</span>)</span><br><span class="line">        out = <span class="variable language_">self</span>.dropout(<span class="variable language_">self</span>.out_proj(y)).permute(<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>).contiguous()</span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure><p>真正实现“式(6)”的是 <code>cross_selective_scan_multimodal_k2</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cross_selective_scan_multimodal_k2</span>(<span class="params">x_rgb, x_e, x_proj_weight, x_proj_bias,</span></span><br><span class="line"><span class="params">                                       dt_projs_weight, dt_projs_bias,</span></span><br><span class="line"><span class="params">                                       A_logs, Ds, out_norm1, out_norm2,</span></span><br><span class="line"><span class="params">                                       softmax_version=-<span class="number">1</span>, nrows=<span class="literal">True</span></span>):</span><br><span class="line">    B, D, H, W = x_rgb.shape</span><br><span class="line">    D, N = A_logs.shape</span><br><span class="line">    K, D, R = dt_projs_weight.shape</span><br><span class="line">    L = <span class="number">2</span> * H * W</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. CrossScan_multimodal: 拼成两条序列（正向 &amp; 反向）</span></span><br><span class="line">    x_fuse = CrossScan_multimodal.apply(x_rgb, x_e)  <span class="comment"># B, 2, C, 2HW</span></span><br><span class="line">    <span class="comment"># x_fuse[:,0] = [rgb 序列, e 序列]</span></span><br><span class="line">    <span class="comment"># x_fuse[:,1] = 上面那条的反向</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 线性投影 -&gt; [dt, B, C]</span></span><br><span class="line">    x_dbl = torch.einsum(<span class="string">&#x27;b k d l, k c d -&gt; b k c l&#x27;</span>, x_fuse, x_proj_weight)</span><br><span class="line">    ...</span><br><span class="line">    dts, Bs, Cs = torch.split(x_dbl, [R, N, N], dim=<span class="number">2</span>)</span><br><span class="line">    dts = torch.einsum(<span class="string">&#x27;b k r l, k d r -&gt; b k d l&#x27;</span>, dts, dt_projs_weight)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 准备 A, D</span></span><br><span class="line">    x_fuse = x_fuse.view(B, -<span class="number">1</span>, L).to(torch.<span class="built_in">float</span>)</span><br><span class="line">    dts    = dts.contiguous().view(B, -<span class="number">1</span>, L).to(torch.<span class="built_in">float</span>)</span><br><span class="line">    As = -torch.exp(A_logs.to(torch.<span class="built_in">float</span>))</span><br><span class="line">    ...</span><br><span class="line">    delta_bias = dt_projs_bias.view(-<span class="number">1</span>).to(torch.<span class="built_in">float</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 跑 SelectiveScan（就是 SSM）</span></span><br><span class="line">    ys = selective_scan(x_fuse, dts, As, Bs, Cs, Ds, delta_bias, delta_softplus, nrows)\</span><br><span class="line">           .view(B, K, -<span class="number">1</span>, <span class="number">2</span> * H * W).to(x_rgb.dtype)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. CrossMerge_multimodal: 把两条序列再拆/合回两路</span></span><br><span class="line">    y_rgb, y_e = CrossMerge_multimodal.apply(ys)</span><br><span class="line">    y_rgb = y_rgb.transpose(<span class="number">1</span>, <span class="number">2</span>).contiguous().view(B, H, W, -<span class="number">1</span>)</span><br><span class="line">    y_e   = y_e.transpose(<span class="number">1</span>, <span class="number">2</span>).contiguous().view(B, H, W, -<span class="number">1</span>)</span><br><span class="line">    y_rgb = out_norm1(y_rgb)</span><br><span class="line">    y_e   = out_norm2(y_e)</span><br><span class="line">    <span class="keyword">return</span> (y_rgb, y_e)</span><br></pre></td></tr></table></figure><p>对应关系（图8 &amp; 式(6)）：</p><ul><li>图8 里「两路输入 F₁&#x2F;F₂、正向&#x2F;反向」 👉 这里的 <code>CrossScan_multimodal</code> 生成两条序列（正向与反向）。</li><li>图8 里「两次 Linear 生成不同参数」 👉 这里一次 <code>x_fuse</code> 里已经含有两路信息（[RGB, E] 的拼接），通过 <code>x_proj_weight</code> + <code>dt_projs_weight</code> 把它们变成多组 (Δ,B,C)；不同的 k 维度相当于式(6) 中“不同组合（F₁F₂ &#x2F; F₂F₁）”的效果。</li><li>图8 里「两次 SSM 再融合」 👉 这里的 <code>SelectiveScan.apply(...)</code> 输出 <code>ys</code>，然后 <code>CrossMerge_multimodal.apply(ys)</code> 把它们合成 <code>y_rgb, y_e</code> 两个结果（相当于 F₁₂ 与 F₂₁ 的融合）。</li></ul><p>在 <code>SSF.forward</code> 里，FF-SSM 被用了 <strong>三次</strong>：</p><ol><li><code>x_fuse_rgb -&gt; self.cm_fusion_rgb(...)</code>：融合「RGB 互补特征 + RGB 共享特征」</li><li><code>x_fuse_e -&gt; self.cm_fusion_e(...)</code>：融合「E 互补特征 + E 共享特征」</li><li><code>[x_rgb, x_e] -&gt; self.cm_fusion(...)</code>：最后再融合「融合后的 RGB 与 融合后的 E」</li></ol><p>这整体就是论文里 FF-SSM 的那一整套“前后双向、模态间来回流动”的过程。</p><h3 id="损失函数"><a href="#损失函数" class="headerlink" title="损失函数"></a>损失函数</h3><p>由MS2Fusion模块生成的融合特征被送入颈部网络（Neck）和检测头（Detection Head），整个流程以<strong>端到端</strong>的方式进行优化。在本文中，作者分别在基于<strong>YOLOv5</strong>和<strong>Co-Detr</strong>的两种检测框架中对MS2Fusion进行了评估。</p><h4 id="YOLO-框架下的总损失函数"><a href="#YOLO-框架下的总损失函数" class="headerlink" title="YOLO 框架下的总损失函数"></a>YOLO 框架下的总损失函数</h4><p>在YOLO框架中，总损失函数可以表示为：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>y</mi><mi>o</mi><mi>l</mi><mi>o</mi></mrow></msub><mo>=</mo><msub><mi>λ</mi><mtext>bbox</mtext></msub><mo>⋅</mo><msub><mi mathvariant="script">L</mi><mtext>bbox</mtext></msub><mo>+</mo><msub><mi>λ</mi><mtext>obj</mtext></msub><mo>⋅</mo><msub><mi mathvariant="script">L</mi><mtext>obj</mtext></msub><mo>+</mo><msub><mi>λ</mi><mtext>cls</mtext></msub><mo>⋅</mo><msub><mi mathvariant="script">L</mi><mtext>cls</mtext></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(7)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align} \mathcal{L}_{yolo} = \lambda_{\text{bbox}} \cdot \mathcal{L}_{\text{bbox}} + \lambda_{\text{obj}} \cdot \mathcal{L}_{\text{obj}} + \lambda_{\text{cls}} \cdot \mathcal{L}_{\text{cls}} \end{align} \tag{7}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-.5em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em"><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">yo</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bbox</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bbox</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obj</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obj</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5em"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:1.5em;vertical-align:-.5em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7</span></span><span class="mord">)</span></span></span></span></span></span><p>其中：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>b</mi><mi>b</mi><mi>o</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{bbox}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bb</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是**定位损失** （Localization Loss）。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>o</mi><mi>b</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{obj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9694em;vertical-align:-.2861em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:.05724em">bj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span></span></span></span> 是**置信度损失** （Confidence Loss）。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>c</mi><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{cls}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是**分类损失** （Classification Loss）。</li><li>超参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>b</mi><mi>b</mi><mi>o</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{bbox}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bb</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>o</mi><mi>b</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{obj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9805em;vertical-align:-.2861em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:.05724em">bj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>c</mi><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{cls}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 用于调整各项损失的权重，这些权重保持了基线模型的默认设置。</li></ul><h4 id="CoDetr-框架下的总损失函数"><a href="#CoDetr-框架下的总损失函数" class="headerlink" title="CoDetr 框架下的总损失函数"></a>CoDetr 框架下的总损失函数</h4><p>CoDetr框架采用了一个<strong>多任务损失函数</strong>，该函数由<strong>四个组成部分</strong>构成：一个主要的CoDINOHead 和三个辅助检测头（包括RPN头、ROI头和Bbox头）。</p><p>总损失函数可以表示为：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="script">L</mi><mtext>CoDetr</mtext></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>λ</mi><mtext>primary</mtext></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>QFL</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>L1</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>GIoU</mtext></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>λ</mi><mtext>RPN</mtext></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>CE</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>L1</mtext></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><msub><mi>λ</mi><mtext>ROI</mtext></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>CE</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>GIoU</mtext></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>λ</mi><mtext>Bbox</mtext></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>Focal</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>GIoU</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>CE</mtext></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(8)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align} \mathcal{L}_{\text{CoDetr}} &amp;= \lambda_{\text{primary}} \cdot \left( \mathcal{L}_{\text{QFL}} + \mathcal{L}_{\text{L1}} + \mathcal{L}_{\text{GIoU}} \right) + \lambda_{\text{RPN}} \cdot \left( \mathcal{L}_{\text{CE}} + \mathcal{L}_{\text{L1}} \right) \\ &amp;+ \lambda_{\text{ROI}} \cdot \left( \mathcal{L}_{\text{CE}} + \mathcal{L}_{\text{GIoU}} \right) + \lambda_{\text{Bbox}} \cdot \left( \mathcal{L}_{\text{Focal}} + \mathcal{L}_{\text{GIoU}} + \mathcal{L}_{\text{CE}} \right) \end{align} \tag{8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CoDetr</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3175em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">primary</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">QFL</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">L1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">GIoU</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">RPN</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">L1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ROI</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">GIoU</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Bbox</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Focal</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">GIoU</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">8</span></span><span class="mord">)</span></span></span></span></span></span><p>其中：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>Q</mi><mi>F</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{QFL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9694em;vertical-align:-.2861em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">QF</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span></span></span></span> 是**质量焦点损失** （Quality Focal Loss）。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>L</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">L_{L1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>L</mtext><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{L}1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord text"><span class="mord">L</span></span><span class="mord">1</span></span></span></span> **损失**。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>G</mi><mi>I</mi><mi>o</mi><mi>U</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{GIoU}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="mord mathnormal mtight" style="margin-right:.07847em">I</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:.10903em">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是 **GIoU损失**。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>C</mi><mi>E</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{CE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05764em">CE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是**交叉熵损失** （Cross-Entropy Loss）。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>F</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{Focal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">F</span><span class="mord mathnormal mtight">oc</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是**焦点损失** （Focal Loss）。</li><li>超参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">λ</span></span></span></span> 为各项损失项的<strong>加权因子</strong>。</li></ul><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p>本章节详细介绍了MS2Fusion模型所进行的系列实验，包括实验设置、SOTA（State-of-the-art）比较、泛化能力测试、消融研究和定性分析。</p><h3 id="数据集和评估指标"><a href="#数据集和评估指标" class="headerlink" title="数据集和评估指标"></a>数据集和评估指标</h3><p><strong>数据集：</strong><br>本文在四个多光谱目标检测数据集上进行了评估：</p><ol><li><strong>FLIR (aligned)</strong>: 包含5,142对RGB-T图像，分为4,129对训练集和1,013对测试集</li><li><strong>LLVIP</strong>: 包含15,488对RGB-T图像，12,025对用于训练，3,463对用于测试，主要标注热成像图像</li><li><strong>M3FD</strong>: 包含4,200对RGB-T对齐图像，涵盖多种条件和六个类别，按8:2划分训练&#x2F;测试集</li><li><strong>VEDAI</strong>: 包含3,640个目标实例（9个类别）的航拍图像，共1,210张1024x1024图像，包含RGB和NIR（近红外）通道，按9:1划分训练&#x2F;测试集</li></ol><p><strong>评估指标：</strong></p><ul><li><strong>AP (Average Precision)</strong>: 标源于精确率-召回率（PR）曲线下的面积，该曲线以召回率为横轴、精确率为纵轴</li><li><strong>mAP (mean Average Precision)</strong>: 所有类别的AP加权平均值。实验中，<a href="mailto:&#109;&#65;&#80;&#x40;&#48;&#x2e;&#53;">mAP@0.5</a>（IoU阈值为0.5）是主要指标。该指标的值越高，表明性能越好</li></ul><h3 id="实验设置"><a href="#实验设置" class="headerlink" title="实验设置"></a>实验设置</h3><ul><li><strong>硬件</strong>: Intel i7-9700 CPU, 64GB RAM, Nvidia RTX 3090 GPU (24GB)</li><li><strong>软件</strong>: PyTorch</li><li><strong>超参数</strong>: 消融研究使用60个epoch，批量大小(batch size)为4，使用SGD优化器，初始学习率为0.01，动量0.937，权重衰减0.0005，余弦学习率衰减</li><li><strong>输入尺寸</strong>: 训练时为640x640，测试时为640x512</li><li><strong>数据增强</strong>: 使用Mosaic（马赛克）增强</li></ul><h3 id="SOTA比较"><a href="#SOTA比较" class="headerlink" title="SOTA比较"></a>SOTA比较</h3><p>实验在YOLOv5（速度快、精度稍低）和CoDetr（速度慢、精度高）两个框架上进行。YOLOv5检测器的推理速度更快，但精度较低；而CoDetr的检测精度更高，但推理速度较慢。</p><h4 id="FLIR-数据集比较"><a href="#FLIR-数据集比较" class="headerlink" title="FLIR 数据集比较"></a>FLIR 数据集比较</h4><p><strong>表2: FLIR-align 数据集比较</strong><br>(‘-’ 表示缺失值. ‘‡’ 符号表示使用CoDetr框架的实验结果，输入图像被调整为640×640像素的固定分辨率)</p><table><thead><tr><th align="center">方法</th><th align="center"><a href="mailto:&#x6d;&#65;&#80;&#x40;&#x30;&#x2e;&#x35;">mAP@0.5</a></th><th align="center">mAP</th><th align="center">自行车</th><th align="center">汽车</th><th align="center">人</th></tr></thead><tbody><tr><td align="center">MMTOD-CG</td><td align="center">61.4</td><td align="center">-</td><td align="center">50.3</td><td align="center">70.6</td><td align="center">63.3</td></tr><tr><td align="center">MMTOD-UNIT</td><td align="center">61.5</td><td align="center">-</td><td align="center">49.4</td><td align="center">70.7</td><td align="center">64.5</td></tr><tr><td align="center">CMPD</td><td align="center">69.4</td><td align="center">-</td><td align="center">59.9</td><td align="center">78.1</td><td align="center">69.6</td></tr><tr><td align="center">CFR</td><td align="center">72.4</td><td align="center">-</td><td align="center">57.8</td><td align="center">84.9</td><td align="center">74.5</td></tr><tr><td align="center">GAFF</td><td align="center">72.9</td><td align="center">37.5</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">BU-ATT</td><td align="center">73.1</td><td align="center">-</td><td align="center">56.1</td><td align="center">87.0</td><td align="center">76.1</td></tr><tr><td align="center">BU-LTT</td><td align="center">73.2</td><td align="center">-</td><td align="center">57.4</td><td align="center">86.5</td><td align="center">75.6</td></tr><tr><td align="center">UA_CMDet</td><td align="center">78.6</td><td align="center">-</td><td align="center">64.3</td><td align="center">88.4</td><td align="center">83.2</td></tr><tr><td align="center">CFT</td><td align="center">78.7</td><td align="center">40.2</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">CSAA</td><td align="center">79.2</td><td align="center">41.3</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">ICAFusion</td><td align="center">79.2</td><td align="center">41.4</td><td align="center">66.9</td><td align="center">89.0</td><td align="center">81.6</td></tr><tr><td align="center">CrossFormer</td><td align="center">79.3</td><td align="center">42.1</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">MFPT</td><td align="center">80.0</td><td align="center">-</td><td align="center">67.7</td><td align="center">89.0</td><td align="center">83.2</td></tr><tr><td align="center">MMFN</td><td align="center">80.8</td><td align="center">41.7</td><td align="center">65.5</td><td align="center">91.2</td><td align="center">85.7</td></tr><tr><td align="center">RSDet</td><td align="center">81.1</td><td align="center">41.4</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">MiPa</td><td align="center">81.3</td><td align="center">44.8</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">UniRGB-IR</td><td align="center">81.4</td><td align="center">44.1</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">CPCF</td><td align="center">82.1</td><td align="center">44.6</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">GM-DETR</td><td align="center">83.9</td><td align="center">45.8</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">Fusion-Mamba(yolov5)</td><td align="center">84.3</td><td align="center">44.4</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">Fusion-Mamba(yolov8)</td><td align="center">84.9</td><td align="center">47.0</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">TFDet</td><td align="center">86.6</td><td align="center">46.6</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">DAMSDet</td><td align="center">86.6</td><td align="center">49.3</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">Ours</td><td align="center">83.3</td><td align="center">40.3</td><td align="center">74.9</td><td align="center">89.8</td><td align="center">85.1</td></tr><tr><td align="center">Ours‡</td><td align="center">87.8</td><td align="center">49.7</td><td align="center">79.6</td><td align="center">93.4</td><td align="center">90.2</td></tr></tbody></table><p><strong>分析</strong>: 如表2所示，MS2Fusion在YOLOv5框架下达到83.3%的<a href="mailto:&#109;&#x41;&#80;&#x40;&#x30;&#x2e;&#53;">mAP@0.5</a>，在CoDetr框架下达到87.8%的<a href="mailto:&#x6d;&#x41;&#x50;&#x40;&#48;&#x2e;&#53;">mAP@0.5</a>，均取得了SOTA性能，分别比当前最优方法提升了2.2%和6.7%。尤其在“人”和“自行车”这两个非热源和小目标类别上增益明显。</p><h4 id="LLVIP-数据集比较"><a href="#LLVIP-数据集比较" class="headerlink" title="LLVIP 数据集比较"></a>LLVIP 数据集比较</h4><p><strong>表3: LLVIP 数据集比较</strong></p><table><thead><tr><th align="center">方法</th><th align="center"><a href="mailto:&#109;&#x41;&#x50;&#64;&#x30;&#x2e;&#x35;">mAP@0.5</a></th><th align="center">mAP</th></tr></thead><tbody><tr><td align="center">DIVFusion</td><td align="center">89.8</td><td align="center">52.0</td></tr><tr><td align="center">GAFF</td><td align="center">94.0</td><td align="center">55.8</td></tr><tr><td align="center">CSAA</td><td align="center">94.3</td><td align="center">41.3</td></tr><tr><td align="center">ECISNet</td><td align="center">95.7</td><td align="center">-</td></tr><tr><td align="center">RSDet</td><td align="center">95.8</td><td align="center">61.3</td></tr><tr><td align="center">UniRGB-IR</td><td align="center">96.1</td><td align="center">63.2</td></tr><tr><td align="center">UA_CMDet</td><td align="center">96.3</td><td align="center">-</td></tr><tr><td align="center">CPCF</td><td align="center">96.4</td><td align="center">65.0</td></tr><tr><td align="center">Fusion-Mamba(yolov5)</td><td align="center">96.8</td><td align="center">62.8</td></tr><tr><td align="center">Fusion-Mamba(yolov8)</td><td align="center">97.0</td><td align="center">64.3</td></tr><tr><td align="center">MMFN</td><td align="center">97.2</td><td align="center">-</td></tr><tr><td align="center">GM-DETR</td><td align="center">97.4</td><td align="center">70.2</td></tr><tr><td align="center">TFDet</td><td align="center">97.9</td><td align="center">71.1</td></tr><tr><td align="center">DAMSDet</td><td align="center">97.9</td><td align="center">69.6</td></tr><tr><td align="center">MiPa</td><td align="center">98.2</td><td align="center">66.5</td></tr><tr><td align="center">Ours</td><td align="center">97.5</td><td align="center">65.5</td></tr><tr><td align="center">Ours‡</td><td align="center">98.4</td><td align="center">70.6</td></tr></tbody></table><p><strong>分析</strong>: 如表3所示，MS2Fusion在LLVIP数据集上同样表现出色，YOLOv5框架下<a href="mailto:&#109;&#x41;&#x50;&#64;&#x30;&#x2e;&#53;">mAP@0.5</a>达到97.5%，CoDetr框架下达到98.4%，优于传统的CNN和Transformer方法。</p><h4 id="M3FD-数据集比较"><a href="#M3FD-数据集比较" class="headerlink" title="M3FD 数据集比较"></a>M3FD 数据集比较</h4><p><strong>表4: M3FD 数据集比较</strong></p><table><thead><tr><th align="center">方法</th><th align="center"><a href="mailto:&#109;&#65;&#80;&#64;&#x30;&#46;&#53;">mAP@0.5</a></th><th align="center">mAP</th><th align="center">People</th><th align="center">Bus</th><th align="center">Car</th><th align="center">Motorcycle</th><th align="center">Lamp</th><th align="center">Truck</th></tr></thead><tbody><tr><td align="center">DIDFuse</td><td align="center">79.0</td><td align="center">52.6</td><td align="center">79.6</td><td align="center">79.7</td><td align="center">92.5</td><td align="center">68.7</td><td align="center">84.7</td><td align="center">68.8</td></tr><tr><td align="center">SDNet</td><td align="center">79.0</td><td align="center">52.9</td><td align="center">79.4</td><td align="center">81.4</td><td align="center">92.3</td><td align="center">67.4</td><td align="center">84.1</td><td align="center">69.3</td></tr><tr><td align="center">RFNet</td><td align="center">79.4</td><td align="center">53.2</td><td align="center">79.4</td><td align="center">78.2</td><td align="center">91.1</td><td align="center">72.8</td><td align="center">85.0</td><td align="center">69.0</td></tr><tr><td align="center">ReC</td><td align="center">79.5</td><td align="center">-</td><td align="center">79.4</td><td align="center">78.9</td><td align="center">91.8</td><td align="center">69.3</td><td align="center">87.4</td><td align="center">70.0</td></tr><tr><td align="center">U2F</td><td align="center">79.6</td><td align="center">-</td><td align="center">80.7</td><td align="center">79.2</td><td align="center">92.3</td><td align="center">66.8</td><td align="center">87.6</td><td align="center">71.4</td></tr><tr><td align="center">DAMSDet</td><td align="center">80.2</td><td align="center">52.9</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">TarDAL</td><td align="center">80.5</td><td align="center">54.1</td><td align="center">81.5</td><td align="center">81.3</td><td align="center">94.8</td><td align="center">69.3</td><td align="center">87.1</td><td align="center">68.7</td></tr><tr><td align="center">DeFusion</td><td align="center">80.8</td><td align="center">53.8</td><td align="center">80.8</td><td align="center">83.0</td><td align="center">92.5</td><td align="center">69.4</td><td align="center">87.8</td><td align="center">71.4</td></tr><tr><td align="center">CDDFusion</td><td align="center">81.1</td><td align="center">54.3</td><td align="center">81.6</td><td align="center">82.6</td><td align="center">92.5</td><td align="center">71.6</td><td align="center">86.9</td><td align="center">71.5</td></tr><tr><td align="center">IGNet</td><td align="center">81.5</td><td align="center">54.5</td><td align="center">81.6</td><td align="center">82.4</td><td align="center">92.8</td><td align="center">73.0</td><td align="center">86.9</td><td align="center">72.1</td></tr><tr><td align="center">SuperFusion</td><td align="center">83.5</td><td align="center">56.0</td><td align="center">83.7</td><td align="center">93.2</td><td align="center">91.0</td><td align="center">77.4</td><td align="center">70.0</td><td align="center">85.8</td></tr><tr><td align="center">Fusion-Mamba(yolov5)</td><td align="center">85.0</td><td align="center">57.5</td><td align="center">80.3</td><td align="center">92.8</td><td align="center">91.9</td><td align="center">73.0</td><td align="center">84.8</td><td align="center">87.1</td></tr><tr><td align="center">MMFN</td><td align="center">86.2</td><td align="center">-</td><td align="center">83.0</td><td align="center">92.1</td><td align="center">93.2</td><td align="center">73.7</td><td align="center">87.6</td><td align="center">87.4</td></tr><tr><td align="center">Fusion-Mamba(yolov8)</td><td align="center">88.0</td><td align="center">61.9</td><td align="center">84.3</td><td align="center">94.2</td><td align="center">92.9</td><td align="center">80.5</td><td align="center">87.5</td><td align="center">88.8</td></tr><tr><td align="center">Ours</td><td align="center">89.4</td><td align="center">59.7</td><td align="center">85.6</td><td align="center">93.7</td><td align="center">93.9</td><td align="center">82.4</td><td align="center">90.8</td><td align="center">89.9</td></tr><tr><td align="center">Ours‡</td><td align="center">91.4</td><td align="center">65.6</td><td align="center">89.8</td><td align="center">95.0</td><td align="center">94.7</td><td align="center">88.2</td><td align="center">88.3</td><td align="center">92.4</td></tr></tbody></table><p><strong>分析</strong>: 如表4所示，MS2Fusion在M3FD数据集上表现出显著优势，YOLOv5框架提升3.2% (<a href="mailto:&#109;&#65;&#80;&#64;&#x30;&#x2e;&#x35;">mAP@0.5</a>)，CoDetr框架提升5.2% (<a href="mailto:&#x6d;&#x41;&#x50;&#64;&#48;&#x2e;&#53;">mAP@0.5</a>)。特别是在摩托车等高热源物体上提升明显，显示了其有效融合热成像特征的能力。</p><h4 id="VEDAI-数据集比较"><a href="#VEDAI-数据集比较" class="headerlink" title="VEDAI 数据集比较"></a>VEDAI 数据集比较</h4><p><strong>表5: VEDAI 数据集比较</strong></p><table><thead><tr><th align="center">方法</th><th align="center"><a href="mailto:&#x6d;&#65;&#80;&#64;&#48;&#x2e;&#53;">mAP@0.5</a></th><th align="center">Car</th><th align="center">Truck</th><th align="center">Pickup</th><th align="center">Tractor</th><th align="center">Camper</th><th align="center">Ship</th><th align="center">Van</th><th align="center">Plane</th></tr></thead><tbody><tr><td align="center">ICAFusion</td><td align="center">76.6</td><td align="center">88.0</td><td align="center">67.5</td><td align="center">80.9</td><td align="center">74.9</td><td align="center">78.3</td><td align="center">56.9</td><td align="center">69.8</td><td align="center">96.7</td></tr><tr><td align="center">MidFusion1</td><td align="center">77.4</td><td align="center">88.2</td><td align="center">84.9</td><td align="center">81.7</td><td align="center">68.4</td><td align="center">72.2</td><td align="center">71.0</td><td align="center">53.6</td><td align="center">99.5</td></tr><tr><td align="center">MidFusion2</td><td align="center">78.9</td><td align="center">89.2</td><td align="center">78.8</td><td align="center">87.6</td><td align="center">66.2</td><td align="center">73.2</td><td align="center">62.5</td><td align="center">73.9</td><td align="center">99.5</td></tr><tr><td align="center">Input Fusion1</td><td align="center">80.0</td><td align="center">88.7</td><td align="center">77.7</td><td align="center">79.5</td><td align="center">72.3</td><td align="center">75.7</td><td align="center">78.6</td><td align="center">72.1</td><td align="center">95.7</td></tr><tr><td align="center">Input Fusion2</td><td align="center">80.5</td><td align="center">89.1</td><td align="center">84.9</td><td align="center">78.7</td><td align="center">84.2</td><td align="center">70.1</td><td align="center">69.9</td><td align="center">68.8</td><td align="center">98.4</td></tr><tr><td align="center">YOLOFusion</td><td align="center">81.6</td><td align="center">91.7</td><td align="center">78.1</td><td align="center">85.9</td><td align="center">71.9</td><td align="center">78.9</td><td align="center">71.7</td><td align="center">75.2</td><td align="center">99.5</td></tr><tr><td align="center">Ours</td><td align="center">80.2</td><td align="center">89.5</td><td align="center">75.6</td><td align="center">84.2</td><td align="center">81.6</td><td align="center">75.9</td><td align="center">61.8</td><td align="center">76.4</td><td align="center">97.0</td></tr><tr><td align="center">Ours‡</td><td align="center">84.2</td><td align="center">93.3</td><td align="center">78.9</td><td align="center">88.5</td><td align="center">85.8</td><td align="center">80.6</td><td align="center">65.5</td><td align="center">83.6</td><td align="center">97.1</td></tr></tbody></table><p><strong>分析</strong>: 如表5所示，在VEDAI（航拍）数据集上，MS2Fusion (CoDetr) 达到了84.2%的<a href="mailto:&#x6d;&#x41;&#x50;&#x40;&#x30;&#x2e;&#53;">mAP@0.5</a>，取得了SOTA性能。这表明模型即使没有针对小目标检测进行专门优化，该模型依然能有效关注小目标的多模态特征，在无人机图像应用中表现出鲁棒性。</p><h3 id="泛化到其他多模态任务"><a href="#泛化到其他多模态任务" class="headerlink" title="泛化到其他多模态任务"></a>泛化到其他多模态任务</h3><h4 id="RGB-T-语义分割"><a href="#RGB-T-语义分割" class="headerlink" title="RGB-T 语义分割"></a>RGB-T 语义分割</h4><ul><li><strong>评估指标</strong>: 平均交并比 mIoU (Mean Intersection over Union)，是语义分割模型常用的评估指标，它通过计算预测分割与真实分割的交并比来衡量模型性能</li><li><strong>数据集</strong>: MFNet (1,569对图像, 8类) 和 SemanticRT (11,371对图像, 13类)</li></ul><p><strong>表6: MFNet 数据集比较</strong></p><table><thead><tr><th align="center">方法</th><th align="center">mIoU</th><th align="center">Car</th><th align="center">Person</th><th align="center">Bike</th><th align="center">Curve</th><th align="center">Car Stop</th><th align="center">Guardrail</th><th align="center">Color Cone</th><th align="center">Bump</th></tr></thead><tbody><tr><td align="center">PSTNet</td><td align="center">48.4</td><td align="center">76.8</td><td align="center">52.6</td><td align="center">55.3</td><td align="center">29.6</td><td align="center">25.1</td><td align="center">15.1</td><td align="center">39.4</td><td align="center">45.0</td></tr><tr><td align="center">RTFNet</td><td align="center">53.2</td><td align="center">87.4</td><td align="center">70.3</td><td align="center">62.7</td><td align="center">45.3</td><td align="center">29.8</td><td align="center">0.0</td><td align="center">29.1</td><td align="center">55.7</td></tr><tr><td align="center">FuseSeg</td><td align="center">54.5</td><td align="center">87.9</td><td align="center">71.7</td><td align="center">64.6</td><td align="center">44.8</td><td align="center">22.7</td><td align="center">6.4</td><td align="center">46.9</td><td align="center">47.9</td></tr><tr><td align="center">AFNet</td><td align="center">54.6</td><td align="center">86.0</td><td align="center">67.4</td><td align="center">62.0</td><td align="center">43.0</td><td align="center">28.9</td><td align="center">4.6</td><td align="center">44.9</td><td align="center">56.6</td></tr><tr><td align="center">ABMDRNet</td><td align="center">54.8</td><td align="center">84.8</td><td align="center">69.6</td><td align="center">60.3</td><td align="center">45.1</td><td align="center">33.1</td><td align="center">5.1</td><td align="center">47.4</td><td align="center">50.0</td></tr><tr><td align="center">FEANet</td><td align="center">55.3</td><td align="center">87.8</td><td align="center">71.1</td><td align="center">61.1</td><td align="center">46.5</td><td align="center">22.1</td><td align="center">6.6</td><td align="center">55.3</td><td align="center">48.9</td></tr><tr><td align="center">GMNet</td><td align="center">57.3</td><td align="center">86.5</td><td align="center">73.1</td><td align="center">61.7</td><td align="center">44.0</td><td align="center">42.3</td><td align="center">14.5</td><td align="center">48.7</td><td align="center">47.4</td></tr><tr><td align="center">EGFNet</td><td align="center">57.5</td><td align="center">89.8</td><td align="center">71.6</td><td align="center">63.9</td><td align="center">46.7</td><td align="center">31.3</td><td align="center">6.7</td><td align="center">52.0</td><td align="center">57.4</td></tr><tr><td align="center">DPLNet</td><td align="center">59.3</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">CMX</td><td align="center">59.7</td><td align="center">90.1</td><td align="center">75.2</td><td align="center">64.5</td><td align="center">50.2</td><td align="center">35.3</td><td align="center">8.5</td><td align="center">54.2</td><td align="center">60.6</td></tr><tr><td align="center">CRM-RGBT-Seg</td><td align="center">61.4</td><td align="center">90.0</td><td align="center">75.1</td><td align="center">67.0</td><td align="center">45.2</td><td align="center">49.7</td><td align="center">18.4</td><td align="center">54.2</td><td align="center">54.4</td></tr><tr><td align="center">MFNet(baseline)</td><td align="center">63.5</td><td align="center">92.6</td><td align="center">82.1</td><td align="center">78.2</td><td align="center">89.6</td><td align="center">24.1</td><td align="center">1.2</td><td align="center">46.2</td><td align="center">94.2</td></tr><tr><td align="center">MS2Fusion-MFNet</td><td align="center">66.3</td><td align="center">94.4</td><td align="center">82.5</td><td align="center">81.0</td><td align="center">89.9</td><td align="center">34.7</td><td align="center">0.0</td><td align="center">49.7</td><td align="center">98.3</td></tr></tbody></table><p><strong>分析</strong>: 如表6所示，在MFNet数据集上，MS2Fusion (MS2Fusion-MFNet) 取得了66.3%的最佳mIoU，相比基线提升了2.8%。在凸起和曲线类别上提升尤为明显，这表明MS2Fusion能有效利用跨模态的共享特征（如局部几何特征），显著提升这两个类别的分割性能。</p><p><strong>表7: SemanticRT 数据集比较</strong></p><table><thead><tr><th align="left">方法</th><th align="left">mIoU</th><th align="left">CarStop</th><th align="left">Bike</th><th align="left">Bicyclist</th><th align="left">Mtcycle</th><th align="left">Mtcyclist</th><th align="left">Car</th><th align="left">Tricycle</th><th align="left">TrafLight</th><th align="left">Box</th><th align="left">Pole</th><th align="left">Curve</th><th align="left">Person</th></tr></thead><tbody><tr><td align="left">PSTNet</td><td align="left">68.0</td><td align="left">71.1</td><td align="left">62.3</td><td align="left">58.5</td><td align="left">47.3</td><td align="left">55.2</td><td align="left">85.4</td><td align="left">44.2</td><td align="left">75.7</td><td align="left">83.0</td><td align="left">71.7</td><td align="left">62.2</td><td align="left">72.2</td></tr><tr><td align="left">RTFNet</td><td align="left">75.5</td><td align="left">79.6</td><td align="left">68.0</td><td align="left">67.4</td><td align="left">63.7</td><td align="left">61.6</td><td align="left">90.4</td><td align="left">66.0</td><td align="left">78.3</td><td align="left">85.9</td><td align="left">78.0</td><td align="left">67.2</td><td align="left">78.9</td></tr><tr><td align="left">EGFNet</td><td align="left">77.4</td><td align="left">78.6</td><td align="left">71.3</td><td align="left">70.9</td><td align="left">68.4</td><td align="left">66.1</td><td align="left">90.5</td><td align="left">71.5</td><td align="left">80.4</td><td align="left">85.4</td><td align="left">76.5</td><td align="left">66.9</td><td align="left">83.7</td></tr><tr><td align="left">ECM</td><td align="left">79.3</td><td align="left">80.2</td><td align="left">75.0</td><td align="left">75.5</td><td align="left">71.4</td><td align="left">70.4</td><td align="left">90.3</td><td align="left">74.0</td><td align="left">85.9</td><td align="left">85.6</td><td align="left">77.2</td><td align="left">68.3</td><td align="left">85.0</td></tr><tr><td align="left">MFNet(baseline)</td><td align="left">77.8</td><td align="left">75.3</td><td align="left">77.1</td><td align="left">63.2</td><td align="left">71.1</td><td align="left">57.3</td><td align="left">97.9</td><td align="left">66</td><td align="left">85.9</td><td align="left">89.5</td><td align="left">82.4</td><td align="left">85.0</td><td align="left">83.2</td></tr><tr><td align="left">MS2Fusion-MFNet</td><td align="left">78.8</td><td align="left">75.3</td><td align="left">77.7</td><td align="left">66.3</td><td align="left">72.3</td><td align="left">59.4</td><td align="left">97.9</td><td align="left">68.2</td><td align="left">86.0</td><td align="left">89.6</td><td align="left">81.8</td><td align="left">84.6</td><td align="left">86.7</td></tr></tbody></table><p><strong>分析</strong>: 如表7所示，在SemanticRT数据集上，MS2Fusion (MS2Fusion-MFNet) 同样表现优异，mIoU达到78.8%，相比基线提升1.0%，且与SOTA方法 (ECM) 仅相差0.5%，证明了其在多光谱特征融合上的鲁棒性和多功能性。</p><h4 id="RGB-T-显著性目标检测-RGB-T-SOD"><a href="#RGB-T-显著性目标检测-RGB-T-SOD" class="headerlink" title="RGB-T 显著性目标检测 (RGB-T SOD)"></a>RGB-T 显著性目标检测 (RGB-T SOD)</h4><ul><li><strong>评估指标</strong>: 平均绝对误差 MAE (↓越低越好), F度量 adpF (↑越高越好), S度量 S-Measure (S↑), E度量 E-Measure (adpE↑)</li><li><strong>数据集</strong>: VT821, VT1000, VT5000</li><li><strong>基线模型</strong>: MSEDNET</li></ul><p><strong>表8: VT821, VT1000 和 VT5000 数据集比较</strong><br>(↓ 表示值越小越好, ↑ 表示值越大越好)</p><table><thead><tr><th align="left">方法</th><th align="left">VT821</th><th align="left"></th><th align="left"></th><th align="left"></th><th align="left">VT1000</th><th align="left"></th><th align="left"></th><th align="left"></th><th align="left">VT5000</th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"></td><td align="left">S↑</td><td align="left">adpE↑</td><td align="left">adpF↑</td><td align="left">MAE↓</td><td align="left">S↑</td><td align="left">adpE↑</td><td align="left">adpF↑</td><td align="left">MAE↓</td><td align="left">S↑</td><td align="left">adpE↑</td><td align="left">adpF↑</td><td align="left">MAE↓</td></tr><tr><td align="left">MTMR</td><td align="left">72.5</td><td align="left">81.5</td><td align="left">66.2</td><td align="left">10.9</td><td align="left">70.6</td><td align="left">83.6</td><td align="left">71.5</td><td align="left">11.9</td><td align="left">68.0</td><td align="left">79.5</td><td align="left">59.5</td><td align="left">11.4</td></tr><tr><td align="left">M3S-NIR</td><td align="left">72.3</td><td align="left">85.9</td><td align="left">76.4</td><td align="left">14.0</td><td align="left">72.6</td><td align="left">82.7</td><td align="left">71.7</td><td align="left">14.5</td><td align="left">65.2</td><td align="left">78.0</td><td align="left">57.5</td><td align="left">16.8</td></tr><tr><td align="left">SGDL</td><td align="left">76.5</td><td align="left">84.7</td><td align="left">76.1</td><td align="left">8.5</td><td align="left">78.7</td><td align="left">85.6</td><td align="left">76.4</td><td align="left">9.0</td><td align="left">75.0</td><td align="left">82.4</td><td align="left">67.2</td><td align="left">8.9</td></tr><tr><td align="left">PoolNet</td><td align="left">75.1</td><td align="left">73.9</td><td align="left">57.8</td><td align="left">10.9</td><td align="left">83.4</td><td align="left">81.3</td><td align="left">71.4</td><td align="left">6.7</td><td align="left">76.9</td><td align="left">75.5</td><td align="left">58.8</td><td align="left">8.9</td></tr><tr><td align="left">R3Net</td><td align="left">78.6</td><td align="left">80.9</td><td align="left">66.0</td><td align="left">7.3</td><td align="left">84.2</td><td align="left">85.9</td><td align="left">76.1</td><td align="left">5.5</td><td align="left">75.7</td><td align="left">79.0</td><td align="left">61.5</td><td align="left">8.3</td></tr><tr><td align="left">CPD</td><td align="left">82.7</td><td align="left">83.7</td><td align="left">71.0</td><td align="left">5.7</td><td align="left">90.6</td><td align="left">90.2</td><td align="left">83.4</td><td align="left">3.2</td><td align="left">84.8</td><td align="left">86.7</td><td align="left">74.1</td><td align="left">5.0</td></tr><tr><td align="left">MMCI</td><td align="left">76.3</td><td align="left">78.4</td><td align="left">61.8</td><td align="left">8.7</td><td align="left">88.6</td><td align="left">89.2</td><td align="left">80.3</td><td align="left">3.9</td><td align="left">82.7</td><td align="left">85.9</td><td align="left">71.4</td><td align="left">5.5</td></tr><tr><td align="left">AFNet</td><td align="left">77.8</td><td align="left">81.6</td><td align="left">66.1</td><td align="left">6.9</td><td align="left">88.8</td><td align="left">91.2</td><td align="left">83.8</td><td align="left">3.3</td><td align="left">83.4</td><td align="left">87.7</td><td align="left">75.0</td><td align="left">5.0</td></tr><tr><td align="left">TANet</td><td align="left">81.8</td><td align="left">85.2</td><td align="left">71.7</td><td align="left">5.2</td><td align="left">90.2</td><td align="left">91.2</td><td align="left">83.8</td><td align="left">3.0</td><td align="left">84.7</td><td align="left">88.3</td><td align="left">75.4</td><td align="left">4.7</td></tr><tr><td align="left">S2MA</td><td align="left">81.1</td><td align="left">81.3</td><td align="left">70.9</td><td align="left">9.8</td><td align="left">91.8</td><td align="left">91.2</td><td align="left">84.8</td><td align="left">2.9</td><td align="left">85.3</td><td align="left">86.4</td><td align="left">74.3</td><td align="left">5.3</td></tr><tr><td align="left">JLDCF</td><td align="left">83.9</td><td align="left">83.0</td><td align="left">72.6</td><td align="left">7.6</td><td align="left">91.2</td><td align="left">89.9</td><td align="left">82.9</td><td align="left">3.0</td><td align="left">86.1</td><td align="left">86.0</td><td align="left">73.9</td><td align="left">5.0</td></tr><tr><td align="left">FMCF</td><td align="left">76.0</td><td align="left">79.6</td><td align="left">64.0</td><td align="left">8.0</td><td align="left">87.3</td><td align="left">89.9</td><td align="left">82.3</td><td align="left">3.7</td><td align="left">81.4</td><td align="left">86.4</td><td align="left">73.4</td><td align="left">5.5</td></tr><tr><td align="left">ADF</td><td align="left">81.0</td><td align="left">84.2</td><td align="left">71.7</td><td align="left">7.7</td><td align="left">91.0</td><td align="left">92.1</td><td align="left">84.7</td><td align="left">3.4</td><td align="left">86.4</td><td align="left">89.1</td><td align="left">77.8</td><td align="left">4.8</td></tr><tr><td align="left">MIDD</td><td align="left">87.1</td><td align="left">89.5</td><td align="left">80.3</td><td align="left">4.5</td><td align="left">91.5</td><td align="left">93.3</td><td align="left">88.0</td><td align="left">2.7</td><td align="left">86.8</td><td align="left">89.6</td><td align="left">79.9</td><td align="left">4.3</td></tr><tr><td align="left">LSNet</td><td align="left">87.2</td><td align="left">91.0</td><td align="left">81.4</td><td align="left">3.6</td><td align="left">92.1</td><td align="left">94.9</td><td align="left">88.1</td><td align="left">2.3</td><td align="left">87.5</td><td align="left">92.0</td><td align="left">81.7</td><td align="left">3.7</td></tr><tr><td align="left">CAVER</td><td align="left">89.8</td><td align="left">92.8</td><td align="left">87.7</td><td align="left">2.7</td><td align="left">93.6</td><td align="left">94.9</td><td align="left">91.1</td><td align="left">1.7</td><td align="left">89.9</td><td align="left">94.1</td><td align="left">84.9</td><td align="left">2.8</td></tr><tr><td align="left">DPLNet</td><td align="left">87.8</td><td align="left">90.8</td><td align="left">81.0</td><td align="left">4.3</td><td align="left">92.8</td><td align="left">95.1</td><td align="left">88.1</td><td align="left">2.2</td><td align="left">87.9</td><td align="left">91.6</td><td align="left">82.8</td><td align="left">3.8</td></tr><tr><td align="left">MSEDNET(baseline)</td><td align="left">87.6</td><td align="left">89.7</td><td align="left">80.3</td><td align="left">3.9</td><td align="left">92.8</td><td align="left">93.9</td><td align="left">86.8</td><td align="left">2.2</td><td align="left">88.1</td><td align="left">91.6</td><td align="left">82.1</td><td align="left">3.7</td></tr><tr><td align="left">MS2Fusion-MSEDNET</td><td align="left">90.4</td><td align="left">93.5</td><td align="left">86.3</td><td align="left">3.2</td><td align="left">94.4</td><td align="left">97.2</td><td align="left">91.8</td><td align="left">1.6</td><td align="left">90.2</td><td align="left">94.2</td><td align="left">86.4</td><td align="left">3.0</td></tr></tbody></table><p><strong>分析</strong>: 如表8所示，MS2Fusion (MS2Fusion-MSEDNET) 在三个RGB-T SOD数据集上均达到了SOTA性能。例如，在VT5000上，MAE指标从基线的3.7降低到3.0；在VT1000上，adpF指标从86.8提升到91.8。MS2Fusion在所有评估指标上均排名第一或第二，展示了其在RGB-T SOD任务中的卓越特征融合能力。</p><h3 id="消融研究"><a href="#消融研究" class="headerlink" title="消融研究"></a>消融研究</h3><p>所有消融研究均在FLIR数据集和YOLOv5框架上进行。</p><h4 id="不同检测框架的影响"><a href="#不同检测框架的影响" class="headerlink" title="不同检测框架的影响"></a>不同检测框架的影响</h4><p><strong>表9: 不同骨干网络和检测框架的影响</strong></p><table><thead><tr><th align="center">编号</th><th align="center">框架</th><th align="center">融合模型</th><th align="center">人</th><th align="center">汽车</th><th align="center">自行车</th><th align="center"><a href="mailto:&#x6d;&#65;&#80;&#64;&#48;&#x2e;&#53;">mAP@0.5</a></th><th align="center">FPS</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">YOLOv5</td><td align="center">Baseline</td><td align="center">83.8</td><td align="center">88.9</td><td align="center">67.3</td><td align="center">80.0</td><td align="center">43.2</td></tr><tr><td align="center">2</td><td align="center"></td><td align="center">MS2Fusion</td><td align="center">85.1</td><td align="center">89.8</td><td align="center">74.9</td><td align="center">83.3 (+3.3)</td><td align="center">24.4</td></tr><tr><td align="center">3</td><td align="center">CoDetr</td><td align="center">Baseline</td><td align="center">88.0</td><td align="center">91.7</td><td align="center">73.8</td><td align="center">84.5</td><td align="center">5.9</td></tr><tr><td align="center">4</td><td align="center"></td><td align="center">MS2Fusion</td><td align="center">90.2</td><td align="center">93.4</td><td align="center">79.6</td><td align="center">87.8 (+3.3)</td><td align="center">4.8</td></tr></tbody></table><p><strong>分析</strong>: 如表9所示，MS2Fusion模块在YOLOv5和CoDetr两个主流检测框架上，均比基线（add fusion）带来了**3.3%**的<a href="mailto:&#109;&#65;&#80;&#64;&#48;&#x2e;&#x35;">mAP@0.5</a>提升。这证明了MS2Fusion具有出色的“即插即用”特性和强大的泛化能力。</p><h4 id="不同骨干网络的影响"><a href="#不同骨干网络的影响" class="headerlink" title="不同骨干网络的影响"></a>不同骨干网络的影响</h4><p><strong>表10: 不同骨干网络的影响</strong></p><table><thead><tr><th align="center">编号</th><th align="center">骨干网络</th><th align="center">融合模型</th><th align="center">人</th><th align="center">汽车</th><th align="center">自行车</th><th align="center"><a href="mailto:&#x6d;&#65;&#x50;&#x40;&#48;&#46;&#x35;">mAP@0.5</a></th></tr></thead><tbody><tr><td align="center">1</td><td align="center">VGG16</td><td align="center">Baseline</td><td align="center">78.9</td><td align="center">87.7</td><td align="center">51.2</td><td align="center">72.6</td></tr><tr><td align="center">2</td><td align="center"></td><td align="center">MS2Fusion</td><td align="center">79.0</td><td align="center">87.8</td><td align="center">53.8</td><td align="center">73.6 (+1.0)</td></tr><tr><td align="center">3</td><td align="center">ResNet50</td><td align="center">Baseline</td><td align="center">76.8</td><td align="center">85.7</td><td align="center">44.6</td><td align="center">69.0</td></tr><tr><td align="center">4</td><td align="center"></td><td align="center">MS2Fusion</td><td align="center">80.2</td><td align="center">88.4</td><td align="center">52.8</td><td align="center">73.8 (+4.8)</td></tr><tr><td align="center">5</td><td align="center">CSPDarkNet53</td><td align="center">Baseline</td><td align="center">83.8</td><td align="center">88.9</td><td align="center">67.3</td><td align="center">80.0</td></tr><tr><td align="center">6</td><td align="center"></td><td align="center">MS2Fusion</td><td align="center">85.1</td><td align="center">89.8</td><td align="center">74.9</td><td align="center">83.3 (+3.3)</td></tr></tbody></table><p><strong>分析</strong>: 如表10所示，MS2Fusion在VGG16、ResNet50和CSPDarkNet53三种不同骨干网络上均实现了一致的性能增益，分别提升了1.0%、4.8%和3.3% (<a href="mailto:&#109;&#x41;&#x50;&#x40;&#x30;&#x2e;&#53;">mAP@0.5</a>)。这进一步证实了MS2Fusion模块对不同骨干架构的强大泛化能力和兼容性。</p><h4 id="不同模块的影响"><a href="#不同模块的影响" class="headerlink" title="不同模块的影响"></a>不同模块的影响</h4><p><strong>表11: 不同融合模块的影响</strong></p><table><thead><tr><th align="center">编号</th><th align="center">CP-SSM</th><th align="center">SP-SSM</th><th align="center">FF-SSM</th><th align="center">人</th><th align="center">汽车</th><th align="center">自行车</th><th align="center"><a href="mailto:&#109;&#65;&#x50;&#64;&#48;&#x2e;&#x35;">mAP@0.5</a></th><th align="center">Params(M)</th></tr></thead><tbody><tr><td align="center">1</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">83.8</td><td align="center">88.9</td><td align="center">67.3</td><td align="center">80.0</td><td align="center">72.7</td></tr><tr><td align="center">2</td><td align="center">✓</td><td align="center"></td><td align="center"></td><td align="center">83.8</td><td align="center">89.8</td><td align="center">72.7</td><td align="center">82.1 (+2.1)</td><td align="center">84.5</td></tr><tr><td align="center">3</td><td align="center"></td><td align="center">✓</td><td align="center"></td><td align="center">85.6</td><td align="center">90.4</td><td align="center">70.6</td><td align="center">82.2 (+2.2)</td><td align="center">90.4</td></tr><tr><td align="center">4</td><td align="center"></td><td align="center"></td><td align="center">✓</td><td align="center">84.9</td><td align="center">90.1</td><td align="center">72.4</td><td align="center">82.5 (+2.5)</td><td align="center">86.0</td></tr><tr><td align="center">5</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td><td align="center">84.9</td><td align="center">90.3</td><td align="center">72.9</td><td align="center">82.7 (+2.7)</td><td align="center">117.0</td></tr><tr><td align="center">6</td><td align="center">✓</td><td align="center"></td><td align="center">✓</td><td align="center">85.5</td><td align="center">90.0</td><td align="center">72.5</td><td align="center">82.7 (+2.7)</td><td align="center">97.8</td></tr><tr><td align="center">7</td><td align="center"></td><td align="center">✓</td><td align="center">✓</td><td align="center">85.5</td><td align="center">90.3</td><td align="center">72.9</td><td align="center">82.9 (+2.9)</td><td align="center">103.7</td></tr><tr><td align="center">8</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">85.1</td><td align="center">89.8</td><td align="center">74.9</td><td align="center">83.3 (+3.3)</td><td align="center">130.2</td></tr></tbody></table><p><strong>分析</strong>: 如表11所示，基线（第1行）mAP为80.0%。</p><ul><li>单独使用<strong>CP-SSM</strong> （第2行）提升2.1% mAP，显著提升了“自行车”类别（+5.4%），表明它善于增强模态特定特征</li><li>单独使用<strong>SP-SSM</strong> （第3行）提升2.2% mAP，表明提取跨模态共享特征的有效性</li><li>单独使用<strong>FF-SSM</strong> （第4行）提升2.5% mAP，表明其异构特征融合的高效性</li><li>组合使用（第5-7行）均有提升，而<strong>集成所有三个模块</strong> （第8行）达到了83.3% mAP的最佳性能（+3.3%），尤其在“自行车”类别上提升了7.6%</li><li>这证明了CP-SSM（互补）、SP-SSM（共享）和FF-SSM（融合）三者协同作用，实现了模态特异性增强、跨模态泛化和自适应融合的平衡</li></ul><h4 id="不同融合层的影响"><a href="#不同融合层的影响" class="headerlink" title="不同融合层的影响"></a>不同融合层的影响</h4><p><strong>表12: 在不同层进行融合的影响</strong></p><table><thead><tr><th align="center">编号</th><th align="center">P3</th><th align="center">P4</th><th align="center">P5</th><th align="center">人</th><th align="center">汽车</th><th align="center">自行车</th><th align="center"><a href="mailto:&#x6d;&#x41;&#x50;&#x40;&#x30;&#46;&#x35;">mAP@0.5</a></th></tr></thead><tbody><tr><td align="center">1</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">83.8</td><td align="center">88.9</td><td align="center">67.3</td><td align="center">80.0</td></tr><tr><td align="center">2</td><td align="center">✓</td><td align="center"></td><td align="center"></td><td align="center">83.4</td><td align="center">88.5</td><td align="center">71.4</td><td align="center">81.1 (+1.1)</td></tr><tr><td align="center">3</td><td align="center">✓</td><td align="center">✓</td><td align="center"></td><td align="center">85.8</td><td align="center">90.1</td><td align="center">70.0</td><td align="center">82.0 (+2.0)</td></tr><tr><td align="center">4</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">85.1</td><td align="center">89.8</td><td align="center">74.9</td><td align="center">83.3 (+3.3)</td></tr></tbody></table><p><strong>分析</strong>: 如表12所示，对比了在不同特征层（P3, P4, P5）应用MS2Fusion模块的效果。</p><ul><li>仅在P3（浅层）融合（第2行），“自行车”AP大幅提升5.7%，但“人”和“车”略降，总mAP升至81.1%</li><li>在P3和P4融合（第3行），“人”和“车”的AP反弹，总mAP升至82.0%</li><li>在P3、P4和P5（深层）全部融合（第4行），达到了最佳平衡，<a href="mailto:&#x6d;&#x41;&#x50;&#64;&#x30;&#46;&#53;">mAP@0.5</a>达到83.3%，并且“自行车”的AP达到74.9%，为所有配置中最高</li><li>这表明多层次特征融合（浅层细节+深层语义）对于跨模态特征集成至关重要，特别是对“自行车”等挑战性类别</li></ul><h4 id="CP-SSM-的讨论"><a href="#CP-SSM-的讨论" class="headerlink" title="CP-SSM 的讨论"></a>CP-SSM 的讨论</h4><p><strong>表13: CP-SSM 的微调</strong></p><table><thead><tr><th align="center">编号</th><th align="center">微调</th><th align="center">人</th><th align="center">汽车</th><th align="center">自行车</th><th align="center"><a href="mailto:&#x6d;&#x41;&#80;&#x40;&#48;&#x2e;&#53;">mAP@0.5</a></th></tr></thead><tbody><tr><td align="center">1</td><td align="center">rows</td><td align="center">85.1</td><td align="center">89.8</td><td align="center">74.9</td><td align="center">83.3</td></tr><tr><td align="center">2</td><td align="center">columns</td><td align="center">64.1</td><td align="center">90.3</td><td align="center">72.8</td><td align="center">82.4</td></tr><tr><td align="center">3</td><td align="center">rows and columns</td><td align="center">85.4</td><td align="center">90.4</td><td align="center">70.2</td><td align="center">82.0</td></tr><tr><td align="center">4</td><td align="center">w&#x2F;o exchange C</td><td align="center">85.7</td><td align="center">90.6</td><td align="center">71.7</td><td align="center">82.7</td></tr><tr><td align="center">5</td><td align="center">exchange C</td><td align="center">85.1</td><td align="center">89.8</td><td align="center">74.9</td><td align="center">83.3</td></tr></tbody></table><p><strong>分析</strong>: 表13探索了CP-SSM的两个关键设计：</p><ol><li><strong>扫描方向 (row 1-3)</strong>: 实验发现，仅按行（rows）扫描（第1行）效果最好（83.3% mAP）。使用多方向扫描（rows and columns，第3行）反而导致性能下降（82.0% mAP），可能是因为它改变了目标特征，不利于检测任务所需的稳定性</li><li><strong>C参数交换 (row 4-5)</strong>: 对比“不交换C”（第4行，82.7% mAP）和“交换C”（第5行，83.3% mAP），发现<strong>交换C参数</strong>的机制（即跨模态分支交换隐藏状态投影矩阵）带来了**0.6%**的稳定性能提升。这证明了该设计能有效优化跨特征交互效率</li></ol><h4 id="不同输入模态的比较"><a href="#不同输入模态的比较" class="headerlink" title="不同输入模态的比较"></a>不同输入模态的比较</h4><p><strong>表14: 不同输入的性能</strong><br>(V, T 分别表示可见光和热成像。V+T表示双模态输入，V+V或T+T表示单模态输入。)</p><table><thead><tr><th align="center">编号</th><th align="center">模型</th><th align="center">输入</th><th align="center"><a href="mailto:&#109;&#x41;&#x50;&#64;&#x30;&#x2e;&#53;">mAP@0.5</a></th></tr></thead><tbody><tr><td align="center">1</td><td align="center">YOLOv5</td><td align="center">V</td><td align="center">67.8</td></tr><tr><td align="center">2</td><td align="center"></td><td align="center">T</td><td align="center">73.9</td></tr><tr><td align="center">3</td><td align="center">Baseline</td><td align="center">V+V</td><td align="center">61.2</td></tr><tr><td align="center">4</td><td align="center"></td><td align="center">T+T</td><td align="center">77.8</td></tr><tr><td align="center">5</td><td align="center"></td><td align="center">V+T</td><td align="center">80.0</td></tr><tr><td align="center">6</td><td align="center">Ours</td><td align="center">V+V</td><td align="center">68.4 (+7.2)</td></tr><tr><td align="center">7</td><td align="center"></td><td align="center">T+T</td><td align="center">82.1 (+4.3)</td></tr><tr><td align="center">8</td><td align="center"></td><td align="center">V+T</td><td align="center">83.3 (+3.3)</td></tr></tbody></table><p><strong>分析</strong>: 表14展示了MS2Fusion在处理缺失模态时的鲁棒性。</p><ul><li>在所有输入配置下（V+V, T+T, V+T），Ours（MS2Fusion）均显著优于Baseline（基线）</li><li>当仅使用热成像（T+T）时（第7行），Ours的性能（82.1% mAP）仅比使用双模态（V+T）时（第8行，83.3% mAP）低1.2%，显示了极强的鲁棒性</li><li>这表明MS2Fusion能有效利用异构数据的共享空间特征，利用一个可用的模态信息来增强另一个模态的特征</li></ul><h4 id="FF-SSM-输入配置分析"><a href="#FF-SSM-输入配置分析" class="headerlink" title="FF-SSM 输入配置分析"></a>FF-SSM 输入配置分析</h4><p><strong>表15: FF-SSM 模块的输入配置</strong></p><table><thead><tr><th align="center">FF-SSM input</th><th align="center"><a href="mailto:&#109;&#65;&#x50;&#64;&#48;&#x2e;&#53;">mAP@0.5</a></th><th align="center">person</th><th align="center">car</th><th align="center">bicycle</th></tr></thead><tbody><tr><td align="center">(V, T)</td><td align="center">83.1</td><td align="center">85.4</td><td align="center">90.2</td><td align="center">73.9</td></tr><tr><td align="center">(T, V)</td><td align="center">82.5</td><td align="center">85.1</td><td align="center">90.1</td><td align="center">72.4</td></tr><tr><td align="center">((V, T), (T, V))</td><td align="center">83.3</td><td align="center">85.1</td><td align="center">89.8</td><td align="center">74.9</td></tr></tbody></table><p><strong>分析</strong>: 表15研究了FF-SSM模块的输入顺序。</p><ul><li>使用单向输入 (V, T)（第1行）或 (T, V)（第2行）时，mAP分别为83.1%和82.5%，均低于基线（83.3%）</li><li>这揭示了状态空间模型中存在的<strong>特征衰减（遗忘）现象</strong>：较早输入的特征在状态传播过程中逐渐被遗忘</li><li>而使用本文提出的<strong>双向架构 ((V, T), (T, V))</strong> （第3行）时，性能恢复并达到最佳（83.3% mAP），“自行车”检测（74.9%）也得到改善</li><li>如图9（ERF可视化，未显示）所示，双向策略建立了鲁棒的跨模态特征记忆路径，显著扩大了有效感受野（ERF），从而在保持线性复杂度的同时缓解了特征衰减</li></ul><p><img data-src="/./../images/image-20251031213920975-1761991594416-28.png" alt="image-20251031213920975"></p><h3 id="定性分析"><a href="#定性分析" class="headerlink" title="定性分析"></a>定性分析</h3><h4 id="模型统计分析"><a href="#模型统计分析" class="headerlink" title="模型统计分析"></a>模型统计分析</h4><p><strong>表16: 模型的统计分析 (释放随机种子进行10次实验)</strong></p><table><thead><tr><th align="center"></th><th align="center">Mean(%)</th><th align="center"></th><th align="center">VAR(%)</th><th align="center"></th></tr></thead><tbody><tr><td align="center"></td><td align="center"><a href="mailto:&#109;&#65;&#80;&#64;&#48;&#x2e;&#x35;">mAP@0.5</a></td><td align="center">mAP</td><td align="center"><a href="mailto:&#x6d;&#x41;&#80;&#64;&#x30;&#x2e;&#53;">mAP@0.5</a></td><td align="center">mAP</td></tr><tr><td align="center">FLIR</td><td align="center">82.99</td><td align="center">40.60</td><td align="center">0.15</td><td align="center">2.47</td></tr><tr><td align="center">LLVIP</td><td align="center">97.41</td><td align="center">63.46</td><td align="center">0.03</td><td align="center">2.31</td></tr><tr><td align="center">M3FD</td><td align="center">89.11</td><td align="center">59.76</td><td align="center">0.18</td><td align="center">0.42</td></tr></tbody></table><p><strong>分析</strong>: 如表16所示，通过10次随机种子实验，MS2Fusion表现出极高的稳定性。在FLIR上<a href="mailto:&#x6d;&#65;&#x50;&#64;&#x30;&#46;&#53;">mAP@0.5</a>方差仅为0.15%，在LLVIP上方差低至0.03%。这表明模型对初始条件变化具有很强的抵抗力，在不同数据分布上保持一致性能。</p><h4 id="热图可视化-图10"><a href="#热图可视化-图10" class="headerlink" title="热图可视化 (图10)"></a>热图可视化 (图10)</h4><p>对比Baseline、ICAFusion和MS2Fusion：</p><ul><li>在停车场（第一行）、夜间街道（第二行）和道路（第三行）等多种场景下，MS2Fusion均表现最佳。</li><li><strong>优势</strong>: (1) 相比CNN基线，MS2Fusion的感受野更广，能捕获更宽的对象区域；(2) 相比Transformer (ICAFusion)，它实现了更精确的轮廓拟合；(3) 假阴性率（漏检）最低，尤其是在低光照条件下。</li></ul><p><img data-src="/./../images/image-20251031214157371-1761991594416-29.png" alt="image-20251031214157371"></p><h4 id="特征融合比较可视化-图11"><a href="#特征融合比较可视化-图11" class="headerlink" title="特征融合比较可视化 (图11)"></a>特征融合比较可视化 (图11)</h4><p>对比P5层的特征图 (Baseline vs MS2Fusion)：</p><ul><li>Baseline（简单求和）导致信息丢失或模态冲突。</li><li>MS2Fusion通过其多阶段框架（CP&#x2F;SP&#x2F;FF），能选择性保留每个模态中最具辨识度的特征，同时抑制冗余，生成更丰富、更清晰的特征图。</li></ul><p><img data-src="/./../images/image-20251031214216261-1761991594416-30.png" alt="image-20251031214216261"></p><h4 id="共享和互补特征的可视化分析-图12"><a href="#共享和互补特征的可视化分析-图12" class="headerlink" title="共享和互补特征的可视化分析 (图12)"></a>共享和互补特征的可视化分析 (图12)</h4><p>在低光照条件下可视化CP-SSM和SP-SSM的输出：</p><ul><li>由于RGB模态特征弱，CP-SSM（互补特征）主要关注模态特定差异（如热梯和纹理）。</li><li>SP-SSM（共享特征）则有效融合了两个模态，生成了跨RGB和热域一致的共享语义表示（如物体轮廓、行人区域）。SP-SSM通过强制语义一致性补偿了可见光谱的退化。</li></ul><p><img data-src="/./../images/image-20251031214233322-1761991594416-31.png" alt="image-20251031214233322"></p><h4 id="RGB-T-语义分割样本可视化-图13"><a href="#RGB-T-语义分割样本可视化-图13" class="headerlink" title="RGB-T 语义分割样本可视化 (图13)"></a>RGB-T 语义分割样本可视化 (图13)</h4><p>对比Baseline和MS2Fusion的分割结果：</p><ul><li>Baseline在处理行人和车辆边界时表现模糊且存在误分类。</li><li>MS2Fusion在这些挑战区域表现出显著改进，能保持对象轮廓的精细细节和复杂背景下的分割一致性。</li></ul><p><img data-src="/./../images/image-20251031214255210-1761991594416-32.png" alt="image-20251031214255210"></p><h4 id="RGB-T-显著性目标检测样本可视化-图14"><a href="#RGB-T-显著性目标检测样本可视化-图14" class="headerlink" title="RGB-T 显著性目标检测样本可视化 (图14)"></a>RGB-T 显著性目标检测样本可视化 (图14)</h4><p>对比Ours (MS2Fusion) 和其他SOTA方法：</p><ul><li><strong>优势</strong>: (1) 利用跨模态互补性生成精确的对象边界，噪声干扰最小（第1, 5行）；(2) 在遮挡场景中鲁棒性强，保持了完整的物体形态（第2行）；(3) 对小物体（第4行）和复杂形状（第3, 6行）具有出色的敏感性。</li></ul><p><img data-src="/./../images/image-20251031214312729-1761991594416-33.png" alt="image-20251031214312729"></p><h3 id="局限性-图15"><a href="#局限性-图15" class="headerlink" title="局限性 (图15)"></a>局限性 (图15)</h3><p>分析了几个失败案例：</p><ol><li><strong>远处物体</strong>: 当物体距离远且在热图像中不突出（热信号与背景接近）时，模型难以区分物体和背景。</li><li><strong>遮挡物体</strong>: 模型倾向于忽略部分或完全被遮挡的物体，导致漏检。</li><li><strong>热相似物体的假阳性</strong>: 具有与人相似热特征的物体（如第3行）会导致假阳性检测，尤其是在低分辨率图像中，模型难以区分。</li></ol><p><img data-src="/./../images/image-20251031214326873-1761991594416-34.png" alt="image-20251031214326873"></p><h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>本论文提出了**多光谱状态空间特征融合（MS2Fusion）**框架，旨在解决现代多光谱目标检测中存在的两个关键限制：一是过度偏向局部互补特征，而忽略跨模态共享语义，影响了泛化性能；二是感受野尺寸和计算复杂度之间的权衡，是可扩展特征建模的关键瓶颈。</p><p>MS2Fusion基于<strong>状态空间模型（SSM）</strong>，通过<strong>双路径参数交互机制</strong>实现了高效且有效的特征融合。</p><ul><li>**共享参数交互（SP-SSM）**分支：通过在SSM中共享参数，探索跨模态对齐，以获得相似的语义特征和结构。</li><li>**交叉参数交互（CP-SSM）**分支：利用SSM中的跨模态隐藏状态解码，继承了交叉注意力的优势，以挖掘互补信息。</li></ul><p>这两种路径在一个统一的框架内通过SSM进行联合优化，使MS2Fusion能够同时享有功能互补性和共享语义空间。得益于这种双分支SSM设计，本方法同时继承了<strong>计算效率</strong>和<strong>全局感受野</strong>的优点，显著提高了多光谱目标检测的性能。</p><p>实验结果表明，MS2Fusion持续优于现有强大的基线方法：</p><ul><li>在目标检测（FLIR）任务中，<a href="mailto:&#109;&#x41;&#80;&#64;&#x30;&#46;&#x35;">mAP@0.5</a>提高了3.3%。</li><li>在RGB-T语义分割（MFNet）任务中，mIoU提升了2.8%。</li><li>在显著性目标检测（VT5000）任务中，MAE降低了0.7%。</li></ul><p>值得注意的是，MS2Fusion无需针对特定任务进行修改，即可在多个多光谱感知任务上实现<strong>新的最先进（SOTA）结果</strong>，充分证明了其卓越的<strong>泛化能力</strong>。</p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"><strong>本文作者： </strong>MaJianyu</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://mjy.js.org/2025/10/30/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20Inf.%20Fusion%202025%20%20MS2Fusion%EF%BC%9A%E5%A4%9A%E9%87%8D%E5%85%89%E8%B0%B1%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E3%80%91/" title="【论文阅读 | Inf. Fusion 2025 | MS2Fusion：多重光谱状态空间特征融合】">https://mjy.js.org/2025/10/30/【论文阅读 Inf. Fusion 2025 MS2Fusion：多重光谱状态空间特征融合】/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="post-tags"><a href="/tags/%E5%A4%9A%E5%85%89%E8%B0%B1%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/" rel="tag"># 多光谱目标检测</a> <a href="/tags/%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B/" rel="tag"># 状态空间模型</a> <a href="/tags/%E5%85%B1%E4%BA%AB%E5%8F%82%E6%95%B0/" rel="tag"># 共享参数</a> <a href="/tags/%E8%B7%A8%E5%8F%82%E6%95%B0%E4%BA%A4%E4%BA%92/" rel="tag"># 跨参数交互</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2025/10/28/2025.10.28%20C%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8A%E6%9C%BA%E5%AE%9E%E4%B9%A0%E4%BA%8C/" rel="prev" title="2025.10.28 C语言程序设计上机实习二"><i class="fa fa-angle-left"></i> 2025.10.28 C语言程序设计上机实习二</a></div><div class="post-nav-item"><a href="/2025/10/31/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%202024%20ICM%20%20Problem%20F%20%202409949%E3%80%91/" rel="next" title="【论文阅读 | 2024 ICM | Problem F | 2409949 】">【论文阅读 | 2024 ICM | Problem F | 2409949 】 <i class="fa fa-angle-right"></i></a></div></div></footer></article></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2021 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">MaJianyu</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span>站点总字数：</span> <span title="站点总字数">211k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span>站点阅读时长 &asymp;</span> <span title="站点阅读时长">6:23</span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动</div><a href="https://icp.gov.moe/?keyword=20216556" target="_blank">萌ICP备20216556号</a></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><a href="https://github.com/majianyu2007" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://mjy.js.org/js/darkmode@1.5.7.min.js"></script><script>var options = {
  bottom: '16px',
  right: '16px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();</script></body></html>