<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2025.10.28 C语言程序设计上机实习二</title>
    <url>/2025/10/28/2025.10.28%20C%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8A%E6%9C%BA%E5%AE%9E%E4%B9%A0%E4%BA%8C/</url>
    <content><![CDATA[<h1 id="2025-10-28-C语言程序设计上机实习二"><a href="#2025-10-28-C语言程序设计上机实习二" class="headerlink" title="2025.10.28 C语言程序设计上机实习二"></a>2025.10.28 C语言程序设计上机实习二</h1><h2 id="题目一：内存图的绘制"><a href="#题目一：内存图的绘制" class="headerlink" title="题目一：内存图的绘制"></a>题目一：内存图的绘制</h2><p>实际输出结果：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251028$ ./question1</span><br><span class="line">Address of ch: 0x7ffeaee82527, Value: X</span><br><span class="line">Address of arr: 0x7ffeaee82530, arr[0]: 10</span><br><span class="line">Address of arr[1]: 0x7ffeaee82534, Value: 20</span><br><span class="line">Address of arr[2]: 0x7ffeaee82538, Value: 30</span><br><span class="line">Address of num: 0x7ffeaee82528, Value: 100</span><br><span class="line">Address of f: 0x7ffeaee8252c, Value: 3.140000</span><br></pre></td></tr></table></figure>

<p>内存布局图:<img data-src="/./../images/image-20251028192056596.png" alt="image-20251028192056596"></p>
<h2 id="题目二：运算符与表达式求值的逆向解析"><a href="#题目二：运算符与表达式求值的逆向解析" class="headerlink" title="题目二：运算符与表达式求值的逆向解析"></a>题目二：运算符与表达式求值的逆向解析</h2><p>程序的完整源代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a=<span class="number">10</span>, b=<span class="number">3</span>, c=<span class="number">0</span>; <span class="comment">//声明变量</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Step1 输出原始值</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Initial values: a=%d, b=%d, c=%d\n&quot;</span>, a, b, c);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Step2 计算a / b并输出</span></span><br><span class="line">    c = a / b; <span class="comment">//执行除法运算，并将结果赋给 c</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After a / b: c=%d, a=%d, b=%d\n&quot;</span>, c, a, b);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Step3 计算a % b并输出</span></span><br><span class="line">    c = a % b; <span class="comment">//执行取余运算，并将结果赋给 c</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After a %% b: c=%d, a=%d, b=%d\n&quot;</span>, c, a, b);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Step4 a前置自增并输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After ++a: c=%d, a=%d, b=%d\n&quot;</span>, c, ++a, b); <span class="comment">//a自增，在输出a之前对a执行自增运算</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Step5 b后置自减并输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After b--: c=%d, a=%d, b=%d\n&quot;</span>, c, a, b--); <span class="comment">//在输出b之后对b执行自减运算</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Step6 使c赋值为a后置自增与b前置自减的积并输出</span></span><br><span class="line">    c = a++ * --b; <span class="comment">//a自增，但不立即改变；b自减，立即改变</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After c = a++ * --b: c=%d, a=%d, b=%d\n&quot;</span>, c, a, b);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Step7 输出最终结果</span></span><br><span class="line">    <span class="comment">//在Step4-6中，自增自减操作均独立成行，没有对输出造成影响</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Final values: a=%d, b=%d, c=%d\n&quot;</span>, a, b, c);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>程序的实际运行输出：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251028$ ./question2</span><br><span class="line">Initial values: a=10, b=3, c=0</span><br><span class="line">After a / b: c=3, a=10, b=3</span><br><span class="line">After a % b: c=1, a=10, b=3</span><br><span class="line">After ++a: c=1, a=11, b=3</span><br><span class="line">After b--: c=1, a=11, b=3</span><br><span class="line">After c = a++ * --b: c=11, a=12, b=1</span><br><span class="line">Final values: a=12, b=1, c=11</span><br></pre></td></tr></table></figure>

<h2 id="题目三：逻辑与关系表达式的逆向解析"><a href="#题目三：逻辑与关系表达式的逆向解析" class="headerlink" title="题目三：逻辑与关系表达式的逆向解析"></a>题目三：逻辑与关系表达式的逆向解析</h2><p>程序的完整源代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">5</span>, y = <span class="number">0</span>, z = <span class="number">1</span>, result;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Initial values: x=%d, y=%d, z=%d\n&quot;</span>, x, y, z);<span class="comment">// 初始值由int声明时赋予</span></span><br><span class="line">    <span class="comment">// 计算 x &gt; 3，将结果赋给 result</span></span><br><span class="line">    result = ( x &gt; <span class="number">3</span> );</span><br><span class="line">    <span class="comment">// printf 打印输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After x &gt; 3: result=%d, x=%d, y=%d, z=%d\n&quot;</span>, result, x, y, z);</span><br><span class="line">    <span class="comment">// x &gt; 3 为真，5 &gt; 3，故result为真（1）</span></span><br><span class="line">    <span class="comment">// 计算 y == 0，将结果赋给 result</span></span><br><span class="line">    result = ( y == <span class="number">0</span> );</span><br><span class="line">    <span class="comment">// printf 打印输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After y == 0: result=%d, x=%d, y=%d, z=%d\n&quot;</span>, result, x, y, z);</span><br><span class="line">    <span class="comment">// y == 0 为真，0 == 0，故result为真（1）</span></span><br><span class="line">    <span class="comment">// 计算 z != 1，将结果赋给 result</span></span><br><span class="line">    result = ( z != <span class="number">1</span> );</span><br><span class="line">    <span class="comment">// printf 输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After z != 0: result=%d, x=%d, y=%d, z=%d\n&quot;</span>, result, x, y, z);</span><br><span class="line">    <span class="comment">// z != 0 为假，z == 0，故result为假（0）</span></span><br><span class="line">    <span class="comment">// 计算 x &gt; 3 &amp;&amp; y == 0，将结果赋给 result</span></span><br><span class="line">    result = ( x &gt; <span class="number">3</span> &amp;&amp; y == <span class="number">0</span> );</span><br><span class="line">    <span class="comment">// printf 打印输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After x &gt; 3 &amp;&amp; y == 0: result=%d, x=%d, y=%d, z=%d\n&quot;</span>, result, x, y, z);</span><br><span class="line">    <span class="comment">// &amp;&amp;是逻辑与运算符，要求两边同时为真。变量x的值大于3，且变量y的值等于0，左右两个条件同时满足，所以逻辑与运算的结果为真（1）</span></span><br><span class="line">    <span class="comment">// 计算 x &gt; 3 &amp;&amp; z != 1，将结果赋给 result</span></span><br><span class="line">    result = ( x &gt; <span class="number">3</span> &amp;&amp; z != <span class="number">1</span> );</span><br><span class="line">    <span class="comment">// printf 打印输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After x &gt; 3 &amp;&amp; z != 1: result=%d, x=%d, y=%d, z=%d\n&quot;</span>, result, x, y, z);</span><br><span class="line">    <span class="comment">// &amp;&amp;是逻辑与运算符，要求两边同时为真。变量x的值大于3，且变量z的值不等于1，前一条件满足，后一条件不满足，所以逻辑与运算的结果为假（0）</span></span><br><span class="line">    <span class="comment">// 计算 x &lt;= 3 || y == 0，将结果赋给 result</span></span><br><span class="line">    result = ( x &lt;= <span class="number">3</span> || y == <span class="number">0</span> );</span><br><span class="line">    <span class="comment">// printf 打印输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After x &lt;= 3 || y == 0: result=%d, x=%d, y=%d, z=%d\n&quot;</span>, result, x, y, z);</span><br><span class="line">    <span class="comment">// ||是逻辑或运算符，要求有一为真即可为真。变量x的值小于等于3，或y的值为0，后者满足条件，所以逻辑或运算的结果为真（1）</span></span><br><span class="line">    <span class="comment">// 计算 !y，将结果赋给 result</span></span><br><span class="line">    result = ( !y );</span><br><span class="line">    <span class="comment">// printf 打印输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After !y: result=%d, x=%d, y=%d, z=%d\n&quot;</span>, result, x, y, z);</span><br><span class="line">    <span class="comment">// !为逻辑非运算符，y的值为0为非，取反后为真，所以逻辑非运算的结果为真（1）</span></span><br><span class="line">    <span class="comment">// 计算 !(x &gt; 3 &amp;&amp; y == 0)，将结果赋给 result</span></span><br><span class="line">    result = ( !(x &gt; <span class="number">3</span> &amp;&amp; y == <span class="number">0</span>) );</span><br><span class="line">    <span class="comment">// printf 打印输出</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After !(x &gt; 3 &amp;&amp; y == 0): result=%d, x=%d, y=%d, z=%d\n&quot;</span>, result, x, y, z);</span><br><span class="line">    <span class="comment">// 括号在这里用于改变（提高）运算优先级，先执行括号内部的逻辑表达式 x &gt; 3 &amp;&amp; y == 0</span></span><br><span class="line">    <span class="comment">// 如果没有括号，逻辑非运算符 ! 的优先级高于 &amp;&amp;，会先计算 !x，再与后续表达式进行运算，将会完全改变表达式的逻辑含义，导致结果错误</span></span><br><span class="line">    <span class="comment">// !为逻辑非运算符，用于对其后的布尔值（或可转换为布尔值的表达式）进行取反操作，这里对表达式的计算结果进行取反</span></span><br><span class="line">    <span class="comment">// 根据上一步语句可知，括号内的表达式 x &gt; 3 &amp;&amp; y == 0 的结果为 1（真）</span></span><br><span class="line">    <span class="comment">// 因此 !(x &gt; 3 &amp;&amp; y == 0) 等价于 !1，逻辑非运算的结果为 0（假）</span></span><br><span class="line">    <span class="comment">// 所以此处的 result 变量被赋值为 0</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Final values: x=%d, y=%d, z=%d, result=%d\n&quot;</span>, x, y, z, result);</span><br><span class="line">    <span class="comment">// 本题目仅对result的值进行了改变，且输出结果前未再次对result进行操作</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>程序的实际运行输出：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251028$ ./question3</span><br><span class="line">Initial values: x=5, y=0, z=1</span><br><span class="line">After x &gt; 3: result=1, x=5, y=0, z=1</span><br><span class="line">After y == 0: result=1, x=5, y=0, z=1</span><br><span class="line">After z != 0: result=0, x=5, y=0, z=1</span><br><span class="line">After x &gt; 3 &amp;&amp; y == 0: result=1, x=5, y=0, z=1</span><br><span class="line">After x &gt; 3 &amp;&amp; z != 1: result=0, x=5, y=0, z=1</span><br><span class="line">After x &lt;= 3 || y == 0: result=1, x=5, y=0, z=1</span><br><span class="line">After !y: result=1, x=5, y=0, z=1</span><br><span class="line">After !(x &gt; 3 &amp;&amp; y == 0): result=0, x=5, y=0, z=1</span><br><span class="line">Final values: x=5, y=0, z=1, result=0</span><br></pre></td></tr></table></figure>

<h2 id="题目四：使用-运算符求最大值"><a href="#题目四：使用-运算符求最大值" class="headerlink" title="题目四：使用 ?: 运算符求最大值"></a>题目四：使用 ?: 运算符求最大值</h2><p>程序的完整源代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> A, B, C, max; <span class="comment">//声明变量</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%*c%d%*c%d&quot;</span>, &amp;A, &amp;B, &amp;C); <span class="comment">//输入</span></span><br><span class="line">    max = A &gt; B ? (A &gt; C ? A : C) : (B &gt; C ? B : C);</span><br><span class="line">    <span class="comment">// 比大小</span></span><br><span class="line">    <span class="comment">// 先判断 A 和 B 的大小；</span></span><br><span class="line">    <span class="comment">// 如果 A &gt; B，则进一步比较 A 和 C，将较大值赋给 max</span></span><br><span class="line">    <span class="comment">// 如果 A ≤ B，则进一步比较 B 和 C，将较大值赋给 max</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The maximum of A=%d, B=%d, C=%d is %d.\n&quot;</span>, A, B, C, max);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>程序的实际运行输出：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251028$ ./question4</span><br><span class="line">15 8 23</span><br><span class="line">The maximum of A=15, B=8, C=23 is 23.</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>2025.11.11 C语言程序设计上机实习四</title>
    <url>/2025/11/11/2025.11.11%20C%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8A%E6%9C%BA%E5%AE%9E%E4%B9%A0%E5%9B%9B/</url>
    <content><![CDATA[<h1 id="2025-11-11-C语言程序设计上机实习四"><a href="#2025-11-11-C语言程序设计上机实习四" class="headerlink" title="2025.11.11 C语言程序设计上机实习四"></a>2025.11.11 C语言程序设计上机实习四</h1><h2 id="必做题"><a href="#必做题" class="headerlink" title="必做题"></a>必做题</h2><p><img data-src="/./../images/image-20251111190813130.png" alt="image-20251111190813130"></p>
<h2 id="选做题"><a href="#选做题" class="headerlink" title="选做题"></a>选做题</h2><p>题目源文件<a href="https://mjy.js.org/attach/%E5%AE%9E%E9%AA%8C%E5%9B%9B.pdf">实验四.pdf</a></p>
<p>完整源代码</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">Char2Int</span><span class="params">(<span class="type">char</span> ch)</span>; <span class="comment">// 将字符 &#x27;0&#x27;-&#x27;9&#x27;,&#x27;A&#x27;-&#x27;F&#x27; 转换为对应的整数值（0~15）</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">Strlen</span><span class="params">(<span class="type">char</span> *str)</span>; <span class="comment">// 计算字符串长度（不使用 string.h）</span></span><br><span class="line"><span class="type">char</span> <span class="title function_">Int2Char</span><span class="params">(<span class="type">int</span> d)</span>; <span class="comment">// 将 0~15 转为 &#x27;0&#x27;-&#x27;9&#x27; 或 &#x27;A&#x27;-&#x27;F&#x27;</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">Power</span><span class="params">(<span class="type">int</span> base, <span class="type">int</span> <span class="built_in">exp</span>)</span>; <span class="comment">// 计算 base^exp（exp ≥ 0）</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">Base2Dec</span><span class="params">(<span class="type">int</span> base, <span class="type">char</span> *num)</span>; <span class="comment">// 将 base 进制字符串转为十进制整数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Dec2Base</span><span class="params">(<span class="type">int</span> num, <span class="type">int</span> base, <span class="type">char</span> *converted)</span>; <span class="comment">// 十进制转 base 进制（低位在前）</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Reverse</span><span class="params">(<span class="type">char</span> *str)</span>; <span class="comment">// 反转字符串（原地操作）</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Base2Base</span><span class="params">(<span class="type">int</span> base_from, <span class="type">int</span> base_to, <span class="type">char</span> *num_from, <span class="type">char</span> *num_to)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> base_from, base_to; <span class="comment">// base_from为原始进制，base_to为目标进制</span></span><br><span class="line">    <span class="type">char</span> num_from[<span class="number">11</span>]; <span class="comment">// 输入原始字符串，最大支持10字符，留1给&#x27;\0&#x27;</span></span><br><span class="line">    <span class="type">char</span> num_to[<span class="number">11</span>]; <span class="comment">// 输出转换后字符串，最大支持10字符，留1给&#x27;\0&#x27;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %s %d&quot;</span>, &amp;base_from, num_from, &amp;base_to); <span class="comment">// scanf格式化输入&quot;原始进制 原始字符串 目标进制&quot;</span></span><br><span class="line">    Base2Base(base_from, base_to, num_from, num_to); <span class="comment">// 调用&#x27;Base2Base进制&#x27;，传入四个参量:&quot;原始进制,目标进制,原始字符串,转换后字符串&quot;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, num_to); <span class="comment">// 格式化输出转换后字符串</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将字符 &#x27;0&#x27;-&#x27;9&#x27;,&#x27;A&#x27;-&#x27;F&#x27; 转换为对应的整数值（0~15）</span></span><br><span class="line"><span class="comment">// 若字符非法（如 &#x27;G&#x27;, &#x27;z&#x27;），返回 -1</span></span><br><span class="line"><span class="comment">// 调用返回整型数字</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">Char2Int</span><span class="params">(<span class="type">char</span> ch)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> ch - <span class="string">&#x27;0&#x27;</span>; <span class="comment">// 将字符转化为数字</span></span><br><span class="line">    <span class="keyword">switch</span> (ch) <span class="comment">// 大写字母的转换</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>: <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;B&#x27;</span>: <span class="keyword">return</span> <span class="number">11</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;C&#x27;</span>: <span class="keyword">return</span> <span class="number">12</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;D&#x27;</span>: <span class="keyword">return</span> <span class="number">13</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;E&#x27;</span>: <span class="keyword">return</span> <span class="number">14</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;F&#x27;</span>: <span class="keyword">return</span> <span class="number">15</span>;</span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// 字符非法处理</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算字符串长度（不使用 string.h）</span></span><br><span class="line"><span class="comment">// 调用返回传入字符串数组的长度，不包含&#x27;\0&#x27;</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">Strlen</span><span class="params">(<span class="type">char</span> *str)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (str[i] != <span class="string">&#x27;\0&#x27;</span>) <span class="comment">// 使用while来遍历字符，直至到字符串终止符&#x27;\0&#x27;</span></span><br><span class="line">        i++;</span><br><span class="line">    <span class="keyword">return</span> i; <span class="comment">// 返回字符串长度</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将字符 &#x27;0&#x27;-&#x27;9&#x27;,&#x27;A&#x27;-&#x27;F&#x27; 转换为对应的整数值（0~15）</span></span><br><span class="line"><span class="comment">// 若整数非法（如 &#x27;G&#x27;, &#x27;z&#x27;），返回 -1</span></span><br><span class="line"><span class="comment">// 调用返回传入整数的对应字符</span></span><br><span class="line"><span class="type">char</span> <span class="title function_">Int2Char</span><span class="params">(<span class="type">int</span> d)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">switch</span> (d) <span class="comment">//传入整数的转换</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">return</span> <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>: <span class="keyword">return</span> <span class="string">&#x27;3&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>: <span class="keyword">return</span> <span class="string">&#x27;4&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>: <span class="keyword">return</span> <span class="string">&#x27;5&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>: <span class="keyword">return</span> <span class="string">&#x27;6&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>: <span class="keyword">return</span> <span class="string">&#x27;7&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">8</span>: <span class="keyword">return</span> <span class="string">&#x27;8&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">9</span>: <span class="keyword">return</span> <span class="string">&#x27;9&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">10</span>: <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">11</span>: <span class="keyword">return</span> <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">12</span>: <span class="keyword">return</span> <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13</span>: <span class="keyword">return</span> <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">14</span>: <span class="keyword">return</span> <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">15</span>: <span class="keyword">return</span> <span class="string">&#x27;F&#x27;</span>;</span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// 整数非法处理</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算 base^exp(exp ≥ 0)</span></span><br><span class="line"><span class="comment">// 若exp&lt;0，返回-1</span></span><br><span class="line"><span class="comment">// 调用返回base^exp的结果</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">Power</span><span class="params">(<span class="type">int</span> base, <span class="type">int</span> <span class="built_in">exp</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">exp</span> &gt;= <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> ( <span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">exp</span>; i++ )</span><br><span class="line">        &#123;</span><br><span class="line">            result *= base;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;幂不能为负数!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将 base 进制字符串转为十进制整数</span></span><br><span class="line"><span class="comment">// 调用返回字符串对应的十进制整数</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">Base2Dec</span><span class="params">(<span class="type">int</span> base, <span class="type">char</span> *num)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> len = Strlen(num);</span><br><span class="line">    <span class="type">int</span> result;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( base &lt; <span class="number">2</span> || base &gt; <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;本程序仅支持 2 到 16 进制 之间的相互转换!请检查输入!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( <span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> vaild = Char2Int(num[i]);</span><br><span class="line">        <span class="keyword">if</span> ( vaild &lt; <span class="number">0</span>|| vaild &gt;= base )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;输入的字符串与初始进制不对应!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        result += vaild * Power(base, len - i - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 十进制转 base 进制（低位在前）</span></span><br><span class="line"><span class="comment">// 调用后输出低位在前的converted数组</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Dec2Base</span><span class="params">(<span class="type">int</span> num, <span class="type">int</span> base, <span class="type">char</span> *converted)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> temp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( base &lt; <span class="number">2</span> || base &gt; <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;本程序仅支持 2 到 16 进制 之间的相互转换!请检查输入!&quot;</span>);</span><br><span class="line">        converted[<span class="number">0</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( num == <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        converted[<span class="number">0</span>] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        converted[<span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ( num &gt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        temp = num % base;</span><br><span class="line">        converted[i++] = Int2Char(temp);</span><br><span class="line">        num /= base;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    converted[i] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 反转字符串（原地操作）</span></span><br><span class="line"><span class="comment">// 使用按位异或，不会开辟新的内存空间</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Reverse</span><span class="params">(<span class="type">char</span> *str)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> len = Strlen(str);</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = len - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ( i &lt; j )</span><br><span class="line">    &#123;</span><br><span class="line">        str[i] ^= str[j];</span><br><span class="line">        str[j] ^= str[i];</span><br><span class="line">        str[i] ^= str[j];</span><br><span class="line"></span><br><span class="line">        i++;</span><br><span class="line">        j--;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 主要函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Base2Base</span><span class="params">(<span class="type">int</span> base_from, <span class="type">int</span> base_to, <span class="type">char</span> *num_from, <span class="type">char</span> *num_to)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> num_Dec; <span class="comment">// 存储原始字符串转换后的十进制数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( base_from &lt; <span class="number">2</span> || base_from &gt; <span class="number">16</span> || base_to &lt; <span class="number">2</span> || base_to &gt; <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;本程序仅支持 2 到 16 进制 之间的相互转换!请检查输入!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    num_Dec = Base2Dec(base_from, num_from); <span class="comment">// 赋值，调用Base2Dec函数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( num_Dec &lt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        num_to[<span class="number">0</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Dec2Base(num_Dec, base_to, num_to); <span class="comment">// 使用Dec2Base将十进制数转换为目标进制的字符串(低位在前)</span></span><br><span class="line"></span><br><span class="line">    Reverse(num_to); <span class="comment">// 反转(高位在前)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译&amp;&amp;测试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251111$ gcc main.c -o main</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">10 123 2</span><br><span class="line">1111011</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">2 1111 10</span><br><span class="line">15</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">16 1A 2</span><br><span class="line">11010</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">8 77 16</span><br><span class="line">3F</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">10 0 2</span><br><span class="line">0</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">2 0 16</span><br><span class="line">0</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">16 F 10</span><br><span class="line">15</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">3 222 10</span><br><span class="line">26</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">10 255 16</span><br><span class="line">FF</span><br><span class="line">s13665@ubuntu:~/codes/20251111$ ./main</span><br><span class="line">16 0 10</span><br><span class="line">0</span><br><span class="line">s13665@ubuntu:~/codes/20251111$</span><br></pre></td></tr></table></figure>

<p>截图</p>
<p><img data-src="/./../images/image-20251111204605652.png" alt="image-20251111204605652"></p>
]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>2025.11.04 C语言程序设计上机实习三</title>
    <url>/2025/11/04/2025.11.04%20C%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8A%E6%9C%BA%E5%AE%9E%E4%B9%A0%E4%B8%89/</url>
    <content><![CDATA[<h1 id="2025-11-04-C语言程序设计上机实习三"><a href="#2025-11-04-C语言程序设计上机实习三" class="headerlink" title="2025.11.04 C语言程序设计上机实习三"></a>2025.11.04 C语言程序设计上机实习三</h1><h2 id="函数的基本定义与调用"><a href="#函数的基本定义与调用" class="headerlink" title="函数的基本定义与调用"></a>函数的基本定义与调用</h2><h3 id="程序的完整源代码"><a href="#程序的完整源代码" class="headerlink" title="程序的完整源代码"></a>程序的完整源代码</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义圆周率常量，通过反余弦函数计算获得精确值</span></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">计算圆的面积</span></span><br><span class="line"><span class="comment">r 圆的半径</span></span><br><span class="line"><span class="comment">return 计算得到的圆的面积</span></span><br><span class="line"><span class="comment">***/</span></span><br><span class="line"><span class="type">double</span> <span class="title function_">CircleArea</span><span class="params">(<span class="type">double</span> r)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">计算矩形的面积</span></span><br><span class="line"><span class="comment">l 矩形的长度</span></span><br><span class="line"><span class="comment">w 矩形的宽度</span></span><br><span class="line"><span class="comment">return 计算得到的矩形的面积</span></span><br><span class="line"><span class="comment">***/</span></span><br><span class="line"><span class="type">double</span> <span class="title function_">RectangleArea</span><span class="params">(<span class="type">double</span> l, <span class="type">double</span> w)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">打印圆和矩形的面积</span></span><br><span class="line"><span class="comment">circle 圆的面积</span></span><br><span class="line"><span class="comment">rect 矩形的面积</span></span><br><span class="line"><span class="comment">return 无返回值</span></span><br><span class="line"><span class="comment">***/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">PrintAreas</span><span class="params">(<span class="type">double</span> circle, <span class="type">double</span> rect)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化变量：圆的半径为5.0，矩形的长为4.0、宽为3.0</span></span><br><span class="line">    <span class="type">double</span> radius=<span class="number">5.0</span>, length=<span class="number">4.0</span>, width=<span class="number">3.0</span>;</span><br><span class="line">    <span class="comment">// 声明变量用于存储计算得到的面积</span></span><br><span class="line">    <span class="type">double</span> circle, rect;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用CircleArea函数计算圆的面积</span></span><br><span class="line">    <span class="comment">// 参数传递过程：将radius作为实参传递给形参r，函数内部使用r计算面积后返回结果赋值给circle</span></span><br><span class="line">    circle = CircleArea(radius);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用RectangleArea函数计算矩形的面积</span></span><br><span class="line">    <span class="comment">// 参数传递过程：将length和width作为实参分别传递给形参l和w，函数内部使用l和w计算面积后返回结果赋值给rect</span></span><br><span class="line">    rect = RectangleArea(length, width);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用PrintAreas函数打印面积结果</span></span><br><span class="line">    <span class="comment">// 参数传递过程：将circle和rect作为实参分别传递给形参circle和rect，函数内部使用这两个参数进行格式化输出</span></span><br><span class="line">    PrintAreas(circle, rect);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">计算圆的面积</span></span><br><span class="line"><span class="comment">r 圆的半径</span></span><br><span class="line"><span class="comment">计算得到的圆的面积，计算公式：π * r * r</span></span><br><span class="line"><span class="comment">***/</span></span><br><span class="line"><span class="type">double</span> <span class="title function_">CircleArea</span><span class="params">(<span class="type">double</span> r)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">double</span> result;       <span class="comment">// 声明变量存储计算结果</span></span><br><span class="line">    result = pi * r * r; <span class="comment">// 使用圆面积公式计算</span></span><br><span class="line">    <span class="keyword">return</span> result;       <span class="comment">// 返回计算得到的面积</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">计算矩形的面积</span></span><br><span class="line"><span class="comment">l 矩形的长度</span></span><br><span class="line"><span class="comment">w 矩形的宽度</span></span><br><span class="line"><span class="comment">return 计算得到的矩形的面积，计算公式：l * w</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">double</span> <span class="title function_">RectangleArea</span><span class="params">(<span class="type">double</span> l, <span class="type">double</span> w)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">double</span> result;       <span class="comment">// 声明变量存储计算结果</span></span><br><span class="line">    result = l * w;      <span class="comment">// 使用矩形面积公式计算</span></span><br><span class="line">    <span class="keyword">return</span> result;       <span class="comment">// 返回计算得到的面积</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">打印圆和矩形的面积</span></span><br><span class="line"><span class="comment">circle 圆的面积，以10位小数精度输出</span></span><br><span class="line"><span class="comment">rect 矩形的面积，以2位小数精度输出</span></span><br><span class="line"><span class="comment">return 无返回值</span></span><br><span class="line"><span class="comment">***/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">PrintAreas</span><span class="params">(<span class="type">double</span> circle, <span class="type">double</span> rect)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 格式化输出两个面积值，圆面积保留10位小数，矩形面积保留2位小数</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Circle Area: %.10f, Rectangle Area: %.2f\n&quot;</span>, circle, rect);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="程序的实际运行输出"><a href="#程序的实际运行输出" class="headerlink" title="程序的实际运行输出"></a>程序的实际运行输出</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251104$ gcc 1.c -lm</span><br><span class="line">1.c:4:19: warning: initializer element is not a constant expression</span><br><span class="line"> const double pi = acos(-1);</span><br><span class="line">                   ^</span><br><span class="line">s13665@ubuntu:~/codes/20251104$ ./a.out</span><br><span class="line">Circle Area: 78.5398163397, Rectangle Area: 12.00</span><br></pre></td></tr></table></figure>

<h3 id="程序流程图"><a href="#程序流程图" class="headerlink" title="程序流程图"></a>程序流程图</h3><p><img data-src="/./../images/image-20251104204632468.png" alt="image-20251104204632468"></p>
<h2 id="参数传递与变量作用域"><a href="#参数传递与变量作用域" class="headerlink" title="参数传递与变量作用域"></a>参数传递与变量作用域</h2><h3 id="程序的完整源代码-1"><a href="#程序的完整源代码-1" class="headerlink" title="程序的完整源代码"></a>程序的完整源代码</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数声明</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">ProcessData</span><span class="params">(<span class="type">int</span>)</span>;       <span class="comment">// 声明值传递函数（处理数据并返回结果）</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UpdateValues</span><span class="params">(<span class="type">int</span> *, <span class="type">int</span> *)</span>;  <span class="comment">// 声明地址传递函数（通过指针修改外部变量）</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UpdateValuesFail</span><span class="params">(<span class="type">int</span>, <span class="type">int</span>)</span>;  <span class="comment">// 声明值传递函数（尝试修改但无法影响外部变量）</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">10</span>, b = <span class="number">20</span>;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    result = ProcessData(a);  <span class="comment">// 将a的值（10）传入，接收返回值（15）</span></span><br><span class="line">    ProcessData(b);           <span class="comment">// 将b的值（20）传入，返回值（25）未使用</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;First: a=%d, b=%d, result=%d\n&quot;</span>, a, b, result);  <span class="comment">// a和b仍为初始值</span></span><br><span class="line"></span><br><span class="line">    UpdateValues(&amp;a, &amp;b<span class="comment">/* 传入a和b的地址，允许函数修改原变量 */</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Second: a=%d, b=%d\n&quot;</span>, a, b);  <span class="comment">// a和b已被修改</span></span><br><span class="line"></span><br><span class="line">    UpdateValuesFail(a, b<span class="comment">/* 传入当前a和b的值，函数内修改不影响外部 */</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Third: a=%d, b=%d\n&quot;</span>, a, b);  <span class="comment">// a和b保持修改后的值（未受影响）</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">ProcessData</span><span class="params">(<span class="type">int</span> num)</span>  <span class="comment">// num是传入参数的副本（如a的副本为10）</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> result;</span><br><span class="line">    result = num + <span class="number">5</span>;     <span class="comment">// 仅修改函数内，不影响原变量（如a仍为10）</span></span><br><span class="line">    <span class="keyword">return</span> result;        <span class="comment">// 返回处理后的结果</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">UpdateValues</span><span class="params">(<span class="type">int</span> *t1, <span class="type">int</span> *t2)</span>  <span class="comment">// t1指向a的地址，t2指向b的地址</span></span><br><span class="line">&#123;</span><br><span class="line">    *t1 += <span class="number">5</span>;  <span class="comment">// 通过指针解引用（*t1）直接修改a的实际值（a = a + 5）</span></span><br><span class="line">    *t2 += <span class="number">10</span>; <span class="comment">// 通过指针解引用（*t2）直接修改b的实际值（b = b + 10）</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">UpdateValuesFail</span><span class="params">(<span class="type">int</span> t1, <span class="type">int</span> t2)</span>  <span class="comment">// t1是a的副本，t2是b的副本</span></span><br><span class="line">&#123;</span><br><span class="line">    t1 += <span class="number">5</span>;   <span class="comment">// 仅修改函数内t1，原变量a不受影响</span></span><br><span class="line">    t2 += <span class="number">10</span>;  <span class="comment">// 仅修改函数内t2，原变量b不受影响</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>值传递与地址传递的区别</li>
</ol>
<ul>
<li>值传递（如函数&#x3D;&#x3D;ProcessData&#x3D;&#x3D;和&#x3D;&#x3D;UpdateValuesFail&#x3D;&#x3D;）：<ul>
<li>函数接收的是实参的副本（即复制一份变量的值传入函数）。</li>
<li>函数内部对参数的修改仅作用于函数内的副本，不会影响外部原变量的值。</li>
</ul>
</li>
<li>地址传递（如&#x3D;&#x3D;UpdateValues&#x3D;&#x3D;）：<ul>
<li>函数接收的是实参的内存地址（通过指针传递）。</li>
<li>函数内部通过指针解引用可以直接访问并修改原变量的内存空间，因此会影响外部原变量。</li>
</ul>
</li>
</ul>
<ol start="2">
<li>指针操作的实际效果<br> 指针变量存储的是内存地址。<br> 通过&amp;变量名可以获取变量的地址（如&amp;a表示变量 a 的内存地址）。<br> 通过*指针名（解引用操作）可以访问指针指向的内存空间：<br> 在UpdateValues中，*t1 +&#x3D; 5产生了如下效果：找到 t1 所指向的内存（即 a 的地址），将该地址中的值加 5，最终直接修改了原变量 a。<br> 指针的核心作用是间接访问内存，实现函数对外部变量的修改，突破值传递 “仅操作副本” 的限制。</li>
</ol>
<h3 id="程序的实际运行输出-1"><a href="#程序的实际运行输出-1" class="headerlink" title="程序的实际运行输出"></a>程序的实际运行输出</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251104$ ./a.out</span><br><span class="line">First: a=10, b=20, result=15</span><br><span class="line">Second: a=15, b=30</span><br><span class="line">Third: a=15, b=30</span><br></pre></td></tr></table></figure>

<h3 id="用Debug工具调试和分析代码的过程"><a href="#用Debug工具调试和分析代码的过程" class="headerlink" title="用Debug工具调试和分析代码的过程"></a>用Debug工具调试和分析代码的过程</h3><h4 id="设置断点"><a href="#设置断点" class="headerlink" title="设置断点"></a>设置断点</h4><p>与上方所示代码相对应</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251104$ gdb a.out</span><br><span class="line">GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1</span><br><span class="line">Copyright (C) 2016 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.  Type <span class="string">&quot;show copying&quot;</span></span><br><span class="line">and <span class="string">&quot;show warranty&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line">This GDB was configured as <span class="string">&quot;x86_64-linux-gnu&quot;</span>.</span><br><span class="line">Type <span class="string">&quot;show configuration&quot;</span> <span class="keyword">for</span> configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line">For <span class="built_in">help</span>, <span class="built_in">type</span> <span class="string">&quot;help&quot;</span>.</span><br><span class="line">Type <span class="string">&quot;apropos word&quot;</span> to search <span class="keyword">for</span> commands related to <span class="string">&quot;word&quot;</span>...</span><br><span class="line">Reading symbols from a.out...done.</span><br><span class="line">(gdb) list</span><br><span class="line">1       <span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line">2</span><br><span class="line">3       // 函数声明</span><br><span class="line">4       int ProcessData(int);       // 声明值传递函数（处理数据并返回结果）</span><br><span class="line">5       void UpdateValues(int *, int *);  // 声明地址传递函数（通过指针修改外部变量）</span><br><span class="line">6       void UpdateValuesFail(int, int);  // 声明值传递函数（尝试修改但无法影响外部变量）</span><br><span class="line">7</span><br><span class="line">8       int <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">9           int a = 10, b = 20;</span><br><span class="line">10          int result = 0;</span><br><span class="line">(gdb)</span><br><span class="line">11</span><br><span class="line">12          result = ProcessData(a);  // 将a的值（10）传入，接收返回值（15）</span><br><span class="line">13          ProcessData(b);           // 将b的值（20）传入，返回值（25）未使用</span><br><span class="line">14          <span class="built_in">printf</span>(<span class="string">&quot;First: a=%d, b=%d, result=%d\n&quot;</span>, a, b, result);  // a和b仍为初始值</span><br><span class="line">15</span><br><span class="line">16          UpdateValues(&amp;a, &amp;b/* 传入a和b的地址，允许函数修改原变量 */);</span><br><span class="line">17          <span class="built_in">printf</span>(<span class="string">&quot;Second: a=%d, b=%d\n&quot;</span>, a, b);  // a和b已被修改</span><br><span class="line">18</span><br><span class="line">19          UpdateValuesFail(a, b/* 传入当前a和b的值，函数内修改不影响外部 */);</span><br><span class="line">20          <span class="built_in">printf</span>(<span class="string">&quot;Third: a=%d, b=%d\n&quot;</span>, a, b);  // a和b保持修改后的值（未受影响）</span><br><span class="line">(gdb) <span class="built_in">break</span> 12</span><br><span class="line">Breakpoint 1 at 0x4005c2: file 2_comment.c, line 12.</span><br><span class="line">(gdb) <span class="built_in">break</span> 13</span><br><span class="line">Breakpoint 2 at 0x4005cf: file 2_comment.c, line 13.</span><br><span class="line">(gdb) <span class="built_in">break</span> 16</span><br><span class="line">Breakpoint 3 at 0x4005f3: file 2_comment.c, line 16.</span><br><span class="line">(gdb) <span class="built_in">break</span> 19</span><br><span class="line">Breakpoint 4 at 0x40061d: file 2_comment.c, line 19.</span><br><span class="line">(gdb) <span class="built_in">break</span> ProcessData</span><br><span class="line">Breakpoint 5 at 0x400665: file 2_comment.c, line 28.</span><br><span class="line">(gdb) <span class="built_in">break</span> UpdateValues</span><br><span class="line">Breakpoint 6 at 0x40067f: file 2_comment.c, line 34.</span><br><span class="line">(gdb) <span class="built_in">break</span> UpdateValuesFail</span><br><span class="line">Breakpoint 7 at 0x4006aa: file 2_comment.c, line 40.</span><br></pre></td></tr></table></figure>

<h4 id="开始调试"><a href="#开始调试" class="headerlink" title="开始调试"></a>开始调试</h4><p>执行<code>run</code>开始调试</p>
<p>打印a与a的地址</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) run</span><br><span class="line">Starting program: /home/s13665/codes/20251104/a.out</span><br><span class="line"></span><br><span class="line">Breakpoint 1, main () at 2_comment.c:12</span><br><span class="line">12          result = ProcessData(a);  // 将a的值（10）传入，接收返回值（15）</span><br><span class="line">(gdb) <span class="built_in">print</span> a</span><br><span class="line"><span class="variable">$1</span> = 10</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;a</span><br><span class="line"><span class="variable">$2</span> = (int *) 0x7fffffffe4dc</span><br></pre></td></tr></table></figure>

<p>执行 <code>step</code> 进入 ProcessData 函数，打印形参及形参的地址</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) step</span><br><span class="line"></span><br><span class="line">Breakpoint 5, ProcessData (num=10) at 2_comment.c:28</span><br><span class="line">28          result = num + 5;     // 仅修改函数内，不影响原变量（如a仍为10）</span><br><span class="line">(gdb) <span class="built_in">print</span> num</span><br><span class="line"><span class="variable">$3</span> = 10</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;num</span><br><span class="line"><span class="variable">$4</span> = (int *) 0x7fffffffe4ac</span><br></pre></td></tr></table></figure>

<p>继续执行 <code>continue</code>，打印b与b的地址</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) <span class="built_in">continue</span></span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">Breakpoint 2, main () at 2_comment.c:13</span><br><span class="line">13          ProcessData(b);           // 将b的值（20）传入，返回值（25）未使用</span><br><span class="line">(gdb) <span class="built_in">print</span> b</span><br><span class="line"><span class="variable">$5</span> = 20</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;b</span><br><span class="line"><span class="variable">$6</span> = (int *) 0x7fffffffe4e0</span><br></pre></td></tr></table></figure>

<p>执行 <code>step</code> 进入 ProcessData 函数，打印形参及形参的地址</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) step</span><br><span class="line"></span><br><span class="line">Breakpoint 5, ProcessData (num=20) at 2_comment.c:28</span><br><span class="line">28          result = num + 5;     // 仅修改函数内，不影响原变量（如a仍为10）</span><br><span class="line">(gdb) <span class="built_in">print</span> num</span><br><span class="line"><span class="variable">$7</span> = 20</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;num</span><br><span class="line"><span class="variable">$8</span> = (int *) 0x7fffffffe4ac</span><br></pre></td></tr></table></figure>

<p>继续执行 <code>continue</code>，打印实参 a与a的地址 b与b的地址</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) <span class="built_in">continue</span></span><br><span class="line">Continuing.</span><br><span class="line">First: a=10, b=20, result=15</span><br><span class="line"></span><br><span class="line">Breakpoint 3, main () at 2_comment.c:16</span><br><span class="line">16          UpdateValues(&amp;a, &amp;b/* 传入a和b的地址，允许函数修改原变量 */);</span><br><span class="line">(gdb) <span class="built_in">print</span> a</span><br><span class="line"><span class="variable">$9</span> = 10</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;a</span><br><span class="line"><span class="variable">$10</span> = (int *) 0x7fffffffe4dc</span><br><span class="line">(gdb) <span class="built_in">print</span> b</span><br><span class="line"><span class="variable">$11</span> = 20</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;b</span><br><span class="line"><span class="variable">$12</span> = (int *) 0x7fffffffe4e0</span><br></pre></td></tr></table></figure>

<p>执行 <code>step</code> 进入 UpdateValues 函数，打印形参及形参的地址</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) step</span><br><span class="line"></span><br><span class="line">Breakpoint 6, UpdateValues (t1=0x7fffffffe4dc, t2=0x7fffffffe4e0) at 2_comment.c:34</span><br><span class="line">34          *t1 += 5;  // 通过指针解引用（*t1）直接修改a的实际值（a = a + 5）</span><br><span class="line">(gdb) <span class="built_in">print</span> t1</span><br><span class="line"><span class="variable">$13</span> = (int *) 0x7fffffffe4dc</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;t1</span><br><span class="line"><span class="variable">$14</span> = (int **) 0x7fffffffe4b8</span><br><span class="line">(gdb) <span class="built_in">print</span> t2</span><br><span class="line"><span class="variable">$15</span> = (int *) 0x7fffffffe4e0</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;t2</span><br><span class="line"><span class="variable">$16</span> = (int **) 0x7fffffffe4b0</span><br></pre></td></tr></table></figure>

<p>继续执行 <code>continue</code>，打印实参 a与a的地址 b与b的地址</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) <span class="built_in">continue</span></span><br><span class="line">Continuing.</span><br><span class="line">Second: a=15, b=30</span><br><span class="line"></span><br><span class="line">Breakpoint 4, main () at 2_comment.c:19</span><br><span class="line">19          UpdateValuesFail(a, b/* 传入当前a和b的值，函数内修改不影响外部 */);</span><br><span class="line">(gdb) <span class="built_in">print</span> a</span><br><span class="line"><span class="variable">$17</span> = 15</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;a</span><br><span class="line"><span class="variable">$18</span> = (int *) 0x7fffffffe4dc</span><br><span class="line">(gdb) <span class="built_in">print</span> b</span><br><span class="line"><span class="variable">$19</span> = 30</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;b</span><br><span class="line"><span class="variable">$20</span> = (int *) 0x7fffffffe4e0</span><br></pre></td></tr></table></figure>

<p>执行 <code>step</code> 进入 UpdateValuesFail 函数，打印形参及形参的地址</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) step</span><br><span class="line"></span><br><span class="line">Breakpoint 7, UpdateValuesFail (t1=15, t2=30) at 2_comment.c:40</span><br><span class="line">40          t1 += 5;   // 仅修改函数内t1，原变量a不受影响</span><br><span class="line">(gdb) <span class="built_in">print</span> t1</span><br><span class="line"><span class="variable">$21</span> = 15</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;t1</span><br><span class="line"><span class="variable">$22</span> = (int *) 0x7fffffffe4bc</span><br><span class="line">(gdb) <span class="built_in">print</span> t2</span><br><span class="line"><span class="variable">$23</span> = 30</span><br><span class="line">(gdb) <span class="built_in">print</span> &amp;t2</span><br><span class="line"><span class="variable">$24</span> = (int *) 0x7fffffffe4b8</span><br></pre></td></tr></table></figure>

<h4 id="为什么要打印这些值或地址？"><a href="#为什么要打印这些值或地址？" class="headerlink" title="为什么要打印这些值或地址？"></a>为什么要打印这些值或地址？</h4><ol>
<li><p><strong>验证值传递的特性</strong>：</p>
<ul>
<li>对于 <code>ProcessData</code> 和 <code>UpdateValuesFail</code>，形参（<code>num</code>、<code>t1</code>、<code>t2</code>）是实参的<strong>副本</strong>，打印形参和实参的<strong>地址</strong>可证明两者存储在不同内存位置（地址不同），以此来证明函数内修改形参并不会影响实参。</li>
<li>打印<strong>值</strong>可验证形参初始值与实参一致（副本正确），但修改后形参与实参值不同，以此来说明“变量作用域”。</li>
</ul>
</li>
<li><p><strong>验证地址传递的特性</strong>：</p>
<ul>
<li>在函数 <code>UpdateValues</code> 中，实参是 <code>&amp;a</code> 和 <code>&amp;b</code>（地址），形参 <code>t1</code> 和 <code>t2</code> 是指针，打印形参 <code>t1</code>、<code>t2</code> 的<strong>值</strong>可证明它们确实指向实参 <code>a</code> 和 <code>b</code>（<code>t1 == &amp;a</code>，<code>t2 == &amp;b</code>）。</li>
<li>结合后续对 <code>*t1</code>、<code>*t2</code> 指针指向的内存的修改，可验证通过指针解引用能直接操作实参内存，以此来解释为何实参值会被函数修改。</li>
</ul>
</li>
<li><p><strong>理解函数调用时的参数传递机制</strong>：</p>
<ul>
<li>值传递：实参值的副本给形参</li>
<li>地址传递：实参地址的副本给形参指针</li>
</ul>
</li>
</ol>
<h4 id="程序的部分内存图及其解释"><a href="#程序的部分内存图及其解释" class="headerlink" title="程序的部分内存图及其解释"></a>程序的部分内存图及其解释</h4><p><img data-src="/./../images/image-20251104204642247.png" alt="image-20251104204642247"></p>
<p>UpdateValues函数中t1、t2均为指针变量，存储实参a、b的地址。</p>
<p>UpdateValuesFail函数中t1、t2均为整型变量，先存储实参a、b原来的值，而后分别+5与+10，所得结果仍存储在形参t1、t2，并没有对实参a、b进行改变。</p>
<h2 id="多函数协作与模块化设计"><a href="#多函数协作与模块化设计" class="headerlink" title="多函数协作与模块化设计"></a>多函数协作与模块化设计</h2><h3 id="程序的完整源代码-2"><a href="#程序的完整源代码-2" class="headerlink" title="程序的完整源代码"></a>程序的完整源代码</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="type">double</span> <span class="title function_">CalculateAverage</span><span class="params">(<span class="type">double</span> s1, <span class="type">double</span> s2, <span class="type">double</span> s3)</span>;</span><br><span class="line"><span class="type">char</span> <span class="title function_">GetGrade</span><span class="params">(<span class="type">double</span> avg)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">PrintReport</span><span class="params">(<span class="type">int</span> id, <span class="type">double</span> avg, <span class="type">char</span> grade)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> id = <span class="number">1001</span>;</span><br><span class="line">    <span class="type">double</span> score1 = <span class="number">85.5</span>, score2 = <span class="number">92.0</span>, score3 = <span class="number">78.5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算平均分</span></span><br><span class="line">    <span class="type">double</span> avg = CalculateAverage(score1, score2, score3);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取等级</span></span><br><span class="line">    <span class="type">char</span> grade = GetGrade(avg);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出成绩报告</span></span><br><span class="line">    PrintReport(id, avg, grade);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算三门课平均分</span></span><br><span class="line"><span class="type">double</span> <span class="title function_">CalculateAverage</span><span class="params">(<span class="type">double</span> s1, <span class="type">double</span> s2, <span class="type">double</span> s3)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (s1 + s2 + s3) / <span class="number">3.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据平均分返回等级，使用?: 运算符</span></span><br><span class="line"><span class="type">char</span> <span class="title function_">GetGrade</span><span class="params">(<span class="type">double</span> avg)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (avg &gt;= <span class="number">90.0</span>) ? <span class="string">&#x27;A&#x27;</span> :</span><br><span class="line">           (avg &gt;= <span class="number">80.0</span>) ? <span class="string">&#x27;B&#x27;</span> :</span><br><span class="line">           (avg &gt;= <span class="number">70.0</span>) ? <span class="string">&#x27;C&#x27;</span> : <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出成绩报告</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">PrintReport</span><span class="params">(<span class="type">int</span> id, <span class="type">double</span> avg, <span class="type">char</span> grade)</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ID:%d, Average:%.2f, Grade:%c\n&quot;</span>, id, avg, grade);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="程序的实际运行输出-2"><a href="#程序的实际运行输出-2" class="headerlink" title="程序的实际运行输出"></a>程序的实际运行输出</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s13665@ubuntu:~/codes/20251104$ ./a.out</span><br><span class="line">ID:1001, Average:85.33, Grade:B</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>2025.12.09 C语言程序设计上机实习六</title>
    <url>/2025/12/09/2025.12.09%20C%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8A%E6%9C%BA%E5%AE%9E%E4%B9%A0%E5%85%AD/</url>
    <content><![CDATA[<h1 id="2025-11-11-C语言程序设计上机实习六"><a href="#2025-11-11-C语言程序设计上机实习六" class="headerlink" title="2025.11.11 C语言程序设计上机实习六"></a>2025.11.11 C语言程序设计上机实习六</h1><h2 id="必做题"><a href="#必做题" class="headerlink" title="必做题"></a>必做题</h2><p><img data-src="/./../images/image-20251209190035516.png" alt="image-20251209190035516"></p>
<h2 id="选做题"><a href="#选做题" class="headerlink" title="选做题"></a>选做题</h2><p>题目源文件<a href="https://mjy.js.org/attach/%E5%AE%9E%E9%AA%8C%E5%85%AD.pdf">实验六.pdf</a></p>
<h3 id="题目1：动态字符串数组的双重排序"><a href="#题目1：动态字符串数组的双重排序" class="headerlink" title="题目1：动态字符串数组的双重排序"></a>题目1：动态字符串数组的双重排序</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">SortStrings</span><span class="params">(<span class="type">char</span> **strs, <span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (strs == <span class="literal">NULL</span> || n &lt;= <span class="number">0</span>) <span class="comment">// 传入失败或字符串小于等于0则退出函数</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="comment">// 对第i个字符串进行操作</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> len = <span class="built_in">strlen</span>(strs[i]);</span><br><span class="line">        <span class="comment">// 冒泡排序</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len - <span class="number">1</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j + <span class="number">1</span>; k &lt; len; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (strs[i][j] &gt; strs[i][k])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="type">char</span> temp = strs[i][j];</span><br><span class="line">                    strs[i][j] = strs[i][k];</span><br><span class="line">                    strs[i][k] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 冒泡排序</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strcmp</span>(strs[i], strs[j]) &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">char</span> *temp = strs[i];</span><br><span class="line">                strs[i] = strs[j];</span><br><span class="line">                strs[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/./../images/image-20251209204604146.png" alt="image-20251209204604146"></p>
<h3 id="题目2：模拟解析CSV文件"><a href="#题目2：模拟解析CSV文件" class="headerlink" title="题目2：模拟解析CSV文件"></a>题目2：模拟解析CSV文件</h3><p>结构体定义</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> name[<span class="number">20</span>];</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">char</span> city[<span class="number">20</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ParseCSV函数</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">ParseCSV</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *csvData, <span class="keyword">struct</span> Person **persons, <span class="type">int</span> *count)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (persons == <span class="literal">NULL</span> || count == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    *persons = <span class="literal">NULL</span>;</span><br><span class="line">    *count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若 csvData 为空或 NULL，则 return</span></span><br><span class="line">    <span class="keyword">if</span> (csvData == <span class="literal">NULL</span> || csvData[<span class="number">0</span>] == <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(csvData);</span><br><span class="line">    <span class="type">int</span> lines = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> *temp = <span class="literal">NULL</span>;</span><br><span class="line">    temp = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>) * (len + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span> (!temp) <span class="built_in">free</span>(temp);</span><br><span class="line">    <span class="keyword">if</span> (temp == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">memcpy</span>(temp, csvData, len + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (temp[i] == <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            lines++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (len &gt; <span class="number">0</span> &amp;&amp; temp[len - <span class="number">1</span>] != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        lines++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (lines == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    *persons = (<span class="keyword">struct</span> Person *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Person) * lines);</span><br><span class="line">    <span class="keyword">if</span> (*persons == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> status = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> *line;</span><br><span class="line">    <span class="type">char</span> *saveptr = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    line = strtok_r(temp, <span class="string">&quot;\n&quot;</span>, &amp;saveptr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(line &amp;&amp; status)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> *saveptr2 = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="type">char</span> *name = strtok_r(line, <span class="string">&quot;,&quot;</span>, &amp;saveptr2);</span><br><span class="line">        <span class="type">char</span> *ageStr = strtok_r(<span class="literal">NULL</span>, <span class="string">&quot;,&quot;</span>, &amp;saveptr2);</span><br><span class="line">        <span class="type">char</span> *city = strtok_r(<span class="literal">NULL</span>, <span class="string">&quot;,&quot;</span>, &amp;saveptr2);</span><br><span class="line">        <span class="type">char</span> *extra = strtok_r(<span class="literal">NULL</span>, <span class="string">&quot;,&quot;</span>, &amp;saveptr2);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!name || !ageStr || !city || extra != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            status = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strlen</span>(name) == <span class="number">0</span> || <span class="built_in">strlen</span>(name) &gt;= <span class="number">20</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            status = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">strcpy</span>((*persons)[index].name, name);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; ageStr[i]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (ageStr[i] &lt; <span class="string">&#x27;0&#x27;</span> || ageStr[i] &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                status = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (status == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        (*persons)[index].age = atoi(ageStr);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strlen</span>(city) == <span class="number">0</span> || <span class="built_in">strlen</span>(city) &gt;= <span class="number">20</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            status = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">strcpy</span>((*persons)[index].city, city);</span><br><span class="line"></span><br><span class="line">        index++;</span><br><span class="line">        line = strtok_r(<span class="literal">NULL</span>, <span class="string">&quot;\n&quot;</span>, &amp;saveptr);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(temp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(status == <span class="number">0</span> || index == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">free</span>(*persons);</span><br><span class="line">        *persons = <span class="literal">NULL</span>;</span><br><span class="line">        *count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    *count = index;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AI使用声明：</p>
<p>对于库函数strtok，在本程序中会发生共用缓冲区问题，导致测试例1无法通过。</p>
<p>在《C语言程序设计》附录部分仅介绍了strtok。在AI的帮助下了解到更安全的库函数strtok_r，故更换使用后正常。</p>
<p>若不使用strtok与strtor_r，其他的方法其实还有（包括但不限于）</p>
<ul>
<li>逐位读取读到“,”再处理</li>
<li>统计“,”在每一行中出现的个数判断格式是否正常</li>
</ul>
<p><img data-src="/./../images/image-20251209204910409.png" alt="image-20251209204910409"></p>
<h3 id="题目3：排序后存储为CSV风格的字符串"><a href="#题目3：排序后存储为CSV风格的字符串" class="headerlink" title="题目3：排序后存储为CSV风格的字符串"></a>题目3：排序后存储为CSV风格的字符串</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//未写待补</span></span><br></pre></td></tr></table></figure>

<h3 id="附：完整代码"><a href="#附：完整代码" class="headerlink" title="附：完整代码"></a>附：完整代码</h3><h4 id="TestSortStrings-c"><a href="#TestSortStrings-c" class="headerlink" title="TestSortStrings.c"></a>TestSortStrings.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SortStrings</span><span class="params">(<span class="type">char</span> **strs, <span class="type">int</span> n)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 测试框架 ==========</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_tests</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 主函数 ==========</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    run_tests();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_tests</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 字符串数组双重排序测试 ===\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> pass_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> total_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例1：正常情况</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例1：正常情况\n&quot;</span>);</span><br><span class="line">    <span class="type">char</span> *strs1[] = &#123;<span class="built_in">malloc</span>(<span class="number">4</span>), <span class="built_in">malloc</span>(<span class="number">4</span>), <span class="built_in">malloc</span>(<span class="number">4</span>)&#125;;</span><br><span class="line">    <span class="built_in">strcpy</span>(strs1[<span class="number">0</span>], <span class="string">&quot;cba&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(strs1[<span class="number">1</span>], <span class="string">&quot;fed&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(strs1[<span class="number">2</span>], <span class="string">&quot;abc&quot;</span>);</span><br><span class="line">    SortStrings(strs1, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(strs1[<span class="number">0</span>], <span class="string">&quot;abc&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(strs1[<span class="number">1</span>], <span class="string">&quot;abc&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(strs1[<span class="number">2</span>], <span class="string">&quot;def&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败: 实际 [%s, %s, %s]\n&quot;</span>, strs1[<span class="number">0</span>], strs1[<span class="number">1</span>], strs1[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(strs1[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">free</span>(strs1[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">free</span>(strs1[<span class="number">2</span>]);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例2：包含空字符串</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例2：包含空字符串\n&quot;</span>);</span><br><span class="line">    <span class="type">char</span> *strs2[] = &#123;<span class="built_in">malloc</span>(<span class="number">1</span>), <span class="built_in">malloc</span>(<span class="number">5</span>), <span class="built_in">malloc</span>(<span class="number">6</span>)&#125;;</span><br><span class="line">    <span class="built_in">strcpy</span>(strs2[<span class="number">0</span>], <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(strs2[<span class="number">1</span>], <span class="string">&quot;dcba&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(strs2[<span class="number">2</span>], <span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    SortStrings(strs2, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(strs2[<span class="number">0</span>], <span class="string">&quot;&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(strs2[<span class="number">1</span>], <span class="string">&quot;abcd&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(strs2[<span class="number">2</span>], <span class="string">&quot;ehllo&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(strs2[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">free</span>(strs2[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">free</span>(strs2[<span class="number">2</span>]);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例3：单字符字符串</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例3：单字符字符串\n&quot;</span>);</span><br><span class="line">    <span class="type">char</span> *strs3[] = &#123;<span class="built_in">malloc</span>(<span class="number">2</span>), <span class="built_in">malloc</span>(<span class="number">2</span>), <span class="built_in">malloc</span>(<span class="number">2</span>)&#125;;</span><br><span class="line">    <span class="built_in">strcpy</span>(strs3[<span class="number">0</span>], <span class="string">&quot;b&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(strs3[<span class="number">1</span>], <span class="string">&quot;a&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(strs3[<span class="number">2</span>], <span class="string">&quot;c&quot;</span>);</span><br><span class="line">    SortStrings(strs3, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(strs3[<span class="number">0</span>], <span class="string">&quot;a&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(strs3[<span class="number">1</span>], <span class="string">&quot;b&quot;</span>) == <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(strs3[<span class="number">2</span>], <span class="string">&quot;c&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(strs3[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">free</span>(strs3[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">free</span>(strs3[<span class="number">2</span>]);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例4：大规模动态示例（课堂原题）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例4：大规模动态示例（课堂原题）\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> m = <span class="number">26</span>;</span><br><span class="line">    <span class="type">char</span> **strs4 = (<span class="type">char</span>**)<span class="built_in">malloc</span>(m * <span class="keyword">sizeof</span>(<span class="type">char</span>*));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        strs4[i] = (<span class="type">char</span>*)<span class="built_in">malloc</span>((i + <span class="number">2</span>) * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= i; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            strs4[i][j] = <span class="string">&#x27;z&#x27;</span> - j;</span><br><span class="line">        &#125;</span><br><span class="line">        strs4[i][i + <span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    SortStrings(strs4, m);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> valid = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">size_t</span> len = <span class="built_in">strlen</span>(strs4[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j + <span class="number">1</span> &lt; len; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (strs4[i][j] &gt; strs4[i][j + <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                valid = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!valid)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (valid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m - <span class="number">1</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strcmp</span>(strs4[i], strs4[i + <span class="number">1</span>]) &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                valid = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (valid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">free</span>(strs4[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(strs4);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例5：n为0且strs为NULL</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例5：n为0且strs为NULL\n&quot;</span>);</span><br><span class="line">    SortStrings(<span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 无异常，通过\n&quot;</span>);</span><br><span class="line">    pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== 测试结果 ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;通过: %d/%d (%.1f%%)\n&quot;</span>, pass_count, total_count, (<span class="type">float</span>)pass_count / total_count * <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SortStrings</span><span class="params">(<span class="type">char</span> **strs, <span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (strs == <span class="literal">NULL</span> || n &lt;= <span class="number">0</span>) <span class="comment">// 传入失败或字符串小于等于0则退出函数</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="comment">// 对第i个字符串进行操作</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> len = <span class="built_in">strlen</span>(strs[i]);</span><br><span class="line">        <span class="comment">// 冒泡排序</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len - <span class="number">1</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j + <span class="number">1</span>; k &lt; len; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (strs[i][j] &gt; strs[i][k])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="type">char</span> temp = strs[i][j];</span><br><span class="line">                    strs[i][j] = strs[i][k];</span><br><span class="line">                    strs[i][k] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 冒泡排序</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strcmp</span>(strs[i], strs[j]) &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">char</span> *temp = strs[i];</span><br><span class="line">                strs[i] = strs[j];</span><br><span class="line">                strs[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TestParseCSV-c"><a href="#TestParseCSV-c" class="headerlink" title="TestParseCSV.c"></a>TestParseCSV.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> name[<span class="number">20</span>];</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">char</span> city[<span class="number">20</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">ParseCSV</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *csvData, <span class="keyword">struct</span> Person **persons, <span class="type">int</span> *count)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 测试框架 ==========</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_tests</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========== 主函数 ==========</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    run_tests();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_tests</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== CSV 文件解析为结构体测试 ===\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> pass_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> total_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例1：正常情况</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例1：正常情况\n&quot;</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *csv1 = <span class="string">&quot;Zoe,29,Hangzhou\nAlice,25,Beijing\nBob,30,Shanghai\nCharlie,22,Guangzhou\nDiana,28,Shenzhen&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> *<span class="title">persons1</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">int</span> count1 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    ParseCSV(csv1, &amp;persons1, &amp;count1);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (count1 == <span class="number">5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strcmp</span>(persons1[<span class="number">0</span>].name, <span class="string">&quot;Zoe&quot;</span>) == <span class="number">0</span> &amp;&amp; persons1[<span class="number">0</span>].age == <span class="number">29</span> &amp;&amp; <span class="built_in">strcmp</span>(persons1[<span class="number">0</span>].city, <span class="string">&quot;Hangzhou&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strcmp</span>(persons1[<span class="number">1</span>].name, <span class="string">&quot;Alice&quot;</span>) == <span class="number">0</span> &amp;&amp; persons1[<span class="number">1</span>].age == <span class="number">25</span> &amp;&amp; <span class="built_in">strcmp</span>(persons1[<span class="number">1</span>].city, <span class="string">&quot;Beijing&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">strcmp</span>(persons1[<span class="number">2</span>].name, <span class="string">&quot;Bob&quot;</span>) == <span class="number">0</span> &amp;&amp; persons1[<span class="number">2</span>].age == <span class="number">30</span> &amp;&amp; <span class="built_in">strcmp</span>(persons1[<span class="number">2</span>].city, <span class="string">&quot;Shanghai&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(persons1[<span class="number">3</span>].name, <span class="string">&quot;Charlie&quot;</span>) == <span class="number">0</span> &amp;&amp; persons1[<span class="number">3</span>].age == <span class="number">22</span> &amp;&amp; <span class="built_in">strcmp</span>(persons1[<span class="number">3</span>].city, <span class="string">&quot;Guangzhou&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">strcmp</span>(persons1[<span class="number">4</span>].name, <span class="string">&quot;Diana&quot;</span>) == <span class="number">0</span> &amp;&amp; persons1[<span class="number">4</span>].age == <span class="number">28</span> &amp;&amp; <span class="built_in">strcmp</span>(persons1[<span class="number">4</span>].city, <span class="string">&quot;Shenzhen&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">                            pass_count++;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败: Diana 行错误\n&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败: Charlie 行错误\n&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败: Bob 行错误\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败: Alice 行错误\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败: Zoe 行错误\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败: 记录数不正确，期望 5，实际 %d\n&quot;</span>, count1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(persons1);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例2：空数据</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例2：空数据\n&quot;</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *empty = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> *<span class="title">persons2</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">int</span> count2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    ParseCSV(empty, &amp;persons2, &amp;count2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (count2 == <span class="number">0</span> &amp;&amp; persons2 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例3：单行</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例3：单行数据\n&quot;</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *single = <span class="string">&quot;Tom,35,Chengdu&quot;</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> *<span class="title">persons3</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">int</span> count3 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    ParseCSV(single, &amp;persons3, &amp;count3);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (count3 == <span class="number">1</span> &amp;&amp; <span class="built_in">strcmp</span>(persons3[<span class="number">0</span>].name, <span class="string">&quot;Tom&quot;</span>) == <span class="number">0</span> &amp;&amp; persons3[<span class="number">0</span>].age == <span class="number">35</span> &amp;&amp; <span class="built_in">strcmp</span>(persons3[<span class="number">0</span>].city, <span class="string">&quot;Chengdu&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(persons3);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例4：无逗号</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例4：异常格式（无逗号）\n&quot;</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *invalid = <span class="string">&quot;John18NewYork\nMary22Paris&quot;</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> *<span class="title">persons4</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">int</span> count4 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    ParseCSV(invalid, &amp;persons4, &amp;count4);</span><br><span class="line">    <span class="keyword">if</span> (count4 == <span class="number">0</span> &amp;&amp; persons4 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过（格式错误，应返回空）\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：应拒绝解析\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例5：字段数量不一致（某行不是3列）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例5：字段数量不一致（第二行只有2列）\n&quot;</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *csv5 = <span class="string">&quot;Zoe,29,Hangzhou\nAlice,25\nBob,30,Shanghai&quot;</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> *<span class="title">persons5</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">int</span> count5 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    ParseCSV(csv5, &amp;persons5, &amp;count5);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (count5 == <span class="number">0</span> &amp;&amp; persons5 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过（格式错误，应返回空）\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：应拒绝解析\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 汇总结果</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== 测试结果 ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;通过: %d/%d (%.1f%%)\n&quot;</span>, pass_count, total_count, (<span class="type">float</span>)pass_count / total_count * <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">ParseCSV</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *csvData, <span class="keyword">struct</span> Person **persons, <span class="type">int</span> *count)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (persons == <span class="literal">NULL</span> || count == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    *persons = <span class="literal">NULL</span>;</span><br><span class="line">    *count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若 csvData 为空或 NULL，则 return</span></span><br><span class="line">    <span class="keyword">if</span> (csvData == <span class="literal">NULL</span> || csvData[<span class="number">0</span>] == <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(csvData);</span><br><span class="line">    <span class="type">int</span> lines = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> *temp = <span class="literal">NULL</span>;</span><br><span class="line">    temp = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>) * (len + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span> (!temp) <span class="built_in">free</span>(temp);</span><br><span class="line">    <span class="keyword">if</span> (temp == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">memcpy</span>(temp, csvData, len + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (temp[i] == <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            lines++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (len &gt; <span class="number">0</span> &amp;&amp; temp[len - <span class="number">1</span>] != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        lines++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (lines == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    *persons = (<span class="keyword">struct</span> Person *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Person) * lines);</span><br><span class="line">    <span class="keyword">if</span> (*persons == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> status = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> *line;</span><br><span class="line">    <span class="type">char</span> *saveptr = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    line = strtok_r(temp, <span class="string">&quot;\n&quot;</span>, &amp;saveptr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(line &amp;&amp; status)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> *saveptr2 = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="type">char</span> *name = strtok_r(line, <span class="string">&quot;,&quot;</span>, &amp;saveptr2);</span><br><span class="line">        <span class="type">char</span> *ageStr = strtok_r(<span class="literal">NULL</span>, <span class="string">&quot;,&quot;</span>, &amp;saveptr2);</span><br><span class="line">        <span class="type">char</span> *city = strtok_r(<span class="literal">NULL</span>, <span class="string">&quot;,&quot;</span>, &amp;saveptr2);</span><br><span class="line">        <span class="type">char</span> *extra = strtok_r(<span class="literal">NULL</span>, <span class="string">&quot;,&quot;</span>, &amp;saveptr2);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!name || !ageStr || !city || extra != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            status = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strlen</span>(name) == <span class="number">0</span> || <span class="built_in">strlen</span>(name) &gt;= <span class="number">20</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            status = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">strcpy</span>((*persons)[index].name, name);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; ageStr[i]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (ageStr[i] &lt; <span class="string">&#x27;0&#x27;</span> || ageStr[i] &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                status = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (status == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        (*persons)[index].age = atoi(ageStr);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strlen</span>(city) == <span class="number">0</span> || <span class="built_in">strlen</span>(city) &gt;= <span class="number">20</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            status = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">strcpy</span>((*persons)[index].city, city);</span><br><span class="line"></span><br><span class="line">        index++;</span><br><span class="line">        line = strtok_r(<span class="literal">NULL</span>, <span class="string">&quot;\n&quot;</span>, &amp;saveptr);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(temp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(status == <span class="number">0</span> || index == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">free</span>(*persons);</span><br><span class="line">        *persons = <span class="literal">NULL</span>;</span><br><span class="line">        *count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    *count = index;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TestSortSaveAsCSV-c"><a href="#TestSortSaveAsCSV-c" class="headerlink" title="TestSortSaveAsCSV.c"></a>TestSortSaveAsCSV.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_MALLOC 100</span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *<span class="title function_">SortSaveAsCSV</span><span class="params">(<span class="keyword">struct</span> Person *persons, <span class="type">int</span> count)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== 测试框架 ===================</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_tests</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    run_tests();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_tests</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 排序后存储为CSV风格字符串测试 ===\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> pass_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> total_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例1：正常情况（多个人，不同年龄）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例1：正常情况\n&quot;</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> <span class="title">people1</span>[] =</span> &#123;</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Zoe&quot;</span>, <span class="number">29</span>, <span class="string">&quot;Hangzhou&quot;</span>&#125;,</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Alice&quot;</span>, <span class="number">25</span>, <span class="string">&quot;Beijing&quot;</span>&#125;,</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Bob&quot;</span>, <span class="number">30</span>, <span class="string">&quot;Shanghai&quot;</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">char</span> *csv1 = SortSaveAsCSV(people1, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (csv1 != <span class="literal">NULL</span> &amp;&amp; <span class="built_in">strcmp</span>(csv1, <span class="string">&quot;Alice,25,Beijing\nZoe,29,Hangzhou\nBob,30,Shanghai\n&quot;</span>) == <span class="number">0</span> &amp;&amp; malloc_usable_size(csv1) &lt; MAX_MALLOC)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：输出不正确or内存开辟过大\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(csv1);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例2：空数组或NULL输入</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例2：空数组或NULL输入\n&quot;</span>);</span><br><span class="line">    <span class="type">char</span> *csv2 = SortSaveAsCSV(<span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strlen</span>(csv2) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：应返回空字符串\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例3：单个元素</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例3：单个元素\n&quot;</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> <span class="title">person3</span> =</span> (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Tom&quot;</span>, <span class="number">35</span>, <span class="string">&quot;Chengdu&quot;</span>&#125;;</span><br><span class="line">    <span class="type">char</span> *csv3 = SortSaveAsCSV(&amp;person3, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (csv3 != <span class="literal">NULL</span> &amp;&amp; <span class="built_in">strcmp</span>(csv3, <span class="string">&quot;Tom,35,Chengdu\n&quot;</span>) == <span class="number">0</span> &amp;&amp; malloc_usable_size(csv3) &lt; MAX_MALLOC)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：单行输出错误或开辟内存过大\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(csv3);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例4：相同年龄（稳定排序）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例4：相同年龄（稳定排序）\n&quot;</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> <span class="title">people4</span>[] =</span> &#123;</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Zoe&quot;</span>, <span class="number">25</span>, <span class="string">&quot;Hangzhou&quot;</span>&#125;,</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Alice&quot;</span>, <span class="number">25</span>, <span class="string">&quot;Beijing&quot;</span>&#125;,</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Bob&quot;</span>, <span class="number">26</span>, <span class="string">&quot;Shanghai&quot;</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">char</span> *csv4 = SortSaveAsCSV(people4, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (csv4 != <span class="literal">NULL</span> &amp;&amp; <span class="built_in">strcmp</span>(csv4, <span class="string">&quot;Zoe,25,Hangzhou\nAlice,25,Beijing\nBob,26,Shanghai\n&quot;</span>) == <span class="number">0</span> &amp;&amp; malloc_usable_size(csv4) &lt; MAX_MALLOC)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：排序不稳定或式格错误or开辟内存过大\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(csv4);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例5：城市为空字符串</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例5：城市为空字符串\n&quot;</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> <span class="title">people5</span>[] =</span> &#123;</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Zoe&quot;</span>, <span class="number">29</span>, <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Alice&quot;</span>, <span class="number">25</span>, <span class="string">&quot;Beijing&quot;</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">char</span> *csv5 = SortSaveAsCSV(people5, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (csv5 != <span class="literal">NULL</span> &amp;&amp; <span class="built_in">strcmp</span>(csv5, <span class="string">&quot;Alice,25,Beijing\nZoe,29,\n&quot;</span>) == <span class="number">0</span> &amp;&amp; malloc_usable_size(csv5) &lt; MAX_MALLOC)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：空城市未正确处理或内存开辟过大\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(csv5);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例6：姓名或城市含特殊字符</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例6：姓名/城市含特殊字符\n&quot;</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> <span class="title">people6</span>[] =</span> &#123;</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Li_42&quot;</span>, <span class="number">29</span>, <span class="string">&quot;New-York&quot;</span>&#125;,</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;OOP_Programmer&quot;</span>, <span class="number">25</span>, <span class="string">&quot;San-Francisco&quot;</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">char</span> *csv6 = SortSaveAsCSV(people6, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (csv6 != <span class="literal">NULL</span> &amp;&amp; <span class="built_in">strcmp</span>(csv6, <span class="string">&quot;OOP_Programmer,25,San-Francisco\nLi_42,29,New-York\n&quot;</span>) == <span class="number">0</span> &amp;&amp; malloc_usable_size(csv6) &lt; MAX_MALLOC)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：特殊字符未原样输出或内存开辟过大\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(csv6);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例7：负年龄</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试用例7：负年龄\n&quot;</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> <span class="title">people7</span>[] =</span> &#123;</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Zoe&quot;</span>, <span class="number">-5</span>, <span class="string">&quot;Hangzhou&quot;</span>&#125;,</span><br><span class="line">        (<span class="keyword">struct</span> Person)&#123;<span class="string">&quot;Alice&quot;</span>, <span class="number">100</span>, <span class="string">&quot;Beijing&quot;</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">char</span> *csv7 = SortSaveAsCSV(people7, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (csv7 != <span class="literal">NULL</span> &amp;&amp; <span class="built_in">strcmp</span>(csv7, <span class="string">&quot;Zoe,-5,Hangzhou\nAlice,100,Beijing\n&quot;</span>) == <span class="number">0</span> &amp;&amp; malloc_usable_size(csv7) &lt; MAX_MALLOC)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ✔️ 通过\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  ❌ 失败：负数年龄未正确输出或内存开辟过大\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(csv7);</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 汇总结果</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== 测试结果 ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;通过: %d/%d (%.1f%%)\n&quot;</span>, pass_count, total_count, (<span class="type">float</span>)pass_count / total_count * <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//未写待补</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>2025.12.16 C语言程序设计上机实习七</title>
    <url>/2025/12/16/2025.12.16%20C%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8A%E6%9C%BA%E5%AE%9E%E4%B9%A0%E4%B8%83/</url>
    <content><![CDATA[<h1 id="2025-11-11-C语言程序设计上机实习七"><a href="#2025-11-11-C语言程序设计上机实习七" class="headerlink" title="2025.11.11 C语言程序设计上机实习七"></a>2025.11.11 C语言程序设计上机实习七</h1><h2 id="必做题"><a href="#必做题" class="headerlink" title="必做题"></a>必做题</h2><p><img data-src="/./../images/image-20251216190105048.png" alt="image-20251216190105048"></p>
<h2 id="选做题"><a href="#选做题" class="headerlink" title="选做题"></a>选做题</h2><p>题目源文件<a href="https://mjy.js.org/attach/%E5%AE%9E%E9%AA%8C%E4%B8%83.pdf">实验七.pdf</a></p>
<h3 id="题目1：结构体数组中按条件筛选并计算收入总和"><a href="#题目1：结构体数组中按条件筛选并计算收入总和" class="headerlink" title="题目1：结构体数组中按条件筛选并计算收入总和"></a>题目1：结构体数组中按条件筛选并计算收入总和</h3><p><strong>30行之后的代码补充</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 解析行并存入结构体的相应数据中</span></span><br><span class="line"><span class="type">int</span> id;</span><br><span class="line"><span class="type">char</span> lastname[<span class="number">20</span>], firstname[<span class="number">20</span>];</span><br><span class="line"><span class="type">double</span> income;</span><br><span class="line"></span><br><span class="line"><span class="built_in">sscanf</span>(line, <span class="string">&quot;%d %s %s %lf&quot;</span>, &amp;id, lastname, firstname, &amp;income);</span><br><span class="line"></span><br><span class="line">people[i].id = id;</span><br><span class="line">people[i].income = income;</span><br><span class="line"><span class="built_in">snprintf</span>(people[i].name, <span class="keyword">sizeof</span>(people[i].name),<span class="string">&quot;%s %s&quot;</span>, lastname, firstname);</span><br></pre></td></tr></table></figure>

<p><strong>函数SumIncomeByLastname</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">SumIncomeByLastname</span><span class="params">(<span class="keyword">struct</span> Person *people, <span class="type">int</span> n, <span class="type">const</span> <span class="type">char</span> *lastname)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (!people) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (!lastname) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(lastname);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strncmp</span>(people[i].name, lastname, len) == <span class="number">0</span> &amp;&amp; people[i].name[len] == <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += people[i].income;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>函数SumIncomeByIDList</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">SumIncomeByIDList</span><span class="params">(<span class="keyword">struct</span> Person *people, <span class="type">int</span> n, <span class="type">int</span> *id_list, <span class="type">int</span> id_count)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( people == <span class="literal">NULL</span> ) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( n &lt;= <span class="number">0</span> ) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; id_count; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ( people[i].id == id_list[j] )</span><br><span class="line">            &#123;</span><br><span class="line">                sum += people[i].income;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>用相应测试例测试的运行结果截图</strong></p>
<p><img data-src="/./../images/image-20251216195405284.png" alt="image-20251216195405284"></p>
<h3 id="附：完整代码"><a href="#附：完整代码" class="headerlink" title="附：完整代码"></a>附：完整代码</h3><h4 id="CalculateIncome-c"><a href="#CalculateIncome-c" class="headerlink" title="CalculateIncome.c"></a>CalculateIncome.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">30</span>];  <span class="comment">// 实际上是 &quot;Lastname Firstname&quot;</span></span><br><span class="line">    <span class="type">double</span> income;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你需要完成的函数</span></span><br><span class="line"><span class="type">double</span> <span class="title function_">SumIncomeByLastname</span><span class="params">(<span class="keyword">struct</span> Person *people, <span class="type">int</span> n, <span class="type">const</span> <span class="type">char</span> *lastname)</span>;</span><br><span class="line"><span class="type">double</span> <span class="title function_">SumIncomeByIDList</span><span class="params">(<span class="keyword">struct</span> Person *people, <span class="type">int</span> n, <span class="type">int</span> *id_list, <span class="type">int</span> id_count)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于测试</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Test</span><span class="params">(<span class="keyword">struct</span> Person *people, <span class="type">int</span> n)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    getchar(); <span class="comment">// 清除换行符</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Person</span> *<span class="title">people</span> =</span> (<span class="keyword">struct</span> Person *)<span class="built_in">malloc</span>(n * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> Person));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="comment">// 读取一行</span></span><br><span class="line">        <span class="type">char</span> line[<span class="number">100</span>];</span><br><span class="line">        <span class="keyword">if</span> (!fgets(line, <span class="keyword">sizeof</span>(line), <span class="built_in">stdin</span>))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析行并存入结构体的相应数据中</span></span><br><span class="line">        <span class="type">int</span> id;</span><br><span class="line">        <span class="type">char</span> lastname[<span class="number">20</span>], firstname[<span class="number">20</span>];</span><br><span class="line">        <span class="type">double</span> income;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sscanf</span>(line, <span class="string">&quot;%d %s %s %lf&quot;</span>, &amp;id, lastname, firstname, &amp;income);</span><br><span class="line"></span><br><span class="line">        people[i].id = id;</span><br><span class="line">        people[i].income = income;</span><br><span class="line">        <span class="built_in">snprintf</span>(people[i].name, <span class="keyword">sizeof</span>(people[i].name),<span class="string">&quot;%s %s&quot;</span>, lastname, firstname);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Test(people, n);</span><br><span class="line">    <span class="built_in">free</span>(people);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Test</span><span class="params">(<span class="keyword">struct</span> Person *people, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">// 0. 测试输出全部信息</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %s %f\n&quot;</span>, people[i].id, people[i].name, people[i].income);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. 测试姓氏 &quot;Zhang&quot;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试: 姓氏 \&quot;Zhang\&quot; ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, SumIncomeByLastname(people, n, <span class="string">&quot;Zhang&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 测试姓氏 &quot;Li&quot;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试: 姓氏 \&quot;Li\&quot; ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, SumIncomeByLastname(people, n, <span class="string">&quot;Li&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 测试姓氏 &quot;Torres&quot;（假设存在）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试: 姓氏 \&quot;Torres\&quot; ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, SumIncomeByLastname(people, n, <span class="string">&quot;Torres&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. 测试不存在的姓氏 &quot;Minese&quot;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试: 姓氏 \&quot;Minese\&quot; (不存在) ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, SumIncomeByLastname(people, n, <span class="string">&quot;Minese&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. 测试完整名 &quot;Zhang San&quot;（不应匹配，因为只比对姓）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试: 姓氏 \&quot;Zhang San\&quot; (完整名) ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, SumIncomeByLastname(people, n, <span class="string">&quot;Zhang San&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. 测试 ID 列表：1001 ~ 1100 全部 ID</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试: ID 1001~1100 全部 ===\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> all_ids[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">        all_ids[i] = <span class="number">1001</span> + i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, SumIncomeByIDList(people, n, all_ids, <span class="number">100</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 7. 测试 ID 列表：1001~1100 的奇数 ID</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试: ID 1001~1100 奇数 ===\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> odd_ids[<span class="number">50</span>];</span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1001</span>; i &lt;= <span class="number">1100</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">        odd_ids[count++] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, SumIncomeByIDList(people, n, odd_ids, count));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 8. 测试 ID 列表：1001~1100 的偶数 ID</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试: ID 1001~1100 偶数 ===\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> even_ids[<span class="number">50</span>];</span><br><span class="line">    count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1002</span>; i &lt;= <span class="number">1100</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">        even_ids[count++] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, SumIncomeByIDList(people, n, even_ids, count));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> <span class="title function_">SumIncomeByLastname</span><span class="params">(<span class="keyword">struct</span> Person *people, <span class="type">int</span> n, <span class="type">const</span> <span class="type">char</span> *lastname)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (!people) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (!lastname) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(lastname);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strncmp</span>(people[i].name, lastname, len) == <span class="number">0</span> &amp;&amp; people[i].name[len] == <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += people[i].income;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> <span class="title function_">SumIncomeByIDList</span><span class="params">(<span class="keyword">struct</span> Person *people, <span class="type">int</span> n, <span class="type">int</span> *id_list, <span class="type">int</span> id_count)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( people == <span class="literal">NULL</span> ) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( n &lt;= <span class="number">0</span> ) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; id_count; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ( people[i].id == id_list[j] )</span><br><span class="line">            &#123;</span><br><span class="line">                sum += people[i].income;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>2025.12.02 C语言程序设计上机实习五</title>
    <url>/2025/12/02/2025.12.02%20C%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8A%E6%9C%BA%E5%AE%9E%E4%B9%A0%E4%BA%94/</url>
    <content><![CDATA[<h1 id="2025-11-11-C语言程序设计上机实习五"><a href="#2025-11-11-C语言程序设计上机实习五" class="headerlink" title="2025.11.11 C语言程序设计上机实习五"></a>2025.11.11 C语言程序设计上机实习五</h1><h2 id="必做题"><a href="#必做题" class="headerlink" title="必做题"></a>必做题</h2><p><img data-src="/./../images/image-20251202190228897.png" alt="image-20251202190228897"></p>
<h2 id="选做题"><a href="#选做题" class="headerlink" title="选做题"></a>选做题</h2><p>题目源文件<a href="https://mjy.js.org/attach/%E5%AE%9E%E9%AA%8C%E4%BA%94.pdf">实验五.pdf</a></p>
<h3 id="题目1：字符串查找函数"><a href="#题目1：字符串查找函数" class="headerlink" title="题目1：字符串查找函数"></a>题目1：字符串查找函数</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">FindSubstring</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str, <span class="type">const</span> <span class="type">char</span>* substr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!str || !substr) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">strlen</span>(str);</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(substr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; m &amp;&amp; str[i + j] == substr[j])</span><br><span class="line">        &#123;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (j == m)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/./../images/image-20251202210831577.png" alt="image-20251202210831577"></p>
<h3 id="题目2：字符串替换函数"><a href="#题目2：字符串替换函数" class="headerlink" title="题目2：字符串替换函数"></a>题目2：字符串替换函数</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 字符串替换函数实现</span></span><br><span class="line"><span class="type">char</span>* <span class="title function_">ReplaceAll</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* original, <span class="type">const</span> <span class="type">char</span>* target, <span class="type">const</span> <span class="type">char</span>* replacement)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 检查参数是否为空</span></span><br><span class="line">    <span class="keyword">if</span> (original == <span class="literal">NULL</span> || target == <span class="literal">NULL</span> || replacement == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算各字符串长度</span></span><br><span class="line">    <span class="type">int</span> orig_len = <span class="built_in">strlen</span>(original);</span><br><span class="line">    <span class="type">int</span> target_len = <span class="built_in">strlen</span>(target);</span><br><span class="line">    <span class="type">int</span> repl_len = <span class="built_in">strlen</span>(replacement);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果目标字符串为空，返回原字符串的副本</span></span><br><span class="line">    <span class="keyword">if</span> (target_len == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span>* result = (<span class="type">char</span>*)<span class="built_in">malloc</span>((orig_len + <span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (result == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">strcpy</span>(result, original);</span><br><span class="line">        result[orig_len] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算需要替换的次数</span></span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* pos = original;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((pos = <span class="built_in">strstr</span>(pos, target)) != <span class="literal">NULL</span>) <span class="comment">// strstr的用法在课本P486</span></span><br><span class="line">    &#123;</span><br><span class="line">        count++;</span><br><span class="line">        pos += target_len; <span class="comment">// 跳过已找到的目标字符串</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算新字符串长度</span></span><br><span class="line">    <span class="type">int</span> new_len = orig_len + count * (repl_len - target_len);</span><br><span class="line">    <span class="type">char</span>* result = (<span class="type">char</span>*)<span class="built_in">malloc</span>((new_len + <span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行替换操作</span></span><br><span class="line">    <span class="type">char</span>* current = result;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* start = original;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* found;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((found = <span class="built_in">strstr</span>(start, target)) != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 复制目标字符串之前的部分</span></span><br><span class="line">        <span class="type">int</span> prefix_len = found - start;</span><br><span class="line">        <span class="keyword">if</span> (prefix_len &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">strncpy</span>(current, start, prefix_len);</span><br><span class="line">            current += prefix_len;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 复制替换字符串</span></span><br><span class="line">        <span class="keyword">if</span> (repl_len &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">strcpy</span>(current, replacement);</span><br><span class="line">            current += repl_len;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 移动到下一个位置</span></span><br><span class="line">        start = found + target_len;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 复制剩余部分</span></span><br><span class="line">    <span class="built_in">strcpy</span>(current, start);</span><br><span class="line">    result[new_len] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>修改部分：</p>
<ul>
<li>malloc用法，长度*sizeof(类型)</li>
<li>strcpy复制位置（原有-1删去）（两处）</li>
<li>result字符串末尾要加 ‘\0’ （两处）</li>
<li>（无用）加入 repl_len &gt; 0 判断</li>
</ul>
<p><img data-src="/./../images/image-20251202210911428.png" alt="image-20251202210911428"></p>
<h3 id="题目3：回文单词检测函数"><a href="#题目3：回文单词检测函数" class="headerlink" title="题目3：回文单词检测函数"></a>题目3：回文单词检测函数</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">HasPalindromeWord</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* sentence)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (sentence == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// 传空参数处理</span></span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* p = sentence;</span><br><span class="line">    <span class="keyword">while</span> (*p) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (*p &amp;&amp; !<span class="built_in">isalnum</span>(*p)) <span class="comment">// 字母与数字可过，略过字符</span></span><br><span class="line">        &#123;</span><br><span class="line">            p++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (*p == <span class="string">&#x27;\0&#x27;</span>) <span class="comment">// 如果因为上一个while跳到结尾了就该抓紧终止了</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* start = p;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (*p &amp;&amp; <span class="built_in">isalnum</span>(*p)) <span class="comment">// 来个字母和数字作为起点，读到不是字母和数字和&#x27;\0&#x27;就停</span></span><br><span class="line">        &#123;</span><br><span class="line">            p++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* end = p;</span><br><span class="line"></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> len = end - start;</span><br><span class="line">        <span class="keyword">if</span> (len &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="type">size_t</span> i = <span class="number">0</span>, j = len - <span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> is_pal = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">                <span class="type">char</span> a = (<span class="type">char</span>)<span class="built_in">tolower</span>(start[i]);</span><br><span class="line">                <span class="type">char</span> b = (<span class="type">char</span>)<span class="built_in">tolower</span>(start[j]);</span><br><span class="line">                <span class="keyword">if</span> (a != b)</span><br><span class="line">                &#123;</span><br><span class="line">                    is_pal = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                i++;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (is_pal)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/./../images/image-20251202210951504.png" alt="image-20251202210951504"></p>
<h3 id="题目4：礼貌数判断函数（被放弃的期中考试题）"><a href="#题目4：礼貌数判断函数（被放弃的期中考试题）" class="headerlink" title="题目4：礼貌数判断函数（被放弃的期中考试题）"></a>题目4：礼貌数判断函数（被放弃的期中考试题）</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">IsPoliteNumber</span><span class="params">(<span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> test = n, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= test; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i; j &lt; test; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += j;</span><br><span class="line">            <span class="keyword">if</span> (sum == test)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (sum &gt; test)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/./../images/image-20251202211032319.png" alt="image-20251202211032319"></p>
<h3 id="题目5：矩阵转置函数"><a href="#题目5：矩阵转置函数" class="headerlink" title="题目5：矩阵转置函数"></a>题目5：矩阵转置函数</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span>** <span class="title function_">TransMat</span><span class="params">(<span class="type">int</span>** matrix, <span class="type">int</span> m, <span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> **arr;</span><br><span class="line">    arr = (<span class="type">int</span> **)<span class="built_in">malloc</span>(n * <span class="keyword">sizeof</span>(<span class="type">int</span> *));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        arr[i] = (<span class="type">int</span> *)<span class="built_in">malloc</span>(m * <span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">        <span class="keyword">if</span>(arr[i] == <span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            arr[i][j] = matrix[j][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/./../images/image-20251202211104822.png" alt="image-20251202211104822"></p>
<h3 id="附：完整代码"><a href="#附：完整代码" class="headerlink" title="附：完整代码"></a>附：完整代码</h3><h4 id="TestFindSubstr-c"><a href="#TestFindSubstr-c" class="headerlink" title="TestFindSubstr.c"></a>TestFindSubstr.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串查找函数声明</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">FindSubstring</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str, <span class="type">const</span> <span class="type">char</span>* substr)</span>;</span><br><span class="line"><span class="comment">// 测试函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_tests</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    run_tests();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">run_tests</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 字符串查找函数测试 ===\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pass_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> total_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例1：正常情况</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试1: 正常查找\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> result1 = FindSubstring(<span class="string">&quot;Hello world&quot;</span>, <span class="string">&quot;world&quot;</span>);</span><br><span class="line">    <span class="type">int</span> expected1 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: str=\&quot;Hello world\&quot;, substr=\&quot;world\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: %d, 实际: %d - %s\n&quot;</span>, expected1, result1,</span><br><span class="line">           result1 == expected1 ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (result1 == expected1)</span><br><span class="line">            pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例2：不存在的情况</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试2: 子串不存在\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> result2 = FindSubstring(<span class="string">&quot;Hello world&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line">    <span class="type">int</span> expected2 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: str=\&quot;Hello world\&quot;, substr=\&quot;test\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: %d, 实际: %d - %s\n&quot;</span>, expected2, result2,</span><br><span class="line">           result2 == expected2 ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (result2 == expected2)</span><br><span class="line">            pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例3：部分匹配但最后一个字符不匹配</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试3: 部分匹配（最后一个字符不匹配）\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> result3 = FindSubstring(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;hella&quot;</span>);</span><br><span class="line">    <span class="type">int</span> expected3 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: str=\&quot;hello world\&quot;, substr=\&quot;hella\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: %d, 实际: %d - %s\n&quot;</span>, expected3, result3,</span><br><span class="line">           result3 == expected3 ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (result3 == expected3)</span><br><span class="line">            pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例4：开头匹配</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试4: 子串在开头\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> result4 = FindSubstring(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    <span class="type">int</span> expected4 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: str=\&quot;hello world\&quot;, substr=\&quot;hello\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: %d, 实际: %d - %s\n&quot;</span>, expected4, result4,</span><br><span class="line">           result4 == expected4 ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (result4 == expected4)</span><br><span class="line">            pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例5：结尾匹配</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试5: 子串在结尾\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> result5 = FindSubstring(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;world&quot;</span>);</span><br><span class="line">    <span class="type">int</span> expected5 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: str=\&quot;hello world\&quot;, substr=\&quot;world\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: %d, 实际: %d - %s\n&quot;</span>, expected5, result5,</span><br><span class="line">           result5 == expected5 ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (result5 == expected5)</span><br><span class="line">            pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 汇总结果</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== 测试结果 ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;通过: %d/%d (%.1f%%)\n&quot;</span>, pass_count, total_count,</span><br><span class="line">           (<span class="type">float</span>)pass_count/total_count*<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">FindSubstring</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str, <span class="type">const</span> <span class="type">char</span>* substr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!str || !substr) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">strlen</span>(str);</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(substr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; m &amp;&amp; str[i + j] == substr[j])</span><br><span class="line">        &#123;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (j == m)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TestReplaceAll-c"><a href="#TestReplaceAll-c" class="headerlink" title="TestReplaceAll.c"></a>TestReplaceAll.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数原型声明</span></span><br><span class="line"><span class="type">char</span>* <span class="title function_">ReplaceAll</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* original, <span class="type">const</span> <span class="type">char</span>* target, <span class="type">const</span> <span class="type">char</span>* replacement)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">StringsEqual</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str1, <span class="type">const</span> <span class="type">char</span>* str2)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">RunTests</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">TestMemoryLeak</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    RunTests();</span><br><span class="line">    TestMemoryLeak();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n按任意键退出...&quot;</span>);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 辅助函数：比较两个字符串是否相等</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">StringsEqual</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str1, <span class="type">const</span> <span class="type">char</span>* str2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (str1 == <span class="literal">NULL</span> &amp;&amp; str2 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (str1 == <span class="literal">NULL</span> || str2 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">strcmp</span>(str1, str2) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">RunTests</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 字符串替换函数测试 ===\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pass_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> total_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span>* result = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">char</span>* expected = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例1：正常情况 - 单次替换</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试1: 正常替换（单次出现）\n&quot;</span>);</span><br><span class="line">    result = ReplaceAll(<span class="string">&quot;I like apples&quot;</span>, <span class="string">&quot;apples&quot;</span>, <span class="string">&quot;oranges&quot;</span>);</span><br><span class="line">    expected = <span class="string">&quot;I like oranges&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: original=\&quot;I like apples\&quot;, target=\&quot;apples\&quot;, replacement=\&quot;oranges\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: \&quot;%s\&quot;\n&quot;</span>, expected);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: \&quot;%s\&quot;\n&quot;</span>, result ? result : <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, StringsEqual(result, expected) ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringsEqual(result, expected))</span><br><span class="line">    &#123;</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line">    result = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例2：多次替换</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试2: 多次替换\n&quot;</span>);</span><br><span class="line">    result = ReplaceAll(<span class="string">&quot;I like apples, apples are delicious.&quot;</span>, <span class="string">&quot;apples&quot;</span>, <span class="string">&quot;oranges&quot;</span>);</span><br><span class="line">    expected = <span class="string">&quot;I like oranges, oranges are delicious.&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: original=\&quot;I like apples, apples are delicious.\&quot;, target=\&quot;apples\&quot;, replacement=\&quot;oranges\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: \&quot;%s\&quot;\n&quot;</span>, expected);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: \&quot;%s\&quot;\n&quot;</span>, result ? result : <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, StringsEqual(result, expected) ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringsEqual(result, expected))</span><br><span class="line">    &#123;</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line">    result = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例3：目标子串不存在</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试3: 目标子串不存在\n&quot;</span>);</span><br><span class="line">    result = ReplaceAll(<span class="string">&quot;I like apples&quot;</span>, <span class="string">&quot;bananas&quot;</span>, <span class="string">&quot;oranges&quot;</span>);</span><br><span class="line">    expected = <span class="string">&quot;I like apples&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: original=\&quot;I like apples\&quot;, target=\&quot;bananas\&quot;, replacement=\&quot;oranges\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: \&quot;%s\&quot;\n&quot;</span>, expected);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: \&quot;%s\&quot;\n&quot;</span>, result ? result : <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, StringsEqual(result, expected) ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringsEqual(result, expected))</span><br><span class="line">    &#123;</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line">    result = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例4：原始字符串为空</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试4: 原始字符串为空\n&quot;</span>);</span><br><span class="line">    result = ReplaceAll(<span class="string">&quot;&quot;</span>, <span class="string">&quot;apples&quot;</span>, <span class="string">&quot;oranges&quot;</span>);</span><br><span class="line">    expected = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: original=\&quot;\&quot;, target=\&quot;apples\&quot;, replacement=\&quot;oranges\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: \&quot;%s\&quot;\n&quot;</span>, expected);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: \&quot;%s\&quot;\n&quot;</span>, result ? result : <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, StringsEqual(result, expected) ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringsEqual(result, expected))</span><br><span class="line">    &#123;</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line">    result = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例5：替换为空字符串（删除操作）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试5: 替换为空字符串（删除）\n&quot;</span>);</span><br><span class="line">    result = ReplaceAll(<span class="string">&quot;Hello World&quot;</span>, <span class="string">&quot;o&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    expected = <span class="string">&quot;Hell Wrld&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: original=\&quot;Hello World\&quot;, target=\&quot;o\&quot;, replacement=\&quot;\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: \&quot;%s\&quot;\n&quot;</span>, expected);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: \&quot;%s\&quot;\n&quot;</span>, result ? result : <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, StringsEqual(result, expected) ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringsEqual(result, expected))</span><br><span class="line">    &#123;</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line">    result = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例6：连续出现目标子串（重点测试）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试6: 连续出现目标子串\n&quot;</span>);</span><br><span class="line">    result = ReplaceAll(<span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;aa&quot;</span>, <span class="string">&quot;b&quot;</span>);</span><br><span class="line">    expected = <span class="string">&quot;bb&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: original=\&quot;aaaa\&quot;, target=\&quot;aa\&quot;, replacement=\&quot;b\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: \&quot;%s\&quot;\n&quot;</span>, expected);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: \&quot;%s\&quot;\n&quot;</span>, result ? result : <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, StringsEqual(result, expected) ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringsEqual(result, expected))</span><br><span class="line">    &#123;</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line">    result = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例7：特殊字符</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试7: 特殊字符\n&quot;</span>);</span><br><span class="line">    result = ReplaceAll(<span class="string">&quot;a-b-c-d&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">    expected = <span class="string">&quot;a b c d&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: original=\&quot;a-b-c-d\&quot;, target=\&quot;-\&quot;, replacement=\&quot; \&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: \&quot;%s\&quot;\n&quot;</span>, expected);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: \&quot;%s\&quot;\n&quot;</span>, result ? result : <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, StringsEqual(result, expected) ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringsEqual(result, expected))</span><br><span class="line">    &#123;</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line">    result = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 汇总结果</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== 测试结果 ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;通过: %d/%d (%.1f%%)\n&quot;</span>, pass_count, total_count,</span><br><span class="line">           (<span class="type">float</span>)pass_count / total_count * <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pass_count == total_count)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;所有测试通过！\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;有 %d 个测试失败\n&quot;</span>, total_count - pass_count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 内存泄漏检查辅助函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">TestMemoryLeak</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== 内存泄漏检查 ===\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试多次替换，检查是否有内存泄漏</span></span><br><span class="line">    <span class="type">char</span>* results[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    results[<span class="number">0</span>] = ReplaceAll(<span class="string">&quot;test test test&quot;</span>, <span class="string">&quot;test&quot;</span>, <span class="string">&quot;TEST&quot;</span>);</span><br><span class="line">    results[<span class="number">1</span>] = ReplaceAll(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;hello&quot;</span>, <span class="string">&quot;Hi&quot;</span>);</span><br><span class="line">    results[<span class="number">2</span>] = ReplaceAll(<span class="string">&quot;a b c d&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;替换结果:\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  结果%d: %s\n&quot;</span>, i + <span class="number">1</span>, results[i] ? results[i] : <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">        <span class="built_in">free</span>(results[i]); <span class="comment">// 正确释放内存</span></span><br><span class="line">        results[i] = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;若results均能正常输出，则释放基本正确\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串替换函数实现</span></span><br><span class="line"><span class="type">char</span>* <span class="title function_">ReplaceAll</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* original, <span class="type">const</span> <span class="type">char</span>* target, <span class="type">const</span> <span class="type">char</span>* replacement)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 检查参数是否为空</span></span><br><span class="line">    <span class="keyword">if</span> (original == <span class="literal">NULL</span> || target == <span class="literal">NULL</span> || replacement == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算各字符串长度</span></span><br><span class="line">    <span class="type">int</span> orig_len = <span class="built_in">strlen</span>(original);</span><br><span class="line">    <span class="type">int</span> target_len = <span class="built_in">strlen</span>(target);</span><br><span class="line">    <span class="type">int</span> repl_len = <span class="built_in">strlen</span>(replacement);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果目标字符串为空，返回原字符串的副本</span></span><br><span class="line">    <span class="keyword">if</span> (target_len == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span>* result = (<span class="type">char</span>*)<span class="built_in">malloc</span>((orig_len + <span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (result == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">strcpy</span>(result, original);</span><br><span class="line">        result[orig_len] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算需要替换的次数</span></span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* pos = original;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((pos = <span class="built_in">strstr</span>(pos, target)) != <span class="literal">NULL</span>) <span class="comment">// strstr的用法在课本P486</span></span><br><span class="line">    &#123;</span><br><span class="line">        count++;</span><br><span class="line">        pos += target_len; <span class="comment">// 跳过已找到的目标字符串</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算新字符串长度</span></span><br><span class="line">    <span class="type">int</span> new_len = orig_len + count * (repl_len - target_len);</span><br><span class="line">    <span class="type">char</span>* result = (<span class="type">char</span>*)<span class="built_in">malloc</span>((new_len + <span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行替换操作</span></span><br><span class="line">    <span class="type">char</span>* current = result;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* start = original;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* found;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((found = <span class="built_in">strstr</span>(start, target)) != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 复制目标字符串之前的部分</span></span><br><span class="line">        <span class="type">int</span> prefix_len = found - start;</span><br><span class="line">        <span class="keyword">if</span> (prefix_len &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">strncpy</span>(current, start, prefix_len);</span><br><span class="line">            current += prefix_len;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 复制替换字符串</span></span><br><span class="line">        <span class="keyword">if</span> (repl_len &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">strcpy</span>(current, replacement);</span><br><span class="line">            current += repl_len;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 移动到下一个位置</span></span><br><span class="line">        start = found + target_len;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 复制剩余部分</span></span><br><span class="line">    <span class="built_in">strcpy</span>(current, start);</span><br><span class="line">    result[new_len] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TestPalindromeWord-c"><a href="#TestPalindromeWord-c" class="headerlink" title="TestPalindromeWord.c"></a>TestPalindromeWord.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数原型声明</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">HasPalindromeWord</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* sentence)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">RunTests</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    RunTests();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n按任意键退出...&quot;</span>);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">RunTests</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 回文单词检测函数测试 ===\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pass_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> total_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例1：包含回文单词</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试1: 包含回文单词\n&quot;</span>);</span><br><span class="line">    result = HasPalindromeWord(<span class="string">&quot;Madam,this is a test.&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: \&quot;Madam,this is a test.\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1 (Madam是回文)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例2：不包含回文单词</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试2: 不包含回文单词\n&quot;</span>);</span><br><span class="line">    result = HasPalindromeWord(<span class="string">&quot;Hello world,this is a test.&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: \&quot;Hello world,this is a test.\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 0\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">0</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">0</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例3：多个回文单词</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试3: 多个回文单词\n&quot;</span>);</span><br><span class="line">    result = HasPalindromeWord(<span class="string">&quot;mem level&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: \&quot;mem level\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例4：空句子</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试4: 空句子\n&quot;</span>);</span><br><span class="line">    result = HasPalindromeWord(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: \&quot;\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 0\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">0</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">0</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例5：只有标点符号</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试5: 只有标点符号\n&quot;</span>);</span><br><span class="line">    result = HasPalindromeWord(<span class="string">&quot;!@#$%^&amp;*()&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: \&quot;!@#$%%^&amp;*()\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 0\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">0</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">0</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例6：单个回文单词</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试6: 单个回文单词\n&quot;</span>);</span><br><span class="line">    result = HasPalindromeWord(<span class="string">&quot;racecar&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: \&quot;racecar\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例7：混合大小写的回文</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试7: 混合大小写的回文\n&quot;</span>);</span><br><span class="line">    result = HasPalindromeWord(<span class="string">&quot;LeVel is important&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: \&quot;LeVel is important\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1 (Level是回文)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例8：数字和字母混合</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试8: 数字和字母混合\n&quot;</span>);</span><br><span class="line">    result = HasPalindromeWord(<span class="string">&quot;This is 12321 number&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: \&quot;This is 12321 number\&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1 (12321是回文)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 汇总结果</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== 测试结果 ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;通过: %d/%d (%.1f%%)\n&quot;</span>, pass_count, total_count,</span><br><span class="line">           (<span class="type">float</span>)pass_count / total_count * <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pass_count == total_count)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;所有测试通过！\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;有 %d 个测试失败\n&quot;</span>, total_count - pass_count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">HasPalindromeWord</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* sentence)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (sentence == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// 传空参数处理</span></span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* p = sentence;</span><br><span class="line">    <span class="keyword">while</span> (*p) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (*p &amp;&amp; !<span class="built_in">isalnum</span>(*p)) <span class="comment">// 字母与数字可过，略过字符</span></span><br><span class="line">        &#123;</span><br><span class="line">            p++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (*p == <span class="string">&#x27;\0&#x27;</span>) <span class="comment">// 如果因为上一个while跳到结尾了就该抓紧终止了</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* start = p;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (*p &amp;&amp; <span class="built_in">isalnum</span>(*p)) <span class="comment">// 来个字母和数字作为起点，读到不是字母和数字和&#x27;\0&#x27;就停</span></span><br><span class="line">        &#123;</span><br><span class="line">            p++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* end = p;</span><br><span class="line"></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> len = end - start;</span><br><span class="line">        <span class="keyword">if</span> (len &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="type">size_t</span> i = <span class="number">0</span>, j = len - <span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> is_pal = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">                <span class="type">char</span> a = (<span class="type">char</span>)<span class="built_in">tolower</span>(start[i]);</span><br><span class="line">                <span class="type">char</span> b = (<span class="type">char</span>)<span class="built_in">tolower</span>(start[j]);</span><br><span class="line">                <span class="keyword">if</span> (a != b)</span><br><span class="line">                &#123;</span><br><span class="line">                    is_pal = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                i++;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (is_pal)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TestPoliteNumber-c"><a href="#TestPoliteNumber-c" class="headerlink" title="TestPoliteNumber.c"></a>TestPoliteNumber.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数原型声明</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">IsPoliteNumber</span><span class="params">(<span class="type">int</span> n)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">RunTests</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    RunTests();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n按任意键退出...&quot;</span>);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">RunTests</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 礼貌数判断函数测试（必须使用循环实现） ===\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;注意：本题必须使用循环方法实现，直接使用2的幂判断将不予通过！\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pass_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> total_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="type">clock_t</span> start, end;</span><br><span class="line">    <span class="type">double</span> cpu_time_used;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例1：明显的礼貌数</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试1: 明显的礼貌数\n&quot;</span>);</span><br><span class="line">    result = IsPoliteNumber(<span class="number">9</span>); <span class="comment">// 9 = 4+5 或 2+3+4</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 9\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例2：2的幂次方（非礼貌数）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试2: 2的幂次方（非礼貌数）\n&quot;</span>);</span><br><span class="line">    result = IsPoliteNumber(<span class="number">8</span>); <span class="comment">// 8 = 2^3</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 8\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 0\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">0</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">0</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例3：边界值1</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试3: 边界值1\n&quot;</span>);</span><br><span class="line">    result = IsPoliteNumber(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 1\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 0（不能表示为两个或更多连续正整数之和）\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">0</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">0</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例4：边界值3</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试4: 边界值3\n&quot;</span>);</span><br><span class="line">    result = IsPoliteNumber(<span class="number">3</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 3\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1（3=1+2）\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例5：较大的礼貌数</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试5: 较大的礼貌数\n&quot;</span>);</span><br><span class="line">    result = IsPoliteNumber(<span class="number">15</span>); <span class="comment">// 15=7+8 或 4+5+6 或 1+2+3+4+5</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 15\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例6：质数（通常是礼貌数，除了2）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试6: 质数（礼貌数）\n&quot;</span>);</span><br><span class="line">    result = IsPoliteNumber(<span class="number">7</span>); <span class="comment">// 7=3+4</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 7\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">1</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">1</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例7：较大的2的幂次方</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试7: 较大的2的幂次方\n&quot;</span>);</span><br><span class="line">    result = IsPoliteNumber(<span class="number">32</span>); <span class="comment">// 32=2^5</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 32\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 0\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  结果: %s\n&quot;</span>, result == <span class="number">0</span> ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">0</span>) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例8：大数测试 - 礼貌数</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试8: 大数测试 - 礼貌数\n&quot;</span>);</span><br><span class="line">    start = clock();</span><br><span class="line">    result = IsPoliteNumber(<span class="number">1000000</span>); <span class="comment">// 1000000是礼貌数</span></span><br><span class="line">    end = clock();</span><br><span class="line">    cpu_time_used = ((<span class="type">double</span>) (end - start)) / CLOCKS_PER_SEC * <span class="number">1000</span>; <span class="comment">// 转换为毫秒</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 1000000\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 1\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  运行时间: %.2f 毫秒\n&quot;</span>, cpu_time_used);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查结果和运行时间</span></span><br><span class="line">    <span class="type">int</span> time_check = (cpu_time_used &gt; <span class="number">0.1</span>); <span class="comment">// 运行时间应大于0.1毫秒</span></span><br><span class="line">    <span class="type">int</span> result_check = (result == <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result_check &amp;&amp; time_check)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  结果: 通过（结果正确且使用了循环）\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (result_check &amp;&amp; !time_check)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  结果: 失败（结果正确但运行时间过短，可能使用了直接判断）\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  结果: 失败（结果错误）\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例9：大数测试 - 非礼貌数</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试9: 大数测试 - 非礼貌数\n&quot;</span>);</span><br><span class="line">    start = clock();</span><br><span class="line">    result = IsPoliteNumber(<span class="number">1048576</span>); <span class="comment">// 1048576=2^20，不是礼貌数</span></span><br><span class="line">    end = clock();</span><br><span class="line">    cpu_time_used = ((<span class="type">double</span>) (end - start)) / CLOCKS_PER_SEC * <span class="number">1000</span>; <span class="comment">// 转换为毫秒</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  输入: 1048576\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  预期: 0\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  实际: %d\n&quot;</span>, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  运行时间: %.2f 毫秒\n&quot;</span>, cpu_time_used);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查结果和运行时间</span></span><br><span class="line">    time_check = (cpu_time_used &gt; <span class="number">0.1</span>); <span class="comment">// 运行时间应大于0.1毫秒</span></span><br><span class="line">    result_check = (result == <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result_check &amp;&amp; time_check)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  结果: 通过（结果正确且使用了循环）\n&quot;</span>);</span><br><span class="line">        pass_count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (result_check &amp;&amp; !time_check)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  结果: 失败（结果正确但运行时间过短，可能使用了直接判断）\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  结果: 失败（结果错误）\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 汇总结果</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== 测试结果 ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;通过: %d/%d (%.1f%%)\n&quot;</span>, pass_count, total_count,</span><br><span class="line">           (<span class="type">float</span>)pass_count / total_count * <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pass_count == total_count)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;所有测试通过！\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;有 %d 个测试失败\n&quot;</span>, total_count - pass_count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 特别说明</span></span><br><span class="line">    <span class="keyword">if</span> (pass_count &gt;= <span class="number">7</span> &amp;&amp; pass_count &lt; total_count)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n注意：部分测试失败可能是因为使用了直接判断方法（检查2的幂次方）。\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;本题要求必须使用循环实现，请检查您的实现方法。\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">IsPoliteNumber</span><span class="params">(<span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> test = n, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= test; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i; j &lt; test; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += j;</span><br><span class="line">            <span class="keyword">if</span> (sum == test)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (sum &gt; test)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TestMatrixTranspose-c"><a href="#TestMatrixTranspose-c" class="headerlink" title="TestMatrixTranspose.c"></a>TestMatrixTranspose.c</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数原型声明</span></span><br><span class="line"><span class="type">int</span>** <span class="title function_">TransMat</span><span class="params">(<span class="type">int</span>** matrix, <span class="type">int</span> m, <span class="type">int</span> n)</span>;</span><br><span class="line"><span class="type">int</span>** <span class="title function_">CreateMatrix</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeMatrix</span><span class="params">(<span class="type">int</span>** matrix, <span class="type">int</span> m)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">PrintMatrix</span><span class="params">(<span class="type">int</span>** matrix, <span class="type">int</span> m, <span class="type">int</span> n)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">CompareMatrices</span><span class="params">(<span class="type">int</span>** mat1, <span class="type">int</span> m1, <span class="type">int</span> n1, <span class="type">int</span>** mat2, <span class="type">int</span> m2, <span class="type">int</span> n2)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">RunTests</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    RunTests();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n测试完成，按任意键退出...&quot;</span>);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建指定大小的矩阵并填充测试数据</span></span><br><span class="line"><span class="type">int</span>** <span class="title function_">CreateMatrix</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m &lt;= <span class="number">0</span> || n &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>** matrix = (<span class="type">int</span>**)<span class="built_in">malloc</span>(m * <span class="keyword">sizeof</span>(<span class="type">int</span>*));</span><br><span class="line">    <span class="keyword">if</span> (matrix == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        matrix[i] = (<span class="type">int</span>*)<span class="built_in">malloc</span>(n * <span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">        <span class="keyword">if</span> (matrix[i] == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 分配失败，释放已分配的内存</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">free</span>(matrix[j]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">free</span>(matrix);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 填充测试数据：matrix[i][j] = i * n + j + 1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            matrix[i][j] = i * n + j + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> matrix;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 释放矩阵内存</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">FreeMatrix</span><span class="params">(<span class="type">int</span>** matrix, <span class="type">int</span> m)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (matrix == <span class="literal">NULL</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">free</span>(matrix[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(matrix);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印矩阵</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">PrintMatrix</span><span class="params">(<span class="type">int</span>** matrix, <span class="type">int</span> m, <span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (matrix == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;矩阵为空\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%4d&quot;</span>, matrix[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 比较两个矩阵是否相等</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">CompareMatrices</span><span class="params">(<span class="type">int</span>** mat1, <span class="type">int</span> m1, <span class="type">int</span> n1, <span class="type">int</span>** mat2, <span class="type">int</span> m2, <span class="type">int</span> n2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (m1 != m2 || n1 != n2) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (mat1 == <span class="literal">NULL</span> || mat2 == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m1; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n1; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (mat1[i][j] != mat2[i][j])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">RunTests</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 矩阵转置函数测试 ===\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pass_count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> total_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例1：2x3矩阵转置</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试1: 2x3矩阵转置\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span>** original1 = CreateMatrix(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;原始矩阵(2x3):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(original1, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>** result1 = TransMat(original1, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;转置结果(3x2):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(result1, <span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 验证结果：创建期望的转置矩阵</span></span><br><span class="line">    <span class="type">int</span>** expected1 = CreateMatrix(<span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (expected1 != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        expected1[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>; expected1[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">4</span>;</span><br><span class="line">        expected1[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">2</span>; expected1[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">5</span>;</span><br><span class="line">        expected1[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">3</span>; expected1[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> test1_pass = CompareMatrices(result1, <span class="number">3</span>, <span class="number">2</span>, expected1, <span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;结果: %s\n\n&quot;</span>, test1_pass ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (test1_pass) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 释放内存</span></span><br><span class="line">    FreeMatrix(original1, <span class="number">2</span>);</span><br><span class="line">    FreeMatrix(result1, <span class="number">3</span>);</span><br><span class="line">    FreeMatrix(expected1, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例2：1x1矩阵转置</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试2: 1x1矩阵转置\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span>** original2 = CreateMatrix(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;原始矩阵(1x1):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(original2, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>** result2 = TransMat(original2, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;转置结果(1x1):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(result2, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> test2_pass = (result2 != <span class="literal">NULL</span>) &amp;&amp; (result2[<span class="number">0</span>][<span class="number">0</span>] == original2[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;结果: %s\n\n&quot;</span>, test2_pass ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (test2_pass) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 释放内存</span></span><br><span class="line">    FreeMatrix(original2, <span class="number">1</span>);</span><br><span class="line">    FreeMatrix(result2, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例3：3x1矩阵转置（列向量）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试3: 3x1矩阵转置（列向量）\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span>** original3 = CreateMatrix(<span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;原始矩阵(3x1):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(original3, <span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>** result3 = TransMat(original3, <span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;转置结果(1x3):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(result3, <span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 验证结果</span></span><br><span class="line">    <span class="type">int</span> test3_pass = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (result3 != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        test3_pass = (result3[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">1</span>) &amp;&amp; (result3[<span class="number">0</span>][<span class="number">1</span>] == <span class="number">2</span>) &amp;&amp; (result3[<span class="number">0</span>][<span class="number">2</span>] == <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        test3_pass = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;结果: %s\n\n&quot;</span>, test3_pass ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (test3_pass) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 释放内存</span></span><br><span class="line">    FreeMatrix(original3, <span class="number">3</span>);</span><br><span class="line">    FreeMatrix(result3, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例4：1x4矩阵转置（行向量）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试4: 1x4矩阵转置（行向量）\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span>** original4 = CreateMatrix(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;原始矩阵(1x4):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(original4, <span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>** result4 = TransMat(original4, <span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;转置结果(4x1):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(result4, <span class="number">4</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 验证结果</span></span><br><span class="line">    <span class="type">int</span> test4_pass = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (result4 != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        test4_pass = (result4[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">1</span>) &amp;&amp; (result4[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">2</span>) &amp;&amp;</span><br><span class="line">                     (result4[<span class="number">2</span>][<span class="number">0</span>] == <span class="number">3</span>) &amp;&amp; (result4[<span class="number">3</span>][<span class="number">0</span>] == <span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        test4_pass = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;结果: %s\n\n&quot;</span>, test4_pass ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (test4_pass) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 释放内存</span></span><br><span class="line">    FreeMatrix(original4, <span class="number">1</span>);</span><br><span class="line">    FreeMatrix(result4, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试用例5：方阵转置（3x3）</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;测试5: 3x3方阵转置\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span>** original5 = CreateMatrix(<span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;原始矩阵(3x3):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(original5, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>** result5 = TransMat(original5, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;转置结果(3x3):\n&quot;</span>);</span><br><span class="line">    PrintMatrix(result5, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 验证方阵转置：对角线不变，其他元素对称交换</span></span><br><span class="line">    <span class="type">int</span> test5_pass = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (result5 != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (result5[i][j] != original5[j][i])</span><br><span class="line">                &#123;</span><br><span class="line">                    test5_pass = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!test5_pass) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        test5_pass = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;结果: %s\n\n&quot;</span>, test5_pass ? <span class="string">&quot;通过&quot;</span> : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (test5_pass) pass_count++;</span><br><span class="line">    total_count++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 释放内存</span></span><br><span class="line">    FreeMatrix(original5, <span class="number">3</span>);</span><br><span class="line">    FreeMatrix(result5, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 汇总结果</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== 测试结果汇总 ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;通过测试: %d/%d\n&quot;</span>, pass_count, total_count);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;成功率: %.1f%%\n&quot;</span>, (<span class="type">float</span>)pass_count / total_count * <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pass_count == total_count)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;🎉 所有测试通过！\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;❌ 有 %d 个测试失败\n&quot;</span>, total_count - pass_count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>** <span class="title function_">TransMat</span><span class="params">(<span class="type">int</span>** matrix, <span class="type">int</span> m, <span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> **arr;</span><br><span class="line">    arr = (<span class="type">int</span> **)<span class="built_in">malloc</span>(n * <span class="keyword">sizeof</span>(<span class="type">int</span> *));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        arr[i] = (<span class="type">int</span> *)<span class="built_in">malloc</span>(m * <span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">        <span class="keyword">if</span>(arr[i] == <span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            arr[i][j] = matrix[j][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows下的Python环境配置</title>
    <url>/2025/10/01/Configuring-the-Python-Environment-on-Windows/</url>
    <content><![CDATA[<h2 id="在开始之前"><a href="#在开始之前" class="headerlink" title="在开始之前"></a>在开始之前</h2><ul>
<li><p>保证你的用户文件夹不要存在中文，且在任何情况下不要把项目文件&#x2F;文件夹放在中文目录下。</p>
<p>例如<img data-src="/./../images/image-20251001200303183.png" alt="image-20251001200303183"></p>
</li>
</ul>
<p>你的用户主文件夹不能为中文，否则在后续操作中会出现许多未知错误，导致安装或运行程序无法继续进行。图中用户主文件夹名为“TranquilYu”，符合要求。若采用邮箱登录，其用户主文件夹一般为邮箱的开头5位数字，同样是符合要求的。如果发现自己用户主文件夹为中文，请创建一个新本地用户（权限应为管理员权限，账户名字应不包含中文），然后继续按照教程操作。</p>
<ul>
<li><p>保证良好的网络连接</p>
</li>
<li><p>拥有充足的硬盘空间</p>
</li>
</ul>
<h2 id="Anaconda的安装"><a href="#Anaconda的安装" class="headerlink" title="Anaconda的安装"></a>Anaconda的安装</h2><p>很多刚接触Python环境管理的人都会混淆Anaconda和conda。简单说，<strong>Anaconda是一个集成的Python数据科学平台，而conda是平台内置的包与环境管理工具</strong>，二者是“平台”与“工具”的包含关系。也就是说，conda是Python的一个库，Anaconda是一个整合包，整合了包含conda在内的其他Python库。</p>
<h3 id="1-核心定义与定位"><a href="#1-核心定义与定位" class="headerlink" title="1. 核心定义与定位"></a>1. 核心定义与定位</h3><ul>
<li><strong>Anaconda</strong>：全称Anaconda Individual Edition，是一个免费开源的Python&#x2F;R数据科学发行版。它不仅包含Python解释器，还预装了NumPy、Pandas、Matplotlib等数百个常用数据科学包，同时内置了conda工具，旨在让用户“开箱即用”，无需手动配置复杂环境。</li>
<li><strong>conda</strong>：是一个跨平台的包管理器和环境管理器，核心功能是安装、卸载、更新软件包，以及创建隔离的Python环境（避免不同项目依赖冲突）。它不依赖Python，甚至可以管理非Python语言的包（如R语言包）。</li>
</ul>
<h3 id="2-关键区别对比"><a href="#2-关键区别对比" class="headerlink" title="2. 关键区别对比"></a>2. 关键区别对比</h3><table>
<thead>
<tr>
<th>对比维度</th>
<th>Anaconda</th>
<th>conda</th>
</tr>
</thead>
<tbody><tr>
<td><strong>本质</strong></td>
<td>集成平台（含Python、工具、预装包）</td>
<td>包与环境管理工具</td>
</tr>
<tr>
<td><strong>包含关系</strong></td>
<td>内置conda，是conda的“载体”之一</td>
<td>是Anaconda的核心组件，也可独立安装</td>
</tr>
<tr>
<td><strong>核心功能</strong></td>
<td>提供完整的数据科学开发环境（一键启动）</td>
<td>管理包（安装&#x2F;卸载）、管理环境（创建&#x2F;切换）</td>
</tr>
<tr>
<td><strong>独立使用</strong></td>
<td>无法拆分，是完整的安装包</td>
<td>可单独安装（如Miniconda，仅含conda和Python）</td>
</tr>
</tbody></table>
<h3 id="3-那Python的“库”又是什么呢"><a href="#3-那Python的“库”又是什么呢" class="headerlink" title="3.那Python的“库”又是什么呢"></a>3.那Python的“库”又是什么呢</h3><p>在Python中，“库”（Library）是一系列预先编写好的代码集合，包含了函数、类、变量等，用于实现特定功能，方便开发者直接调用，无需重复编写基础代码。</p>
<p>简单说，库就像一个“工具包”：</p>
<ul>
<li>比如处理数据的<code>pandas</code>库，封装了表格处理、数据分析的常用功能</li>
<li>用于绘图的<code>matplotlib</code>库，提供了各种图表绘制的现成方法</li>
<li>网络请求的<code>requests</code>库，简化了网页数据获取的过程</li>
</ul>
<p>这些库由Python社区或开发者团队维护，通过<code>pip install 库名</code>或<code>conda install 库名</code>等命令安装后，就能在代码中用<code>import</code>导入并使用，极大提高开发效率。这两个命令在本文后面还会讲到。</p>
<p>库可以理解为Python生态的“积木”，开发者通过组合不同库，快速搭建复杂应用，而不必从零开始编写每一行代码。</p>
<p>这也就是为什么Python越来越火，因为使用Python实现一个功能不要求你从0开始编写代码，你只需要在互联网上找到你想调用的库，简要学习一下如何调用，便可整合到你的程序中去。</p>
<p>安装Anaconda有两个下载途径</p>
<h3 id="1-官网下载（不推荐）"><a href="#1-官网下载（不推荐）" class="headerlink" title="1.官网下载（不推荐）"></a>1.官网下载（不推荐）</h3><p><img data-src="/./../images/image-20251001201513671.png" alt="image-20251001201513671"></p>
<p>官方下载链接为<a href="https://www.anaconda.com/download">Download Anaconda Distribution | Anaconda</a></p>
<p>理论上点击Get Started便可以开始下载，但是事实并非如此。在点击Get Started之后，你需要注册账户，且下载源来自国外，在国内下载速度不稳定，因为相对繁琐，所以不推荐此方法。</p>
<h3 id="2-从清华大学开源软件镜像站下载"><a href="#2-从清华大学开源软件镜像站下载" class="headerlink" title="2.从清华大学开源软件镜像站下载"></a>2.从清华大学开源软件镜像站下载</h3><p>首先先解答一个问题：何为镜像站？</p>
<p>这类镜像站的核心作用是<strong>缓存并分发开源软件资源</strong>，让用户能更快速、稳定地获取所需文件。</p>
<p>这类站点在开发者和高校用户中非常常用。它的存在主要解决了三个核心问题：</p>
<ol>
<li><strong>提升下载速度</strong>：很多开源软件的官方服务器位于国外，国内用户直接访问会受网络链路影响，速度很慢。镜像站将这些资源同步到国内服务器，用户从国内站点下载，速度会提升数倍甚至数十倍。</li>
<li><strong>保障访问稳定性</strong>：官方服务器可能因地域、带宽或维护等原因出现宕机或访问不稳定的情况。国内部分镜像站多采用多节点部署，能有效避免一个服务器故障导致下载出现问题，确保用户随时能获取资源。</li>
<li><strong>降低官方服务器压力</strong>：全球大量用户同时从官方服务器下载，会对其造成巨大带宽压力。镜像站通过分担下载请求，帮助官方服务器减轻负载，保障其核心服务的稳定。</li>
</ol>
<p>简单来说，镜像站就像一个“本地仓库”。它定期从“总仓库”（官方服务器）进货，当你需要时，不用再去遥远的“总仓库”，直接在“本地仓库”就能快速拿到一样的东西。</p>
<p>在Linux中，包管理器类似apt，yum，pacman都需要我们手动换源以加快下载速度。</p>
<p>点击下面链接即可访问镜像站：</p>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/">清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a></p>
<p>在镜像站首页，可以看到有很多仓库，这里我们需要找到并点击anaconda，进入achieve目录，按日期排序，找到符合我们系统（Windows）和架构（x86_64）的最新版本，点击就可以进行下载了。下面是个简单的动图，展示了如何找到我们所需的发行版安装包：</p>
<p><img data-src="/./../images/0001.gif" alt="0001"></p>
<p>在本文编辑完成之前，对于Windows系统而言，最新版本的软件包是“Anaconda3-2025.06-1-Windows-x86_64.exe”，如果您是通过电脑阅读本文，也可点击下面链接下载安装程序：<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-2025.06-1-Windows-x86_64.exe">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-2025.06-1-Windows-x86_64.exe</a></p>
<p>下载完成，自然是要进行安装。不过，安装并不是无脑地点击Next和Agree，有些选项也是需要进行选择的。</p>
<p>运行安装程序（双击Anaconda3-2025.06-1-Windows-x86_64.exe），等待安装程序加载完成后，您会看到下面画面：</p>
<p><img data-src="/./../images/image-20251001203216213.png" alt="image-20251001203216213"></p>
<p>这里点击“Next &gt;”，进行下一步</p>
<p><img data-src="/./../images/image-20251001203243953.png" alt="image-20251001203243953"></p>
<p>“I Agree”</p>
<p><img data-src="/./../images/image-20251001203311320.png" alt="image-20251001203311320"></p>
<p>这里默认是“Just Me”，不过我们要把它改成“All Users”，然后点击“Next &gt;”，这里也许会弹出UAC弹窗，选择“是”即可。</p>
<p><img data-src="/./../images/image-20251001203428718.png" alt="image-20251001203428718"></p>
<p>这一步让我们选择安装目录。我们可以看到，安装Anaconda需要5.2GB的空间，图示电脑C盘还剩余106.1GB，这里我们可以按照默认安装位置安装，如果你的C盘空间紧张或是对于存储空间有所规划，可以选择安装到其他盘。如果要安装到其他盘，建议目标文件夹是<code>D:\anaconda3</code>。不允许安装到含有中文的目录中，例如<code>D:\软件\anaconda3</code>，大多数程序对于中文路径的处理并不完善，极易出现bug甚至程序崩溃。本文中安装文件夹将以<code>C:\ProgramData\anaconda3</code>为例。需要注意的是，<strong>你需要记住这个安装目录</strong>，后续操作会用到此安装目录。选择好安装目录后点击“Next &gt;”继续。</p>
<p><img data-src="/./../images/image-20251001204116315.png" alt="image-20251001204116315"></p>
<p>此处默认只有第一个复选框被选中，我们要把三个都勾选上，然后点击“Install”</p>
<p>由于释放文件较多，安装时间略长，耐心等待即可……</p>
<p><img data-src="/./../images/image-20251001204611527.png" alt="image-20251001204611527"></p>
<p>出现Completed代表安装结束，此时点击“Next &gt;”</p>
<p><img data-src="/./../images/image-20251001204656068.png" alt="image-20251001204656068"></p>
<p>会出现以下界面，点击“Next &gt;”进行下一步。</p>
<p><img data-src="/./../images/image-20251001204731723.png" alt="image-20251001204731723"></p>
<p>到了最后一步，将这两个默认勾选的复选框取消勾选（用不到），然后点击退出。</p>
<p> 至此我们Anaconda的安装告一段落了，但是接下来我们还要对其进行配置，否则我们无法正常使用。</p>
<h2 id="Anaconda的配置"><a href="#Anaconda的配置" class="headerlink" title="Anaconda的配置"></a>Anaconda的配置</h2><h3 id="修改系统变量"><a href="#修改系统变量" class="headerlink" title="修改系统变量"></a>修改系统变量</h3><p>此时安装完成的Anaconda并没有加入系统的环境变量中，这将导致我们没法在终端（命令提示符即cmd）直接调用，于是我们需要对其进行配置。</p>
<ul>
<li><p><strong>打开系统属性</strong> 在 Windows 系统中，右键点击“此电脑”或“我的电脑”，选择“属性”。然后点击“高级系统设置”，进入“环境变量”设置界面。（或者直接在开始菜单的搜索框中搜索“<strong>系统变量</strong>”（其实完整名字是“编辑系统环境变量”））</p>
</li>
<li><p><strong>编辑系统变量中的 Path</strong> 在“系统变量”部分找到 <em>Path</em>，点击“编辑”。在弹出的窗口中，点击“新建”，添加以下路径（假设 Anaconda 安装在 <em>C:\ProgramData\anaconda3</em>）：</p>
</li>
</ul>
<figure class="highlight moonscript"><table><tr><td class="code"><pre><span class="line"><span class="name">C</span>:\ProgramData\anaconda3</span><br><span class="line"><span class="name">C</span>:\ProgramData\anaconda3\Scripts</span><br><span class="line"><span class="name">C</span>:\ProgramData\anaconda3\Library\bin</span><br><span class="line"><span class="name">C</span>:\ProgramData\anaconda3\Library\mingw-w64\bin</span><br></pre></td></tr></table></figure>

<p>当然，如果你安装在了D:\anaconda3，那么路径应该是这样的</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">D:</span>\anaconda3</span><br><span class="line"><span class="symbol">D:</span>\anaconda3\Scripts</span><br><span class="line"><span class="symbol">D:</span>\anaconda3\Library\bin</span><br><span class="line"><span class="symbol">D:</span>\anaconda3\Library\mingw-w64\bin</span><br></pre></td></tr></table></figure>

<p>关于如何添加，下面有个动图进行演示：</p>
<p><img data-src="/./../images/0002.gif" alt="0002"></p>
<p>需要注意的关键点：</p>
<ul>
<li><p>编辑的是“系统变量”而非“用户变量”</p>
</li>
<li><p>编辑完成一定要点三次确定，确保窗口完全关闭！</p>
</li>
</ul>
<p>如何确定自己已经正确配置了环境变量？</p>
<p><img data-src="/./../images/0003.gif" alt="0003"></p>
<p>按Win + R键（或者右键开始菜单图标点击“运行”），在弹出的“运行”对话框中输入cmd并回车，在弹出的命令提示符中输入（V要大写）</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">conda -V</span></span><br></pre></td></tr></table></figure>

<p>若如下图所示输出则环境变量配置成功。</p>
<p><img data-src="/./../images/image-20251001210033489.png" alt="image-20251001210033489"></p>
<p>如图，conda输出了它的版本号：25.5.1</p>
<p>这代表Anaconda已经安装完成，恭喜！</p>
<h3 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h3><p>没错，还是更换镜像源，具体优点与好处上文已经提及，不再赘述。</p>
<p>将以下代码复制到上一步骤所示命令提示符中执行，便可更换镜像源为清华源</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>pkgs<span class="regexp">/free/</span></span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>pkgs<span class="regexp">/main/</span></span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/pytorch/</span></span><br><span class="line">conda config --add channels https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>cloud<span class="regexp">/pytorch/</span>linux-<span class="number">64</span>/</span><br><span class="line">conda config --set show_channel_urls yes</span><br></pre></td></tr></table></figure>

<p>如下图所示：</p>
<p><img data-src="/./../images/0004.gif" alt="0004"></p>
<p>验证配置是否成功，可以使用命令</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">conda</span> <span class="literal">info</span></span><br></pre></td></tr></table></figure>

<p>查看。在channel URLs一项中出现了很多清华源，则配置成功！</p>
<p><img data-src="/./../images/image-20251001210512992.png" alt="image-20251001210512992"></p>
<p>至此，Anaconda配置结束。</p>
<h2 id="Conda命令介绍"><a href="#Conda命令介绍" class="headerlink" title="Conda命令介绍"></a>Conda命令介绍</h2><p>在实际使用conda之前，我们首先要进入<strong>Anaconda Prompt</strong>环境。注意这个程序不会直接在你的桌面上创建快捷方式，你需要在开始菜单——A字母开头——Anaconda3文件夹中找到它。你也可以在开始菜单的搜索框中直接搜索<strong>Anaconda Prompt</strong>打开它。打开它应该是这样的：</p>
<p><img data-src="/./../images/image-20251001212237025.png" alt="image-20251001212237025"></p>
<p>注意到与平常使用的命令提示符存在不同——最前面有个（base）！这个其实是在提醒你当前是在默认的环境中。接下来我们便需要创建一个新的环境。在控制台中执行：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">conda</span> create -n name python=<span class="number">3</span>.<span class="number">13</span></span><br></pre></td></tr></table></figure>

<p>create便是”创建“，意味着我们要创建一个环境了。</p>
<p><strong>-n</strong>其实是**–name**的缩写，使用哪个都可以，但要在其后加上参数即环境名称。这条指令便可创建一个Python环境。</p>
<p>这时你可能要问了：为什么我要创建一个Python环境呢？</p>
<p>用conda创建Python环境，核心是为了解决不同项目间的<strong>依赖冲突</strong>，让每个项目都能在独立、干净的环境中运行。</p>
<p>这个问题提得很实用，很多Python初学者都会因为环境问题踩坑。conda创建环境的必要性，主要体现在以下3点：</p>
<h3 id="1-解决依赖版本冲突"><a href="#1-解决依赖版本冲突" class="headerlink" title="1. 解决依赖版本冲突"></a>1. 解决依赖版本冲突</h3><p>不同Python项目可能需要同一库的不同版本。</p>
<ul>
<li>例如，项目A需要<code>numpy 1.20</code>版本，而项目B必须用<code>numpy 1.18</code>版本。</li>
<li>如果不隔离环境，安装高版本会导致低版本项目报错，反之亦然。</li>
<li>conda能为每个项目单独安装所需版本的库，互不干扰。</li>
</ul>
<h3 id="2-保持系统环境干净"><a href="#2-保持系统环境干净" class="headerlink" title="2. 保持系统环境干净"></a>2. 保持系统环境干净</h3><p>直接在系统默认Python环境安装库，会导致：</p>
<ul>
<li>安装的库越来越多，难以管理。</li>
<li>误删或升级某个库，可能影响系统自带程序（部分系统工具依赖Python）。</li>
<li>conda创建的环境是独立目录，删除环境时能彻底清理所有相关文件，不残留垃圾。</li>
</ul>
<h3 id="3-方便项目迁移与协作"><a href="#3-方便项目迁移与协作" class="headerlink" title="3. 方便项目迁移与协作"></a>3. 方便项目迁移与协作</h3><p>当需要和他人协作或在新电脑上运行项目时：</p>
<ul>
<li>可以用conda导出当前环境的依赖列表（<code>environment.yml</code>文件）。</li>
<li>他人只需通过该文件，就能一键复现完全相同的环境，避免“我这能跑，你那报错”的问题。</li>
</ul>
<p>简而言之，创建不同的Python本质上就是为了“隔离”，你可能有很多个Python项目要跑，而这些项目对于库与依赖的要求各不相同，甚至会起冲突，于是你便需要创建不同的环境把它们隔离开咯~</p>
<p>话说回来，起什么名字还是需要自己依照实际需求起。这里为了演示方便，我便起名“test”了。后面的<strong>python&#x3D;3.13</strong>是为了指定这个环境所使用的Python版本。输入完成后，敲击回车便开始创建环境了。</p>
<p>（tips：如果你的用户主文件夹是中文的话在这一步会创建不了环境哦（回收开头））</p>
<p><img data-src="/./../images/image-20251001211623674.png" alt="image-20251001211623674"></p>
<p>出现此提示，输入<strong>y</strong>之后回车或者直接回车确认安装这些软件包。</p>
<p><img data-src="/./../images/image-20251001212512068.png" alt="image-20251001212512068"></p>
<p>创建完成！左上角提示<strong>done</strong>便是最好的证明。conda也贴心地为我们贴出来了两条指令。我们便接着这两条指令说下去：</p>
<p>首先是</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">conda <span class="built_in">activate</span> &lt;你的环境名&gt;</span><br></pre></td></tr></table></figure>

<p>activate不必多说，激活嘛。我们输入这行命令并回车，便出现了以下变化：</p>
<p><img data-src="/./../images/image-20251001212747620.png" alt="image-20251001212747620"></p>
<p>注意到前面的标志换了！这表明我们已经切换到test环境下了！</p>
<p>要想从test环境回到默认的base环境，只需输入</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">conda deactivate</span></span><br></pre></td></tr></table></figure>

<p>并回车即可回到base环境。</p>
<p><img data-src="/./../images/image-20251001212935407.png" alt="image-20251001212935407"></p>
<p>使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda <span class="built_in">env</span> list</span><br></pre></td></tr></table></figure>

<p>便可列出当前存在的所有环境。</p>
<p>使用</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">conda env <span class="built_in">remove</span> -n &lt;你的环境名&gt;</span><br></pre></td></tr></table></figure>

<p>便可移除你创建的环境。-n也可写作–name</p>
<p>在你想使用的环境中（例如刚创建的test环境），使用</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">conda install <span class="tag">&lt;<span class="name">库名</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>来安装你想要安装的库，例如安装numpy库，见下图：</p>
<p><img data-src="/./../images/0005.gif" alt="0005"></p>
<p>同样的，程序会询问你是否安装，输入y并回车或者直接回车就可以安装。</p>
<p>以上仅说明了基本的conda命令，如果想了解更多命令，请访问：</p>
<p><a href="https://www.runoob.com/python-qt/anaconda-tutorial.html">Anaconda 教程 | 菜鸟教程</a></p>
<h2 id="pip换源"><a href="#pip换源" class="headerlink" title="pip换源"></a>pip换源</h2><p>pip同样也是一个Python包管理器。为了加速下载速度，我们同样可以换源来加速下载。</p>
<p>按Win + R打开cmd（命令提示符），右键输入下面代码并回车即可完成换源。</p>
<p><img data-src="/./../images/0006.gif" alt="0006"></p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">mkdir %APPDATA%\pip &amp;&amp; (echo [<span class="keyword">global</span>] &amp; echo <span class="keyword">index</span>-url = https://pypi.tuna.tsinghua.edu.cn/simple/ &amp; echo <span class="keyword">trusted</span>-host = pypi.tuna.tsinghua.edu.cn) &gt; %APPDATA%\pip\pip.ini</span><br></pre></td></tr></table></figure>

<h2 id="PyCharm的安装"><a href="#PyCharm的安装" class="headerlink" title="PyCharm的安装"></a>PyCharm的安装</h2><p>PyCharm 是 JetBrains 公司开发的一款专业 Python 集成开发环境（IDE），主要特点如下：</p>
<ol>
<li><p><strong>功能全面</strong>：集成代码编辑、调试、测试、版本控制（Git 等）、数据库工具等，一站式满足 Python 开发需求。</p>
</li>
<li><p><strong>智能辅助</strong>：提供代码自动补全、语法高亮、错误提示、重构建议等功能，大幅提升编码效率。</p>
</li>
<li><p><strong>环境兼容</strong>：完美支持虚拟环境（如 conda、venv），可快速切换不同项目的运行环境。</p>
</li>
<li><p><strong>扩展性强</strong>：通过插件市场支持 Django、Flask 等框架开发，以及 JavaScript、HTML 等多语言混合编程。</p>
</li>
<li><p><strong>跨平台</strong>：支持 Windows、macOS、Linux 系统，适合不同操作系统的开发者。</p>
</li>
</ol>
<p>适合从入门到专业的各类 Python 开发场景，是目前最流行的 Python IDE 之一。</p>
<p>在这里，我们使用PyCharm的社区版而非专业版。</p>
<p>在下载页面<a href="https://www.jetbrains.com/zh-cn/pycharm/download/other.html">其他版本 - PyCharm</a>中找到<strong>PyCharm Community Edition</strong>一栏，找到**<a href="https://download.jetbrains.com/python/pycharm-community-2025.2.2.exe">2025.2.2 - Windows (exe)</a>**一项并点击下载。如果您使用电脑阅读本文，可直接点击链接下载。本文编辑完成前，PyCharm版本为2025.2.2。</p>
<p>等待其下载完成后，双击安装程序进行安装。等待安装程序加载完成后，应该向您询问UAC权限，选”是“即可。</p>
<p><img data-src="/./../images/image-20251001215019891.png" alt="image-20251001215019891"></p>
<p>”下一步“</p>
<p><img data-src="/./../images/image-20251001215036969.png" alt="image-20251001215036969"></p>
<p>可以选择更改一个你喜欢的位置，这里我仍然选择不做修改，如果你要修改，切记不要装在有中文的目录下，最保险的做法就是把这串安装路径的“C:\”改为“D:\”。</p>
<p><img data-src="/./../images/image-20251001215229683.png" alt="image-20251001215229683"></p>
<p>这一页默认所有复选框都没被勾选，按图示勾选这三个即可。点击两次下一步后即可开始安装。安装完成后启动PyCharm。</p>
<p><img data-src="/./../images/image-20251001215632715.png" alt="image-20251001215632715"></p>
<p>中文就非常不错，直接下一个！</p>
<p><img data-src="/./../images/image-20251001215659091.png" alt="image-20251001215659091"></p>
<p>同意条款后继续</p>
<p><img data-src="/./../images/image-20251001215716667.png" alt="image-20251001215716667"></p>
<p>不发送</p>
<p>如果你之前安装过其他编辑器，会询问你是否导入，选择不导入即可。</p>
<h2 id="PyCharm的界面说明及使用方法"><a href="#PyCharm的界面说明及使用方法" class="headerlink" title="PyCharm的界面说明及使用方法"></a>PyCharm的界面说明及使用方法</h2><p>此内容实在复杂，请移步菜鸟教程查看（doge），但在查看之前，请先配置好Python解释器（下一节内容）</p>
<p><a href="https://www.runoob.com/pycharm/pycharm-tutorial.html">PyCharm 教程 | 菜鸟教程</a></p>
<p><a href="https://www.runoob.com/pycharm/pycharm-first-python-project.html">PyCharm 创建第一个 Python 项目 | 菜鸟教程</a></p>
<p><a href="https://www.runoob.com/pycharm/pycharm-start-intro.html">PyCharm 界面说明 | 菜鸟教程</a></p>
<p><a href="https://www.runoob.com/pycharm/pycharm-run-debug.html">PyCharm 运行与调试 | 菜鸟教程</a></p>
<h2 id="PyCharm的Python解释器配置"><a href="#PyCharm的Python解释器配置" class="headerlink" title="PyCharm的Python解释器配置"></a>PyCharm的Python解释器配置</h2><p>点击PyCharm主界面左下角的小齿轮图标，在弹出的二级菜单中点击设置，找到页面最上方的<strong>Python</strong>（注：不需要点”&gt;”使之展开，在右边的页面中点击“解释器”</p>
<p><img data-src="/./../images/image-20251001220009405.png" alt="image-20251001220009405"></p>
<p><img data-src="/./../images/image-20251001220049389.png" alt="image-20251001220049389"></p>
<p>点击<strong>添加解释器</strong>——<strong>添加本地解释器</strong></p>
<p>环境——<strong>选择现有</strong></p>
<p>类型——选<strong>Conda</strong></p>
<p>如果你在安装Anaconda时没有改变安装目录，那么你的PyCharm可能已经默认认到了解释器，更改一下环境即可点击确定退出。假如你将Anaconda安装在了D:\anaconda3，那么你需要在conda的路径一栏填写D:\anaconda3\condabin\conda.bat，然后点击蓝色的<strong>重新加载环境</strong>，便可正常识别环境。</p>
<h2 id="Python的学习"><a href="#Python的学习" class="headerlink" title="Python的学习"></a>Python的学习</h2><p>可以选择观看视频（耗时较长），建议可以先看文字教程了解基本语法，然后使用AI辅助生成代码</p>
<p><a href="https://www.runoob.com/python3/python3-tutorial.html">Python3 教程 | 菜鸟教程</a></p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Windows</tag>
        <tag>PyCharm</tag>
        <tag>Anaconda</tag>
      </tags>
  </entry>
  <entry>
    <title>将Windows中文用户主文件夹修改为英文</title>
    <url>/2025/10/03/Change-the-Windows-Chinese-user-home-folder-to-English/</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在Windows下，部分软件对于中文目录的适配性并不完整，导致程序无法正常运行或是出现一堆奇奇怪怪的报错。大部分软件会要求你选择一个非中文目录，但是由于部分软件的用户配置数据存储在了用户文件夹下，而用户文件夹的名字一般由Windows自动配置，若我们在OOBE阶段设置了中文名，则用户主文件夹也将是中文名，不利于后续操作。因此本教程将向您介绍在不重装系统、不创建新用户的情况下修改用户主文件夹名。</p>
<h2 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h2><p>如何判断自己的用户主文件夹名是否为中文？<br>若您在Windows的OOBE阶段（激活）使用了Microsoft账户登录，那么您的用户主文件夹应该为邮箱前缀。您无需继续浏览本教程。<br>若您在Windows的OOBE阶段（激活）使用了<strong>oobe\bypassnro</strong>跳过联网而创建本地用户，并为账户起了中文名，那么您将会拥有一个中文用户主文件夹，正如下图所示：</p>
<p><img data-src="/./../images/image-20251003084919376.png" alt="image-20251003084919376"></p>
<p>如果您已经忘记了自己如何激活的Windows，那么您可以转到<strong>C:\Users</strong>文件夹下进行判断。在文件资源管理器中，<strong>User</strong>文件夹一般显示为中文<strong>用户</strong>。如下图所示：</p>
<p><img data-src="/./../images/image-20251003085747561.png" alt="image-20251003085747561"></p>
<p>图示“姓名”不合规的中文主文件夹，现在我们将对其进行修改，使之变为英文文件夹</p>
<p><strong>注意！以下操作存在极大风险！可能导致部分软件无法使用需要重装！</strong></p>
<h2 id="创建还原点"><a href="#创建还原点" class="headerlink" title="创建还原点"></a>创建还原点</h2><p>对系统做这么大手术，当然需要创建一个还原点了，方便恢复修改前状态。在Windows开始菜单搜索框中搜索<strong>还原点</strong></p>
<p><img data-src="/./../images/image-20251003090032036.png" alt="image-20251003090032036"></p>
<p>即可找到创建还原点选项。</p>
<p>首先先点击<strong>配置</strong>启用系统保护（若已启用则忽略）</p>
<p><img data-src="/./../images/image-20251003090225081.png" alt="image-20251003090225081"></p>
<p>然后点击<strong>创建</strong>，名字随意，创建一个还原点。</p>
<p><img data-src="/./../images/image-20251003090322343.png" alt="image-20251003090322343"></p>
<p>耐心等待还原点创建完成，然后点击<strong>确定</strong>关闭所有窗口。</p>
<h2 id="启用Administrator账户"><a href="#启用Administrator账户" class="headerlink" title="启用Administrator账户"></a>启用Administrator账户</h2><p>右键开始菜单的微软徽标，点击<strong>终端管理员</strong></p>
<p><img data-src="/./../images/image-20251003090715686.png" alt="image-20251003090715686"></p>
<p>在出现的终端中输入命令并回车</p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> user administrator /active:yes</span><br></pre></td></tr></table></figure>

<p>执行后，屏幕会提示“命令成功完成”，说明Administrator账号已启用。如下图所示：</p>
<p><img data-src="/./../images/image-20251003090912298.png" alt="image-20251003090912298"></p>
<h2 id="切换Administrator账户并注销原账户"><a href="#切换Administrator账户并注销原账户" class="headerlink" title="切换Administrator账户并注销原账户"></a>切换Administrator账户并注销原账户</h2><p><img data-src="/./../images/202510030001.gif" alt="202510030001"></p>
<p>将所有选项取消勾选</p>
<p><img data-src="/./../images/image-20251003091504362.png" alt="image-20251003091504362"></p>
<p>进入桌面后，切回原用户，注销后再登录Administrator账户。</p>
<p><img data-src="/./../images/202510030002.gif" alt="202510030002"></p>
<h2 id="重命名用户主文件夹"><a href="#重命名用户主文件夹" class="headerlink" title="重命名用户主文件夹"></a>重命名用户主文件夹</h2><p>现在转到<strong>C:\Users</strong>，修改原来的中文用户主文件夹文件名为英文，可能会提示“操作无法完成，因为文件或文件夹已在其他程序中打开”。</p>
<h2 id="处理文件夹占用"><a href="#处理文件夹占用" class="headerlink" title="处理文件夹占用"></a>处理文件夹占用</h2><p>Win + R打开cmd，执行以下命令（替换“用户名”为你实际的用户名）</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> /f &quot;skip=<span class="number">1</span> tokens=<span class="number">3</span>&quot; %s <span class="keyword">in</span> (&#x27;query user 用户名&#x27;) <span class="keyword">do</span> <span class="built_in">taskkill</span> /f /fi &quot;sessionname eq %s&quot;</span><br></pre></td></tr></table></figure>

<p>杀死进程后再次修改。</p>
<h2 id="修改注册表"><a href="#修改注册表" class="headerlink" title="修改注册表"></a>修改注册表</h2><p>按Win + R输入regedit并回车打开注册表编辑器</p>
<p>在上方输入框中输入</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList</span><br></pre></td></tr></table></figure>

<p>在此路径下还有很多以S开头的目录，挨个排查，直到找到右边的<strong>ProfileImagePath</strong>为中文的目录，如下图</p>
<p><img data-src="/./../images/image-20251003093307131.png" alt="image-20251003093307131"></p>
<p>双击<strong>ProfileImagePath</strong>条目修改，将中文替换为您刚修改的英文文件夹名称。</p>
<p>在上方输入框中输入</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\UserManager\Users</span><br></pre></td></tr></table></figure>

<p>找到包含中文用户名的数字项(<strong>UserPicture</strong>)，双击对应的键值，将中文用户名改为英文全拼，点击“确定”</p>
<h2 id="关闭Administrator账户"><a href="#关闭Administrator账户" class="headerlink" title="关闭Administrator账户"></a>关闭Administrator账户</h2><p>按Win + R打开终端，输入命令并回车，关闭Administrator账户</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> user administrator /active:no</span><br></pre></td></tr></table></figure>

<p><img data-src="/./../images/image-20251003093749028.png" alt="image-20251003093749028"></p>
<p>提示“命令成功完成”后，注销Administrator账号，回到登录页面。</p>
<h2 id="更新环境变量"><a href="#更新环境变量" class="headerlink" title="更新环境变量"></a><strong>更新环境变量</strong></h2><p>登录回原用户后，搜索<strong>环境变量</strong>，编辑<strong>用户</strong>环境变量</p>
<p><img data-src="/./../images/image-20251003093857619.png" alt="image-20251003093857619"></p>
<p>接下来要对<strong>用户变量</strong>进行操作，首先把OneDrive的变量进行修改，将原来的中文文件夹名改为你原来的英文文件夹名。</p>
<p>然后单击<strong>Path</strong>条目，点击<strong>编辑</strong>，检查所有包含中文用户名的路径，将条目中原来的中文文件夹名改为你原来的英文文件夹名。</p>
<p>连续点击三个<strong>确定</strong>，完成环境变量编辑。</p>
<h2 id="更新用户账户信息（可选）"><a href="#更新用户账户信息（可选）" class="headerlink" title="更新用户账户信息（可选）"></a>更新用户账户信息（可选）</h2><p>如果你想一并把显示的用户信息进行修改，请完成以下操作。</p>
<p>按Win + R，输入</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">control userpasswords2</span><br></pre></td></tr></table></figure>

<p><img data-src="/./../images/image-20251003094407027.png" alt="image-20251003094407027"></p>
<p>对其进行修改，点两次<strong>确定</strong>退出即可。</p>
<h2 id="创建符号链接"><a href="#创建符号链接" class="headerlink" title="创建符号链接"></a>创建符号链接</h2><p>部分软件可能认死理，这时我们要照顾这些软件的情绪，想办法让它们读到文件。</p>
<p>右键开始菜单的微软徽标，点击<strong>终端管理员</strong></p>
<p>对下方命令按照实际情况进行修改后，在出现的终端中输入命令并回车</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cmd</span></span><br><span class="line"></span><br><span class="line">mklink /d &quot;C:\Users\用户&quot; &quot;C:\Users\User&quot;</span><br></pre></td></tr></table></figure>

<p>这会将旧用户名路径链接到新路径，解决软件路径报错问题。</p>
<h2 id="重启"><a href="#重启" class="headerlink" title="重启"></a>重启</h2><p>确保全部操作完成后重启计算机，如果正常进入桌面，那么基本没有什么问题了</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><ul>
<li>备份重要数据：修改用户名涉及注册表操作，建议提前备份重要文件，以防万一。单纯仅仅创建还原点是不够的，还原点只可备份当前系统配置文件</li>
<li>谨慎操作注册表：确保按照步骤修改，避免误删关键项。</li>
<li>软件路径问题：部分软件可能仍需重新安装，确保路径正确。</li>
<li>桌面文件丢失：如果重启后桌面只剩“此电脑”和“回收站”，用符号链接方法即可恢复。</li>
</ul>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Python学习笔记其一</title>
    <url>/2025/10/01/Python0001/</url>
    <content><![CDATA[<p>相关教程：</p>
<p><a href="https://www.runoob.com/python3/python3-conditional-statements.html">Python3 条件控制 | 菜鸟教程</a></p>
<p><a href="https://www.runoob.com/python3/python3-loop.html">Python3 循环语句 | 菜鸟教程</a></p>
<p>使用for求1-100的和：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    <span class="built_in">sum</span> += i</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sum</span>)</span><br></pre></td></tr></table></figure>

<p>使用while求1-100的和：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">101</span>:</span><br><span class="line">    <span class="built_in">sum</span> += i</span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>排除1-100中含有“7”的数并求和：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    <span class="keyword">if</span> i // <span class="number">10</span> == <span class="number">7</span> <span class="keyword">or</span> i % <span class="number">10</span> == <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">sum</span> += i</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sum</span>)</span><br></pre></td></tr></table></figure>

<p>亦可通过while实现：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">101</span>:</span><br><span class="line">    <span class="keyword">if</span> i // <span class="number">10</span> == <span class="number">7</span> <span class="keyword">or</span> i % <span class="number">10</span> == <span class="number">7</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">sum</span> += i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sum</span>)</span><br></pre></td></tr></table></figure>

<p>亦可通过将i转化为字符串排除实现：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    a = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;7&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> a:</span><br><span class="line">        <span class="built_in">sum</span> += i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sum</span>)</span><br></pre></td></tr></table></figure>

<p>遇到的坑：</p>
<ul>
<li>for、if、elif、else、while语句要加:（冒号）</li>
<li>在for或者while进行完if判断后需要对i进行自增，否则进入死循环</li>
<li>continue为略过，break为中断，pass仅占位（debug用）</li>
</ul>
]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>MATLAB基础作业其一</title>
    <url>/2025/10/18/MATLAB0001/</url>
    <content><![CDATA[<h1 id="MATLAB-基础第一次作业"><a href="#MATLAB-基础第一次作业" class="headerlink" title="MATLAB 基础第一次作业"></a>MATLAB 基础第一次作业</h1><h2 id="一、基础巩固题（每题8-分，共4-题，满分32-分）"><a href="#一、基础巩固题（每题8-分，共4-题，满分32-分）" class="headerlink" title="一、基础巩固题（每题8 分，共4 题，满分32 分）"></a>一、基础巩固题（每题8 分，共4 题，满分32 分）</h2><p><strong>目标：熟练掌握MATLAB 的基本运算规则、变量赋值及简单函数使用。</strong></p>
<h3 id="1-温度转换计算"><a href="#1-温度转换计算" class="headerlink" title="1. 温度转换计算"></a>1. 温度转换计算</h3><p>  编写代码将25 摄氏度转换为华氏度，转换公式为F &#x3D; C × 9&#x2F;5 + 32。要求：定义变量C 存储摄氏度数值，计算后输出结果（保留1 位小数）。</p>
<p>MATLAB代码：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 定义摄氏度变量</span></span><br><span class="line">C = <span class="number">25</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 根据公式计算华氏度</span></span><br><span class="line">F = C * <span class="number">9</span>/<span class="number">5</span> + <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出结果，保留1位小数</span></span><br><span class="line">fprintf(<span class="string">&#x27;25摄氏度转换为华氏度是: %.1f°F\n&#x27;</span>, F);</span><br></pre></td></tr></table></figure>

<p>运行结果截图：</p>
<p><img data-src="/./../images/image-20251018131426548.png" alt="image-20251018131426548"></p>
<p>命令行输出：</p>
<blockquote>
<p>&gt;&gt; h1_1</p>
<p>25摄氏度转换为华氏度是: 77.0°F</p>
</blockquote>
<h3 id="2-简单表达式求值"><a href="#2-简单表达式求值" class="headerlink" title="2. 简单表达式求值"></a>2. 简单表达式求值</h3><p>计算表达式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msqrt><mn>16</mn></msqrt><mo>+</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>10</mn></msub><mo stretchy="false">(</mo><mn>1000</mn><mo stretchy="false">)</mo><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mi>π</mi><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><mrow><msup><mn>2</mn><mn>3</mn></msup><mo>−</mo><mn>5</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\sqrt{16} + \log_{10}(1000) - \sin(\frac{\pi}{2})}{2^3 - 5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5931em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1898em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">5</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5508em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">16</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span style="top:-2.2341em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2659em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1000</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mop mtight"><span class="mtight">s</span><span class="mtight">i</span><span class="mtight">n</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6915em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>的值。要求：使用MATLAB 内置函数（sqrt、log10、sin、pi）计算，直接输出结果。</p>
<p>MATLAB代码：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 计算分子部分</span></span><br><span class="line">numerator = <span class="built_in">sqrt</span>(<span class="number">16</span>) + <span class="built_in">log10</span>(<span class="number">1000</span>) - <span class="built_in">sin</span>(<span class="built_in">pi</span>/<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 计算分母部分</span></span><br><span class="line">denominator = <span class="number">2</span>^<span class="number">3</span> - <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 计算整个表达式的值</span></span><br><span class="line">result = numerator / denominator;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出结果</span></span><br><span class="line"><span class="built_in">disp</span>(result);</span><br></pre></td></tr></table></figure>

<p>运行结果截图：</p>
<p><img data-src="/./../images/image-20251018131827586.png" alt="image-20251018131827586"></p>
<p>命令行输出：</p>
<blockquote>
<p>&gt;&gt; h1_2</p>
<p>​     2</p>
</blockquote>
<h3 id="3-矩阵创建与输出"><a href="#3-矩阵创建与输出" class="headerlink" title="3. 矩阵创建与输出"></a>3. 矩阵创建与输出</h3><p>创建一个3×3 的矩阵A，元素为1-9 的递增整数（第一行1-3，第二行4-6，第三行7-9），再创建一个3×1 的列向量B（元素为[2;4;6]），最后分别输出矩阵A 和向量B。</p>
<p>MATLAB代码：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 创建 3×3 矩阵 A</span></span><br><span class="line">A = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>; <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>; <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 创建 3×1 列向量 B</span></span><br><span class="line">B = [<span class="number">2</span>; <span class="number">4</span>; <span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出矩阵 A</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;矩阵 A:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(A);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出向量 B</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;列向量 B:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(B);</span><br></pre></td></tr></table></figure>

<p>运行结果截图：</p>
<p><img data-src="/./../images/image-20251018132020159.png" alt="image-20251018132020159"></p>
<p>命令行输出：</p>
<blockquote>
<p>&gt;&gt; h1_3</p>
<p>矩阵 A:<br>    1     2     3<br>    4     5     6<br>    7     8     9</p>
<p>列向量 B:<br>    2<br>    4<br>    6</p>
</blockquote>
<h3 id="4-矩阵基本运算"><a href="#4-矩阵基本运算" class="headerlink" title="4. 矩阵基本运算"></a>4. 矩阵基本运算</h3><p>基于第3 题中的矩阵A 和向量B，计算以下结果并输出：（1）A 的转置矩阵；（2）A 与B 的乘法（A*B）；（3）A 中所有元素的平均值。</p>
<p>MATLAB代码：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 矩阵A和列向量B</span></span><br><span class="line">A = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>; <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>; <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line">B = [<span class="number">2</span>; <span class="number">4</span>; <span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 计算A的转置矩阵</span></span><br><span class="line">A_transpose = A&#x27;;</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;A的转置矩阵:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(A_transpose);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 计算A与B的乘法（A*B）</span></span><br><span class="line">AB_product = A * B;</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;A与B的乘法结果:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(AB_product);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 计算A中所有元素的平均值</span></span><br><span class="line">A_mean = <span class="built_in">mean</span>(A(:));</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;A中所有元素的平均值:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(A_mean);</span><br></pre></td></tr></table></figure>

<p>运行结果截图：</p>
<p><img data-src="/./../images/image-20251018132310167.png" alt="image-20251018132310167"></p>
<p>命令行输出：</p>
<blockquote>
<p>&gt;&gt; h1_4</p>
<p>A的转置矩阵:<br>    1     4     7<br>    2     5     8<br>    3     6     9</p>
<p>A与B的乘法结果:<br>   28<br>   64<br>  100</p>
<p>A中所有元素的平均值:<br>    5</p>
</blockquote>
<h2 id="二、能力提升题（每题17-分，共4-题，满分68-分）"><a href="#二、能力提升题（每题17-分，共4-题，满分68-分）" class="headerlink" title="二、能力提升题（每题17 分，共4 题，满分68 分）"></a>二、能力提升题（每题17 分，共4 题，满分68 分）</h2><p><strong>目标：结合多个知识点，实现复杂逻辑与数据处理。</strong></p>
<h3 id="1-矩阵条件筛选"><a href="#1-矩阵条件筛选" class="headerlink" title="1. 矩阵条件筛选"></a>1. 矩阵条件筛选</h3><p>创建一个4×4 的随机矩阵（元素范围0-10，使用randi 函数），筛选出矩阵中大于5 的元素并输出这些元素的位置（行号和列号）及具体数值。</p>
<p>MATLAB代码：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 创建 4×4 的随机矩阵，元素范围 0 - 10</span></span><br><span class="line">A = randi([<span class="number">0</span>, <span class="number">10</span>], <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出原始矩阵</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;原始矩阵 A:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(A);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 筛选出大于 5 的元素的行和列索引</span></span><br><span class="line">[row, col] = <span class="built_in">find</span>(A &gt; <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 筛选出大于 5 的元素值</span></span><br><span class="line">values = A(A &gt; <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出大于 5 的元素的位置（行号和列号）及具体数值</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;矩阵中大于 5 的元素：&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(row)</span><br><span class="line">    fprintf(<span class="string">&#x27;行号：%d，列号：%d，数值：%d\n&#x27;</span>, row(<span class="built_in">i</span>), col(<span class="built_in">i</span>), values(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>运行结果截图：</p>
<p><img data-src="/./../images/image-20251018132717474.png" alt="image-20251018132717474"></p>
<p>命令行输出：</p>
<blockquote>
<p>&gt;&gt; h2_1</p>
<p>原始矩阵 A:<br>    8     6    10    10<br>    9     1    10     5<br>    1     3     1     8<br>   10     6    10     1</p>
<p>矩阵中大于 5 的元素：<br>行号：1，列号：1，数值：8<br>行号：2，列号：1，数值：9<br>行号：4，列号：1，数值：10<br>行号：1，列号：2，数值：6<br>行号：4，列号：2，数值：6<br>行号：1，列号：3，数值：10<br>行号：2，列号：3，数值：10<br>行号：4，列号：3，数值：10<br>行号：1，列号：4，数值：10<br>行号：3，列号：4，数值：8</p>
</blockquote>
<h3 id="2-线性代数方程组求解"><a href="#2-线性代数方程组求解" class="headerlink" title="2. 线性代数方程组求解"></a>2. 线性代数方程组求解</h3><p>已知线性方程组：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>10</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>4</mn><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>3</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>12</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{cases}
2x_1 + 3x_2 - x_3 = 10 \\
x_1 - 2x_2 + 4x_3 = -5 \\
3x_1 + x_2 - 2x_3 = 12
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">10</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord">5</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">12</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>将其表示为Ax &#x3D; b 的形式（其中A 为系数矩阵，b 为常数项向量），使用MATLAB 求解x，并验证A ∗ x 是否等于b。</p>
<p>MATLAB代码：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 定义系数矩阵 A</span></span><br><span class="line">A = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">-1</span>; <span class="number">1</span>, <span class="number">-2</span>, <span class="number">4</span>; <span class="number">3</span>, <span class="number">1</span>, <span class="number">-2</span>];</span><br><span class="line"><span class="comment">% 定义常数项向量 b</span></span><br><span class="line">b = [<span class="number">10</span>; <span class="number">-5</span>; <span class="number">12</span>];</span><br><span class="line"><span class="comment">% 求解线性方程组 Ax = b</span></span><br><span class="line">x = A \ b;</span><br><span class="line"><span class="comment">% 验证 A*x 是否等于 b</span></span><br><span class="line">verify = A * x;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出结果</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;方程组的解 x:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(x);</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;验证 A*x 的结果:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(verify);</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;常数项向量 b:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(b);</span><br></pre></td></tr></table></figure>

<p>运行结果截图：</p>
<p><img data-src="/./../images/image-20251018132958993.png" alt="image-20251018132958993"></p>
<p>命令行输出：</p>
<blockquote>
<p>&gt;&gt; h2_2</p>
<p>方程组的解 x:<br>   2.7143<br>   1.0571<br>  -1.4000</p>
<p>验证 A*x 的结果:<br>   10<br>   -5<br>   12</p>
<p>常数项向量 b:<br>   10<br>   -5<br>   12</p>
</blockquote>
<h3 id="3-描述性统计分析"><a href="#3-描述性统计分析" class="headerlink" title="3. 描述性统计分析"></a>3. 描述性统计分析</h3><p>生成一个包含50 个随机数的向量（服从均值为10、标准差为2 的正态分布，使用normrnd 函数），计算该向量的描述性统计量：均值、中位数、标准差、方差、极差（最大值减最小值），并将结果以表格形式输出。</p>
<p>MATLAB代码：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 生成服从均值为 10、标准差为 2 的正态分布的 50 个随机数向量</span></span><br><span class="line"></span><br><span class="line">x = normrnd(<span class="number">10</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 计算描述性统计量</span></span><br><span class="line">mean_val = <span class="built_in">mean</span>(x);          <span class="comment">% 均值</span></span><br><span class="line">median_val = median(x);      <span class="comment">% 中位数</span></span><br><span class="line">std_val = std(x);            <span class="comment">% 标准差</span></span><br><span class="line">var_val = var(x);            <span class="comment">% 方差</span></span><br><span class="line">range_val = range(x);        <span class="comment">% 极差（最大值减最小值）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 以表格形式输出结果</span></span><br><span class="line">stats_table = <span class="built_in">table</span>(mean_val, median_val, std_val, var_val, range_val, ...</span><br><span class="line">    <span class="string">&#x27;VariableNames&#x27;</span>, &#123;<span class="string">&#x27;均值&#x27;</span>, <span class="string">&#x27;中位数&#x27;</span>, <span class="string">&#x27;标准差&#x27;</span>, <span class="string">&#x27;方差&#x27;</span>, <span class="string">&#x27;极差&#x27;</span>&#125;);</span><br><span class="line"><span class="built_in">disp</span>(stats_table);</span><br></pre></td></tr></table></figure>

<p>运行结果截图：</p>
<p><img data-src="/./../images/image-20251018133420352.png" alt="image-20251018133420352"></p>
<p>命令行输出：</p>
<blockquote>
<p>&gt;&gt; h2_3</p>
<p>​     均值     中位数     标准差      方差      极差 </p>
<hr>
<p>​    10.568    10.644    2.5251    6.3759    13.045</p>
</blockquote>
<h3 id="4-线性规划问题求解"><a href="#4-线性规划问题求解" class="headerlink" title="4. 线性规划问题求解"></a>4. 线性规划问题求解</h3><p>使用 <code>linprog</code> 函数求解线性规划问题。目标函数：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\min f(x) = 2x_1 + 3x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>；约束条件：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">x_1 + x_2 \geq 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_1 - 2x_2 \leq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_1 \geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_2 \geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>。要求：正确设置目标函数系数 <code>f</code>、不等式约束矩阵 <code>A</code> 和向量 <code>b</code>、变量上下界 <code>lb</code>，输出最优解 <code>x</code> 及对应的目标函数最小值。（提示：<code>linprog</code> 默认求解 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\min</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mop">min</span></span></span></span> 问题，不等式约束需转换为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi mathvariant="bold">x</mi><mo>≤</mo><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">A\mathbf{x} \leq \mathbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf">b</span></span></span></span> 形式）</p>
<p>MATLAB代码：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 目标函数系数（对应 min f(x) = 2x1 + 3x2）</span></span><br><span class="line">f = [<span class="number">2</span>; <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 不等式约束转换为 A*x ≤ b 形式</span></span><br><span class="line"><span class="comment">% 原约束 x1 + x2 ≥ 2 转换为 -x1 - x2 ≤ -2</span></span><br><span class="line"><span class="comment">% 原约束 x1 - 2x2 ≤ 1 保持不变</span></span><br><span class="line">A = [<span class="number">-1</span>, <span class="number">-1</span>;</span><br><span class="line">      <span class="number">1</span>, <span class="number">-2</span>];</span><br><span class="line">b = [<span class="number">-2</span>;</span><br><span class="line">      <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 变量下界（x1 ≥ 0, x2 ≥ 0）</span></span><br><span class="line">lb = [<span class="number">0</span>; <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 调用 linprog 求解</span></span><br><span class="line">options = optimoptions(<span class="string">&#x27;linprog&#x27;</span>, <span class="string">&#x27;Display&#x27;</span>, <span class="string">&#x27;iter&#x27;</span>); <span class="comment">% 显示迭代过程</span></span><br><span class="line">[x, fval] = linprog(f, A, b, [], [], lb, [], options);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 输出结果</span></span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;最优解 x:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(x);</span><br><span class="line"><span class="built_in">disp</span>(<span class="string">&#x27;目标函数最小值 fval:&#x27;</span>);</span><br><span class="line"><span class="built_in">disp</span>(fval);</span><br></pre></td></tr></table></figure>

<p>运行结果截图：</p>
<p><img data-src="/./../images/image-20251018133842761.png" alt="image-20251018133842761"></p>
<p>命令行输出：</p>
<blockquote>
<p>&gt;&gt; h2_4</p>
<p>Running HiGHS 1.7.1: Copyright (c) 2024 HiGHS under MIT licence terms<br>Coefficient ranges:<br> Matrix [1e+00, 2e+00]<br> Cost   [2e+00, 3e+00]<br> Bound  [0e+00, 0e+00]<br> RHS    [1e+00, 2e+00]<br>Presolving model<br>2 rows, 2 cols, 4 nonzeros  0s<br>2 rows, 2 cols, 4 nonzeros  0s<br>Presolve : Reductions: rows 2(-0); columns 2(-0); elements 4(-0) - Not reduced<br>Problem not reduced by presolve: solving the LP<br>Using EKK dual simplex solver - serial<br> Iteration        Objective     Infeasibilities num(sum)<br>         0     0.0000000000e+00 Pr: 1(2) 0s<br>         2     4.3333333333e+00 Pr: 0(0) 0s<br>Model   status      : Optimal<br>Simplex   iterations: 2<br>Objective value     :  4.3333333333e+00<br>HiGHS run time      :          0.01</p>
<p>找到最优解。</p>
<p>最优解 x:<br>   1.6667<br>   0.3333</p>
<p>目标函数最小值 fval:<br>   4.3333</p>
</blockquote>
]]></content>
      <categories>
        <category>作业</category>
      </categories>
      <tags>
        <tag>MATLAB</tag>
      </tags>
  </entry>
  <entry>
    <title>Python学习笔记其二</title>
    <url>/2025/10/02/Python0002/</url>
    <content><![CDATA[<h2 id="写在最前"><a href="#写在最前" class="headerlink" title="写在最前"></a>写在最前</h2><p><strong>先看完教程链接，再看相关实例！</strong></p>
<p>几个容易遇到的坑：</p>
<ul>
<li>编程语言中的符号一定不要打成中文符号！！！经常容易打错的有：括号()，逗号,，引号””</li>
<li>中文乱码考虑一下有没有把编码形式改成utf-8</li>
<li>注意观察参数需不需要加引号，如open函数的encoding&#x3D;”utf-8”就要加引号</li>
<li>有问题把报错和源码复制给Ai进行询问</li>
</ul>
<h2 id="输入与输出"><a href="#输入与输出" class="headerlink" title="输入与输出"></a>输入与输出</h2><p><a href="https://www.runoob.com/python3/python3-inputoutput.html">Python3 输入和输出 | 菜鸟教程</a></p>
<p>Python两种输出值的方式: 表达式语句和 print() 函数。</p>
<p>第三种方式是使用文件对象的 write() 方法，标准输出文件可以用 sys.stdout 引用。</p>
<p>如果你希望输出的形式更加多样，可以使用 str.format() 函数来格式化输出值。</p>
<p>如果你希望将输出的值转成字符串，可以使用 repr() 或 str() 函数来实现。</p>
<ul>
<li><strong>str()：</strong> 函数返回一个用户易读的表达形式。</li>
<li><strong>repr()：</strong> 产生一个解释器易读的表达形式。</li>
</ul>
<h3 id="str-format占位符"><a href="#str-format占位符" class="headerlink" title="str.format占位符"></a>str.format占位符</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&quot;Bob&quot;</span></span><br><span class="line">age = <span class="number">20</span></span><br><span class="line">score = <span class="number">88.456</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;姓名：&#123;&#125;, 年龄：&#123;&#125;, 成绩：&#123;:.1f&#125;&quot;</span>.<span class="built_in">format</span>(name, age, score))</span><br><span class="line"><span class="comment"># 输出：姓名：Bob, 年龄：20, 成绩：88.5</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;姓名：&#123;0&#125;, 年龄：&#123;1&#125;, 成绩：&#123;2:.2f&#125;&quot;</span>.<span class="built_in">format</span>(name, age, score))</span><br><span class="line"><span class="comment"># 输出：姓名：Bob, 年龄：20, 成绩：88.46</span></span><br></pre></td></tr></table></figure>

<h3 id="print分开字符串与变量"><a href="#print分开字符串与变量" class="headerlink" title="print分开字符串与变量"></a>print分开字符串与变量</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;The value of test is: <span class="subst">&#123;test&#125;</span>&quot;</span>)	<span class="comment">##引号前加一“f”，在想要显示变量值的地方加一个大括号&#123;&#125;，其中写入变量名</span></span><br></pre></td></tr></table></figure>
<p>% 占位符</p>
<p>这是最早的字符串格式化方法。与C语言基本一致。常用的占位符包括：</p>
<p>%s：字符串</p>
<p>%d：整数</p>
<p>%f：浮点数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;姓名：%s, 年龄：%d, 成绩：%.2f&quot;</span> % (name, age, score))</span><br></pre></td></tr></table></figure>

<h3 id="input输入"><a href="#input输入" class="headerlink" title="input输入"></a>input输入</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">input</span>(<span class="string">&quot;提示的文本&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>一般直接赋给变量值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">age = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;年龄&quot;</span>))		<span class="comment">##由于年龄是个整型，这里使用int对其进行格式化</span></span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="built_in">input</span>(<span class="string">&quot;姓名：&quot;</span>)</span><br><span class="line">age = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;年龄：&quot;</span>))</span><br><span class="line">love_programming_language = <span class="built_in">input</span>(<span class="string">&quot;喜欢的编程语言（以逗号分隔）：&quot;</span>)</span><br><span class="line">age_after_3years = <span class="built_in">int</span>(age + <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;个人信息&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;姓名：<span class="subst">&#123;name&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;年龄：%d&quot;</span>, age)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;喜欢的编程语言：<span class="subst">&#123;love_programming_language&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;三年后年龄：<span class="subst">&#123;age_after_3years&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="open函数"><a href="#open函数" class="headerlink" title="open函数"></a>open函数</h2><p><a href="https://www.runoob.com/python3/python3-file-methods.html">Python3 File 方法 | 菜鸟教程</a></p>
<h2 id="os模块"><a href="#os模块" class="headerlink" title="os模块"></a>os模块</h2><p><a href="https://www.runoob.com/python3/python3-os-file-methods.html">Python3 OS 文件&#x2F;目录方法 | 菜鸟教程</a></p>
<blockquote>
<p>问题2:文件处理<br>编写一个程序，使用 os 模块和文件方法完成以下操作:1.创建一个名为”test files”的目录(如果不存在)<br>2.在该目录下创建一个文本文件”notes.txt<br>3.向文件中写入 3 行内容已创建目录: test files已向文件 notes.txt 写入内容<br>文件内容如下:<br>第1行: 这是第一行内容</p>
<p>第2行: Python文件操作练习</p>
<p>第3行: 使用os模块和文件方法</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os	<span class="comment">##导入os模块</span></span><br><span class="line"></span><br><span class="line">status1 = os.listdir()	<span class="comment">##获取当前目录下文件，为下面看看有没有&quot;test_files&quot;做准备</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;test_files&quot;</span> <span class="keyword">in</span> status1:	<span class="comment">##判断&quot;test_files&quot;在不在当前工作目录下</span></span><br><span class="line">    os.chdir(<span class="string">&quot;test_files&quot;</span>)	<span class="comment">##如果存在就切换工作目录到&quot;test_files&quot;中</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    os.mkdir(<span class="string">&quot;test_files&quot;</span>)	<span class="comment">##如果不存在就创建目录</span></span><br><span class="line">    os.chdir(<span class="string">&quot;test_files&quot;</span>)	<span class="comment">##并进入&quot;test_files&quot;</span></span><br><span class="line">status2 = os.listdir()	<span class="comment">##获取&quot;test_files&quot;目录下文件，为下面看看有没有做准备</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;notes.txt&quot;</span> <span class="keyword">in</span> status2:	<span class="comment">##判断&quot;notes.txt&quot;在不在当前工作目录下</span></span><br><span class="line">    os.remove(<span class="string">&quot;notes.txt&quot;</span>)	<span class="comment">##如果在就删除</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;notes.txt&quot;</span>, mode=<span class="string">&#x27;x&#x27;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:	<span class="comment">##创建并打开notes.txt，以写入方式打开（mode=&#x27;x&#x27;），编解码方式为&quot;utf-8&quot;（使用utf-8以避免中文报错）</span></span><br><span class="line">	f.write(<span class="string">&quot;这是第一行内容\nPython文件操作练习\n使用os模块和文件方法&quot;</span>)	<span class="comment">##写入内容至notes.txt</span></span><br><span class="line">	f.flush()	<span class="comment">##刷新文件内部缓冲，直接把内部缓冲区的数据立刻写入文件, 而不是被动的等待输出缓冲区写入。</span></span><br><span class="line">	f.close()	<span class="comment">##关闭文件。关闭后文件不能再进行读写操作。</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;已向文件notes.txt中写入内容&quot;</span>)		<span class="comment">##进行提示</span></span><br></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p><a href="https://www.runoob.com/python3/python3-function.html">Python3 函数 | 菜鸟教程</a></p>
<h2 id="name"><a href="#name" class="headerlink" title="name"></a><strong>name</strong></h2><p><a href="https://www.runoob.com/python3/python3-name-main.html">Python <strong>name</strong> 与 <strong>main</strong> | 菜鸟教程</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main() </span><br></pre></td></tr></table></figure>

<p>命名为主函数。Python中，总是从主函数开始运行。</p>
<p>例如：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">greet</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;来自 example 模块的问候！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:	<span class="comment">##模块将从此处开始运行</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;该脚本正在直接运行。&quot;</span>)</span><br><span class="line">    greet()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;该脚本作为模块被导入。&quot;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>问题3:编写def函数</p>
<p>编写一个名为sum_and_average的函数</p>
<p>要求:函数接收一个包含数字的列表作为参数函数返回两个值:列表中所有数字的总和，以及这些数字的平均值</p>
<p>如果传入的列表为空，总和返回 0，平均值返回 0.0</p>
<p>编写代码测试这个函数，至少测试两种情况:包含数字的列表和空列表</p>
</blockquote>
<p>例如：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum_and_average</span>(<span class="params"><span class="built_in">list</span></span>):	<span class="comment">##定义sum_and_average(list)</span></span><br><span class="line">    total = <span class="built_in">sum</span>(<span class="built_in">list</span>)	<span class="comment">##求和</span></span><br><span class="line">    count = <span class="built_in">len</span>(<span class="built_in">list</span>)	<span class="comment">##统计传入列表中的值的数量</span></span><br><span class="line">    average = total / count <span class="keyword">if</span> count &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>	<span class="comment">##判断，因为求平均要求分母不为零，有传入为空的要求，故进行判断，当传入为空时使average为0，传入不为空时用总和除以值的数量求平均</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;求和：%d&quot;</span> %total)	<span class="comment">##打印求和量，类型是整数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;平均：%.1f&quot;</span> %average)	<span class="comment">##打印求平均量，类型是浮点型，保留小数点后一位</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>	<span class="comment">##返回None，此行代码可不写</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:	<span class="comment">##main</span></span><br><span class="line">    before_list = <span class="built_in">input</span>(<span class="string">&quot;输入一些数字，使用英文逗号间隔：&quot;</span>)	<span class="comment">##对传入数据在before_list变量中进行预存储，方便后续校验非空</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> before_list:	<span class="comment">##如果传入内容为空</span></span><br><span class="line">        <span class="built_in">list</span> = before_list	<span class="comment">##则让list列表为空</span></span><br><span class="line">    <span class="keyword">else</span>:	<span class="comment">##如果传入内容不为空</span></span><br><span class="line">        <span class="built_in">list</span> = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> before_list.split(<span class="string">&#x27;,&#x27;</span>)]	<span class="comment">##将输入before_list中值传入list中，英文逗号为分隔符</span></span><br><span class="line">    sum_and_average(<span class="built_in">list</span>)	<span class="comment">##运行自定义函数</span></span><br></pre></td></tr></table></figure>

<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><p><strong>高难度内容，Python最难的内容，最抽象的内容，最绕的内容</strong></p>
<p><a href="https://www.runoob.com/python3/python3-class.html">Python3 面向对象 | 菜鸟教程</a></p>
<h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><p><a href="https://www.runoob.com/python3/python3-module.html">Python3 模块 | 菜鸟教程</a></p>
<p>例如：</p>
<blockquote>
<p>问题4:设计book类<br>设计一个Book类，要求如下<br>属性:书名(title)、作者(author)页数(pages)<br>方法:构造方法初始化所有属性<br>is_long()方法:如果页数超过 300 页，返回True，否则返回False</p>
<p>get_info()方法:返回包含书名、作者和页数的字符串，格式如”《Python 编程》- 张三 (280 页)”</p>
<p>最后创建 1个Book对象，分别调用上述方法并打印结果。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>:		<span class="comment">##定义一个Book类</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,title,author,pages</span>):  	<span class="comment">##详情请见教程__init__类，必须要有self，否则无法传入主函数输入的变量值</span></span><br><span class="line">        <span class="variable language_">self</span>.title = title</span><br><span class="line">        <span class="variable language_">self</span>.author = author</span><br><span class="line">        <span class="variable language_">self</span>.pages = pages</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_long</span>(<span class="params">self</span>):		<span class="comment">##定义一个is_long函数</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.pages &gt; <span class="number">300</span>:		<span class="comment">##判断页数是否大于300</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span>		<span class="comment">##如果大于300返回True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>		<span class="comment">##如果小于300返回False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_info</span>(<span class="params">self</span>):		<span class="comment">##定义一个get_info函数</span></span><br><span class="line">        info = <span class="string">f&quot;<span class="subst">&#123;self.title&#125;</span> - <span class="subst">&#123;self.author&#125;</span> (<span class="subst">&#123;self.pages&#125;</span> 页)&quot;</span>		<span class="comment">##配置一个info函数，方便后续显示</span></span><br><span class="line">        <span class="keyword">return</span> info		<span class="comment">##返回info变量，方便后续调用</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:		<span class="comment">##主函数</span></span><br><span class="line">    title = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入书名（带书名号）：&quot;</span>))		<span class="comment">##获取书名</span></span><br><span class="line">    author = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入作者名：&quot;</span>))		<span class="comment">##获取作者名</span></span><br><span class="line">    pages = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入页数：&quot;</span>))		<span class="comment">##获取书页数</span></span><br><span class="line">    x = Book(title,author,pages)		<span class="comment">##将获取到的三个变量传入Book类对应的变量中</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;是长书吗：<span class="subst">&#123;x.is_long()&#125;</span>&quot;</span>)		<span class="comment">##打印判断结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;本书信息：<span class="subst">&#123;x.get_info()&#125;</span>&quot;</span>)		<span class="comment">##打印本书信息</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="推导式"><a href="#推导式" class="headerlink" title="推导式"></a>推导式</h2><p><a href="https://www.runoob.com/python3/python-comprehensions.html">Python 推导式 | 菜鸟教程</a></p>
<h2 id="迭代器与生成器"><a href="#迭代器与生成器" class="headerlink" title="迭代器与生成器"></a>迭代器与生成器</h2><p><a href="https://www.runoob.com/python3/python3-iterator-generator.html">Python3 迭代器与生成器 | 菜鸟教程</a></p>
<h2 id="with-关键字"><a href="#with-关键字" class="headerlink" title="with 关键字"></a>with 关键字</h2><p><a href="https://www.runoob.com/python3/python3-with-keyword.html">Python with 关键字 | 菜鸟教程</a></p>
<h2 id="错误和异常"><a href="#错误和异常" class="headerlink" title="错误和异常"></a>错误和异常</h2><p><a href="https://www.runoob.com/python3/python3-errors-execptions.html">Python3 错误和异常 | 菜鸟教程</a></p>
<h2 id="标准库概览"><a href="#标准库概览" class="headerlink" title="标准库概览"></a>标准库概览</h2><p><a href="https://www.runoob.com/python3/python3-stdlib.html">Python3 标准库概览 | 菜鸟教程</a></p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p><a href="https://www.runoob.com/python3/python3-examples.html">Python3 实例 | 菜鸟教程</a></p>
]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown学习笔记</title>
    <url>/2021/01/01/Markdown/</url>
    <content><![CDATA[<h2 id="后缀"><a href="#后缀" class="headerlink" title="后缀"></a>后缀</h2><p>.md</p>
<p>.markdown</p>
<p>.MD</p>
<p>.MARKDOWN</p>
<h2 id="标头"><a href="#标头" class="headerlink" title="标头"></a>标头</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># h1标头</span></span><br><span class="line"><span class="section">## h2标头</span></span><br><span class="line"><span class="section">### h3标头</span></span><br><span class="line">......</span><br><span class="line"><span class="section">###### h6标头</span></span><br></pre></td></tr></table></figure>

<h1 id="h1标头"><a href="#h1标头" class="headerlink" title="h1标头"></a>h1标头</h1><h2 id="h2标头"><a href="#h2标头" class="headerlink" title="h2标头"></a>h2标头</h2><h3 id="h3标头"><a href="#h3标头" class="headerlink" title="h3标头"></a>h3标头</h3><p>……</p>
<h6 id="h6标头"><a href="#h6标头" class="headerlink" title="h6标头"></a>h6标头</h6><p>H后数越大，字体越小</p>
<h2 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="emphasis">*要斜体的文字*</span></span><br><span class="line"></span><br><span class="line"><span class="strong">**要加黑的文字**</span></span><br><span class="line"></span><br><span class="line"><span class="emphasis">_要斜体的文字_</span></span><br><span class="line"></span><br><span class="line"><span class="strong">__要加黑的文字__</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>要斜体的文字</em></p>
<p><strong>要加黑的文字</strong></p>
<p><em>要斜体的文字</em></p>
<p><strong>要加黑的文字</strong></p>
<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><h3 id="无序"><a href="#无序" class="headerlink" title="无序"></a>无序</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">*</span> 1</span><br><span class="line"><span class="bullet">*</span> 2</span><br><span class="line"><span class="bullet">*</span> 3</span><br><span class="line"><span class="bullet">*</span> 4</span><br><span class="line"><span class="bullet">*</span> 5</span><br><span class="line"><span class="bullet"> *</span> 1</span><br><span class="line"><span class="bullet"> *</span> 2</span><br><span class="line"><span class="bullet"> *</span> 3</span><br><span class="line"><span class="bullet"> *</span> 4</span><br><span class="line"><span class="bullet"> *</span> 5</span><br></pre></td></tr></table></figure>


<ul>
<li>1</li>
<li>2</li>
<li>3</li>
<li>4</li>
<li>5</li>
<li>1</li>
<li>2</li>
<li>3</li>
<li>4</li>
<li>5</li>
</ul>
<p>在此博客上空格加“*”是同样的效果。</p>
<h3 id="有序"><a href="#有序" class="headerlink" title="有序"></a>有序</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">1.</span> 1</span><br><span class="line"><span class="bullet">2.</span> 2</span><br><span class="line"><span class="bullet">3.</span> 3</span><br><span class="line"><span class="bullet">4.</span> 4</span><br><span class="line"><span class="bullet">5.</span> 5</span><br></pre></td></tr></table></figure>
<ol>
<li>1</li>
<li>2</li>
<li>3</li>
<li>4</li>
<li>5</li>
</ol>
<p>使用一个回车后会自动补充</p>
<h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p>###图片</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">图片描述</span>](<span class="link">图片位置</span>)</span><br></pre></td></tr></table></figure>
<h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">链接描述</span>](<span class="link">链接</span>)</span><br></pre></td></tr></table></figure>

<p><a href="https://mjy.js.org/">Blog</a></p>
<h3 id="块引用"><a href="#块引用" class="headerlink" title="块引用"></a>块引用</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">As Kanye West said:</span><br><span class="line"></span><br><span class="line"><span class="quote">&gt; We&#x27;re living the future so</span></span><br><span class="line"><span class="quote">&gt; the present is our past.</span></span><br></pre></td></tr></table></figure>

<p>As Kanye West said:</p>
<blockquote>
<p>We’re living the future so<br>the present is our past.</p>
</blockquote>
<h3 id="内联代码"><a href="#内联代码" class="headerlink" title="内联代码"></a>内联代码</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">I think you should use an</span><br><span class="line"><span class="code">`&lt;addr&gt;`</span> element here instead.</span><br></pre></td></tr></table></figure>
<p>I think you should use an<br><code>&lt;addr&gt;</code> element here instead.</p>
<h2 id="语法高亮"><a href="#语法高亮" class="headerlink" title="语法高亮"></a>语法高亮</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="code">` `</span> `语言类型</span><br><span class="line">code</span><br><span class="line"><span class="code">` `</span> `</span><br><span class="line">// 中间无空格</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="string">&quot;Hello world&quot;</span>;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>将代码前加上四个空格有同样的效果</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="code">    &lt;?php echo &quot;Hello world&quot;;?&gt;</span></span><br><span class="line"><span class="code">四个空格+code</span></span><br></pre></td></tr></table></figure>
<pre><code>&lt;?php echo &quot;Hello world&quot;;?&gt;
&lt;?php echo &quot;1&quot;;?&gt;
&lt;?php echo &quot;2&quot;;?&gt;
&lt;?php echo &quot;3&quot;;?&gt;
</code></pre>
<h2 id="任务清单"><a href="#任务清单" class="headerlink" title="任务清单"></a>任务清单</h2><ul>
<li><input disabled="" type="checkbox"> 未完成</li>
<li><input checked="" disabled="" type="checkbox"> 已完成</li>
</ul>
<h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">A | B</span><br><span class="line">-- | --</span><br><span class="line">1 | 2</span><br><span class="line">2 | 3</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
</tr>
</tbody></table>
<h2 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a>删除线</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">del</span>&gt;</span></span>Del<span class="language-xml"><span class="tag">&lt;/<span class="name">del</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><del>Del</del></p>
<h2 id="表情"><a href="#表情" class="headerlink" title="表情"></a>表情</h2><p><a href="https://github.com/ikatyang/emoji-cheat-sheet/blob/master/README.md">URL</a></p>
]]></content>
      <categories>
        <category>notes</category>
      </categories>
      <tags>
        <tag>markdown</tag>
        <tag>Markdown</tag>
        <tag>笔记</tag>
        <tag>notes</tag>
      </tags>
  </entry>
  <entry>
    <title>Python学习笔记其三</title>
    <url>/2025/10/03/Python0003/</url>
    <content><![CDATA[<h1 id="PyTorch教程"><a href="#PyTorch教程" class="headerlink" title="PyTorch教程"></a>PyTorch教程</h1><p>在开始学习本教程之前，你应具备以下基础知识，以便更好地理解和应用 PyTorch</p>
<ul>
<li>编程基础:熟悉至少一种编程语言，尤其是 Python，这是 PyTorch 的主要开发语言。</li>
<li>数学基础:掌握线性代数、概率论与统计学、微积分等基础数学知识，为理解机器学习算法打下坚实基础。</li>
<li>机器学习基础:了解监督学习、无监督学习、强化学习等基本概念，以及常用的模型评估指标(如准确率、召回率、F1 分数等)</li>
<li>深度学习基础:熟悉神经网络的基本结构和原理，如前馈神经网络、CNN、RNN、LSTM 等</li>
<li>领域知识:若计划将 PyTorch 应用于计算机视觉或自然语言处理，了解相关领<br>域的基础知识将大有裨益。</li>
</ul>
<p><img data-src="/./../images/image-20251003140242783.png" alt="image-20251003140242783"></p>
<p>有关pytorch，请见<a href="https://docs.pytorch.ac.cn/docs/stable/index.html">PyTorch 文档 — PyTorch 2.8 文档 - PyTorch 文档</a></p>
<h2 id="PyTorch简介"><a href="#PyTorch简介" class="headerlink" title="PyTorch简介"></a>PyTorch简介</h2><p>PyTorch 是一个开源的 Python 机器学习库,基于 Torch 库，底层由 C++实现，应用于人工智能领域，如计算机视觉和自然语言处理。</p>
<p>PyTorch 最初由 Meta Platforms 的人工智能研究团队开发，现在属于Linux 基金会的一部分。</p>
<p>PyTorch 主要有两大特征:</p>
<ul>
<li>类似于 NumPy 的张量计算，能在 GPU 等硬件加速器上加速。</li>
<li>基于带自动微分系统的深度神经网络。</li>
</ul>
<blockquote>
<p>注:基于自动微分系统的深度神经网络是 PyTorch 核心能力之一，其通过autograd模块自动追踪张量运算过程，可在反向传播阶段无需人工推导，直接计算损失函数对模型参数的梯度，为网络训练提供关键的梯度信息支撑。<br>NumPy是Python语言的一个扩展程序库。支持高阶大规模的多维数组与矩阵运算，此外也针对数组运算提供大量的数学</p>
</blockquote>
<p>PyTorch 特性</p>
<ul>
<li><p>动态计算图(Dynamic Computation Graphs): PyTorch 的计算图是动态的，这意味着它们在运行时构建，并且可以随时改变。这为实验和调试提供了极大的灵活性，因为开发者可以逐行<br>执行代码，查看中间结果。</p>
</li>
<li><p>自动微分(Automatic Differentiation): PyTorch 的自动微分系统允许开发者轻松地计算梯度这对于训练深度学习模型至关重要。它通过反向传播算法自动计算出损失函数对模型参数的梯度。</p>
</li>
<li><p>张量计算(Tensor Computation): PyTorch 提供了类似于 NumPy 的张量操作，这些操作可以在 CPU 和 GPU 上执行，从而加速计算过程。张量是 PyTorch 中的基本数据结构，用于存储和操作数据。</p>
</li>
</ul>
<p>动态计算图(Dynamic Computation Graph.<br>PyTorch 最显著的特点之一是其动态计算图的机制。PyTorch 在执行时构建计算图，这意味着在每次计算时，图都会根据输入数据的形状自动变化。</p>
<p>动态计算图的优点:<br>计算图(Computation Graph)是深度学习中一个非常核心的概念，可以把它理解成:<br>拿一张用“节点”和“边”表示数学运算流程的“流程图”，它描述了数据(张量)是如何通过系列运算一步步变换、最终得到输出结果的。</p>
<ul>
<li><p>更加灵活，特别适用于需要条件判断或递归的场景。</p>
</li>
<li><p>方便调试和修改，能够直接查看中间结果·更接近 Python 编程的风格，易于上手。</p>
</li>
</ul>
<p><img data-src="/./../images/image-20251003140819157.png" alt="image-20251003140819157"></p>
<blockquote>
<p>(+)位置可以看到张量</p>
</blockquote>
<p><img data-src="/./../images/image-20251003140914863.png" alt="image-20251003140914863"></p>
<p><img data-src="/./../images/image-20251003140925476.png" alt="image-20251003140925476"></p>
<p><img data-src="/./../images/image-20251003140959558.png" alt="image-20251003140959558"></p>
<h2 id="PyTorch安装"><a href="#PyTorch安装" class="headerlink" title="PyTorch安装"></a>PyTorch安装</h2><p><img data-src="/./../images/image-20251003141107206.png" alt="image-20251003141107206"></p>
<p><img data-src="/./../images/image-20251003141216897.png" alt="image-20251003141216897"></p>
<blockquote>
<p>建议使用Python3.9</p>
</blockquote>
<p><img data-src="/./../images/image-20251003141302556.png" alt="image-20251003141302556"></p>
<p><img data-src="/./../images/image-20251003141332954.png" alt="image-20251003141332954"></p>
<p><img data-src="/./../images/image-20251003141356803.png" alt="image-20251003141356803"></p>
<p><a href="https://pytorch.org/">PyTorch</a></p>
<p><img data-src="/./../images/image-20251003142043338.png" alt="image-20251003142043338"></p>
<p><img data-src="/./../images/image-20251003142405066.png" alt="image-20251003142405066"></p>
<p><img data-src="/./../images/image-20251003144017338.png" alt="image-20251003144017338"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前安装的 PyTorch 库的版本</span></span><br><span class="line"><span class="built_in">print</span>(torch.__version__)</span><br><span class="line"><span class="comment"># 检查 CUDA 是否可用，即你的系统有 NVIDIA 的 GPU</span></span><br><span class="line"><span class="built_in">print</span>(torch.cuda.is_available())</span><br></pre></td></tr></table></figure>



<p><a href="https://www.runoob.com/pytorch/pytorch-install.html#:~:text=torch%20torchvision%20torchaudio-,%E9%AA%8C%E8%AF%81%E5%AE%89%E8%A3%85,-%E4%B8%BA%E4%BA%86%E7%A1%AE%E4%BF%9D%20PyTorch">PyTorch 安装 | 菜鸟教程</a></p>
<p><img data-src="/./../images/image-20251003144552271.png" alt="image-20251003144552271"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line">x = torch.rand(<span class="number">5</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>

<p><img data-src="/./../images/image-20251003145225620.png" alt="image-20251003145225620"></p>
<p><a href="https://www.runoob.com/pytorch/pytorch-basic.html">PyTorch 基础 | 菜鸟教程</a></p>
<p><a href="https://www.runoob.com/pytorch/pytorch-tensor.html">PyTorch 张量（Tensor） | 菜鸟教程</a></p>
<h1 id="神经网络"><a href="#神经网络" class="headerlink" title="神经网络"></a>神经网络</h1><h2 id="神经网络介绍"><a href="#神经网络介绍" class="headerlink" title="神经网络介绍"></a>神经网络介绍</h2><p><img data-src="/./../images/image-20251003170121375.png" alt="image-20251003170121375"></p>
<p><img data-src="/./../images/image-20251003170146520.png" alt="image-20251003170146520"></p>
<p><img data-src="/./../images/image-20251003170308804.png" alt="image-20251003170308804"></p>
<p><img data-src="/./../images/image-20251003170316205.png" alt="image-20251003170316205"></p>
<p><img data-src="/./../images/image-20251003170531497.png" alt="image-20251003170531497"></p>
<p><img data-src="/./../images/image-20251003170715586.png" alt="image-20251003170715586"></p>
<p><img data-src="/./../images/image-20251003170752551.png" alt="image-20251003170752551"></p>
<p><img data-src="/./../images/image-20251003170933461.png" alt="image-20251003170933461"></p>
<p><img data-src="/./../images/image-20251003171319618.png" alt="image-20251003171319618"></p>
<p><img data-src="/./../images/image-20251003171547160.png" alt="image-20251003171547160"></p>
<p><img data-src="/./../images/image-20251003172010239.png" alt="image-20251003172010239"></p>
<p><img data-src="/./../images/image-20251003172058968.png" alt="image-20251003172058968"></p>
<p><img data-src="/./../images/image-20251003172219754.png" alt="image-20251003172219754"></p>
<p><img data-src="/./../images/image-20251003172329671.png" alt="image-20251003172329671"></p>
<p><img data-src="/./../images/image-20251003172344771.png" alt="image-20251003172344771"></p>
<p><img data-src="/./../images/image-20251003172445140.png" alt="image-20251003172445140"></p>
<p><img data-src="/./../images/image-20251003172546077.png" alt="image-20251003172546077"></p>
<p><img data-src="/./../images/image-20251003172656866.png" alt="image-20251003172656866"></p>
<p><img data-src="/./../images/image-20251003172809240.png" alt="image-20251003172809240"></p>
<p><img data-src="/./../images/image-20251003172927799.png" alt="image-20251003172927799"></p>
<p><img data-src="/./../images/image-20251003172940247.png" alt="image-20251003172940247"></p>
<h2 id="数据集与数据加载"><a href="#数据集与数据加载" class="headerlink" title="数据集与数据加载"></a>数据集与数据加载</h2><p><img data-src="/./../images/image-20251003173012074.png" alt="image-20251003173012074"></p>
<p><img data-src="/./../images/image-20251003173435990.png" alt="image-20251003173435990"></p>
]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>山东省综合素质评价填报指北</title>
    <url>/2023/08/25/Shandong-Comprehensive-Quality-Evaluation-Filling-Guide/</url>
    <content><![CDATA[<p>一学期一度的综合素质评价马上就要结束了（9月1日），而我的综合素质评价还一字未填，于是决定撰写一篇文章来介绍填报方式及注意事项。</p>
<p>关于填报，相关的三方群聊其实不少，有人会联系你然后给你提供相应资料，有偿但是价格合适，本篇文章不采取这种方式，而是介绍利用Bing AI进行辅助填写。</p>
<p>首先打开<a href="https://www.sdei.edu.cn/home/html/shouye.html">https://www.sdei.edu.cn/home/html/shouye.html</a>（山东省教育公共服务平台），点击高中综评专用入口（或者直接点击<a href="https://szpj.sdei.edu.cn/zhszpj/">https://szpj.sdei.edu.cn/zhszpj/</a>）</p>
<p><img data-src="/images/1692965477-image-1024x576.png"></p>
<p>进入网页后，按照学校提供信息进行登录。</p>
<p><img data-src="/images/1692965609-image-1024x517.png"></p>
<p>用户名一般为学生身份证号，当然如果你绑定了手机号也可以使用手机号登录。</p>
<p>登录后点击左侧的“点滴记录”，开始填报综合素质评价。</p>
<h4 id="任职情况"><a href="#任职情况" class="headerlink" title="任职情况"></a><strong>任职情况</strong></h4><p>这里如实填写即可，什么都可以往上填，例如xx委员，xx课代表，卫生x组组员（除非实在没的填，否则尽量不要填这个）。</p>
<p>点击“添加”，在“担任职务”一栏填写职务名称，在开始时间一栏选择本学期开始时间（如果你能记得你的任职日期那就填写更为准确的日期），结束时间写本学期结束时间（正常放寒暑假时间）即可。貌似选项“至今”已经不再可选，所以大家还是选择假期开始时间最合适。“是否选入档案”当然要选择“是”。职务描述最少25字，描述你的职务内容即可（可使用AI写作）。佐证材料方面，如果有“优秀班干部”等类似奖状，拍照并重命名图片名字为：“优秀班干部-班长-佐证材料”否则不必填写。</p>
<p>这里提供几个样本（本人自己写作）</p>
<blockquote>
<p>电教委员：管理班级一体机等多媒体教学资源，协助老师完成多媒体教学、线上教学等任务。</p>
<p>课代表：协助XX老师完成课堂任务，维持课堂秩序，下发课程所需讲义，课下询问作业，课前联系老师。</p>
<p>安全委员：协助老师保障校园生活中同学们的安全，认真负责好班级里安全隐患排查。</p>
</blockquote>
<p><img data-src="/images/1692968917-image.png"></p>
<p><img data-src="/images/1692968938-image.png"></p>
<p>填写完毕确认无误后保存即可。</p>
<h4 id="奖惩情况"><a href="#奖惩情况" class="headerlink" title="奖惩情况"></a><strong>奖惩情况</strong></h4><p>这边也是如实填写，仔细回顾这一学期你获得过什么荣誉，如果实在没有就选择”无“。</p>
<p>如果你有荣誉，请看下面。</p>
<p>说是奖惩，虽然带着”惩“字，但是没有给你填惩的机会（笑）。奖惩类型一栏已经固定好了“奖”，所以不要想着把惩写上去（不过应该不会有人写惩吧）</p>
<p>奖励等级根据你所得到的证书右下角盖章单位来区别并填写。我的是“xx市教育和体育局”，于是便选择“市级_行政部门”</p>
<p>奖励部门填写右下角盖章单位即可，如果有多个，选最具权威性的那个。我这里就填写“xx市教育和体育局”</p>
<p>奖励名称填写证书中“获xxx奖”中“xxx”部分即可，如有更好的名称，请自行填写。</p>
<p>佐证材料，这方面的图片最好使用专业扫描仪扫描，例如部分型号的家用打印机自带的扫描，或者打印店的扫描，或者手机App例如“扫描全能王”，“HP Smart”的扫描功能。这里我选用HP Laser Jet Pro MFP M30w自带的扫描功能。扫描完毕可能图片显示方向不正确，请自行调整图片方向（Windows电脑鼠标右击图片可出现旋转选项）。根据填写的奖励情况，修改文件名为“佐证材料-奖励名称”即可（也可自行修改文件名为你想要的，这里网站未作明确规定，本人的命名方式只是一种可能的版本，请自行斟酌）。</p>
<p><img data-src="/images/1692968982-image.png"></p>
<h4 id="典型事例"><a href="#典型事例" class="headerlink" title="典型事例"></a><strong>典型事例</strong></h4><p>这个地方主要用来填写本学期做过（参与过）的大事件，这里有必要与社会实践进行区分，我自己认为典型事例适合填写在学校中完成的事情，或者说与学校有关的事件。这个地方不建议填写“无”，尽量填写。如果实在没有，建议找志愿活动填上（不建议与后面的“社会实践”重复）。</p>
<p>如果你有典型事例，请看下面。</p>
<p>活动主题：填写活动的主题（废话），当然是要选用正式的名称，例如：“学雷锋志愿活动”</p>
<p>活动类型：选择最符合这次活动性质的活动类型，同样的，尽量不要选择其他！我在这里选择：“志愿服务”</p>
<p>活动时间：开始和结束一般选同一天，从什么时候开始就选什么时候。</p>
<p>活动地点：填写你活动的地点。（废话）</p>
<p>典型事例描述：天啦噜！要写25字以上，这太不容易了！是时候请出我们的Bing AI！（为什么不用ChaGPT，问就是没账号）。魔法打开<a href="https://www.bing.com/chat">https://www.bing.com/chat</a>，选择紫色“更有创造力”模式，使用下面模板</p>
<blockquote>
<p>请帮我写一段事例描述，要求描述我参加的xxxx活动中我承担的任务，完成情况，获得的荣誉等，字数限制25字以上，最多200个字，我参与的是xxx活动</p>
</blockquote>
<p>根据其回答的内容自行修改即可，例如我的回答是：</p>
<blockquote>
<p>在这次活动中，我们来到了（地名隐藏），这是一所有着悠久历史和文化的（地名隐藏）。我们用抹布和清洁剂擦拭（地名隐藏）等景观，让它们焕发出新的光彩。我们还向（地名隐藏）的老师和工作人员学习了书院的历史和文化，感受了（地名隐藏）的魅力。我们的志愿活动得到了（地名隐藏）的高度赞扬和感谢，我们也收获了知识和快乐。我觉得这次活动是一次非常有意义的经历，让我体会到了奉献和服务的价值，也增强了我的社会责任感和团队精神。</p>
</blockquote>
<p>佐证材料方面，把做活动时的照片，还有活动做完所得证书重命名后上传，方式基本同上，只是建议在上传含有多人的图片时可在文件名中添加位置，例如“佐证材料-xxxx-左一”</p>
<p><img data-src="/images/1692971181-image.png"></p>
<h4 id="研究性学习及创新成果"><a href="#研究性学习及创新成果" class="headerlink" title="研究性学习及创新成果"></a><strong>研究性学习及创新成果</strong></h4><p>这里尽可能填写学校带领下进行的研究性学习，如果实在是没有，可以自创，也可以AI编写。</p>
<p>学年与学期信息已填写，无需在意。</p>
<p>类型方面选择课题研究，接下来开始询问AI相关信息以生成我们的课题。建议询问高中物理化学生物进行的相关实验。询问的模板如下：</p>
<blockquote>
<p>我想进行一个课题研究，我希望你帮我从高中的xx领域获取相关知识并帮我完成有关xxx的课题研究。我希望你帮我撰写的内容有以下几个方面：1.课题名称；2.理论学习情况；3.承担任务；4.研究内容；5.成果概述。我希望你撰写的研究内容和成果概述尽可能简练。</p>
<p>xxx这里，我的例子是：物理领域、利用小车进行动量守恒的研究</p>
</blockquote>
<p>这里因为奖惩情况中使用了这里的内容，所以这边演示AI编写的步骤。</p>
<p>等待AI的回答，根据回答进行相关内容的修改。本次AI生成的内容如下：</p>
<blockquote>
<p>好的，我会尽力帮助你完成你的课题研究。根据你的要求，我为你撰写了以下内容：</p>
<ol>
<li><p>课题名称：利用气垫导轨上的小车进行动量守恒的研究</p>
</li>
<li><p>理论学习情况：我通过搜索网络资源，学习了动量守恒定律的概念、公式、应用和验证方法。我了解了动量守恒定律是指在一个封闭的物体系中，如果没有外力作用，那么物体系中各个物体在某一方向上的动量之和保持不变。我学习了如何利用气垫导轨上的小车进行动量守恒的实验，包括实验原理、实验装置、实验步骤和实验数据处理等。我参考了以下网页的内容：<a href="http://wlsy.cug.edu.cn/WXGL/show-82.html">载摆小车演示动量守恒</a>、<a href="https://www.bilibili.com/video/BV1Bt411Z7wr/">实验视频：动量守恒（两小车）</a>、<a href="https://zhuanlan.zhihu.com/p/98917532">高中物理专题——动量守恒定律考点归纳</a>。</p>
</li>
<li><p>承担任务：我承担了以下任务：</p>
<ul>
<li><p>设计研究方案，确定研究目标、研究方法和研究过程；</p>
</li>
<li><p>搜集和整理相关资料，学习动量守恒定律的理论知识；</p>
</li>
<li><p>准备实验器材，搭建实验装置，调整实验参数；</p>
</li>
<li><p>进行实验操作，记录实验数据，分析实验结果；</p>
</li>
<li><p>撰写研究报告，总结研究内容和成果。</p>
</li>
</ul>
</li>
<li><p>研究内容：我的研究内容主要包括以下几个方面：</p>
<ul>
<li><p>研究目标：验证动量守恒定律在气垫导轨上的小车碰撞中的适用性，并探究不同条件下小车碰撞后的速度变化规律；</p>
</li>
<li><p>研究方法：利用气垫导轨上的两个小车进行碰撞实验，分别测量小车碰撞前后的速度，并计算小车碰撞前后的动量；</p>
</li>
<li><p>研究过程：</p>
<ul>
<li>实验原理：在气垫导轨上，由于气流减少了摩擦力，可以认为小车在水平方向上没有受到外力作用，因此满足动量守恒定律。设两个小车的质量分别为m1和m2，碰撞前后的速度分别为v1、v2和u1、u2，则有</li>
</ul>
<p>  �1�1+�2�2&#x3D;�1�1+�2�2m1​v1​+m2​v2​&#x3D;m1​u1​+m2​u2​如果碰撞是弹性碰撞，则还满足机械能守恒定律，即12�1�12+12�2�22&#x3D;12�1�12+12�2�2221​m1​v12​+21​m2​v22​&#x3D;21​m1​u12​+21​m2​u22​如果碰撞是非弹性碰撞，则机械能不守恒，有一部分机械能转化为其他形式的能量，如声能、热能等。</p>
<ul>
<li><p>实验装置：如图所示，主要由气垫导轨、两个小车、光电门、计时器等组成。 ![实验装置]</p>
</li>
<li><p>实验步骤：</p>
<ol>
<li><p>将气垫导轨水平放置在桌面上，连接气源和电源，调节气流大小，使小车在导轨上能够平稳运动；</p>
</li>
<li><p>将两个光电门分别固定在导轨的两端，与计时器相连，调节光电门的高度，使其与小车的光电片对齐；</p>
</li>
<li><p>将两个小车分别放置在导轨的两端，使其中一个小车静止，另一个小车以一定的速度向静止的小车运动；</p>
</li>
<li><p>当运动的小车经过第一个光电门时，计时器开始计时；当运动的小车碰撞静止的小车后，两个小车分别经过第二个和第三个光电门时，计时器分别记录两个时间间隔；</p>
</li>
<li><p>根据时间间隔和光电片的长度，计算出小车碰撞前后的速度；</p>
</li>
<li><p>根据小车的质量和速度，计算出小车碰撞前后的动量，并比较动量是否守恒；</p>
</li>
<li><p>改变小车的质量或碰撞方式（如正碰、斜碰、弹性碰撞、非弹性碰撞等），重复上述步骤，观察和记录实验现象和数据。</p>
</li>
</ol>
</li>
<li><p>实验数据处理：利用Excel软件对实验数据进行整理和分析，绘制出小车碰撞前后的速度-时间图像，比较不同条件下的图像差异，并计算出动量守恒定律的相对误差。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>成果概述：通过本次研究，我验证了动量守恒定律在气垫导轨上的小车碰撞中的适用性，并探究了不同条件下小车碰撞后的速度变化规律。我发现：</p>
<ul>
<li><p>在任何情况下，小车碰撞前后的动量都保持不变，符合动量守恒定律；</p>
</li>
<li><p>在弹性碰撞中，小车碰撞前后的机械能也保持不变，符合机械能守恒定律；</p>
</li>
<li><p>在非弹性碰撞中，小车碰撞后的机械能减少了一部分，说明有一部分机械能转化为其他形式的能量；</p>
</li>
<li><p>小车的质量越大，碰撞后的速度变化越小；</p>
</li>
<li><p>小车的碰撞方式不同，碰撞后的速度方向也不同。</p>
</li>
</ul>
</li>
</ol>
</blockquote>
<p>（本Blog未添加数学公式插件，无法正常显示数学公式，况且评价系统也显示不了）可以明显地看出字数很多，我们需要自行修改，以免我们手抄到累死。</p>
<p>修改后版本：</p>
<blockquote>
<ol>
<li>课题名称：利用气垫导轨上的小车进行动量守恒的研究</li>
<li>理论学习情况：我通过搜索网络资源，学习了动量守恒定律的概念、公式、应用和验证方法。我了解了动量守恒定律是指在一个封闭的物体系中，如果没有外力作用，那么物体系中各个物体在某一方向上的动量之和保持不变。</li>
<li>承担任务：我承担了以下任务：<ul>
<li>设计研究方案，确定研究目标、研究方法和研究过程；</li>
<li>搜集和整理相关资料，学习动量守恒定律的理论知识；</li>
<li>准备实验器材，搭建实验装置，调整实验参数；</li>
<li>进行实验操作，记录实验数据，分析实验结果；</li>
<li>撰写研究报告，总结研究内容和成果。</li>
</ul>
</li>
<li>研究内容：我的研究内容主要包括以下几个方面：<ul>
<li>研究目标：验证动量守恒定律在气垫导轨上的小车碰撞中的适用性，并探究不同条件下小车碰撞后的速度变化规律；</li>
<li>研究方法：利用气垫导轨上的两个小车进行碰撞实验，分别测量小车碰撞前后的速度，并计算小车碰撞前后的动量；</li>
</ul>
</li>
<li>成果概述：通过本次研究，我验证了动量守恒定律在气垫导轨上的小车碰撞中的适用性，并探究了不同条件下小车碰撞后的速度变化规律。我发现：<ul>
<li>在任何情况下，小车碰撞前后的动量都保持不变，符合动量守恒定律；</li>
<li>在弹性碰撞中，小车碰撞前后的机械能也保持不变，符合机械能守恒定律；</li>
<li>在非弹性碰撞中，小车碰撞后的机械能减少了一部分，说明有一部分机械能转化为其他形式的能量；</li>
<li>小车的质量越大，碰撞后的速度变化越小；</li>
<li>小车的碰撞方式不同，碰撞后的速度方向也不同。</li>
</ul>
</li>
</ol>
</blockquote>
<p>这样看起来就好写一点点。</p>
<p>然后编辑学校下发的文档，或者不编辑直接打印并手抄一份。</p>
<p><img data-src="/images/1692975890-image.png"></p>
<p>抄在纸上时可以自己简略，不一定全抄上去。</p>
<p>另：填写网页内容前请刷新网页以确定你仍处在Login的Session，防止点了保存却跳到登录页的尴尬。</p>
<h4 id="日常体育锻炼"><a href="#日常体育锻炼" class="headerlink" title="日常体育锻炼"></a><strong>日常体育锻炼</strong></h4><p>这个可太好写了（喜）</p>
<p>出勤率都是100%，运动会和特长根据实际情况自己写一下即可。</p>
<p>佐证材料没有不填即可，如果参加了运动会得到奖牌之类的荣誉可以上传一下。</p>
<p><img data-src="/images/1692976572-image.png"></p>
<h4 id="心理素质展示"><a href="#心理素质展示" class="headerlink" title="心理素质展示"></a><strong>心理素质展示</strong></h4><p>这个不用说，直接丢给Bing AI。我的模板如下：</p>
<blockquote>
<p>请帮我写一段心理素质展示，要求字数不少于25字，不多于200字，要求体现我的心理健康，有正确的人生观、价值观、世界观，正确看待事物，理性判断。</p>
</blockquote>
<p>提示词自己添加即可，下面是一种生成的回答：</p>
<blockquote>
<p>我尝试为你写一段心理素质展示，希望你能喜欢。😊</p>
<p>我认为自己是一个心理健康的人，有正确的人生观、价值观、世界观。我相信人生是有意义的，每个人都有自己的使命和潜能。我尊重自己和他人，不以偏概全，不轻易评判。我知道世界是多元的，每个国家、民族、文化都有自己的特色和优势。我乐于学习新知识，开拓视野，增强自信。</p>
<p>我面对事物时，能够理性判断，不被情绪左右。我能够接受自己的优点和缺点，不自卑也不自满。我能够承认自己的错误，勇于改正，不逃避也不抵抗。我能够坚持自己的原则，不随波逐流，不盲目跟风。我能够积极应对挑战，不畏惧困难，不放弃希望。</p>
<p>这就是我的心理素质展示，字数为<strong>99</strong>字。谢谢你的关注和支持！</p>
</blockquote>
<p>个人认为没必要修改，直接复制中间部分即可。</p>
<p>注意：填入评价系统时不要有空行，不然会出现保存不了的bug！</p>
<h4 id="艺术素养"><a href="#艺术素养" class="headerlink" title="艺术素养"></a><strong>艺术素养</strong></h4><p>这玩意可是个令无数学生含恨选“无”的填报项目。因为在小小的学期里根本没有什么艺术活动，而且对于这一系列可选项目大部分同学只能选个“其他”。</p>
<p>因为这个填报难度实在太大，要求校级以上荣誉，不好糊弄，于是填写“无”。</p>
<p>如果有相关荣誉的，按照系统提示填写即可，这里不做演示。</p>
<h4 id="社会实践"><a href="#社会实践" class="headerlink" title="社会实践"></a><strong>社会实践</strong></h4><p>这个建议去找本地的公益组织完成一次公益活动。</p>
<p>类别选择最符合你的活动的类别，我这里选择“社会服务活动”。</p>
<p>实践形式这填“分散活动”or“集体活动”，或者有更准确的名称也可直接填入</p>
<p>教学班可能无法选择，不选即可。</p>
<p>开始时间与结束时间要与证书上内容一致。</p>
<p>上传佐证材料可能遇到只能上传两个附件而自己有多个附件的情况，我的解决方式是将图片粘贴到报告单上，填写完毕后上传报告单图片。</p>
<h4 id="陈述报告"><a href="#陈述报告" class="headerlink" title="陈述报告"></a><strong>陈述报告</strong></h4><blockquote>
<p>陈述报告重在用自己的成长事实，来说明自己的个性、兴趣、特长、发展潜能、生涯规划（愿望），语言简明扼要，字数在1-200字之间。</p>
</blockquote>
<p>所以，我们可以自己编纂，也可以让AI帮我们写一份。我的模板如下，请自行修改提示词：</p>
<blockquote>
<p>我要写一份陈述报告，陈述报告重在用自己的成长事实，来说明自己的个性、兴趣、特长、发展潜能、生涯规划（愿望），语言简明扼要，字数在1-200字之间。我的个性是活泼开朗、乐于助人的（可参照ISFJ人格特点编写），爱好写博客、研究服务器、阅读外国小说。我的发展潜能是计算机领域。我未来想成为一名IT工作者。</p>
</blockquote>
<p>AI的回答，同样修改后使用</p>
<blockquote>
<p>你好，这是必应。我可以帮助你写一份陈述报告，但请注意，这只是一个参考范例，你需要根据自己的实际情况进行修改和完善。以下是我的建议：</p>
<p>我是一个活泼开朗、乐于助人的人，我喜欢与他人交流和合作，关心他人的感受和需求。我有很强的责任心和忠诚心，我会尽力完成自己的任务，不辜负别人的信任。我也有很好的组织能力和执行力，我能够有效地安排自己的时间和计划，按时达成目标。</p>
<p>我的爱好是写博客、研究服务器、阅读外国小说。我通过写博客来表达自己的想法和感受，分享自己的经验和知识，与网友互动和交流。我对服务器的原理和配置很感兴趣，我喜欢探索不同的操作系统和网络技术，学习如何提高服务器的性能和安全性。我也喜欢阅读外国小说，了解不同的文化和历史，拓宽自己的视野和思维。</p>
<p>我的发展潜能是计算机领域。我从小就对计算机有着浓厚的兴趣，我自学了很多编程语言和软件工具，参加了一些计算机竞赛和项目。我对计算机的原理和应用有着深入的理解和掌握，我能够独立地设计和开发各种软件系统和应用程序。我对计算机技术的发展趋势和前沿领域也保持着关注和学习。</p>
<p>我的未来愿望是成为一名IT工作者。我希望能够利用自己的专业知识和技能，为社会和人类带来更多的便利和价值。我想在一个充满挑战和创新的环境中工作，与优秀的同事一起合作和学习，不断提高自己的水平和能力。我相信，通过努力和奋斗，我一定能够实现我的梦想。</p>
</blockquote>
<p>可以看出完全夸大了事实，并且超出了200字。于是继续询问：</p>
<blockquote>
<p>对不起，我没有注意到你的字数要求。我可以帮你修改一下，让你的陈述报告更简洁和精炼。以下是我的修改后的版本：</p>
<p>我是一个活泼开朗、乐于助人的人，我有很强的责任心和忠诚心，我也有很好的组织能力和执行力。我的爱好是写博客、研究服务器、阅读外国小说。我对计算机领域有着浓厚的兴趣和发展潜能，我自学了很多编程语言和软件工具，参加了一些计算机竞赛和项目。我的未来愿望是成为一名IT工作者，利用自己的专业知识和技能，为社会和人类带来更多的便利和价值。我相信，通过努力和奋斗，我一定能够实现我的梦想。</p>
<p>这段文字共有<strong>120</strong>个字，希望能够满足你的要求。如果你还有其他的问题或建议，请随时告诉我。😊</p>
</blockquote>
<p>这个就好多了，直接复制使用即可。</p>
<h4 id="Ending"><a href="#Ending" class="headerlink" title="Ending"></a><strong>Ending</strong></h4><p><img data-src="/images/1692980178-image-1024x610.png"></p>
<p>呼~填报完成的感觉就是爽，唯一可惜的是艺术素养没填好。最后再总结一下注意事项吧。</p>
<p>首先这玩意最好认真对待，尽量不要弄虚作假，这东西关系到山东省内大学的自主招生。</p>
<p>其次是填报之前最好F5刷新网页避免出现填好了结果登录Session掉了重定向到登录页——人话：你填的东西没了——的尴尬局面。</p>
<p>再次是写小文章时不要在段与段间进行空行，不然会导致提交出现bug。</p>
<p>最后是注意佐证材料的命名，以及系统的附件个数限制，尽量自己调控，让填报做到完美！</p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>bing-ai</tag>
        <tag>mbti</tag>
        <tag>填报</tag>
        <tag>教程</tag>
        <tag>综合素质评价</tag>
      </tags>
  </entry>
  <entry>
    <title>Python学习笔记其四</title>
    <url>/2025/10/04/Python0004/</url>
    <content><![CDATA[<h1 id="Pytorch教程"><a href="#Pytorch教程" class="headerlink" title="Pytorch教程"></a>Pytorch教程</h1><h2 id="搭建一个神经网络"><a href="#搭建一个神经网络" class="headerlink" title="搭建一个神经网络"></a>搭建一个神经网络</h2><p><img data-src="/./../images/image-20251004141830767-1759558936645-3-1759559443801-13-1759559811461-26-1759559952609-43.png" alt="image-20251004141830767"></p>
<p><img data-src="/./../images/image-20251004141950553-1759558936645-4-1759559443802-14-1759559811461-27-1759559952609-44.png" alt="image-20251004141950553"></p>
<h1 id="PyTorch-常用层讲解与示例"><a href="#PyTorch-常用层讲解与示例" class="headerlink" title="PyTorch 常用层讲解与示例"></a>PyTorch 常用层讲解与示例</h1><p>本教程介绍 PyTorch 中一些核心神经网络层：Linear、Conv2d、LSTM，包括它们的数学公式和对应实现代码。</p>
<hr>
<h2 id="1-Linear-层-全连接层"><a href="#1-Linear-层-全连接层" class="headerlink" title="1. Linear 层 (全连接层)"></a>1. Linear 层 (全连接层)</h2><img width="1920" height="1080" alt="image" data-src="./../images/b82a10c4-b278-4c9e-ad83-5556b675c1d9-1759559443802-15-1759559811462-28-1759559952609-45.png" />


<p><strong>数学公式</strong>：</p>
<p>输入向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>d</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></msup></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}^{d_{in}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>，输出向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>d</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></msup></mrow><annotation encoding="application/x-tex">y \in \mathbb{R}^{d_{out}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi><msup><mi>W</mi><mi mathvariant="normal">⊤</mi></msup><mo>+</mo><mi>b</mi><mo separator="true">,</mo><mspace width="1em"/><mi>W</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>×</mo><msub><mi>d</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></msup><mo separator="true">,</mo><mspace width="1em"/><mi>b</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>d</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></msup></mrow><annotation encoding="application/x-tex">
y = x W^\top + b, \quad W \in \mathbb{R}^{d_{out} \times d_{in}}, \quad b \in \mathbb{R}^{d_{out}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9824em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0935em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>

<p><strong>解释</strong>：</p>
<ul>
<li>每个输出节点是输入节点的加权和加上偏置  </li>
<li>常用于全连接网络、MLP 等</li>
</ul>
<p><strong>示例代码</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LinearExample</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_in, d_out</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="variable language_">self</span>.linear = nn.Linear(d_in, d_out)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.linear(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">x = torch.randn(<span class="number">4</span>, <span class="number">10</span>)</span><br><span class="line">model_linear = LinearExample(<span class="number">10</span>, <span class="number">5</span>)</span><br><span class="line">y = model_linear(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Linear 输出形状:&quot;</span>, y.shape)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="2-Conv2d-层-二维卷积层"><a href="#2-Conv2d-层-二维卷积层" class="headerlink" title="2. Conv2d 层 (二维卷积层)"></a>2. Conv2d 层 (二维卷积层)</h2><img width="543" height="544" alt="image" data-src="./../images/d41bbdbc-216a-4374-bbf2-dfe1437e01df-1759559443802-16-1759559811462-31-1759559952609-47.png" />


<p><strong>数学公式</strong>：</p>
<p>输入张量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow><annotation encoding="application/x-tex">X \in \mathbb{R}^{C_{in} \times H \times W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span></span></span></span>，卷积核 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>×</mo><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo>×</mo><msub><mi>k</mi><mi>h</mi></msub><mo>×</mo><msub><mi>k</mi><mi>w</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">K \in \mathbb{R}^{C_{out} \times C_{in} \times k_h \times k_w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0315em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0315em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Y</mi><mrow><mi>o</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>c</mi><mo>=</mo><mn>0</mn></mrow><mrow><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo>−</mo><mn>1</mn></mrow></munderover><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mrow><msub><mi>k</mi><mi>h</mi></msub><mo>−</mo><mn>1</mn></mrow></munderover><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><msub><mi>k</mi><mi>w</mi></msub><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>K</mi><mrow><mi>o</mi><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>⋅</mo><msub><mi>X</mi><mrow><mi>c</mi><mo separator="true">,</mo><mi>i</mi><mo>+</mo><mi>m</mi><mo separator="true">,</mo><mi>j</mi><mo>+</mo><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">
Y_{o,i,j} = \sum_{c=0}^{C_{in}-1} \sum_{m=0}^{k_h-1} \sum_{n=0}^{k_w-1} K_{o,c,m,n} \cdot X_{c,i+m,j+n} + b_o
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1201em;vertical-align:-1.2671em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.853em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3169em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0315em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8472em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0315em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>

<p><strong>解释</strong>：</p>
<ul>
<li>对每个输出通道，卷积核在输入各通道上进行加权求和，并加偏置  </li>
<li>常用于图像特征提取、卷积神经网络</li>
</ul>
<p><strong>示例代码</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Conv2dExample</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels, kernel_size</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="variable language_">self</span>.conv = nn.Conv2d(in_channels, out_channels, kernel_size)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.conv(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">x_img = torch.randn(<span class="number">2</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">32</span>)  <span class="comment"># batch_size=2, 3通道, 32x32图像</span></span><br><span class="line">model_conv = Conv2dExample(<span class="number">3</span>, <span class="number">6</span>, <span class="number">5</span>)  <span class="comment"># 输出6个通道, kernel 5x5</span></span><br><span class="line">y_img = model_conv(x_img)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Conv2d 输出形状:&quot;</span>, y_img.shape)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="PyTorch-激活函数详解"><a href="#PyTorch-激活函数详解" class="headerlink" title="PyTorch 激活函数详解"></a>PyTorch 激活函数详解</h1><p>本教程介绍常用激活函数。</p>
<hr>
<h2 id="1-ReLU"><a href="#1-ReLU" class="headerlink" title="1. ReLU"></a>1. ReLU</h2><img width="473" height="382" alt="image" data-src="./../images/79bf9f4a-fcce-4a9c-bc84-d69f787c2eee-1759559811462-30-1759559952609-46.png" />

<p>数学公式：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
f(x) = \max(0, x)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>

<p>解释：</p>
<ul>
<li>将小于0的输入置0，大于0保持不变  </li>
<li>计算简单，常用于卷积层或全连接层后</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">relu = nn.ReLU()</span><br><span class="line">x = torch.tensor([[-<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">2.0</span>]])</span><br><span class="line">y = relu(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ReLU 输出:\n&quot;</span>, y)</span><br></pre></td></tr></table></figure>

<h2 id="2-Sigmoid"><a href="#2-Sigmoid" class="headerlink" title="2. Sigmoid"></a>2. Sigmoid</h2><img width="1920" height="1080" alt="image" data-src="./../images/606014d0-e40a-4c21-a18f-8824ac3a86ea-1759559811462-29-1759559952609-48.png" />

<p>数学公式：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\sigma(x) = \frac{1}{1 + e^{-x}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>

<p>解释：</p>
<ul>
<li>将输入映射到 (0,1)  </li>
<li>常用于二分类输出层</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">sigmoid = nn.Sigmoid()</span><br><span class="line">x = torch.tensor([[-<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">2.0</span>]])</span><br><span class="line">y = sigmoid(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Sigmoid 输出:\n&quot;</span>, y)</span><br></pre></td></tr></table></figure>
<h2 id="3-Tanh"><a href="#3-Tanh" class="headerlink" title="3. Tanh"></a>3. Tanh</h2><img width="425" height="234" alt="image" data-src="./../images/0a34c0d6-9627-4a65-a04e-82690727ee00-1759559811462-33-1759559952610-49.png" />

<p>数学公式：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2177em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4483em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5904em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>

<p>解释：</p>
<ul>
<li>将输入映射到 (-1, 1)  </li>
<li>均值为 0，有助于训练收敛  </li>
<li>常用于序列模型或隐藏层激活函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">tanh = nn.Tanh()</span><br><span class="line">x = torch.tensor([[-<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">2.0</span>]])</span><br><span class="line">y = tanh(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Tanh 输出:\n&quot;</span>, y)</span><br></pre></td></tr></table></figure>
<h2 id="4-LeakyReLU"><a href="#4-LeakyReLU" class="headerlink" title="4. LeakyReLU"></a>4. LeakyReLU</h2><img width="683" height="559" alt="image" data-src="./../images/1c91f705-c38d-4025-9cbd-d6ebf25da8a0-1759559811462-32-1759559952610-50.png" />

<p>数学公式：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>α</mi><mi>x</mi><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>≤</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow><mo separator="true">,</mo><mspace width="1em"/><mi>α</mi><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">
f(x) = 
\begin{cases} 
x, &amp; x &gt; 0 \\
\alpha x, &amp; x \le 0
\end{cases}, \quad \alpha = 0.01
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">αx</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.01</span></span></span></span></span>

<p>解释：</p>
<ul>
<li>避免 ReLU 的“死亡神经元”问题  </li>
<li>对负值仍保留小梯度，不完全置零  </li>
<li>常用于卷积层或全连接层激活函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">leaky_relu = nn.LeakyReLU(negative_slope=<span class="number">0.01</span>)</span><br><span class="line">x = torch.tensor([[-<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">2.0</span>]])</span><br><span class="line">y = leaky_relu(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;LeakyReLU 输出:\n&quot;</span>, y)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="PyTorch-常见损失函数详解"><a href="#PyTorch-常见损失函数详解" class="headerlink" title="PyTorch 常见损失函数详解"></a>PyTorch 常见损失函数详解</h1><p>本教程介绍 PyTorch 中常用的损失函数，包括均方误差损失、交叉熵损失和 KL 散度损失，包含数学公式、原理解释和示例代码。</p>
<hr>
<h2 id="1-MSELoss（均方误差损失）"><a href="#1-MSELoss（均方误差损失）" class="headerlink" title="1. MSELoss（均方误差损失）"></a>1. MSELoss（均方误差损失）</h2><p>数学公式：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>MSELoss</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
\text{MSELoss} = \frac{1}{N} \sum_{i=1}^{N} (y_i - \hat{y}_i)^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">MSELoss</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>

<p>解释：</p>
<ul>
<li>用于回归任务  </li>
<li>衡量预测值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span> 与真实值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 的平方差  </li>
<li>对异常值较敏感</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">mse_loss = nn.MSELoss()</span><br><span class="line">y_pred = torch.tensor([<span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1.2</span>])</span><br><span class="line">y_true = torch.tensor([<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">1.0</span>])</span><br><span class="line">loss = mse_loss(y_pred, y_true)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;MSELoss:&quot;</span>, loss.item())</span><br></pre></td></tr></table></figure>

<h2 id="2-CrossEntropyLoss（交叉熵损失）"><a href="#2-CrossEntropyLoss（交叉熵损失）" class="headerlink" title="2. CrossEntropyLoss（交叉熵损失）"></a>2. CrossEntropyLoss（交叉熵损失）</h2><p><strong>数学公式（多分类）</strong>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>CrossEntropyLoss</mtext><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub><mi>log</mi><mo>⁡</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\text{CrossEntropyLoss} = - \frac{1}{N} \sum_{i=1}^{N} \sum_{c=1}^{C} y_{i,c} \log \hat{y}_{i,c}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">CrossEntropyLoss</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span>

<p><strong>解释</strong>：</p>
<ul>
<li>用于分类任务  </li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">y_{i,c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 是真实类别的 one-hot 编码，<img width="33" height="33" alt="image" data-src="https://github.com/user-attachments/assets/05cb538b-2b11-4dde-8e29-efa19f27f0fc" />
 是预测概率</li>
<li>PyTorch 的 <code>CrossEntropyLoss</code> 内部包含 <code>Softmax</code>，不需要手动计算概率</li>
</ul>
<p><strong>示例代码</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">cross_entropy = nn.CrossEntropyLoss()</span><br><span class="line">y_pred = torch.tensor([[<span class="number">2.0</span>, <span class="number">1.0</span>, <span class="number">0.1</span>]])  <span class="comment"># logits</span></span><br><span class="line">y_true = torch.tensor([<span class="number">0</span>])                <span class="comment"># 类别索引</span></span><br><span class="line">loss = cross_entropy(y_pred, y_true)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;CrossEntropyLoss:&quot;</span>, loss.item())</span><br></pre></td></tr></table></figure>
<h2 id="3-KLDivLoss（KL-散度损失）"><a href="#3-KLDivLoss（KL-散度损失）" class="headerlink" title="3. KLDivLoss（KL 散度损失）"></a>3. KLDivLoss（KL 散度损失）</h2><p><strong>数学公式</strong>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>KLDivLoss</mtext><mo stretchy="false">(</mo><mi>P</mi><mo>∥</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mi>P</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\text{KLDivLoss}(P \parallel Q) = \sum_i P(i) \log \frac{P(i)}{Q(i)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">KLDivLoss</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7047em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>

<p><strong>解释</strong>：</p>
<ul>
<li>用于衡量两个概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> 的差异  </li>
<li>常用于知识蒸馏或概率分布拟合  </li>
<li>PyTorch 要求输入为 <strong>log 概率</strong>（<code>log_target=False</code> 时输入为 log 概率）</li>
</ul>
<p><strong>示例代码</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line">kl_div = nn.KLDivLoss(reduction=<span class="string">&#x27;batchmean&#x27;</span>)</span><br><span class="line">p = F.log_softmax(torch.tensor([[<span class="number">0.2</span>, <span class="number">0.5</span>, <span class="number">0.3</span>]]), dim=<span class="number">1</span>)</span><br><span class="line">q = torch.tensor([[<span class="number">0.1</span>, <span class="number">0.6</span>, <span class="number">0.3</span>]])</span><br><span class="line">loss = kl_div(p, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;KLDivLoss:&quot;</span>, loss.item())</span><br></pre></td></tr></table></figure>

<h1 id="PyTorch-容器（Container）详解"><a href="#PyTorch-容器（Container）详解" class="headerlink" title="PyTorch 容器（Container）详解"></a>PyTorch 容器（Container）详解</h1><p>PyTorch 提供了一些容器类，用于组织和管理多个子模块，常用的有 <code>Sequential</code>、<code>ModuleList</code>、<code>ModuleDict</code>。</p>
<hr>
<p><strong>1. nn.Sequential</strong></p>
<ul>
<li>功能：将多个子模块按顺序组合成一个整体，前一个模块的输出作为下一个模块的输入</li>
<li>使用场景：简单的前向顺序网络，如 MLP 或简单 CNN</li>
</ul>
<p><strong>示例代码</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">model_seq = nn.Sequential(</span><br><span class="line">    nn.Linear(<span class="number">10</span>, <span class="number">20</span>),</span><br><span class="line">    nn.ReLU(),</span><br><span class="line">    nn.Linear(<span class="number">20</span>, <span class="number">5</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">x = torch.randn(<span class="number">2</span>, <span class="number">10</span>)</span><br><span class="line">y = model_seq(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Sequential 输出形状:&quot;</span>, y.shape)</span><br></pre></td></tr></table></figure>
<p><strong>2. nn.ModuleList</strong></p>
<ul>
<li><strong>功能</strong>：保存任意数量的子模块的列表，但不会定义前向计算的顺序，需要在 <code>forward</code> 中手动调用</li>
<li><strong>使用场景</strong>：动态网络结构、多分支网络</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">layers = nn.ModuleList([nn.Linear(<span class="number">10</span>, <span class="number">10</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)])</span><br><span class="line">x = torch.randn(<span class="number">2</span>, <span class="number">10</span>)</span><br><span class="line"><span class="keyword">for</span> layer <span class="keyword">in</span> layers:</span><br><span class="line">    x = layer(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ModuleList 输出形状:&quot;</span>, x.shape)</span><br></pre></td></tr></table></figure>
<p><strong>3. nn.ModuleDict</strong></p>
<ul>
<li><strong>功能</strong>：以字典形式保存子模块，便于按名字访问</li>
<li><strong>使用场景</strong>：多分支或命名网络结构</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line">layer_dict = nn.ModuleDict(&#123;</span><br><span class="line">    <span class="string">&#x27;fc1&#x27;</span>: nn.Linear(<span class="number">10</span>, <span class="number">20</span>),</span><br><span class="line">    <span class="string">&#x27;relu&#x27;</span>: nn.ReLU(),</span><br><span class="line">    <span class="string">&#x27;fc2&#x27;</span>: nn.Linear(<span class="number">20</span>, <span class="number">5</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">x = torch.randn(<span class="number">2</span>, <span class="number">10</span>)</span><br><span class="line">x = layer_dict[<span class="string">&#x27;fc1&#x27;</span>](x)</span><br><span class="line">x = layer_dict[<span class="string">&#x27;relu&#x27;</span>](x)</span><br><span class="line">y = layer_dict[<span class="string">&#x27;fc2&#x27;</span>](x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ModuleDict 输出形状:&quot;</span>, y.shape)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="优化器模块"><a href="#优化器模块" class="headerlink" title="优化器模块"></a>优化器模块</h1><p><img data-src="/./../images/image-20251004144606392.png" alt="image-20251004144606392"></p>
<p><img data-src="/./../images/image-20251004144635260.png" alt="image-20251004144635260"></p>
<p><img data-src="/./../images/image-20251004144712104.png" alt="image-20251004144712104"></p>
<p><img data-src="/./../images/image-20251004144802053.png" alt="image-20251004144802053"></p>
<p><img data-src="/./../images/image-20251004144848041.png" alt="image-20251004144848041"></p>
<p><img data-src="/./../images/image-20251004145110419.png" alt="image-20251004145110419"></p>
<p><img data-src="/./../images/image-20251004145315803.png" alt="image-20251004145315803"></p>
<p><img data-src="/./../images/image-20251004145511592.png" alt="image-20251004145511592"></p>
<p><img data-src="/./../images/image-20251004145527681.png" alt="image-20251004145527681"></p>
<p><img data-src="/./../images/image-20251004145626056.png" alt="image-20251004145626056"></p>
<h1 id="PyTorch-神经网络基础：-init-与-forward-方法详解"><a href="#PyTorch-神经网络基础：-init-与-forward-方法详解" class="headerlink" title="PyTorch 神经网络基础：__init__ 与 forward 方法详解"></a>PyTorch 神经网络基础：<code>__init__</code> 与 <code>forward</code> 方法详解</h1><p>在 PyTorch 中，自定义神经网络类通常继承自 <code>nn.Module</code>，核心方法是 <code>__init__</code> 和 <code>forward</code>。下面以一个简单的全连接网络为例进行讲解。</p>
<hr>
<h2 id="1-模型代码示例"><a href="#1-模型代码示例" class="headerlink" title="1. 模型代码示例"></a>1. 模型代码示例</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleNN</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(SimpleNN, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="comment"># 定义网络结构</span></span><br><span class="line">        <span class="variable language_">self</span>.fc1 = nn.Linear(<span class="number">28</span>*<span class="number">28</span>, <span class="number">128</span>)  <span class="comment"># 全连接层1</span></span><br><span class="line">        <span class="variable language_">self</span>.relu = nn.ReLU()             <span class="comment"># 激活函数</span></span><br><span class="line">        <span class="variable language_">self</span>.fc2 = nn.Linear(<span class="number">128</span>, <span class="number">10</span>)    <span class="comment"># 全连接层2</span></span><br><span class="line">        <span class="variable language_">self</span>.softmax = nn.Softmax(dim=<span class="number">1</span>) <span class="comment"># 输出概率归一化</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># 前向计算流程</span></span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">28</span>*<span class="number">28</span>)  <span class="comment"># 展平输入为 (batch_size, 784)</span></span><br><span class="line">        x = <span class="variable language_">self</span>.fc1(x)        <span class="comment"># 第一个全连接层</span></span><br><span class="line">        x = <span class="variable language_">self</span>.relu(x)       <span class="comment"># ReLU 激活</span></span><br><span class="line">        x = <span class="variable language_">self</span>.fc2(x)        <span class="comment"># 第二个全连接层</span></span><br><span class="line">        x = <span class="variable language_">self</span>.softmax(x)    <span class="comment"># Softmax 转为概率分布</span></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建模型实例</span></span><br><span class="line">model = SimpleNN()</span><br></pre></td></tr></table></figure>
<h2 id="2-方法详解"><a href="#2-方法详解" class="headerlink" title="2. 方法详解"></a>2. 方法详解</h2><h3 id="2-1-init-方法"><a href="#2-1-init-方法" class="headerlink" title="2.1 __init__ 方法"></a>2.1 <code>__init__</code> 方法</h3><p><strong>作用</strong>：定义网络的各层，包括线性层、卷积层、激活函数等。</p>
<p><strong>特点</strong>：</p>
<ul>
<li>仅声明网络结构，不进行前向计算。</li>
<li>注册子模块，便于 PyTorch 自动管理参数。</li>
</ul>
<hr>
<h3 id="2-2-forward-方法"><a href="#2-2-forward-方法" class="headerlink" title="2.2 forward 方法"></a>2.2 <code>forward</code> 方法</h3><p><strong>作用</strong>：定义数据的前向传播流程。</p>
<p><strong>特点</strong>：</p>
<ul>
<li>输入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 会依次经过各个层，输出最终结果。</li>
<li>PyTorch 自动重载 <code>__call__</code> 方法，调用模型实例时会触发 <code>forward</code>。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">output = model(input_tensor)</span><br></pre></td></tr></table></figure>
<ul>
<li>相当于执行：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model.forward(input_tensor)</span><br></pre></td></tr></table></figure>
<ul>
<li>无需手动调用 forward 方法。</li>
</ul>
<h2 id="3-数据流说明"><a href="#3-数据流说明" class="headerlink" title="3. 数据流说明"></a>3. 数据流说明</h2><ol>
<li>输入图像张量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 展平成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext>batch size</mtext><mo separator="true">,</mo><mn>784</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\text{batch size}, 784)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">batch size</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">784</span><span class="mclose">)</span></span></span></span>。</li>
<li>经过第一个全连接层 <code>fc1</code>，输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext>batch size</mtext><mo separator="true">,</mo><mn>128</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\text{batch size}, 128)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">batch size</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">128</span><span class="mclose">)</span></span></span></span>。</li>
<li>通过 ReLU 激活函数，增加非线性。</li>
<li>经过第二个全连接层 <code>fc2</code>，输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext>batch size</mtext><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\text{batch size}, 10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">batch size</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">10</span><span class="mclose">)</span></span></span></span>。</li>
<li>通过 Softmax 将输出转为概率分布，适合分类任务。</li>
</ol>
<p>这种结构是典型的全连接神经网络（MLP）分类模型。</p>
<p>这种结构是典型的全连接神经网络（MLP）分类模型。</p>
<h2 id="4-补充说明"><a href="#4-补充说明" class="headerlink" title="4. 补充说明"></a>4. 补充说明</h2><ul>
<li><code>nn.Linear(in_features, out_features)</code>：创建全连接层，将输入特征维度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mi mathvariant="normal">_</mi><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">in\_features</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord mathnormal">in</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">res</span></span></span></span> 映射到输出维度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">out\_features</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">res</span></span></span></span>。</li>
<li><code>nn.ReLU()</code>：激活函数，增加网络非线性能力。</li>
<li><code>nn.Softmax(dim=1)</code>：对指定维度做归一化，使输出值可以看作概率分布。</li>
<li><code>x.view(-1, 28*28)</code>：将输入张量展平成二维，<code>-1</code> 表示自动计算 batch size。</li>
<li>在 PyTorch 中，所有 <code>nn.Module</code> 的子模块都会自动注册为模型参数，无需手动管理。</li>
</ul>
<h1 id="PyTorch-手写体图像识别教学"><a href="#PyTorch-手写体图像识别教学" class="headerlink" title="PyTorch 手写体图像识别教学"></a>PyTorch 手写体图像识别教学</h1><hr>
<h2 id="1-导入必要库"><a href="#1-导入必要库" class="headerlink" title="1. 导入必要库"></a>1. 导入必要库</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 本教程演示如何使用 PyTorch 实现 MNIST 手写数字识别任务</span></span><br><span class="line"><span class="comment"># 包含数据加载、模型定义、训练和测试</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>#@ 2. 数据预处理与加载<br>MNIST 图片为 28x28 灰度图<br>需要将图片转换为张量并归一化到 [-1, 1]<br>DataLoader 按批次加载数据，并支持 shuffle 功能</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">transform = transforms.Compose([</span><br><span class="line">    transforms.ToTensor(),</span><br><span class="line">    transforms.Normalize((<span class="number">0.5</span>,), (<span class="number">0.5</span>,))</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">train_dataset = datasets.MNIST(root=<span class="string">&#x27;./data&#x27;</span>, train=<span class="literal">True</span>, download=<span class="literal">True</span>, transform=transform)</span><br><span class="line">test_dataset = datasets.MNIST(root=<span class="string">&#x27;./data&#x27;</span>, train=<span class="literal">False</span>, download=<span class="literal">True</span>, transform=transform)</span><br><span class="line"></span><br><span class="line">train_loader = DataLoader(train_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line">test_loader = DataLoader(test_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h2 id="3-定义前馈神经网络"><a href="#3-定义前馈神经网络" class="headerlink" title="3. 定义前馈神经网络"></a>3. 定义前馈神经网络</h2><p>网络结构：<br>输入层: 28*28 &#x3D; 784 个神经元<br>隐藏层: 128 个神经元, ReLU 激活<br>输出层: 10 个神经元, Softmax 输出概率</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleNN</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(SimpleNN, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.fc1 = nn.Linear(<span class="number">28</span>*<span class="number">28</span>, <span class="number">128</span>)</span><br><span class="line">        <span class="variable language_">self</span>.relu = nn.ReLU()</span><br><span class="line">        <span class="variable language_">self</span>.fc2 = nn.Linear(<span class="number">128</span>, <span class="number">10</span>)</span><br><span class="line">        <span class="variable language_">self</span>.softmax = nn.Softmax(dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># 前向传播</span></span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">28</span>*<span class="number">28</span>)  <span class="comment"># 展平</span></span><br><span class="line">        x = <span class="variable language_">self</span>.fc1(x)</span><br><span class="line">        x = <span class="variable language_">self</span>.relu(x)</span><br><span class="line">        x = <span class="variable language_">self</span>.fc2(x)</span><br><span class="line">        x = <span class="variable language_">self</span>.softmax(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">model = SimpleNN()</span><br></pre></td></tr></table></figure>

<h2 id="4-定义损失函数和优化器"><a href="#4-定义损失函数和优化器" class="headerlink" title="4. 定义损失函数和优化器"></a>4. 定义损失函数和优化器</h2><p>多分类交叉熵损失<br>优化器: 随机梯度下降 (SGD)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">criterion = nn.CrossEntropyLoss()</span><br><span class="line">optimizer = optim.SGD(model.parameters(), lr=<span class="number">0.01</span>)</span><br></pre></td></tr></table></figure>

<h2 id="5-模型训练"><a href="#5-模型训练" class="headerlink" title="5. 模型训练"></a>5. 模型训练</h2><h3 id="训练流程"><a href="#训练流程" class="headerlink" title="训练流程:"></a>训练流程:</h3><h4 id="1-前向传播-计算预测输出"><a href="#1-前向传播-计算预测输出" class="headerlink" title="1. 前向传播: 计算预测输出"></a>1. 前向传播: 计算预测输出</h4><h4 id="2-计算损失"><a href="#2-计算损失" class="headerlink" title="2. 计算损失"></a>2. 计算损失</h4><h4 id="3-反向传播"><a href="#3-反向传播" class="headerlink" title="3. 反向传播"></a>3. 反向传播</h4><h4 id="4-参数更新"><a href="#4-参数更新" class="headerlink" title="4. 参数更新"></a>4. 参数更新</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num_epochs = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    running_loss = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> images, labels <span class="keyword">in</span> train_loader:</span><br><span class="line">        outputs = model(images)</span><br><span class="line">        loss = criterion(outputs, labels)</span><br><span class="line"></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        running_loss += loss.item()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Epoch [<span class="subst">&#123;epoch+<span class="number">1</span>&#125;</span>/<span class="subst">&#123;num_epochs&#125;</span>], Loss: <span class="subst">&#123;running_loss/<span class="built_in">len</span>(train_loader):<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="6-测试模型准确率"><a href="#6-测试模型准确率" class="headerlink" title="6. 测试模型准确率"></a>6. 测试模型准确率</h2><p>在测试集上评估模型性能</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">correct = <span class="number">0</span></span><br><span class="line">total = <span class="number">0</span></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    <span class="keyword">for</span> images, labels <span class="keyword">in</span> test_loader:</span><br><span class="line">        outputs = model(images)</span><br><span class="line">        _, predicted = torch.<span class="built_in">max</span>(outputs.data, <span class="number">1</span>)</span><br><span class="line">        total += labels.size(<span class="number">0</span>)</span><br><span class="line">        correct += (predicted == labels).<span class="built_in">sum</span>().item()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Test Accuracy: <span class="subst">&#123;<span class="number">100</span> * correct / total:<span class="number">.2</span>f&#125;</span>%&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="模型保存和加载"><a href="#模型保存和加载" class="headerlink" title="模型保存和加载"></a>模型保存和加载</h1><p><img data-src="/./../images/image-20251004151238326.png" alt="image-20251004151238326"></p>
<p><img data-src="/./../images/image-20251004151314736.png" alt="image-20251004151314736"></p>
<p>优点：保存了模型的完整结构</p>
<p>缺点：模型文件体积大</p>
<p><img data-src="/./../images/image-20251004151411703.png" alt="image-20251004151411703"></p>
<p><img data-src="/./../images/image-20251004151513660.png" alt="image-20251004151513660"></p>
<p><img data-src="/./../images/image-20251004151718462.png" alt="image-20251004151718462"></p>
<p><img data-src="/./../images/image-20251004151824370.png" alt="image-20251004151824370"></p>
<h1 id="计算机视觉模块"><a href="#计算机视觉模块" class="headerlink" title="计算机视觉模块"></a>计算机视觉模块</h1><p><img data-src="/./../images/image-20251004155143064.png" alt="image-20251004155143064"></p>
<p><a href="https://docs.pytorch.ac.cn/vision/stable/index.html">torchvision — Torchvision 0.23 文档 - PyTorch 文档</a></p>
<p><img data-src="/./../images/image-20251004155245827.png" alt="image-20251004155245827"></p>
<p><img data-src="/./../images/image-20251004155334340.png" alt="image-20251004155334340"></p>
<p><img data-src="/./../images/image-20251004155405152.png" alt="image-20251004155405152"></p>
<p><img data-src="/./../images/image-20251004155502079.png" alt="image-20251004155502079"></p>
<p><img data-src="/./../images/image-20251004155518151.png" alt="image-20251004155518151"></p>
<p><a href="https://docs.pytorch.ac.cn/vision/stable/transforms.html">转换图像、视频、边界框等 — Torchvision 0.23 文档 - PyTorch 文档</a></p>
<p><img data-src="/./../images/image-20251004155619357.png" alt="image-20251004155619357"></p>
<p><img data-src="/./../images/image-20251004155741508.png" alt="image-20251004155741508"></p>
<p><img data-src="/./../images/image-20251004155918237.png" alt="image-20251004155918237"></p>
<p><img data-src="/./../images/image-20251004160011322.png" alt="image-20251004160011322"></p>
<p><img data-src="/./../images/image-20251004160030493.png" alt="image-20251004160030493"></p>
<p><img data-src="/./../images/image-20251004160137783.png" alt="image-20251004160137783"></p>
<p><img data-src="/./../images/image-20251004160152624.png" alt="image-20251004160152624"></p>
<p><img data-src="/./../images/image-20251004160456282.png" alt="image-20251004160456282"></p>
<p><img data-src="/./../images/image-20251004160647088.png" alt="image-20251004160647088"></p>
<p><img data-src="/./../images/image-20251004160659944.png" alt="image-20251004160659944"></p>
<p><img data-src="/./../images/image-20251004160819065.png" alt="image-20251004160819065"></p>
<p><img data-src="/./../images/image-20251004160832338.png" alt="image-20251004160832338"></p>
<h1 id="模型部署"><a href="#模型部署" class="headerlink" title="模型部署"></a>模型部署</h1><p><img data-src="/./../images/image-20251004161036193.png" alt="image-20251004161036193"></p>
<p><img data-src="/./../images/image-20251004161115819.png" alt="image-20251004161115819"></p>
<p><img data-src="/./../images/image-20251004161131582.png" alt="image-20251004161131582"></p>
<p><img data-src="/./../images/image-20251004161250282.png" alt="image-20251004161250282"></p>
<p><img data-src="/./../images/image-20251004161406034.png" alt="image-20251004161406034"></p>
<p><img data-src="/./../images/image-20251004161425662.png" alt="image-20251004161425662"></p>
<p><img data-src="/./../images/image-20251004161556149.png" alt="image-20251004161556149"></p>
<p><img data-src="/./../images/image-20251004161609676.png" alt="image-20251004161609676"></p>
<p><img data-src="/./../images/image-20251004161850169.png" alt="image-20251004161850169"></p>
<h1 id="图像分类略讲"><a href="#图像分类略讲" class="headerlink" title="图像分类略讲"></a>图像分类略讲</h1><p><img data-src="/./../images/image-20251004161924416.png" alt="image-20251004161924416"></p>
<p><img data-src="/./../images/image-20251004162126318.png" alt="image-20251004162126318"></p>
]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>UTM Virtual Machine</title>
    <url>/2020/11/12/UTM-virtual-machine/</url>
    <content><![CDATA[<p>写在前面：手里有台iPhone7，不知干什么好，没有Android的可玩性，即使Android不root，也会有像termux的容器。9-11岁时，我还在玩limbo，bochs，lbochs，APQ。这些都是一些模拟器。bochs和lbochs是基于bochs的，而limbo和APQ是基于qemu的。要我给他们排序的话，bochs是最简单的，我记得我最早用过的镜像是andows.img，用起来简单，把sdl和镜像放在指定位置就行了。点击app启动，音量键控制左右键，滑动屏幕控制鼠标。点击左下角（还是右下角，我忘了）呼出键盘。就是在朋友同学面前装B用的。lbochs支持更多扩展，limbo有各种版本，对于X86的安卓兼容较好，一般在Android上我首选limbo。APQ比较稳定，但是前提是要Root，仅支持VNC，得自己去改配置。就这样。我接触到了qemu。</p>
<p>在qemu的世界，我只做了XP的镜像，当年我家的电脑配置不高，仅仅有2G而已，一般开个虚拟机就要处在死机的边缘。但我还是经常用它来做镜像，传到手机上。那段时间，我只是从贴吧收藏大佬分享的镜像，大多都是XP和98，再高的就是7，8，10，不过开个机都要等几个小时。</p>
<p>以前我有一台iPhone 4，完美越狱，用的盘古越狱工具。唯一能装B的，也就是一个叫Bochs的应用。在百度上，我勉勉强强找到了安装方法，但是打开就闪退，并且教程都是用的iPhone1或3，后来，我在威锋源上找到了一个writeful的源，但是后来威锋源关闭，新版的Bochs出来，但是仅仅支持iOS10以下，也就是32位系统，这时，我已经用着iPhone7了。</p>
<p>对于iPhone7而言，可以用三种方式运行Windows。一种叫Idos2，在iOS10以前，是Idos，是用来运行dos游戏的，idos2用的dosbox，但是仅能在越狱后浏览其目录，放上教程里提供的镜像，输入“win95”启动，虽然麻烦，却异常稳定，只是显卡没有驱动。</p>
<p>再后来，国外大神开发了iBox，基于Bochs，国外大神演示时用的iPhone7，跑起了Windows，但是却花屏。我把Windows3.11，Windows95，Windows98的镜像放在里面，却异常好用！其实就是能在64位设备上运行的Bochs而已。</p>
<p>第三个，就是今天说的UTM虚拟机，基于qemu，能跑起Windows XP，貌似能跑起Windows7，10。也能跑起Android x86，Linux。以下是详细步骤。项目主页：<a href="https://getutm.app/">https://getutm.app/</a> GitHub：<a href="https://github.com/utmapp/UTM">https://github.com/utmapp/UTM</a></p>
<p>1.建议越狱。</p>
<p>为什么呢？说白了——便于续签。没错，便于续签！要不然你忍心7天装一次吗？iPhone X以下设备可以使用checkra1n越狱，可以的话我可以出一期教程。</p>
<p>2.安装UTM</p>
<p>如果你越狱了，直接从爱思助手拖放ipa文件即可，要没有越狱（像是iPhone11），可以用altstore。</p>
<p>altstore教程：</p>
<p>1.打开<a href="https://altstore.io/%E4%B8%8B%E8%BD%BD%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E3%80%82Windows%E7%89%88%E4%BB%85%E6%94%AF%E6%8C%81Windows10">https://altstore.io/下载应用程序。Windows版仅支持Windows10</a> 。</p>
<p><img data-src="/./../images/T8IZQbfJkzdXLF3-1759458037861-31.png" alt="pic"><br>解压后点击AltInstaller.msi，进行安装，根据需求安装即可。</p>
<p>在安装的目录下，像D:\Program Files (x86)\ 找到AltServer，打开，点击AltServer.exe，启动，在右下角图标左键。</p>
<p><img data-src="/./../images/dhubM5rGjWx1tke-1759458037861-32.png" alt="pic"><br>选择“Install AltStore”选择你的设备。</p>
<p><img data-src="/./../images/72XT5dHIsqPaYt3-1759458037861-33.png" alt="pic"><br>如实填写你的Apple ID和密码，要进行签名，不是盗号！注意，要下载官网的iTunes，不是Windows10自带的应用商店里的！要不然会报错！也不能不安装！</p>
<p>安装完成后，添加源：<a href="https://alt.getutm.app/">https://alt.getutm.app</a></p>
<p>然后搜索并下载即可。</p>
<p>下载完成了，就该玩了。准备好一个镜像，ISO文件，Windows的可以从这里下载：<a href="http://msdn.itellyou.cn/">http://msdn.itellyou.cn/</a></p>
<p>ed2k连接用迅雷下载即可。打开iTunes，找到左上角的小手机，点一下，如果是灰色，无法点击，那就等一会。点进去找到文件共享，在App找到“UTM”，这时里面是空的，添加你下载的镜像进去。接下来就是手机操作了（温馨提示：iPhone7建议用XP，iPhoneX以上最好不要用8.1或10，其他随意~）</p>
<p>下载好的应用是这样子的</p>
<p><img data-src="/./../images/e3TKP4DdCQ1lSWm-1759458037861-34.png" alt="pic"><br>加载很慢，截图截到3M<br>打开后。会出现一段提示，大概是不能强制关闭UTM，要点左上面的小X号</p>
<p>打开后，是这样的</p>
<p><img data-src="/./../images/jV8Lr3ZmGNOl9eo-1759458037861-35.png" alt="pic"><br>那两个是我提前创建好的。点击右上角的+，会这样：</p>
<p><img data-src="/./../images/fwsHnUy79YTtA4J-1759458037861-36.png" alt="pic"><br>内存，iPhone7设置到768差不多，最高的应该是1015吧，点击加载镜像，如下</p>
<p><img data-src="/./../images/oYZSMsv8i2T5dk6-1759458037861-37.png" alt="pic"><br>点击右上角的+，创建一个驱动器，如图</p>
<p><img data-src="/./../images/8qfijOIHSLBuXEF-1759458037861-38.png" alt="pic"><br>镜像类型，硬盘就是disk，光驱就是cd&#x2F;dvd，如图</p>
<p><img data-src="/./../images/3nhPlu6W1KtxTJV-1759458037861-39.png" alt="pic"><br>先选cd&#x2F;dvd，点击文件路径，点击右上角的+，如图</p>
<p><img data-src="/./../images/vnLVM6Sblpe5AkB-1759458037861-40.png" alt="pic"><br>会这样</p>
<p><img data-src="/./../images/1kNJEcW2Hf6LhUe-1759458037861-41.png" alt="pic"><br>如果选的cd&#x2F;dvd，选“导入”，会这样</p>
<p><img data-src="/./../images/Wevqyri87jakPOQ-1759458037861-42.png" alt="pic"><br>这是我已经打开utm文件夹，具体可以点击“我的iPhone”找到“UTM”文件夹，选择你复制的镜像ISO文件，如图</p>
<p><img data-src="/./../images/zYtWGIiEkJRs146-1759458037861-43.png" alt="pic"><br>再点一次镜像，加载，重复第（调整disk或cd&#x2F;dvd）步选择disk，不要选导入，如果你有现成的，那就选导入，一般是xxx.img，创建，一般填hda.img，第二行看系统大小来定，XP可以是10G，win7可以是20G，10G填10240，20G填20480，以此类推。</p>
<p>创建完成后，点击播放建，开机，正常安装系统即可。来了电话回自动暂停，来了微信，就点击上面的暂停键，暂停。如图（会加载缓慢）</p>
<p><img data-src="/./../images/Xl1ow2tg3qPU7xf-1759458037861-44.png" alt="pic"><br><img data-src="/./../images/Xl1ow2tg3qPU7xf-1759458037863-46.png" alt="pic"><br>继续运行点击中间即可。退出点击X，如果开着机，相当于强制关机。</p>
<p><img data-src="/./../images/BDYJa1RFfnIX4Qt-1759458037861-45.png" alt="pic"></p>
<hr>
<p>Q&amp;A：</p>
<p>Q：为什么安装AltStore会出现签名错误？</p>
<p>A：13.3.1有此问题，建议越狱后使用，或用爱思助手安装。</p>
<p>Q：为什么7天后提示我验证应用？</p>
<p>A：普遍问题，建议越狱后安装续签插件。免费开发者账户需要7天一签，付费的一年一签。</p>
<p>Q：越狱后如何在手机上直接安装UTM.ipa？</p>
<p>A：下载Filza，在里面点选ipa文件安装。</p>
<p>Q：为什么我在一些云上续签了，但是启动VM时会崩溃？</p>
<p>A：许多“云”签名服务（包括AppCake）不能与UTM一起使用，因为它们使用了错误的签名证书。如果尝试启动VM时发生崩溃，则可能是您的签名证书无效。</p>
<p>Q：有什么免费的续签方法吗？</p>
<p>A：如果您运行的是普通iOS，则使用iOS App Signer 可以免费，轻松地重新签名IPA 。然后，您可以使用iTunes，音乐应用程序或Xcode安装它。</p>
<p>注：图片加载于sm.ms图床，部分资料参考与UTM官网。</p>
]]></content>
      <categories>
        <category>IOS</category>
      </categories>
      <tags>
        <tag>ios</tag>
        <tag>UTM</tag>
        <tag>VM</tag>
        <tag>iPhone</tag>
      </tags>
  </entry>
  <entry>
    <title>Usage of Structure Block in Minecraft PE</title>
    <url>/2020/11/22/Usage-of-structure-block-in-Minecraft-PE/</url>
    <content><![CDATA[<p>写在前面：看到我写游戏，是不是感到非常惊讶？是否有很多问号？其实我从2013年接触我的世界，最早玩0.10.5版本，接触了多玩我的世界盒子和葫芦侠。最早玩我的世界还是用的三星的GT-I9050,安卓2.3，除了运行0.10.5,再大的版本就运行不了了。后来，我用我妈的红米玩0.12.2，地狱疣和药水炼制让我着迷。后来中间潜心学习了一段时间，终于在网易代理后又拾起了我的世界。现在手机版都有地狱更新了，我玩着新版本，没有感觉不熟悉，反而是满满的回忆。今天的我的世界,盒子类几乎没有，唯一好的盒子还是Toolbox，最近也要看广告才能解锁高级功能。<br>今天教大家如何在我的世界中使用结构方块，其实官方名字叫“建筑方块”。<br>首先，在创建世界时，打开“启用实验玩法”，确定开启了作弊和创造。建议下载Toolbox，我就用的toolbox。</p>
<p><img data-src="/./../images/2020042717372011.jpg" alt="jpg"><br><img data-src="/./../images/2020042717372010.jpg" alt="jpg"><br><img data-src="/./../images/202004271737209.jpg" alt="jpg"><br><img data-src="/./../images/202004271737208.jpg" alt="jpg"></p>
<p>接着，点击小稿头，找到世界-获取项目，不要点上面的四个，弹出键盘关闭即可。<br><img data-src="/./../images/202004271737207.jpg" alt="jpg"></p>
<p>在最下面找到这个方块，点击“添加”<br>然后放在地下，你想复制的地方，可以不是一个维度，比如复制各种遗迹。<br>放下“建筑方块”会看到以下界面<br><img data-src="/./../images/202004271737206.jpg" alt="jpg"></p>
<p>这就是要复制的范围，大小可以调，点击“建筑方块”<br><img data-src="/./../images/202004271737205.jpg" alt="jpg"></p>
<p>会看到一个3D图像和右边的大小和偏移。可以自行调节，比对3D图像，X轴是红色，Y轴是绿色，Z轴是红色，偏移是复制结构偏移多少格，像这样<br><img data-src="/./../images/202004271737203.jpg" alt="jpg"></p>
<p>X轴和Y轴最大64，Y轴未知（自己试试）<br><img data-src="/./../images/202004271737204.jpg" alt="jpg"><br>可以选择包含实体或移除方块。包含实体如果打开了，掉落物，各种动物，怪物，村民都可以保存下来。如果打开了移除方块，就会只保留实体。<br><img data-src="/./../images/202004271737202.jpg" alt="jpg"></p>
<p>保存到磁盘中可以导出为3D图像，或复制到另一个世界。不过toolbox的世界与原版不互通，并且找不到toolbox的文档目录，我已经发邮件问作者，还没回。保存到内存的话，应该是退出世界就没有了。<br><img data-src="/./../images/202004271737201.jpg" alt="jpg"></p>
<p>保存的话，写上一个名字，会自动为你补全mystructure:这是，找个你想复制的地方，放下“建筑方块”,模式选择“加载”，也是光输入你保存时写的的名字。我这里是test，如果存在，则字体变亮，如果不存在，会是灰色。输入正确后，会显示出你保存的大小，调整即可。最后点击“加载”会有点卡，一点一点加载，甚是舒服！最后就是这个样子<br><img data-src="/./../images/20200427173720.jpg" alt="jpg"></p>
<p>突然出现的“山”是不是很有趣？也可以把末地船复制到大海上，稍加修缮，就成真正在海上的船了！<br>写在最后：近的物体，还是用clone命令吧。两者皆用，建筑我行！（这应该是全网第一篇教程，有不明白的可以点游戏中建筑方块里面的问号）</p>
]]></content>
      <categories>
        <category>Games</category>
      </categories>
      <tags>
        <tag>Minecarft</tag>
      </tags>
  </entry>
  <entry>
    <title>Slurm 使用入门教程</title>
    <url>/2025/12/07/Using-Slurm-for-Job-Submission-and-Queue-Management/</url>
    <content><![CDATA[<h1 id="🧭-Slurm-使用入门教程：作业脚本编写、任务提交与队列管理指南"><a href="#🧭-Slurm-使用入门教程：作业脚本编写、任务提交与队列管理指南" class="headerlink" title="🧭 Slurm 使用入门教程：作业脚本编写、任务提交与队列管理指南"></a>🧭 Slurm 使用入门教程：作业脚本编写、任务提交与队列管理指南</h1><p>Slurm（Simple Linux Utility for Resource Management）是目前最主流的高性能计算（HPC）资源调度系统。本文将介绍：</p>
<ul>
<li>如何编写 <code>.slurm</code> 作业脚本</li>
<li>如何提交任务</li>
<li>如何查看任务队列</li>
<li>如何规范存放日志</li>
<li>如何查看 <code>.out</code> &#x2F; <code>.err</code> 文件</li>
<li>如何使用 <code>tail -f</code> 滚动查看输出</li>
<li>如何申请 GPU、CPU、内存</li>
<li>如何让大模型自动生成 Slurm 脚本</li>
</ul>
<p>本文假设你所在的集群使用 partition &#x3D; <code>lab104</code>。</p>
<hr>
<h2 id="📌-1-集群资源最大限制（本服务器）"><a href="#📌-1-集群资源最大限制（本服务器）" class="headerlink" title="📌 1. 集群资源最大限制（本服务器）"></a>📌 1. 集群资源最大限制（本服务器）</h2><p>服务器硬件资源上限如下：</p>
<table>
<thead>
<tr>
<th>资源</th>
<th>最大可申请量</th>
</tr>
</thead>
<tbody><tr>
<td><strong>CPU</strong></td>
<td>56 核</td>
</tr>
<tr>
<td><strong>内存</strong></td>
<td>约 256 GB</td>
</tr>
<tr>
<td><strong>GPU</strong></td>
<td>2 张（NVIDIA）</td>
</tr>
<tr>
<td><strong>节点数</strong></td>
<td>单节点（1 台服务器）</td>
</tr>
</tbody></table>
<p>注意事项：</p>
<ul>
<li>若申请 GPU &gt; 2，会导致作业永久 PENDING 或被系统拒绝</li>
<li>若申请内存过大（&gt;250GB）也会导致任务无法调度</li>
<li>建议申请资源量 ≤ 实际需求，避免占用队列</li>
</ul>
<hr>
<h2 id="📌-2-推荐的日志规范"><a href="#📌-2-推荐的日志规范" class="headerlink" title="📌 2. 推荐的日志规范"></a>📌 2. 推荐的日志规范</h2><p>为了避免日志文件到处乱飞，建议统一放在：</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">~/slurm_logs/<span class="variable">&lt;job_name&gt;</span>/<span class="variable">&lt;jobid&gt;</span>.<span class="keyword">out</span></span><br><span class="line">~/slurm_logs/<span class="variable">&lt;job_name&gt;</span>/<span class="variable">&lt;jobid&gt;</span>.err</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line">~<span class="regexp">/slurm_logs/</span>train/<span class="number">12345.</span>out</span><br><span class="line">~<span class="regexp">/slurm_logs/</span>train/<span class="number">12345.</span>err</span><br></pre></td></tr></table></figure>

<p>你可以在脚本中这样设置：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">SBATCH --output=/home/<span class="variable">$USER</span>/slurm_logs/train/%j.out</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">SBATCH --error=/home/<span class="variable">$USER</span>/slurm_logs/train/%j.err</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📌-3-编写-slurm-作业脚本"><a href="#📌-3-编写-slurm-作业脚本" class="headerlink" title="📌 3. 编写 .slurm 作业脚本"></a>📌 3. 编写 <code>.slurm</code> 作业脚本</h2><p>下面是一个规范化的作业脚本示例：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#SBATCH --job-name=test_job</span></span><br><span class="line"><span class="comment">#SBATCH --partition=lab104</span></span><br><span class="line"><span class="comment">#SBATCH --nodes=1</span></span><br><span class="line"><span class="comment">#SBATCH --ntasks=1</span></span><br><span class="line"><span class="comment">#SBATCH --cpus-per-task=4</span></span><br><span class="line"><span class="comment">#SBATCH --mem=16G</span></span><br><span class="line"><span class="comment">#SBATCH --gres=gpu:1</span></span><br><span class="line"><span class="comment">#SBATCH --time=48:00:00</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SBATCH --output=/home/$USER/slurm_logs/test_job/%j.out</span></span><br><span class="line"><span class="comment">#SBATCH --error=/home/$USER/slurm_logs/test_job/%j.err</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Job started at <span class="subst">$(date)</span>&quot;</span></span><br><span class="line">python train.py</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Job finished at <span class="subst">$(date)</span>&quot;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📝-常用-Slurm-参数说明表"><a href="#📝-常用-Slurm-参数说明表" class="headerlink" title="📝 常用 Slurm 参数说明表"></a>📝 常用 Slurm 参数说明表</h2><table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><code>--cpus-per-task=4</code></td>
<td>每个任务分配 4 个 CPU</td>
</tr>
<tr>
<td><code>--gres=gpu:1</code></td>
<td>申请 1 个 GPU</td>
</tr>
<tr>
<td><code>--mem=16G</code></td>
<td>申请 16GB 内存</td>
</tr>
<tr>
<td><code>--time=48:00:00</code></td>
<td>最长运行 48 小时</td>
</tr>
<tr>
<td><code>--output</code> &#x2F; <code>--error</code></td>
<td>指定日志路径</td>
</tr>
</tbody></table>
<hr>
<h2 id="📌-4-提交任务：sbatch"><a href="#📌-4-提交任务：sbatch" class="headerlink" title="📌 4. 提交任务：sbatch"></a>📌 4. 提交任务：<code>sbatch</code></h2><figure class="highlight cos"><table><tr><td class="code"><pre><span class="line">sbatch <span class="keyword">job</span>.slurm</span><br></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Submitted </span><span class="keyword">batch </span><span class="keyword">job </span><span class="number">12345</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📌-5-查看任务队列：squeue"><a href="#📌-5-查看任务队列：squeue" class="headerlink" title="📌 5. 查看任务队列：squeue"></a>📌 5. 查看任务队列：<code>squeue</code></h2><p>查看自己的任务：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">squeue</span> -u <span class="variable">$USER</span></span><br></pre></td></tr></table></figure>

<p>查看所有任务：</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">squeue</span></span><br></pre></td></tr></table></figure>

<p>任务状态说明：</p>
<table>
<thead>
<tr>
<th>状态</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>PD</code></td>
<td>Pending（排队）</td>
</tr>
<tr>
<td><code>R</code></td>
<td>Running（运行中）</td>
</tr>
<tr>
<td><code>CG</code></td>
<td>Completing（结束中）</td>
</tr>
<tr>
<td><code>F</code></td>
<td>Failed（失败）</td>
</tr>
</tbody></table>
<hr>
<h2 id="📌-6-取消任务：scancel"><a href="#📌-6-取消任务：scancel" class="headerlink" title="📌 6. 取消任务：scancel"></a>📌 6. 取消任务：<code>scancel</code></h2><p>取消指定任务：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">scancel</span> <span class="number">12345</span></span><br></pre></td></tr></table></figure>

<p>取消当前用户全部任务：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">scancel</span> -u <span class="variable">$USER</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📌-7-查看-out-和-err-日志"><a href="#📌-7-查看-out-和-err-日志" class="headerlink" title="📌 7. 查看 .out 和 .err 日志"></a>📌 7. 查看 <code>.out</code> 和 <code>.err</code> 日志</h2><p>假设日志路径为：</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">~<span class="regexp">/slurm_logs/test</span>_job/<span class="number">12345</span>.<span class="keyword">out</span></span><br><span class="line">~<span class="regexp">/slurm_logs/test</span>_job/<span class="number">12345</span>.err</span><br></pre></td></tr></table></figure>

<p>查看输出日志：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> ~/slurm_logs/test_job/12345.out</span><br></pre></td></tr></table></figure>

<p>查看错误日志：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> ~/slurm_logs/test_job/12345.err</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📌-8-滚动查看实时输出（tail-f）"><a href="#📌-8-滚动查看实时输出（tail-f）" class="headerlink" title="📌 8. 滚动查看实时输出（tail -f）"></a>📌 8. 滚动查看实时输出（tail -f）</h2><p>训练过程持续产生输出时最常用：</p>
<p>实时查看 <code>.out</code>：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">tail</span> -f ~/slurm_logs/test_job/12345.out</span><br></pre></td></tr></table></figure>

<p>实时查看 <code>.err</code>：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">tail</span> -f ~/slurm_logs/test_job/12345.err</span><br></pre></td></tr></table></figure>

<p>退出：</p>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line"><span class="variable">Ctrl</span> <span class="operator">+</span> <span class="built_in">C</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📌-9-交互式任务（srun）"><a href="#📌-9-交互式任务（srun）" class="headerlink" title="📌 9. 交互式任务（srun）"></a>📌 9. 交互式任务（srun）</h2><p>如果你需要进入带 GPU 的交互式环境调试：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">srun <span class="attribute">--partition</span>=lab104 <span class="attribute">--gres</span>=gpu:1 <span class="attribute">--cpus-per-task</span>=4 <span class="attribute">--mem</span>=16G --pty bash</span><br></pre></td></tr></table></figure>

<p>退出：</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📌-10-GPU-多卡示例"><a href="#📌-10-GPU-多卡示例" class="headerlink" title="📌 10. GPU 多卡示例"></a>📌 10. GPU 多卡示例</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#SBATCH --job-name=multi_gpu</span></span><br><span class="line"><span class="comment">#SBATCH --partition=lab104</span></span><br><span class="line"><span class="comment">#SBATCH --gres=gpu:2</span></span><br><span class="line"><span class="comment">#SBATCH --cpus-per-task=8</span></span><br><span class="line"><span class="comment">#SBATCH --mem=64G</span></span><br><span class="line"><span class="comment">#SBATCH --output=/home/$USER/slurm_logs/multi_gpu/%j.out</span></span><br><span class="line"><span class="comment">#SBATCH --error=/home/$USER/slurm_logs/multi_gpu/%j.err</span></span><br><span class="line"></span><br><span class="line">python train_ddp.py</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="📌-11-用大模型自动生成-slurm-文件（推荐）"><a href="#📌-11-用大模型自动生成-slurm-文件（推荐）" class="headerlink" title="📌 11. 用大模型自动生成 .slurm 文件（推荐）"></a>📌 11. 用大模型自动生成 <code>.slurm</code> 文件（推荐）</h2><p>只需一条指令，例如：</p>
<blockquote>
<p>帮我生成一个 Slurm 脚本，partition 为 lab104，需要 1 块 GPU、4 个 CPU、32GB 内存，运行 train.py，并规范输出日志。</p>
</blockquote>
<p>大模型即可自动生成可直接运行的 Slurm 脚本，非常方便。</p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>Slurm</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>js.org free domain</title>
    <url>/2020/11/28/js-org-free-domain/</url>
    <content><![CDATA[<h2 id="了解"><a href="#了解" class="headerlink" title="了解"></a>了解</h2><p><a href="js.org">官方链接</a></p>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>1.一个托管在Github Pages上的Site。必须<strong>要有内容</strong>，不能草草一个html了事；</p>
<p>2.一台电脑；</p>
<p>3.一个Github账号；</p>
<p>4.明白PR的方法。</p>
<p>5.:boom::boom::boom:<br><em><strong>Due to the increased number of requests for js.org subdomains recently, with many having questionable relevancy to the JavaScript community and ecosystem, we’ve decided that going forward js.org will be focusing on accepting subdomain requests from projects with a clear relation to the JS community.</strong></em></p>
<p><em><strong>As some examples, personal pages, blogs, and Discord bot pages will no longer be accepted. Projects such as NPM packages, libraries, tools that have a clear direct relation to JavaScript, will be accepted when requesting a JS.ORG subdomain. This decision does not affect subdomains that have already been granted.</strong></em><br>:boom::boom::boom:</p>
<p>意思是你的申请必须关于js，npm。提高了门槛。</p>
<h2 id="详细步骤"><a href="#详细步骤" class="headerlink" title="详细步骤"></a>详细步骤</h2><p>打开js.org官方仓库。</p>
<p><a href="https://github.com/js-org/js.org">直达链接</a></p>
<p>点击Fork</p>
<p>修改cnames_active.js。</p>
<p>最好按照字母顺序，不按照也没有关系</p>
<p>插入如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;你想要申请的前缀&quot;</span>: <span class="string">&quot;你的仓库URL&quot;</span>,</span><br></pre></td></tr></table></figure>
<p>保存<br>打开你的仓库，确保Pages环境存在，添加CNAME文件，内容为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">你的前缀.js.org</span><br></pre></td></tr></table></figure>

<p>点击仓库上方的Pull requests，点击绿色的“New pull request”</p>
<p>标题<strong>不要</strong>为Update cnames_active.js<br>改成“你的前缀.js.org”<br>其他的不用管，直接提交即可。</p>
<p>坐等成功</p>
<p>我的已经成功了，见<br><a href="https://github.com/js-org/js.org/pull/5039">#5039</a></p>
<p><a href="https://mjy.js.org/">Blog</a></p>
]]></content>
      <categories>
        <category>Domain</category>
      </categories>
      <tags>
        <tag>free</tag>
        <tag>domain</tag>
        <tag>免费</tag>
        <tag>二级域名</tag>
        <tag>域名</tag>
        <tag>js.org</tag>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>对过去的一些回忆与思考</title>
    <url>/2023/08/05/memory1/</url>
    <content><![CDATA[<p><img data-src="/./../images/1691270729-644e6321b37f3df28c6d147fd03a111-466x1024.jpg"></p>
<p>实际上，当我看到这一幕时，我的内心是淡然的，没有了初中时的那份焦虑与慌张，但在一个人的夜晚里，还是会想起，于是写下这篇带有回忆性质的文章。</p>
<p>与她相识在初中，也许是天意，初一与初二我们基本上是分在南北两排，用一句比较通俗的话就是，“我们没有一点交集”，唯一的一次交流还是初一结束时，她作为英语老师的助手，为优秀小组和学生写奖状，为我特别地用绿色笔写（现已褪色为棕色），这就是基础。我对她那个时候的印象，只知道她并没有去“希望之星”研学，另外就是她的成绩很好且很稳定，一直都是第一名。</p>
<p>不过上了初二，我的成绩也在一点点进步，所以意外的被排位排到了同一排，之后我们的交流便开始了。有一个人不能不提，就是我那个时候的同桌，现在情况如图：</p>
<p><img data-src="/./../images/1691271622-f3bfd6b39f889d1422e6c7758e904ba-466x1024.jpg"></p>
<p>（估计两个人是商量好的）</p>
<p>她们俩是要好的朋友，我因此也得以与她搭话。</p>
<p>我们互相加了联系方式，有一天她在女生那边造我的谣，于是命运的齿轮开始乱转，我第一次与她聊天聊到12点（还是1点，反正很晚就对了），之后便一发不可收拾，最晚达到了凌晨3点，她第二天11点才起，我甚至一度以为她出什么事了（乐）。</p>
<p>琐碎的事情不必闲谈，之后她删了我两三次，第一次是为了录视频，证明要是有人这么（反正语气就是不客气）跟她说话，她就删掉那人，第二次与第三次记不太清，有一次是因为AA制没完全AA，回家后我的母亲数落我，我反问她，她跟她的好朋友商量了1h把我删掉，第二天她就发烧了（乐）。反正每逢寒暑假必删我，到开学前一两周才加回来。</p>
<p>我们在校外以一起玩剧本杀为主，第一次一起出去还是去我们的母校（小学），顺带一提，她是唯一一个我跟她出去玩我母亲不会怀疑的女生，虽然一起聊天时我的母亲还是会阴阳我罢了。</p>
<p>我相信“日久生情”，可是她对我没有意思，所以我们的友谊就维持在朋友（或者高一点，闺蜜）上。她找过两次男友，其一是因为冲动，而且还是在我与她处于僵持阶段时谈的，因此我没有许多详细的信息（也不能说），其二现在是我同班同学，我早已劝过她趁早放弃，他这人性格古怪，而且不想谈恋爱，但她属于那种决定好了做什么事无论怎样也要完成的人，结果最后被伤得很惨，我也有幸喜提红色感叹号。很多人不理解，为啥她要把我删掉，实际上我也不是很理解，也许她认为我过于懦弱才造成了这种局面，反正错就在我没错吧？</p>
<p>上了高中，我们在不同的学校，所以我们的往来也就变少了。要不就是互发微信询问各校的情况，要不就是放假出去初中同学聚餐。她找上了男朋友，我也不适合与她有过多的来往。</p>
<p>之后她分手了，这个地方可以详细地写一下（毕竟是最后一次删的原因）</p>
<p>首先我需要先纠正一点，什么是“嗑”啊? 有什么值得嗑的啊? 开玩笑的。嗑很正常，在一中他们也说我有个有好听名字的同学很好 (原话) ，这个名字他们一是从其他实验创新的同学嘴里听说的，还有就是从我之前在教室登录微信他们看到了那个名字 (老师让我登着上网课) ，我们班其实有很多认识她的，他们认识但是并非我告诉他们的 (这里作个铺垫)</p>
<p>她分手的事想必你已经知道了，但是我还是想再说一遍，不要嫌罗嗦，因为这个情节是综合了三个渠道的消息 (目击者、徐的朋友、她给我发的消息) ，真实性确实有待考察，但是相信你可以总结出事情背后的真相</p>
<p>故事发生在高考+中考假结束的一天后，我还拿着手机 (一般是要上交的，包括现在这个发消息的手机还是台 2012 年的老古董，我的主力机在家里放着不让带)，晚上放学回家她给我发消息说她分手了，那我肯定着急，我问她怎么回事，她说她过生日他没给她送礼物，然后分，但是今天有复合的迹象，她跟他面部交流，但是他的组员投来鄙夷的目光(原话并不是这样，但是目光反正就是在嘲讽就是了) ，然后她就很生气，她才知道他把分手的事跟他的组员说了。晚上他的朋友就让她滚，她就把他拉到一个角落给他跪下了，这时有个目击者 (女生，正是上文中提到的)看到了。第二天我问她怎么样了，她说抱了还亲了，但是不知道是什么关系，之后因为她的农历生日到了嘛，我去实验给她放下了礼物还有一封小作文 (就是关于分手的事情啦) ，之后手机没有了，她也没给我发消息。端午假期，她给我发消息，能不能有点距离感，我以为我写的信刺激到她了 (语言过于犀利 (自评) ) 她说不是，说从徐那知道，我在一中传播他们分手的消息，徐说问了个一中的，我想起，我在一中有个性格相似的女同学，我跟她讲了这个事，但是我并没有说提到人名和学校，她的前位是个旗城的女同学据我调查跟徐相对一中的其他同学关系密切，她听出了内容，冲我笑 (不怀好意) ，我跟她说谁也别说，但是据我推测她还是说了，我跟都道歉她就是不理我，于是想着看看，果真让我猜对了 (删了)。</p>
<p>以上内容是我端午之前了解到的，端午后，我的同学 (上文中提到的目击者的好朋友) 跟我说她分手了，在学校里整天哭，这是端午之前的事这是一点，今晚上跟我同桌提起徐，他说 (以下皆为原话，我不可能改动) ，徐的朋友，觉得徐学习好，家里有钱，但是她，长得胖 (我不认可)觉得她配不上徐，劝徐分手。另，上面的目击者还说，徐是真想分了，但是她不想，或是说没看出来，她在她们班女生的内心地位很差，好像说了个因为哭还是怎样，反正人缘不是很好。</p>
<p>故事讲到这里就没了，其实在夜深人静之时仔细想想，我没有对不起她的地方，她删了我很多次，因为不同原因，这些都是过眼云烟，同样的，她有她实验的圈子，我有我一中的圈子，本身已经交集不大。我还是觉得就这样散场还是不是很好，不是一个完美的结局，可是天下没有不散的筵席。之前合格考试碰见了她，也只是当作了陌生人刻意回避她。也许现在真如她第二次删我时所说我们不是一路人罢了。</p>
<p>就这样，我们如图一一样可以说彻底分道扬镳了，思来想去，我觉得我没有将她加回来的必要。首先我们在各自的高中，过着各自的生活，有着各自的小圈子，过多的交流产生的误解容易不好及时解开。自我反省，我与她来往的这三年，我真的没有亏欠过她什么，我认为我做的一些事虽然不对不合适，但我相信我可以通过语言交流化解开。她比较擅长随心所欲，而我比较适合内向保守按规矩办事。我将她看作了我16年人生里的最重要的朋友，可是她也许没这么想。我认为她比较倾向于是一个利己主义者，我的出现可以说能满足她的需要，于是她接纳我。既然我影响到了她，对她产生了不好的影响，那错确实在我，她删我也是情有可原。就这样结束我确实于心不甘，但这也是命运所安排。</p>
<p>最后在此祝她幸福，这是我想说的，也是我真心诚意所期待的。</p>
]]></content>
      <categories>
        <category>情感经历</category>
      </categories>
      <tags>
        <tag>回忆</tag>
        <tag>思考</tag>
        <tag>情感经历</tag>
        <tag>朋友</tag>
        <tag>过去</tag>
      </tags>
  </entry>
  <entry>
    <title>英语口语测试备考</title>
    <url>/2025/12/17/oral-english-test/</url>
    <content><![CDATA[<blockquote>
<p>内容由ChatGPT生成</p>
</blockquote>
<h1 id="Unit-1-Youth-on-the-rise"><a href="#Unit-1-Youth-on-the-rise" class="headerlink" title="Unit 1: Youth on the rise"></a>Unit 1: Youth on the rise</h1><ol>
<li>Q: What does “Youth on the rise” mean to you?</li>
</ol>
<p>A:<br>To me, “Youth on the rise” means young people are becoming more active and influential in society. They are not only thinking about their own future, but also trying to make the world better. Youth represents energy, creativity, and responsibility. If young people learn, act, and keep improving, they can shape tomorrow’s world in a positive way.</p>
<ol start="2">
<li>Q: In your opinion, why are young people important to a country’s future?</li>
</ol>
<p>A:<br>Young people are important because they are future leaders, innovators, and problem-solvers. Their values and actions will influence social progress and national development. If a country supports its youth with education and opportunities, young people can create new ideas and bring real change. When young people thrive, the nation can become stronger and more hopeful.</p>
<ol start="3">
<li>Q: What is the Chinese Dream, and how do you understand it?</li>
</ol>
<p>A:<br>The Chinese Dream is about national rejuvenation and a better life for the people. It means the country becoming prosperous and strong, and people living better lives. I think it also connects personal dreams with social development. If society develops well, individuals can have more chances to achieve their goals. So personal success and national progress are closely linked.</p>
<ol start="4">
<li>Q: How can your personal dream connect with the Chinese Dream?</li>
</ol>
<p>A:<br>My personal dream can connect with the Chinese Dream if I use my strengths to serve society. For example, if I study hard and become a useful professional, I can help my community in a practical way. I believe individual success should not be only about personal benefits. It can also create value for others. When individuals grow, the country can also move forward.</p>
<ol start="5">
<li>Q: What role does education play in helping young people realize their dreams?</li>
</ol>
<p>A:<br>Education is essential because it provides knowledge, skills, and wider horizons. It also gives young people more opportunities and helps improve social mobility. With better education, young people can develop critical thinking and confidence. More importantly, education can guide young people to take responsibility and contribute to society, not just focus on exams.</p>
<ol start="6">
<li>Q: What impressed you most about the young researchers of LHAASO?</li>
</ol>
<p>A:<br>What impressed me most is their perseverance and dedication. They worked in very harsh conditions at high altitude, but they still kept doing their job seriously. There is a saying among them: “We do twice the work with half the oxygen.” This spirit shows strong willpower and teamwork. Their achievements also show how young people can support national scientific development.</p>
<ol start="7">
<li>Q: What can we learn from the “spirit of Haizi Mountain”?</li>
</ol>
<p>A:<br>The spirit of Haizi Mountain is about challenging limits and not giving up when facing difficulties. It teaches us to be brave, patient, and hard-working. In real life, we may feel stressed or lost, but we can still move forward step by step. If we keep learning and keep trying, we may achieve something that once seemed impossible.</p>
<ol start="8">
<li>Q: What global challenges did Ban Ki-moon mention, and why should youth care about them?</li>
</ol>
<p>A:<br>He mentioned challenges like refugees, gender inequality, extremism, poverty, and climate change. Young people should care because these problems affect the whole world. One country’s problem can become everyone’s problem. As the younger generation, we will live with the results in the future, so we should pay attention, ask questions, and take action with responsibility.</p>
<ol start="9">
<li>Q: What is “global citizenship”? How can students practice it?</li>
</ol>
<p>A:<br>Global citizenship means seeing ourselves as part of a global community. It is a mindset that values empathy, cooperation, and shared responsibility beyond borders. As students, we can practice it by learning about global issues, respecting different cultures, joining volunteer activities, and discussing problems through a global lens. Small actions can also matter, like saving energy and reducing waste.</p>
<ol start="10">
<li>Q: If you feel overwhelmed by big world problems, what should you do?</li>
</ol>
<p>A:<br>It is normal to feel overwhelmed, because global problems are complex. But I think the key is to stay curious and keep asking questions. We can start with small steps: learn reliable information, talk with others, and join meaningful activities. When we work together and act in unity, change is not impossible. Everyone can contribute in their own way.</p>
<h1 id="Unit-2-Planting-seeds-harvesting-the-future"><a href="#Unit-2-Planting-seeds-harvesting-the-future" class="headerlink" title="Unit 2: Planting seeds, harvesting the future"></a>Unit 2: Planting seeds, harvesting the future</h1><ol>
<li>Q: Why is education compared to “planting seeds”? What does the “harvest” mean?</li>
</ol>
<p>A:<br>Education is like planting seeds because its results take time. When we learn knowledge and skills, we may not see changes immediately, but step by step we grow. The “harvest” means a better future: better jobs, better lives, and even progress in society. Good education can also create more chances for people and help a country develop in the long run.</p>
<ol start="2">
<li>Q: In your opinion, what is the most important purpose of education?</li>
</ol>
<p>A:<br>For me, the most important purpose is to help people grow as whole persons. Of course, education gives us knowledge, but it should also build character, responsibility, and the ability to think independently. A good education can open our minds, improve our skills, and help us contribute to society, not just pass exams.</p>
<ol start="3">
<li>Q: How can technology help improve education, especially for rural students?</li>
</ol>
<p>A:<br>Technology can make quality education more accessible. For example, online classes, digital libraries, and distance teaching can connect good teachers with students in remote areas. It can help narrow the gap between urban and rural schools. With technology, students can learn anytime and anywhere, and it becomes easier to share good resources fairly.</p>
<ol start="4">
<li>Q: Besides academic scores, what abilities should students develop?</li>
</ol>
<p>A:<br>I think students should develop communication skills, problem-solving ability, and self-discipline. In real life, we often work in teams, so we need to express ideas clearly and listen to others. Also, creativity matters because many problems don’t have standard answers. If we manage time well and keep learning, we can adapt to changes in the future.</p>
<ol start="5">
<li>Q: How do Chinese universities encourage creativity and innovation today?</li>
</ol>
<p>A:<br>Many Chinese universities provide platforms and programs for innovation and entrepreneurship. They combine theory with practice, offer interdisciplinary courses, and encourage students to join competitions and real projects. This helps students turn ideas into solutions. I think these chances are useful because students learn by doing, and they become more confident about solving real-world problems.</p>
<ol start="6">
<li>Q: What can students learn from competitions like the “Challenge Cup”?</li>
</ol>
<p>A:<br>Competitions like the Challenge Cup can train students to face real challenges. We need to work in teams, manage time, and improve our ideas again and again. Sometimes we fail, but we learn from mistakes. It’s different from doing exercises in textbooks, because we must research, test, and communicate our results. That experience is very valuable.</p>
<ol start="7">
<li>Q: What do you think about the Swiss vocational education and training (VET) system?</li>
</ol>
<p>A:<br>I think the Swiss VET system is impressive because it mixes classroom learning with paid workplace training. Students can learn skills and also understand how the industry works. This system shows that vocational education is not “second best”. It can lead to good jobs and even further study. It also supports lifelong learning and flexible paths.</p>
<ol start="8">
<li>Q: What is special about universities of applied sciences (UAS) in Switzerland?</li>
</ol>
<p>A:<br>Universities of applied sciences focus more on practical education and applied research. They often work closely with companies and design projects based on real business needs. This helps students gain job-related skills and real experience. I think this is a good way to connect education with the labor market and improve students’ employability.</p>
<ol start="9">
<li>Q: How can international exchange help students become more creative?</li>
</ol>
<p>A:<br>International exchange can offer new perspectives. When students study or work with people from other cultures, they may see problems in different ways. This can push them out of their comfort zone and make them more open-minded. Also, learning different teaching styles and ideas can inspire students to try new methods and develop creative thinking.</p>
<ol start="10">
<li>Q: If you introduce China’s higher education to foreigners, what tone should you use?</li>
</ol>
<p>A:<br>I think I should use an objective and neutral tone. I should avoid exaggeration like “the best in the world,” and instead use clear facts, examples, and reasonable comparisons. I can talk about achievements, but also admit challenges honestly. This is more respectful in intercultural communication, and it makes my introduction more persuasive.</p>
<h1 id="Unit-3-Into-the-green"><a href="#Unit-3-Into-the-green" class="headerlink" title="Unit 3: Into the green"></a>Unit 3: Into the green</h1><ol>
<li>Q: What does “Into the green” mean in your understanding?</li>
</ol>
<p>A:<br>To me, “Into the green” means moving toward a greener lifestyle and a more sustainable future. It is not only about enjoying nature, but also about protecting it. The idea is to balance modernization with environmental responsibility, so we can build a cleaner and more harmonious world for future generations.</p>
<ol start="2">
<li>Q: How do you understand the idea “Lucid waters and lush mountains are invaluable assets”?</li>
</ol>
<p>A:<br>I understand it as a simple truth: a good environment is as valuable as money and economic growth. Clean rivers, green forests, and fresh air are long-term “assets” because they support health, tourism, agriculture, and overall well-being. So protecting nature is not a “cost”; it is an investment for our future.</p>
<ol start="3">
<li>Q: What does the Asian elephant migration story tell us?</li>
</ol>
<p>A:<br>The elephant migration story shows China’s respect for nature and its efforts in biodiversity protection. The elephants’ journey also attracted public attention, and it became a heartwarming story where the government and local people worked together to keep both elephants and residents safe. It shows that wildlife protection needs cooperation and patience.</p>
<ol start="4">
<li>Q: What measures were taken to protect the elephants during their journey?</li>
</ol>
<p>A:<br>Many measures were used to ensure safety. For example, the local government used drones to monitor the elephants around the clock. This shows how serious and well-organized the protection work was. It also reflects that technology can help reduce human-animal conflict and protect biodiversity more effectively.</p>
<ol start="5">
<li>Q: What major environmental achievements of China impressed you most?</li>
</ol>
<p>A:<br>I’m impressed by the visible progress in ecological restoration and pollution control. For example, China’s forest coverage has reached about 25%, wetlands total 23.5 million hectares, and air quality has improved with PM2.5 dropping from 46 to 29.3 micrograms per cubic meter from 2015 to 2024. These changes show long-term efforts and real results.</p>
<ol start="6">
<li>Q: How has China improved water and soil protection?</li>
</ol>
<p>A:<br>China has made progress in water and soil protection. For water, the proportion of good-quality surface water has increased a lot. For soil, the overall condition of agricultural land remained stable, and the safe utilization rate of contaminated farmland exceeded 91%. These efforts help protect public health and food security.</p>
<ol start="7">
<li>Q: How do green energy and new energy vehicles help fight climate change?</li>
</ol>
<p>A:<br>Green energy reduces dependence on coal and cuts carbon emissions. Also, new energy vehicles can reduce air pollution and help with global carbon reduction. China’s domestic NEV sales exceeded 12 million units in 2024, which shows strong growth and a real shift toward greener transportation.</p>
<ol start="8">
<li>Q: What are the “dual carbon” goals, and why are they important?</li>
</ol>
<p>A:<br>The “dual carbon” goals are important because they guide the whole society to develop in a low-carbon way. China is embedding these goals into economic and social development, such as promoting green energy and green transportation. This reflects long-term thinking and supports high-quality development.</p>
<ol start="9">
<li>Q: What can individuals do to support green development in daily life?</li>
</ol>
<p>A:<br>Individuals can start with small but practical actions: save electricity, reduce waste, sort garbage, and choose greener transportation like public transit or cycling. We can also support sustainable consumption and avoid unnecessary products. If many people do small things every day, it can create big change in society.</p>
<ol start="10">
<li>Q: What can we learn from Constantino Aucca Chutas and community-led conservation?</li>
</ol>
<p>A:<br>We can learn that environmental protection needs long-term dedication and community participation. Community-led action can restore ecosystems and also improve local people’s lives. It reminds us that protecting nature is not only the government’s job—local communities and young people can also play an important role.</p>
<ol start="11">
<li>Q: Why are indigenous communities important in environmental protection?</li>
</ol>
<p>A:<br>Indigenous communities are often regarded as great custodians of nature because they live close to the land and have deep knowledge of local ecosystems. Their contributions to ecosystem restoration are extremely important and urgent. Respecting their rights and working with them can make conservation more effective and fair.</p>
<ol start="12">
<li>Q: How can we communicate environmental stories to international audiences effectively?</li>
</ol>
<p>A:<br>I think we should combine storytelling and data. For example, the elephant story uses a light-hearted style, like calling the elephants “giant tourists,” which makes the topic friendly and engaging. At the same time, we should use clear facts and charts to show real progress, so our message becomes both interesting and convincing.</p>
<h1 id="Unit-4-Cultural-heritage-Tradition-and-innovation"><a href="#Unit-4-Cultural-heritage-Tradition-and-innovation" class="headerlink" title="Unit 4: Cultural heritage: Tradition and innovation"></a>Unit 4: Cultural heritage: Tradition and innovation</h1><ol>
<li>Q: What is cultural heritage, and why is it important?</li>
</ol>
<p>A:<br>Cultural heritage includes both tangible things like historic sites and artifacts, and intangible things like traditions, skills, and festivals. It is important because it preserves a community’s identity and values. It also connects the past with the present. When we protect cultural heritage, we keep our history alive and help future generations understand where they come from.</p>
<ol start="2">
<li>Q: How do you understand the idea “Tradition and innovation” in cultural heritage protection?</li>
</ol>
<p>A:<br>I think tradition means keeping the core spirit and authenticity, while innovation means using new methods to make heritage survive in modern life. If we only protect it in a museum, it may feel far from daily life. But if we combine heritage with technology, design, and education, more people—especially young people—can understand it and value it.</p>
<ol start="3">
<li>Q: What is “guochao,” and why is it popular among young people?</li>
</ol>
<p>A:<br>Guochao, or “China chic,” is a trend where Chinese consumers enjoy domestic brands and heritage-inspired designs. It is popular because it shows cultural confidence and makes traditional culture fashionable. Young people can express their identity through daily choices like clothes, cosmetics, and cultural products. It is like bringing tradition back into modern life.</p>
<ol start="4">
<li>Q: What does the revival of hanfu tell us about culture today?</li>
</ol>
<p>A:<br>The revival of hanfu shows that traditional culture can have new life in the modern era. Many young people mix hanfu with modern clothing, and they wear it at graduation, work, or weddings. This trend makes tradition more visible and more relatable. It also shows that culture is not fixed—it can evolve while keeping its roots.</p>
<ol start="5">
<li>Q: How can we introduce guochao to international audiences effectively?</li>
</ol>
<p>A:<br>I think we should explain the meaning, not just translate the word. We can use relatable examples, such as heritage-inspired fashion or museum creative products, because many countries also have “tradition meets modernity” trends. Using clear details like daily-life examples and even economic data can make the idea easier to understand for foreigners.</p>
<ol start="6">
<li>Q: What makes the Mogao Grottoes culturally significant?</li>
</ol>
<p>A:<br>The Mogao Grottoes are a world-famous cultural treasure and a UNESCO World Heritage Site. They include over 740 caves, 45,000 square meters of murals, and more than 3,000 painted statues. They also show cultural exchange along the Silk Road, because different artistic traditions influenced the art there.</p>
<ol start="7">
<li>Q: What qualities do the guardians of the Mogao Grottoes represent?</li>
</ol>
<p>A:<br>They represent dedication and responsibility. Generations of scholars and experts poured their hearts and souls into protecting the grottoes. People like Chang Shuhong and Fan Jinshi devoted their lives to this work, even in difficult conditions. Their spirit shows “choose one thing and do it for a lifetime,” which is a valuable professional attitude.</p>
<ol start="8">
<li>Q: How does “Digital Dunhuang” help protect and promote the Mogao Grottoes?</li>
</ol>
<p>A:<br>“Digital Dunhuang” uses technologies like photogrammetry and 3D digital reconstruction to create complete digital records. It protects the site by reducing physical pressure from tourism, and it also promotes the grottoes by making them accessible online. For example, the English version of the website helped introduce it to audiences in many countries.</p>
<ol start="9">
<li>Q: In what ways do modernization and globalization challenge cultural heritage?</li>
</ol>
<p>A:<br>Modernization can bring urbanization and mass tourism, which may cause damage to heritage sites. Globalization may also make people prefer global popular culture and forget local traditions. But these challenges also push us to create better protection methods, such as visitor limits, digital archives, and more creative cultural education.</p>
<ol start="10">
<li>Q: Tea culture started in China. How has tea become a global cultural symbol?</li>
</ol>
<p>A:<br>Tea has traveled across borders and developed different meanings in different countries. It can be an art form in Japanese tea ceremonies, a daily ritual in British homes, and a symbol of hospitality in Moroccan families. This shows “harmony in diversity”: people share tea in different ways, but tea still connects cultures “one cup at a time.”</p>
<ol start="11">
<li>Q: What has India done to preserve and innovate its tea culture?</li>
</ol>
<p>A:<br>India uses both protection and innovation. For protection, it uses things like GI tags to protect regional tea names such as Darjeeling, and some producers use blockchain to track and verify origins. For innovation, India develops tea tourism and creates modern tea drinks in cities, which helps tea culture stay alive among young people.</p>
<ol start="12">
<li>Q: What can college students do to protect and promote cultural heritage?</li>
</ol>
<p>A:<br>College students can start with learning and sharing. We can visit museums, join cultural workshops, and respect traditional skills. We can also use social media to introduce heritage in a friendly way, or join volunteer programs at cultural sites. If we combine interest with action, we can help heritage become part of modern life instead of just history.</p>
<h1 id="Unit-5-People-first"><a href="#Unit-5-People-first" class="headerlink" title="Unit 5: People first"></a>Unit 5: People first</h1><ol>
<li>Q: What does “people first” mean in a country’s development?</li>
</ol>
<p>A:<br>“People first” means the government puts people’s lives and well-being at the center. The goal is not only economic growth, but also better living conditions, safety, and fair opportunities. When policies start from people’s real needs, society can develop in a more stable and humane way. </p>
<ol start="2">
<li>Q: Can you give an example of “people first” in daily community life?</li>
</ol>
<p>A:<br>A good example is the courtyard meeting room in a Beijing community. Residents, community workers, and representatives meet regularly to discuss local issues, such as public facilities or neighborhood environment. People can share different opinions, and the community tries to combine them into practical solutions. This shows that residents can take part in local governance. </p>
<ol start="3">
<li>Q: How does the courtyard meeting room show grassroots democracy?</li>
</ol>
<p>A:<br>It shows grassroots democracy because local affairs are discussed by local people. The meeting room offers a platform for residents to speak, and it also connects the government and the people. Even if there are disagreements, the process values public voices and aims to improve people’s lives step by step. </p>
<ol start="4">
<li>Q: How does China’s disaster relief reflect a “people-first” principle?</li>
</ol>
<p>A:<br>In disasters like floods and earthquakes, the key point is to protect lives. Rescue teams deliver emergency supplies such as food, clean water, and medical resources as quickly as possible. The government also mobilizes many rescuers and organizes rescue work on a large scale, showing that saving people is the top priority. </p>
<ol start="5">
<li>Q: Why is emergency management important for “people first”?</li>
</ol>
<p>A:<br>Emergency management is important because it helps a country respond faster and reduce losses. It is not only about rescue after a disaster, but also about prevention. With better systems and technology, risks can be monitored earlier, so more lives can be protected. </p>
<ol start="6">
<li>Q: What can we learn from Singapore’s efforts to support vulnerable groups?</li>
</ol>
<p>A:<br>Singapore shows that a strong country should care for vulnerable people, such as people with disabilities. It builds inclusive spaces like the Enabling Village, using ideas like universal design to help different people move, learn, and work more independently. This makes society more equal and respectful. </p>
<ol start="7">
<li>Q: How can a society become more inclusive in your opinion?</li>
</ol>
<p>A:<br>First, we should respect differences and give everyone fair chances in education, work, and public services. Second, public spaces should be designed for different needs, for example ramps and accessible facilities. Finally, we should encourage people to join community activities, so no one feels isolated. </p>
<ol start="8">
<li>Q: What matters most when we assess a nation’s strength?</li>
</ol>
<p>A:<br>Economic power is important, but it is not the only standard. In my opinion, the way a nation treats its most vulnerable people matters a lot. If a country can protect lives, support those in need, and help people live with dignity, it shows real strength and true progress. </p>
<h1 id="Unit-6-New-quality-new-growth"><a href="#Unit-6-New-quality-new-growth" class="headerlink" title="Unit 6: New quality, new growth"></a>Unit 6: New quality, new growth</h1><ol>
<li>Q: What are “new quality productive forces” in simple words?</li>
</ol>
<p>A:<br>In simple words, new quality productive forces mean a new kind of productivity driven mainly by innovation. They focus on high technology, high efficiency, and high quality. Unlike the old growth model that relies heavily on labor and resources, this new model relies more on new ideas, advanced industries, and better skills. It aims to improve both economic development and people’s lives in a sustainable way. </p>
<ol start="2">
<li>Q: Why is innovation considered the key to new quality growth?</li>
</ol>
<p>A:<br>Innovation is key because it creates new technologies and new industries. With innovation, companies can produce better products with less cost and higher efficiency. It also helps upgrade traditional industries and opens new opportunities for jobs and business. In my opinion, innovation is not only about science labs—it can also be seen in smart factories, digital services, and green energy, which bring real changes to daily life. </p>
<ol start="3">
<li>Q: What are the three main features of new quality productive forces?</li>
</ol>
<p>A:<br>They have three main features: high-tech, high efficiency, and high quality. High-tech means using advanced technologies like AI and intelligent manufacturing. High efficiency means producing more with less time, energy, or manpower. High quality means creating stronger industries and better products, and supporting long-term development instead of short-term growth. These three features work together to create “new quality, new growth.” </p>
<ol start="4">
<li>Q: Can you give an example of new quality growth from transportation?</li>
</ol>
<p>A:<br>Yes. New energy vehicles are a good example. They show how green technology and industry upgrading can happen at the same time. When more people use NEVs, it helps reduce pollution and supports a low-carbon lifestyle. Also, intelligent manufacturing in the auto industry improves efficiency and product quality. This kind of development is more sustainable and future-oriented. </p>
<ol start="5">
<li>Q: What is the “low-altitude economy,” and why is it meaningful?</li>
</ol>
<p>A:<br>The low-altitude economy refers to new industries related to drones and aerial services, and even flying cars in the future. It is meaningful because it can create new growth drivers for the economy. For example, drones can be used in tourism, logistics, and emergency work. It shows how technology can create new ways of living and working, and it may change transportation in the future. </p>
<ol start="6">
<li>Q: How does commercial space development show new quality productive forces?</li>
</ol>
<p>A:<br>Commercial space development shows strong high-tech ability and industrial upgrading. For example, building a commercial space launch site and launching rockets can support satellite services and data applications. It is not only about “going to space,” but also about creating a full industrial chain and new industries. This can improve national competitiveness and inspire more innovation in science and technology. </p>
<ol start="7">
<li>Q: How does ocean technology relate to new quality growth?</li>
</ol>
<p>A:<br>Ocean technology is another important area. Deep-sea exploration and advanced marine equipment show high-level innovation. Also, building more efficient and greener facilities, like underwater data centers, shows how innovation can reduce energy use and support green development. Ocean-related innovation can become a new engine for economic growth and also supports sustainable development. </p>
<ol start="8">
<li>Q: How will new technologies change students’ learning and future jobs?</li>
</ol>
<p>A:<br>New technologies will make learning more flexible and more connected with real life. For example, AI tools can help students learn faster and practice more efficiently. In future jobs, routine tasks may be done by machines, but new jobs will need skills like data analysis, digital literacy, and creativity. So students should keep learning, stay curious, and build strong problem-solving skills to adapt to change. </p>
<ol start="9">
<li>Q: What are “industries of the future,” and which areas are most important?</li>
</ol>
<p>A:<br>Industries of the future are new industries shaped by the Fourth Industrial Revolution. They are mainly around three areas: digital intelligence, sustainability, and healthcare. Digital intelligence includes AI and big data, sustainability focuses on green and low-carbon development, and healthcare includes biotechnology and personalized medicine. These areas can improve productivity and also help solve global challenges. </p>
<ol start="10">
<li>Q: What does “responsible and inclusive innovation” mean?</li>
</ol>
<p>A:<br>It means innovation should benefit everyone, not only a small group. We should also think about problems like privacy, bias, and job displacement. Technology is powerful, but it must be used in a responsible way. Inclusive innovation means giving more people access to new technology and creating fair opportunities. If we do this, future industries can truly create a better and more sustainable world. </p>
<ol start="11">
<li>Q: If you introduce “new quality productive forces” to foreigners, how will you explain it clearly?</li>
</ol>
<p>A:<br>I will avoid abstract words and use simple examples. I can say it is a new growth model driven by innovation, like NEVs, smart manufacturing, and AI. I will also explain the three features: high-tech, high efficiency, and high quality. If needed, I can add a future-looking point, such as how these changes may improve daily life and support green development. Clear examples make the idea easier to understand. </p>
]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>英语</tag>
        <tag>备考</tag>
      </tags>
  </entry>
  <entry>
    <title>【论文阅读  CVPR 2024  RSDet_去除再选择：一种用于 RGB - 红外目标检测的由粗到精融合视角】</title>
    <url>/2025/12/06/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20CVPR%202024%20%20RSDet_%E5%8E%BB%E9%99%A4%E5%86%8D%E9%80%89%E6%8B%A9%EF%BC%9A%E4%B8%80%E7%A7%8D%E7%94%A8%E4%BA%8E%20RGB%20-%20%E7%BA%A2%E5%A4%96%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E7%9A%84%E7%94%B1%E7%B2%97%E5%88%B0%E7%B2%BE%E8%9E%8D%E5%90%88%E8%A7%86%E8%A7%92%E3%80%91/</url>
    <content><![CDATA[<p>[TOC]</p>
<p><img data-src="/./../images/image-20251206180132784.png" alt="image-20251206180132784"></p>
<p>题目：Removal then Selection: A Coarse-to-Fine Fusion Perspective for RGB-Infrared Object Detection</p>
<p>会议：Computer Vision and Pattern Recognition（CVPR）</p>
<p>论文链接：<a href="https://arxiv.org/abs/2401.10731">Link</a></p>
<p>代码（假开源）：<a href="https://github.com/Zhao-Tian-yi/RSDet.git">Zhao-Tian-yi&#x2F;RSDet</a></p>
<p>年份：2024</p>
<h1 id="1-研究背景与动机"><a href="#1-研究背景与动机" class="headerlink" title="1. 研究背景与动机"></a>1. 研究背景与动机</h1><h2 id="1-1-RGB–IR-目标检测的需求"><a href="#1-1-RGB–IR-目标检测的需求" class="headerlink" title="1.1 RGB–IR 目标检测的需求"></a>1.1 RGB–IR 目标检测的需求</h2><p>传统目标检测大多依赖可见光（RGB）图像，在弱光、逆光、夜间、遮挡等复杂场景下容易失败。而红外（IR）图像通过热辐射信息可以在低照度环境下保持较好的目标轮廓，天然与 RGB 形成互补。因此，RGB–IR 联合检测被广泛用于：</p>
<ul>
<li>智能监控、安全巡检  </li>
<li>自动驾驶与无人系统  </li>
<li>远程遥感、边防安防等</li>
</ul>
<p>如何有效融合 RGB 与 IR 的互补特性，是多模态目标检测的核心问题之一。</p>
<h2 id="1-2-现有融合策略及局限"><a href="#1-2-现有融合策略及局限" class="headerlink" title="1.2 现有融合策略及局限"></a>1.2 现有融合策略及局限</h2><p>现有 RGB–IR 检测方法主要采用以下两类融合策略（对应图 1 中 (a)(b)）：</p>
<p><img data-src="/./../images/image-20251206182012755.png" alt="image-20251206182012755"></p>
<blockquote>
<p>图 1. 现有 RGB–IR 特征融合结构与本文提出框架的对比。</p>
</blockquote>
<ol>
<li><p><strong>Late Fusion（晚期融合）</strong>  </p>
<ul>
<li>独立提取 RGB、IR 特征  </li>
<li>在检测头前对特征做简单相加或拼接  </li>
<li>缺乏显式的跨模态交互，难以充分挖掘互补信息，性能较差</li>
</ul>
</li>
<li><p><strong>Halfway Fusion（中途融合）</strong>  </p>
<ul>
<li>在 backbone 中部或多尺度层面插入模态交互模块  </li>
<li>如 MBNet、动态跨模态模块等，通过注意力或交互模块增强两模态的互补性  </li>
<li>这类方法显式建模互补信息，但<strong>基本忽略了各模态内部大量冗余特征</strong>的负面影响</li>
</ul>
</li>
</ol>
<p><strong>关键问题</strong>：  </p>
<p>大多数方法只关注“如何更好地融合”，而没有首先解决“要融合的内容本身是否已经被<strong>净化</strong>”。冗余信息在传播过程中会不断放大，导致跨模态互补学习受到干扰，融合结果难以充分发挥两模态优势。</p>
<h2 id="1-3-认知启发：由粗到细的信息处理"><a href="#1-3-认知启发：由粗到细的信息处理" class="headerlink" title="1.3 认知启发：由粗到细的信息处理"></a>1.3 认知启发：由粗到细的信息处理</h2><p>人类大脑在处理多模态信息时，往往遵循“先粗后细”的选择性注意过程：</p>
<ul>
<li><strong>粗</strong>：对输入信息做初步筛选，抑制明显无关或噪声信息</li>
<li><strong>细</strong>：在剩余信息上进行精细分析与选择，提取当前任务所需的关键信息</li>
</ul>
<p>Treisman 的衰减模型（Attenuation Theory）认为，信息在进入工作记忆之前，会先经过一层“衰减滤波”，无关信息被强烈抑制，有关信息则以较高强度保留下来，用于进一步精细加工。</p>
<p><img data-src="/./../images/image-20251207100633887.png" alt="image-20251207100633887"></p>
<blockquote>
<p>图 4. Treisman 衰减模型示意图。</p>
</blockquote>
<p>作者借鉴这一认知过程，将其映射到 RGB–IR 特征融合上，提出**“由粗到细”（Coarse-to-Fine）特征净化与融合视角**：</p>
<ul>
<li><strong>Coarse（粗）</strong>：在频域粗粒度去除模态内部冗余光谱信息  </li>
<li><strong>Fine（细）</strong>：在特征域通过专家混合机制精细选择不同尺度的有用模态特征</li>
</ul>
<h2 id="1-4-论文主要贡献"><a href="#1-4-论文主要贡献" class="headerlink" title="1.4 论文主要贡献"></a>1.4 论文主要贡献</h2><p>结合引言与方法部分，论文的主要贡献可概括为：</p>
<ol>
<li><p><strong>提出由粗到细的 RGB–IR 特征融合视角</strong>  </p>
<p>先在频域对各模态进行冗余光谱去除，再在特征层面进行动态特征选择，从认知角度解释多模态融合的流程。</p>
</li>
<li><p><strong>冗余光谱去除模块（RSR）</strong>  </p>
<p>在频域对图像幅度谱进行动态滤波，抑制模态内的冗余、高频噪声成分，保留与检测任务相关的有效频段。</p>
</li>
<li><p><strong>动态特征选择模块（DFS）</strong>  </p>
<p>引入**尺度感知专家混合（mixture of scale-aware experts）**结构，通过门控网络与路由器在多尺度 RGB–IR 特征之间进行动态路由，实现跨模态、跨尺度的精细特征选择。</p>
</li>
<li><p><strong>构建 先去除后选择检测器 Removal then Selection Detector（RSDet）</strong>  </p>
<p>将“去除–选择”的由粗到细融合策略嵌入 Faster R-CNN，形成完整检测框架，并在 KAIST、FLIR-aligned、LLVIP 三个公开数据集上取得新的 SOTA 性能，特别是在小目标、严重遮挡与极低照度场景下优势明显。</p>
</li>
</ol>
<hr>
<h1 id="2-方法概览：由粗到细融合策略"><a href="#2-方法概览：由粗到细融合策略" class="headerlink" title="2. 方法概览：由粗到细融合策略"></a>2. 方法概览：由粗到细融合策略</h1><p><img data-src="/./../images/image-20251206182114478.png" alt="image-20251206182114478"></p>
<blockquote>
<h6 id="图-3-由粗到细融合策略的整体框架。上半部分为整体流程，下半部分分别展示-RSR-与-DFS-两个核心模块。"><a href="#图-3-由粗到细融合策略的整体框架。上半部分为整体流程，下半部分分别展示-RSR-与-DFS-两个核心模块。" class="headerlink" title="图 3. 由粗到细融合策略的整体框架。上半部分为整体流程，下半部分分别展示 RSR 与 DFS 两个核心模块。"></a>图 3. 由粗到细融合策略的整体框架。上半部分为整体流程，下半部分分别展示 RSR 与 DFS 两个核心模块。</h6></blockquote>
<h2 id="2-1-整体流程"><a href="#2-1-整体流程" class="headerlink" title="2.1 整体流程"></a>2.1 整体流程</h2><p>给定一对配准好的 RGB 图像 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 和红外图像 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>，RSDet 的整体流程如下：</p>
<ol>
<li><p><strong>频域冗余去除（RSR，粗）</strong>  </p>
<ul>
<li>将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo separator="true">,</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">V, I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> 经离散傅里叶变换（DFT）映射到频域：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>F</mi><mi>I</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_V(u,v), F_I(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>  </li>
<li>基于幅度谱预测模态自适应的动态滤波器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>V</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>H</mi><mi>I</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H_V(u,v), H_I(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>  </li>
<li>在频域进行逐点相乘抑制冗余光谱，逆变换回空间域，得到“净化后”图像 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>I</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">V&#x27;, I&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li><p><strong>共享–特定表示学习</strong>  </p>
<ul>
<li>以 ResNet 为 backbone，引入<strong>共享–特定（Shared–Specific）结构</strong>：  <ul>
<li>共享分支：提取模态无关的共享特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mtext>sha</mtext></msub></mrow><annotation encoding="application/x-tex">C_{\text{sha}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sha</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  </li>
<li>RGB 特定分支：从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">V&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 提取模态特定特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mrow><mi>V</mi><mtext>-spe</mtext></mrow><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">C^{i}_{V\text{-spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2361em;vertical-align:-0.4114em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4114em;"><span></span></span></span></span></span></span></span></span></span>（多尺度）  </li>
<li>IR 特定分支：从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>I</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">I&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 提取模态特定特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mrow><mi>I</mi><mtext>-spe</mtext></mrow><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">C^{i}_{I\text{-spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2361em;vertical-align:-0.4114em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4114em;"><span></span></span></span></span></span></span></span></span></span>（多尺度）</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>动态特征选择（DFS，细）</strong>  </p>
<ul>
<li>将多尺度模态特定特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msubsup><mi>C</mi><mrow><mi>V</mi><mtext>-spe</mtext></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>C</mi><mrow><mi>I</mi><mtext>-spe</mtext></mrow><mi>i</mi></msubsup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{C^{i}_{V\text{-spe}}, C^{i}_{I\text{-spe}}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2361em;vertical-align:-0.4114em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4114em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4114em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 送入 DFS 模块  </li>
<li>DFS 通过尺度感知专家混合（MoE）和路由器，在不同尺度上选择更可靠的模态特征，得到融合后的模态特定特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mtext>spe</mtext></msub></mrow><annotation encoding="application/x-tex">C_{\text{spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li><p><strong>最终融合特征</strong>  </p>
<ul>
<li>将 DFS 输出的特定特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mtext>spe</mtext></msub></mrow><annotation encoding="application/x-tex">C_{\text{spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 与共享特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mtext>sha</mtext></msub></mrow><annotation encoding="application/x-tex">C_{\text{sha}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sha</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 相加，得到最终融合特征：</li>
</ul>
</li>
</ol>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>C</mi><mo>=</mo><msub><mi>C</mi><mtext>sha</mtext></msub><mo>+</mo><msub><mi>C</mi><mtext>spe</mtext></msub></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
C = C_{\text{sha}} + C_{\text{spe}} \tag{1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sha</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span>


<p>该融合特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 随后被送入标准的目标检测头（RPN + R-CNN）进行检测。</p>
<h2 id="2-2-Coarse-vs-Fine-的直观对比"><a href="#2-2-Coarse-vs-Fine-的直观对比" class="headerlink" title="2.2 Coarse vs. Fine 的直观对比"></a>2.2 Coarse vs. Fine 的直观对比</h2><p><img data-src="/./../images/image-20251206182032966.png" alt="image-20251206182032966"></p>
<blockquote>
<p>图 2. 由粗到细融合方法的有效性示例。<br>(a) 传统 Halfway Fusion：RGB 背景噪声抑制了最终融合特征；<br>(b) 本文方法：先去除冗余光谱，再在特征层面选择有用模态信息。</p>
</blockquote>
<ul>
<li>在 Halfway Fusion 方案中，网络直接对原始 RGB–IR 特征做交互，RGB 中大量背景干扰信息会被传播到最终的融合特征中。  </li>
<li>在 RSDet 中，RSR 模块在频域优先抑制掉部分背景与高频噪声，再由 DFS 从“已经净化的模态特征”中选择任务相关的尺度与模态，从而显著提升检测质量。</li>
</ul>
<hr>
<h1 id="3-冗余光谱去除模块（RSR）"><a href="#3-冗余光谱去除模块（RSR）" class="headerlink" title="3. 冗余光谱去除模块（RSR）"></a>3. 冗余光谱去除模块（RSR）</h1><h2 id="3-1-设计动机"><a href="#3-1-设计动机" class="headerlink" title="3.1 设计动机"></a>3.1 设计动机</h2><ul>
<li>图像中的冗余信息不仅存在于空间域，也体现在<strong>频域谱分布</strong>上。  </li>
<li>频域具有天然的<strong>全局建模能力</strong>：通过逐点乘法即可在整幅图上统一抑制某一频段特征。  </li>
<li>直接在空间域做粗粒度过滤较难解耦目标与背景的紧耦合特征，而在频域中通过滤波器可以更直接地削弱某些频率构成的干扰。</li>
</ul>
<p>因此，作者提出在频域设计一个<strong>动态光谱滤波器</strong>，自适应去除 RGB 与 IR 模态内部的冗余成分。</p>
<h2 id="3-2-频域变换与幅度编码"><a href="#3-2-频域变换与幅度编码" class="headerlink" title="3.2 频域变换与幅度编码"></a>3.2 频域变换与幅度编码</h2><p>给定 RGB 图像 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>H</mi><mo>×</mo><mi>W</mi><mo>×</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">V \in \mathbb{R}^{H\times W\times 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="mbin mtight">×</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span> 与 IR 图像 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>H</mi><mo>×</mo><mi>W</mi><mo>×</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">I \in \mathbb{R}^{H\times W\times 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，首先对其进行离散傅里叶变换（DFT）：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>F</mi><mi>I</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">F</mi><mi mathvariant="normal">T</mi></mrow><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mi>F</mi><mi>V</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">F</mi><mi mathvariant="normal">T</mi></mrow><mo stretchy="false">(</mo><mi>V</mi><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
F_I(u, v) = \mathrm{DFT}(I), \quad 
F_V(u, v) = \mathrm{DFT}(V) \tag{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">DFT</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">DFT</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span>


<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span> 可分解为幅度谱与相位谱。RSR 模块只利用幅度信息预测滤波器，而保留相位信息，以尽量不破坏图像结构。</p>
<p>对于两种模态，分别设计轻量编码器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow><mi>I</mi></msub><mo separator="true">,</mo><msub><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">\mathrm{Encoder}_I, \mathrm{Encoder}_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Encoder</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Encoder</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 对幅度谱进行编码，得到嵌入向量：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>M</mi><msub><mi>l</mi><mi>I</mi></msub></msub><mo>=</mo><msub><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow><mi>I</mi></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mi mathvariant="normal">∣</mi><msub><mi>F</mi><mi>I</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mi>M</mi><msub><mi>l</mi><mi>V</mi></msub></msub><mo>=</mo><msub><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow><mi>V</mi></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mi mathvariant="normal">∣</mi><msub><mi>F</mi><mi>V</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
M_{l_I} = \mathrm{Encoder}_I\bigl(|F_I(u, v)|\bigr), \quad 
M_{l_V} = \mathrm{Encoder}_V\bigl(|F_V(u, v)|\bigr) \tag{3}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9336em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0197em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Encoder</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord">∣</span><span class="mclose"><span class="delimsizing size1">)</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0197em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Encoder</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord">∣</span><span class="mclose"><span class="delimsizing size1">)</span></span></span><span class="tag"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span>


<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><msub><mi>l</mi><mi>I</mi></msub></msub><mo separator="true">,</mo><msub><mi>M</mi><msub><mi>l</mi><mi>V</mi></msub></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">M_{l_I}, M_{l_V} \in \mathbb{R}^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9336em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0197em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0197em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span> 中的每个元素可视为某块区域频谱的重要性评分。  </li>
<li>这一步将二维频域图划分为若干 patch，并映射到一维评分空间。</li>
</ul>
<h2 id="3-3-Top-K-与软-硬滤波器"><a href="#3-3-Top-K-与软-硬滤波器" class="headerlink" title="3.3 Top-K 与软 &#x2F; 硬滤波器"></a>3.3 Top-K 与软 &#x2F; 硬滤波器</h2><p>为了在<strong>保留有效谱成分</strong>的同时抑制冗余信息，引入 Top-K 操作选出最重要的频谱区域：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>M</mi><msub><mi>m</mi><mi>I</mi></msub></msub><mo>=</mo><mtext>top-</mtext><mi>K</mi><mo stretchy="false">(</mo><msub><mi>M</mi><msub><mi>l</mi><mi>I</mi></msub></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mi>M</mi><msub><mi>m</mi><mi>V</mi></msub></msub><mo>=</mo><mtext>top-</mtext><mi>K</mi><mo stretchy="false">(</mo><msub><mi>M</mi><msub><mi>l</mi><mi>V</mi></msub></msub><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
M_{m_I} = \text{top-}K(M_{l_I}), \quad 
M_{m_V} = \text{top-}K(M_{l_V}) \tag{4}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9336em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord text"><span class="mord">top-</span></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0197em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord text"><span class="mord">top-</span></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0197em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span>


<p>根据 Top-K 之外元素的处理方式，滤波器分为两类：</p>
<ul>
<li><p><strong>软滤波器（Soft Filter）</strong>：  </p>
<ul>
<li>非 Top-K 元素被压缩到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 范围内，而非直接置零  </li>
<li>能在抑制冗余的同时避免信息完全丢失，表现更稳定</li>
</ul>
</li>
<li><p><strong>硬滤波器（Hard Filter）</strong>：  </p>
<ul>
<li>非 Top-K 元素直接置为 0  </li>
<li>更激进，可能带来更强的噪声抑制，也更容易损失细节</li>
</ul>
</li>
</ul>
<p>在实验中，作者在 FLIR 数据集上比较了不同 K 与滤波器类型的组合，发现当 <strong>软滤波器 + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>320</mn></mrow><annotation encoding="application/x-tex">K=320</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">320</span></span></span></span></strong> 时获得最优性能（见表 III）。</p>
<p>将一维嵌入通过最近邻插值重塑回频域尺寸，得到滤波器：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>H</mi><mi>I</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">(</mo><msub><mi>M</mi><msub><mi>m</mi><mi>I</mi></msub></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mi>H</mi><mi>V</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">(</mo><msub><mi>M</mi><msub><mi>m</mi><mi>V</mi></msub></msub><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(5)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
H_I(u,v) = \mathrm{Reshape}(M_{m_I}), \quad 
H_V(u,v) = \mathrm{Reshape}(M_{m_V}) \tag{5}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathrm">Reshape</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathrm">Reshape</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5</span></span><span class="mord">)</span></span></span></span></span></span>


<p>图 5 给出了学习到的滤波器与滤波后幅度谱的可视化示例：</p>
<p><img data-src="/./../images/image-20251206182211879.png" alt="image-20251206182211879"></p>
<blockquote>
<p>图 5. 学习到的滤波器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>I</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H_I(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>V</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H_V(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 以及滤波前后幅度谱与图像的可视化。</p>
</blockquote>
<p>可以观察到滤波器主要抑制了部分高频噪声区域，而目标区域幅度变化较小。</p>
<h2 id="3-4-频域滤波与逆变换"><a href="#3-4-频域滤波与逆变换" class="headerlink" title="3.4 频域滤波与逆变换"></a>3.4 频域滤波与逆变换</h2><p>得到滤波器后，在频域进行逐元素相乘：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msubsup><mi>F</mi><mi>I</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mi>I</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>⊗</mo><msub><mi>H</mi><mi>I</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msubsup><mi>F</mi><mi>V</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mi>V</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>⊗</mo><msub><mi>H</mi><mi>V</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(6)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
F&#x27;_I(u,v) = F_I(u,v) \otimes H_I(u,v), \quad 
F&#x27;_V(u,v) = F_V(u,v) \otimes H_V(u,v) \tag{6}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6</span></span><span class="mord">)</span></span></span></span></span></span>


<p>随后通过逆离散傅里叶变换（IDFT）返回空间域，得到经过冗余光谱去除的图像：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msup><mi>I</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mrow><mi mathvariant="normal">I</mi><mi mathvariant="normal">D</mi><mi mathvariant="normal">F</mi><mi mathvariant="normal">T</mi></mrow><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msubsup><mi>F</mi><mi>I</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo separator="true">,</mo><mspace width="1em"/><msup><mi>V</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mrow><mi mathvariant="normal">I</mi><mi mathvariant="normal">D</mi><mi mathvariant="normal">F</mi><mi mathvariant="normal">T</mi></mrow><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msubsup><mi>F</mi><mi>V</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(7)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
I&#x27; = \mathrm{IDFT}\bigl(F&#x27;_I(u,v)\bigr), \quad 
V&#x27; = \mathrm{IDFT}\bigl(F&#x27;_V(u,v)\bigr) \tag{7}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathrm">IDFT</span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose"><span class="delimsizing size1">)</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathrm">IDFT</span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose"><span class="delimsizing size1">)</span></span></span><span class="tag"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7</span></span><span class="mord">)</span></span></span></span></span></span>


<p>中间结果的可视化表明：</p>
<ul>
<li>目标区域在 RSR 处理前后变化极小  </li>
<li>被抑制的信息主要集中在背景区域  </li>
<li>图像整体信噪比（SNR）有所提升</li>
</ul>
<p><img data-src="/./../images/image-20251206182231773.png" alt="image-20251206182231773"></p>
<blockquote>
<p>图 7. RSR 模块在 FLIR（左）与 LLVIP（右）数据集上的中间输出可视化。绿色框为目标，红色框为背景，可见背景区域被显著模糊化而目标保持清晰。</p>
</blockquote>
<hr>
<h1 id="4-动态特征选择模块（DFS）"><a href="#4-动态特征选择模块（DFS）" class="headerlink" title="4. 动态特征选择模块（DFS）"></a>4. 动态特征选择模块（DFS）</h1><h2 id="4-1-设计思路：尺度感知专家混合"><a href="#4-1-设计思路：尺度感知专家混合" class="headerlink" title="4.1 设计思路：尺度感知专家混合"></a>4.1 设计思路：尺度感知专家混合</h2><p>在完成频域粗过滤后，RGB 与 IR 特征仍然存在以下难点：</p>
<ul>
<li>不同尺度目标在两模态中的显著性差异较大  </li>
<li>某些尺度上 RGB 更可靠，另一些尺度上 IR 更可靠  </li>
<li>简单相加或注意力往往难以同时处理<strong>多尺度 + 多模态 + 动态路由</strong></li>
</ul>
<p>DFS 的核心思想是：<br>在每一个尺度上，构建一组针对该尺度的<strong>RGB 专家</strong>与<strong>IR 专家</strong>，通过<strong>门控网络 + Router</strong> 实现对不同模态特征的动态选择，形成<strong>尺度感知的 MoE 结构</strong>。</p>
<p><img data-src="/./../images/image-20251206182249229.png" alt="image-20251206182249229"></p>
<blockquote>
<p>图 6. 各尺度专家输出特征与融合特征的可视化。不同专家关注不同尺度的目标，融合后的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mtext>spe</mtext></msub></mrow><annotation encoding="application/x-tex">C_{\text{spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 对目标区域具有更强响应。</p>
</blockquote>
<h2 id="4-2-门控网络：从全局统计到权重分配"><a href="#4-2-门控网络：从全局统计到权重分配" class="headerlink" title="4.2 门控网络：从全局统计到权重分配"></a>4.2 门控网络：从全局统计到权重分配</h2><p>对经过 backbone 提取的多尺度模态特定特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mrow><mi>I</mi><mtext>-spe</mtext></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>C</mi><mrow><mi>V</mi><mtext>-spe</mtext></mrow><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">C^{i}_{I\text{-spe}}, C^{i}_{V\text{-spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2361em;vertical-align:-0.4114em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4114em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4114em;"><span></span></span></span></span></span></span></span></span></span>（尺度索引为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>），首先做全局平均池化并展平：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>X</mi><mi>I</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>X</mi><mi>V</mi><mi>i</mi></msubsup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>M</mi></msup></mrow><annotation encoding="application/x-tex">
X^{i}_I, X^{i}_V \in \mathbb{R}^{M}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1217em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span></span></span>


<p>门控网络 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> 将两个模态的统计特征拼接后映射到权重空间，并通过 Softmax 得到规范化权重：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msubsup><mi>w</mi><mi>I</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>w</mi><mi>V</mi><mi>i</mi></msubsup><mo>=</mo><mi>G</mi><mo stretchy="false">(</mo><msubsup><mi>X</mi><mi>I</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>X</mi><mi>V</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo>=</mo><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mo stretchy="false">[</mo><msubsup><mi>X</mi><mi>I</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>X</mi><mi>V</mi><mi>i</mi></msubsup><mo stretchy="false">]</mo><mo>⋅</mo><mi>W</mi><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(8)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
w^{i}_I, w^{i}_V = G(X^{i}_I, X^{i}_V) = 
\mathrm{Softmax}\bigl([X^{i}_I, X^{i}_V] \cdot W\bigr) \tag{8}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1217em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2247em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathrm">Softmax</span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="delimsizing size1">)</span></span></span><span class="tag"><span class="strut" style="height:1.2247em;vertical-align:-0.35em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">8</span></span><span class="mord">)</span></span></span></span></span></span>


<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>M</mi><mo>×</mo><mi>N</mi></mrow></msup></mrow><annotation encoding="application/x-tex">W \in \mathbb{R}^{M \times N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span></span> 为可学习参数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 为专家数量（按尺度划分）。  </li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mi>I</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>w</mi><mi>V</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">w^{i}_I, w^{i}_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span> 反映该尺度下 IR / RGB 特征的重要性。</li>
</ul>
<h2 id="4-3-路由器：门控到二值路由"><a href="#4-3-路由器：门控到二值路由" class="headerlink" title="4.3 路由器：门控到二值路由"></a>4.3 路由器：门控到二值路由</h2><p>为了在保持可训练性的同时提高决策清晰度，引入阈值路由器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 将连续权重转化为“使用 &#x2F; 不使用”二值门控：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mo stretchy="false">(</mo><msubsup><mi>r</mi><mi>I</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>r</mi><mi>V</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mo stretchy="false">(</mo><msubsup><mi>w</mi><mi>I</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>w</mi><mi>V</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>w</mi><mi>I</mi><mi>i</mi></msubsup><mo>≥</mo><mi>t</mi><mo separator="true">,</mo><mtext> </mtext><msubsup><mi>w</mi><mi>V</mi><mi>i</mi></msubsup><mo>≥</mo><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>w</mi><mi>I</mi><mi>i</mi></msubsup><mo>≥</mo><mi>t</mi><mo separator="true">,</mo><mtext> </mtext><msubsup><mi>w</mi><mi>V</mi><mi>i</mi></msubsup><mo>&lt;</mo><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>w</mi><mi>I</mi><mi>i</mi></msubsup><mo>&lt;</mo><mi>t</mi><mo separator="true">,</mo><mtext> </mtext><msubsup><mi>w</mi><mi>V</mi><mi>i</mi></msubsup><mo>≥</mo><mi>t</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(9)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
(r^{i}_I, r^{i}_V) = R(w^{i}_I, w^{i}_V) = 
\begin{cases}
(1, 1), &amp; w^{i}_I \ge t, ~ w^{i}_V \ge t \\
(1, 0), &amp; w^{i}_I \ge t, ~ w^{i}_V &lt; t \\
(0, 1), &amp; w^{i}_I &lt; t, ~ w^{i}_V \ge t
\end{cases} \tag{9}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace nobreak"> </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace nobreak"> </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace nobreak"> </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">9</span></span><span class="mord">)</span></span></span></span></span></span>


<ul>
<li>若两模态权重均高于阈值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>，则同时保留  </li>
<li>若一方低于阈值，则仅保留权重较高的一方  </li>
<li>这样既可以突出主导模态，又避免完全忽略另一模态的有用信息</li>
</ul>
<h2 id="4-4-尺度感知专家网络与融合"><a href="#4-4-尺度感知专家网络与融合" class="headerlink" title="4.4 尺度感知专家网络与融合"></a>4.4 尺度感知专家网络与融合</h2><p>对每个尺度与每个模态，构建小型专家网络 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">E</mi><mi>I</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="script">E</mi><mi>V</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{E}^{i}_I, \mathcal{E}^{i}_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0894em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.0894em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span>（由两个卷积块组成），对门控后的特征进行进一步变换：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msubsup><mi>C</mi><mi>I</mi><mi>i</mi></msubsup><mo>=</mo><msubsup><mi mathvariant="script">E</mi><mi>I</mi><mi>i</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>I</mi><mi>i</mi></msubsup><mo>⋅</mo><msubsup><mi>r</mi><mi>I</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msubsup><mi>C</mi><mi>V</mi><mi>i</mi></msubsup><mo>=</mo><msubsup><mi mathvariant="script">E</mi><mi>V</mi><mi>i</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>V</mi><mi>i</mi></msubsup><mo>⋅</mo><msubsup><mi>r</mi><mi>V</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(10)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
C^{i}_I = \mathcal{E}^{i}_I(x^{i}_I \cdot r^{i}_I), \quad
C^{i}_V = \mathcal{E}^{i}_V(x^{i}_V \cdot r^{i}_V) \tag{10}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1217em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0894em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0894em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">10</span></span><span class="mord">)</span></span></span></span></span></span>


<p>最终，将所有尺度的专家输出按权重进行加权求和并级联，得到多模态特定融合特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mtext>spe</mtext></msub></mrow><annotation encoding="application/x-tex">C_{\text{spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>C</mi><mtext>spe</mtext></msub><mo>=</mo><munderover><mo>⋃</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msubsup><mi>w</mi><mi>I</mi><mi>i</mi></msubsup><msubsup><mi>C</mi><mi>I</mi><mi>i</mi></msubsup><mo>+</mo><msubsup><mi>w</mi><mi>V</mi><mi>i</mi></msubsup><msubsup><mi>C</mi><mi>V</mi><mi>i</mi></msubsup><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(11)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
C_{\text{spe}} = \bigcup_{i=1}^{n} \bigl( w^{i}_I C^{i}_I + w^{i}_V C^{i}_V \bigr) \tag{11}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">⋃</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2247em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing size1">)</span></span></span><span class="tag"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">11</span></span><span class="mord">)</span></span></span></span></span></span>


<p>从图 6 的可视化可见：</p>
<ul>
<li>不同专家聚焦不同尺度目标（从小物体到大物体）  </li>
<li>每个专家依据当前场景在 RGB &#x2F; IR 中选择更可靠的模态特征  </li>
<li>最终融合特征在目标区域呈现更清晰、更集中的响应，背景抑制更好</li>
</ul>
<hr>
<h1 id="5-去除与选择检测器（RSDet）"><a href="#5-去除与选择检测器（RSDet）" class="headerlink" title="5. 去除与选择检测器（RSDet）"></a>5. 去除与选择检测器（RSDet）</h1><h2 id="5-1-与-Faster-R-CNN-的集成"><a href="#5-1-与-Faster-R-CNN-的集成" class="headerlink" title="5.1 与 Faster R-CNN 的集成"></a>5.1 与 Faster R-CNN 的集成</h2><p>RSDet 在检测框架上采用标准的两阶段检测器 Faster R-CNN，主要改动在 backbone 特征提取部分：</p>
<ul>
<li>用“RSR + Shared–Specific + DFS” 替代原有单模态 ResNet backbone  </li>
<li>RPN、RoI Pooling &#x2F; RoIAlign、R-CNN 头部结构均保持不变</li>
</ul>
<p>因此，RSDet 可看作在<strong>特征层面进行多模态由粗到细融合</strong>的通用模块，与主流两阶段检测框架兼容性较好。</p>
<h2 id="5-2-共享–特定表示与互信息损失"><a href="#5-2-共享–特定表示与互信息损失" class="headerlink" title="5.2 共享–特定表示与互信息损失"></a>5.2 共享–特定表示与互信息损失</h2><p>为显式区分<strong>模态共享信息</strong>与<strong>模态特定信息</strong>，作者引入共享–特定表示学习，并通过互信息（Mutual Information, MI）损失进行监督：</p>
<ul>
<li>共享特征：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mtext>sha</mtext></msub></mrow><annotation encoding="application/x-tex">C_{\text{sha}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sha</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  </li>
<li>IR 特定特征：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>I</mi><mtext>-spe</mtext></mrow></msub></mrow><annotation encoding="application/x-tex">C_{I\text{-spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>  </li>
<li>RGB 特定特征：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>V</mi><mtext>-spe</mtext></mrow></msub></mrow><annotation encoding="application/x-tex">C_{V\text{-spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>通过最大化共享特征与各模态特定特征之间的互信息，鼓励：</p>
<ul>
<li>共享分支捕获两模态共同信息  </li>
<li>特定分支在保留共享部分的基础上学习模态专有差异</li>
</ul>
<p>互信息损失定义为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>I</mi><mtext>-spe</mtext></mrow></msub><mo>=</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">I</mi></mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mtext>sha</mtext></msub><mo separator="true">,</mo><msub><mi>C</mi><mrow><mi>I</mi><mtext>-spe</mtext></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mi mathvariant="script">L</mi><mrow><mi>V</mi><mtext>-spe</mtext></mrow></msub><mo>=</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">I</mi></mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mtext>sha</mtext></msub><mo separator="true">,</mo><msub><mi>C</mi><mrow><mi>V</mi><mtext>-spe</mtext></mrow></msub><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(12–13)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\mathcal{L}_{I\text{-spe}} = \mathrm{MI}(C_{\text{sha}}, C_{I\text{-spe}}), \quad
\mathcal{L}_{V\text{-spe}} = \mathrm{MI}(C_{\text{sha}}, C_{V\text{-spe}}) \tag{12–13}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathrm">MI</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sha</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathrm">MI</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sha</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">12–13</span></span><span class="mord">)</span></span></span></span></span></span>


<p>在具体实现中，作者利用交叉熵（CE）与 KL 散度（KL）对互信息进行近似最大化：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>max</mi><mo>⁡</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">I</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⇒</mo><mi>max</mi><mo>⁡</mo><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">{</mo><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">E</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">E</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∥</mi><mi>x</mi><mo stretchy="false">)</mo><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">}</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(14)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\max \mathrm{MI}(x,y) \Rightarrow \max \bigl\{
\mathrm{CE}(x,y) - \mathrm{KL}(x\|y) + \mathrm{CE}(y,x) - \mathrm{KL}(y\|x)
\bigr\} \tag{14}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">MI</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mop">max</span><span class="mopen"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathrm">CE</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">KL</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">CE</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathrm">KL</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∥</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose"><span class="delimsizing size1">}</span></span></span><span class="tag"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">14</span></span><span class="mord">)</span></span></span></span></span></span>


<h2 id="5-3-总体损失函数"><a href="#5-3-总体损失函数" class="headerlink" title="5.3 总体损失函数"></a>5.3 总体损失函数</h2><p>检测部分采用与 Faster R-CNN 相同的损失：</p>
<ul>
<li>RPN 损失：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>rpn</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{rpn}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">rpn</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>  </li>
<li>边界框回归损失：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>reg</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{reg}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">reg</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>  </li>
<li>分类损失：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>cls</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{cls}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>最终总损失为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi mathvariant="script">L</mi><mo>=</mo><mi>γ</mi><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msub><mi mathvariant="script">L</mi><mrow><mi>I</mi><mtext>-spe</mtext></mrow></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mrow><mi>V</mi><mtext>-spe</mtext></mrow></msub><mo fence="true" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>rpn</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>reg</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>cls</mtext></msub></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(15)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\mathcal{L} = \gamma\bigl(\mathcal{L}_{I\text{-spe}} + \mathcal{L}_{V\text{-spe}}\bigr)
+ \mathcal{L}_{\text{rpn}} + \mathcal{L}_{\text{reg}} + \mathcal{L}_{\text{cls}} \tag{15}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing size1">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">rpn</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">reg</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">15</span></span><span class="mord">)</span></span></span></span></span></span>


<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>0.001</mn></mrow><annotation encoding="application/x-tex">\gamma=0.001</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.001</span></span></span></span> 为互信息项与检测项之间的平衡系数。</p>
<hr>
<h1 id="6-实验设置"><a href="#6-实验设置" class="headerlink" title="6. 实验设置"></a>6. 实验设置</h1><h2 id="6-1-数据集"><a href="#6-1-数据集" class="headerlink" title="6.1 数据集"></a>6.1 数据集</h2><ol>
<li><p><strong>KAIST 多光谱行人检测数据集</strong>  </p>
<ul>
<li>原始数据集标注存在问题，后续工作对训练集与测试集标注进行了修正  </li>
<li>训练集：8,963 对 RGB–IR 图像对  </li>
<li>测试集：2,252 对图像对（使用改进标注）  </li>
<li>划分设置：  <ul>
<li><strong>尺度</strong>：near &#x2F; medium &#x2F; far（按行人高度分段）  </li>
<li><strong>遮挡</strong>：none &#x2F; partial &#x2F; heavy  </li>
<li><strong>光照</strong>：day &#x2F; night  </li>
<li><strong>评估设置</strong>：All &#x2F; Reasonable（本文采用更具挑战性的 All 设置）</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>FLIR-aligned 数据集</strong>  </p>
<ul>
<li>含昼夜场景的 RGB–IR 配对图像，原始 FLIR 数据存在配准误差，故使用对齐版本  </li>
<li>图像对总数：5,142  <ul>
<li>训练：4,129  </li>
<li>测试：1,013</li>
</ul>
</li>
<li>类别：person &#x2F; car &#x2F; bicycle（原始“dog”类实例过少，已在清理过程中移除）</li>
</ul>
</li>
<li><p><strong>LLVIP 低光多模态检测数据集</strong>  </p>
<ul>
<li>严格配准的 RGB–IR 配对数据，场景多为极暗、低照度环境  </li>
<li>图像对总数：15,488  <ul>
<li>训练：12,025  </li>
<li>测试：3,463</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="6-2-评估指标"><a href="#6-2-评估指标" class="headerlink" title="6.2 评估指标"></a>6.2 评估指标</h2><ol>
<li><p><strong>对数平均漏检率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">R</mi></mrow><mrow><mo>−</mo><mn>2</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathrm{MR}^{-2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1373em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">MR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></strong>  </p>
<ul>
<li>用于 KAIST 数据集  </li>
<li>在 9 个对数均匀采样的 FPPI（每图像假阳性数）点上计算平均漏检率  </li>
<li>数值越低表示性能越优</li>
</ul>
</li>
<li><p><strong>平均精度均值（mAP）</strong>  </p>
<ul>
<li>用于 FLIR-aligned 与 LLVIP 数据集  </li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi></mrow><mn>50</mn></msub></mrow><annotation encoding="application/x-tex"> \mathrm{mAP}_{50} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mAP</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：IoU=0.5 时三类的平均 AP  </li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi></mrow><annotation encoding="application/x-tex"> \mathrm{mAP} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathrm">mAP</span></span></span></span></span>：IoU 从 0.5 到 0.95（步长 0.05）上的平均 AP</li>
</ul>
</li>
</ol>
<h2 id="6-3-实现细节"><a href="#6-3-实现细节" class="headerlink" title="6.3 实现细节"></a>6.3 实现细节</h2><ul>
<li>实现平台：mmdetection 工具箱，GPU 为 NVIDIA GeForce RTX 3090  </li>
<li>检测框架：Faster R-CNN，backbone 为 ResNet-50  </li>
<li>优化器：SGD，动量 0.9，权重衰减 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1\times10^{-4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span>  </li>
<li>训练策略：  <ul>
<li>FLIR-aligned &amp; KAIST：训练 12 epoch，初始学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1\times10^{-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>  </li>
<li>LLVIP：初始学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1\times10^{-3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>输入分辨率：为了方便 DFS 模块设计，将各数据集图像分辨率统一为 LLVIP 的分辨率  </li>
<li>数据增强：仅使用概率 0.5 的随机水平翻转，未使用复杂增强策略</li>
</ul>
<hr>
<h1 id="7-消融实验与可视化分析"><a href="#7-消融实验与可视化分析" class="headerlink" title="7. 消融实验与可视化分析"></a>7. 消融实验与可视化分析</h1><h2 id="7-1-模块级消融：RSR-与-DFS-的贡献"><a href="#7-1-模块级消融：RSR-与-DFS-的贡献" class="headerlink" title="7.1 模块级消融：RSR 与 DFS 的贡献"></a>7.1 模块级消融：RSR 与 DFS 的贡献</h2><p><img data-src="/./../images/image-20251206182311779.png" alt="image-20251206182311779"></p>
<blockquote>
<p>表 I. 在 FLIR、LLVIP（mAP，%）及 KAIST（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">R</mi></mrow><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathrm{MR}^{-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8873em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">MR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>，%）上的模块消融实验结果（IoU&#x3D;0.7）。</p>
</blockquote>
<ul>
<li>单独引入 <strong>RSR</strong>：  <ul>
<li>在三数据集上均取得稳定提升，证明频域去冗余的有效性</li>
</ul>
</li>
<li>单独引入 <strong>DFS</strong>：  <ul>
<li>在多尺度、多模态融合方面带来更明显的增益</li>
</ul>
</li>
<li>同时使用 <strong>RSR + DFS</strong>（完整 RSDet）：  <ul>
<li>在所有指标上表现最佳  </li>
<li>说明“先去除再选择”的级联是相互增益的，而非简单叠加</li>
</ul>
</li>
</ul>
<h2 id="7-2-DFS-与其他融合模块的比较"><a href="#7-2-DFS-与其他融合模块的比较" class="headerlink" title="7.2 DFS 与其他融合模块的比较"></a>7.2 DFS 与其他融合模块的比较</h2><p><img data-src="/./../images/image-20251206182325987.png" alt="image-20251206182325987"></p>
<blockquote>
<p>表 II. 在 FLIR 数据集上的融合模块对比（统一 Faster R-CNN + ResNet-50，公平设置）。</p>
</blockquote>
<ul>
<li>基线：Two-Stream Faster R-CNN（简单特征相加）  </li>
<li>对比方法：CMX、CFT 等代表性 RGB–X &#x2F; RGB–IR 融合模块  </li>
<li>结果表明：  <ul>
<li>DFS 相比 Two-Stream 仅增加约 <strong>3.91M</strong> 参数，却带来 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>A</mi><msub><mi>P</mi><mn>50</mn></msub><mo>+</mo><mn>7.8</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">mAP_{50}+7.8\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">7.8%</span></span></span></span></strong> 的显著提升  </li>
<li>与第二优融合方法相比，<strong>参数减少约 2.37 亿，FLOPs 降低 93G</strong>，但在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi></mrow><mn>50</mn></msub></mrow><annotation encoding="application/x-tex">\mathrm{mAP}_{50}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mAP</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi></mrow><mn>75</mn></msub></mrow><annotation encoding="application/x-tex">\mathrm{mAP}_{75}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mAP</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">75</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、mAP 上仍保持优势  </li>
<li>说明 DFS 在<strong>性能–复杂度折中</strong>上具有良好优势</li>
</ul>
</li>
</ul>
<h2 id="7-3-RSR-滤波器设计：硬-软滤波与-K-值"><a href="#7-3-RSR-滤波器设计：硬-软滤波与-K-值" class="headerlink" title="7.3 RSR 滤波器设计：硬 &#x2F; 软滤波与 K 值"></a>7.3 RSR 滤波器设计：硬 &#x2F; 软滤波与 K 值</h2><p><img data-src="/./../images/image-20251206182337562.png" alt="image-20251206182337562"></p>
<blockquote>
<p>表 III. RSR 中不同滤波器类型与 Top-K 值在 FLIR 数据集上的对比。</p>
</blockquote>
<ul>
<li>当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>400</mn></mrow><annotation encoding="application/x-tex">K=400</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">400</span></span></span></span> 时等价于“不过滤”（图像被划分为 400 个 patch）  </li>
<li>在不同 K 下，软滤波器的整体 mAP 均略优于硬滤波器  </li>
<li>最优配置为：<strong>软滤波器 + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>320</mn></mrow><annotation encoding="application/x-tex">K=320</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">320</span></span></span></span></strong>  </li>
<li>平均性能（Avg. mAP）也表明软滤波器在稳定性方面更具优势</li>
</ul>
<h2 id="7-4-中间结果可视化"><a href="#7-4-中间结果可视化" class="headerlink" title="7.4 中间结果可视化"></a>7.4 中间结果可视化</h2><h3 id="7-4-1-RSR-模块：目标与背景的差异"><a href="#7-4-1-RSR-模块：目标与背景的差异" class="headerlink" title="7.4.1 RSR 模块：目标与背景的差异"></a>7.4.1 RSR 模块：目标与背景的差异</h3><p>如图 7 所示（见第 3 节），RSR 模块主要作用于背景区域，使背景变得更加模糊或均匀，而目标区域基本保持不变。SNR 的定量分析进一步证明 RSR 能提高信噪比，对检测任务有积极作用。</p>
<h3 id="7-4-2-共享、特定与融合特征"><a href="#7-4-2-共享、特定与融合特征" class="headerlink" title="7.4.2 共享、特定与融合特征"></a>7.4.2 共享、特定与融合特征</h3><p><img data-src="/./../images/image-20251206182354043.png" alt="image-20251206182354043"></p>
<blockquote>
<p>图 8. DFS 模块在 FLIR 数据集上的特征融合可视化结果。特征被叠加在原始图像上。</p>
</blockquote>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mtext>sha</mtext></msub></mrow><annotation encoding="application/x-tex">C_{\text{sha}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sha</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：共享特征  </li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>I</mi><mtext>-spe</mtext></mrow></msub></mrow><annotation encoding="application/x-tex">C_{I\text{-spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>：IR 特定特征  </li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>V</mi><mtext>-spe</mtext></mrow></msub></mrow><annotation encoding="application/x-tex">C_{V\text{-spe}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span><span class="mord text mtight"><span class="mord mtight">-spe</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>：RGB 特定特征  </li>
<li>DFS 输出的融合特征在目标区域显著增强，且部分原本在共享特征中不显著的目标被凸显出来。</li>
</ul>
<h3 id="7-4-3-t-SNE：RSR-对特征解耦的影响"><a href="#7-4-3-t-SNE：RSR-对特征解耦的影响" class="headerlink" title="7.4.3 t-SNE：RSR 对特征解耦的影响"></a>7.4.3 t-SNE：RSR 对特征解耦的影响</h3><p><img data-src="/./../images/image-20251206182407018.png" alt="image-20251206182407018"></p>
<blockquote>
<p>图 9. t-SNE 可视化：有 &#x2F; 无 RSR 时共享与特定特征的分布差异。</p>
</blockquote>
<ul>
<li><strong>无 RSR</strong>：共享特征与模态特定特征在嵌入空间中混合程度较高，DFS 难以从中筛选特定模态所需信息  </li>
<li><strong>加入 RSR 后</strong>：混合区域数量明显减少，特征簇之间的可分性增强，有利于 DFS 进行更精确的动态特征选择</li>
</ul>
<hr>
<h1 id="8-与最先进方法的比较"><a href="#8-与最先进方法的比较" class="headerlink" title="8. 与最先进方法的比较"></a>8. 与最先进方法的比较</h1><h2 id="8-1-KAIST-数据集（行人检测）"><a href="#8-1-KAIST-数据集（行人检测）" class="headerlink" title="8.1 KAIST 数据集（行人检测）"></a>8.1 KAIST 数据集（行人检测）</h2><p><img data-src="/./../images/image-20251206182430640.png" alt="image-20251206182430640"></p>
<blockquote>
<p>表 IV. KAIST 数据集 “All” 设置下不同尺度、遮挡程度与光照条件的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">R</mi></mrow><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathrm{MR}^{-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8873em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">MR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>（%，IoU&#x3D;0.5 与 0.7）。</p>
</blockquote>
<ul>
<li><p>在 <strong>IoU&#x3D;0.5</strong> 下：  </p>
<ul>
<li>RSDet 在 All &#x2F; Day &#x2F; Night 三个总体设置上均取得最优漏检率  </li>
<li>在 near &#x2F; medium &#x2F; far、none &#x2F; heavy 等绝大多数子集上表现最好  </li>
<li>尤其在 far 子集上，相比第二优方法约提升 <strong>11.72%</strong>，说明其对远距小目标具有显著优势</li>
</ul>
</li>
<li><p>在 <strong>IoU&#x3D;0.7</strong> 下：  </p>
<ul>
<li>所有方法在 near 子集下原本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">R</mi></mrow><mrow><mo>−</mo><mn>2</mn></mrow></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathrm{MR}^{-2}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8873em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">MR</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，随着 IoU 提升，漏检率均有上升  </li>
<li>其他方法漏检率上升区间约为 16.98%–25.19%，而 RSDet 仅上升 11.81%，显示更高定位精度与鲁棒性</li>
</ul>
</li>
</ul>
<p>MR–FPPI 曲线（图 10）进一步表明：  </p>
<p><img data-src="/./../images/image-20251206182452629.png" alt="image-20251206182452629"></p>
<blockquote>
<p>图 10. KAIST “All” 设置下 RSDet 与其他方法的 MR–FPPI 曲线对比。</p>
</blockquote>
<ol>
<li>RSDet 在全范围内拥有最低的漏检率曲线  </li>
<li>在低 FPPI 区域仍能保持显著优势，兼顾高精度与低误检  </li>
<li>曲线较为平滑，说明模型在不同阈值下表现稳定</li>
</ol>
<h2 id="8-2-FLIR-数据集"><a href="#8-2-FLIR-数据集" class="headerlink" title="8.2 FLIR 数据集"></a>8.2 FLIR 数据集</h2><p><img data-src="/./../images/image-20251206182506212.png" alt="image-20251206182506212"></p>
<blockquote>
<p>表 V. FLIR 数据集上不同方法的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi></mrow><mn>50</mn></msub></mrow><annotation encoding="application/x-tex">\mathrm{mAP}_{50}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mAP</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 与 mAP 对比。</p>
</blockquote>
<ul>
<li>单模态 RGB &#x2F; IR 方法整体性能低于多模态融合方法  </li>
<li>RSDet 在 RGB–IR 方法中取得 <strong>83.9% <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi></mrow><mn>50</mn></msub></mrow><annotation encoding="application/x-tex">\mathrm{mAP}_{50}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mAP</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong> 与 <strong>43.8% mAP</strong>：  <ul>
<li>比第二优 RGB–IR 方法分别高出约 <strong>4.7%</strong>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi></mrow><mn>50</mn></msub></mrow><annotation encoding="application/x-tex">\mathrm{mAP}_{50}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mAP</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）与 <strong>2.5%</strong>（mAP）  </li>
<li>说明由粗到细融合策略在城市交通等复杂场景中具有明显优势</li>
</ul>
</li>
</ul>
<h2 id="8-3-LLVIP-数据集（低光条件）"><a href="#8-3-LLVIP-数据集（低光条件）" class="headerlink" title="8.3 LLVIP 数据集（低光条件）"></a>8.3 LLVIP 数据集（低光条件）</h2><p><img data-src="/./../images/image-20251206182519445.png" alt="image-20251206182519445"></p>
<blockquote>
<p>表 VI. LLVIP 数据集上不同方法的性能对比（mAP，%）。  </p>
</blockquote>
<p>在 LLVIP 极低照度场景中，通常出现以下现象：</p>
<ul>
<li>RGB 模态质量显著下降，RGB–IR 融合方法反而受到 RGB 噪声干扰  </li>
<li>许多现有 RGB–IR 方法性能甚至不如单 IR 模态检测器</li>
</ul>
<p>RSDet 在 LLVIP 上实现：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi></mrow><mn>50</mn></msub><mo>=</mo><mn>95.8</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">\mathrm{mAP}_{50} = 95.8\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mAP</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">95.8%</span></span></span></span>，mAP = 61.3%  </li>
<li>相比第二优 RGB–IR 方法，分别提升 <strong>1.2%</strong> 与 <strong>2.1%</strong></li>
</ul>
<p>这说明：</p>
<ul>
<li>RSR 有效抑制了低质量 RGB 特征对 IR 的干扰  </li>
<li>DFS 能够在低照度条件下更倾向于选择 IR 特征，从而稳定提升多模态检测性能</li>
</ul>
<hr>
<h1 id="9-总结与思考"><a href="#9-总结与思考" class="headerlink" title="9. 总结与思考"></a>9. 总结与思考</h1><h2 id="9-1-方法优点"><a href="#9-1-方法优点" class="headerlink" title="9.1 方法优点"></a>9.1 方法优点</h2><ol>
<li><p><strong>认知理论支撑的由粗到细融合视角</strong>  </p>
<ul>
<li>将 Treisman 衰减模型中的“先衰减后精细加工”映射到多模态特征融合流程，提供了较为明确的理论动机。</li>
</ul>
</li>
<li><p><strong>频域冗余光谱去除（RSR）的可解释性与通用性</strong>  </p>
<ul>
<li>操作于输入图像层面，与下游检测器结构解耦，具有较好的可插拔性。  </li>
<li>滤波器可视化与 SNR 指标均表明其主要抑制背景与噪声，而尽量保留目标区域。</li>
</ul>
</li>
<li><p><strong>动态特征选择（DFS）的尺度感知能力</strong>  </p>
<ul>
<li>通过门控网络 + Router + 专家混合，在多尺度、多模态上实现动态路由，能够显式选择更可靠的模态与尺度。  </li>
<li>相比复杂的跨模态注意力模块，DFS 在参数量与 FLOPs 上更为经济，性能–效率折中良好。</li>
</ul>
</li>
<li><p><strong>共享–特定表示与互信息约束</strong>  </p>
<ul>
<li>引入显式的共享–特定分解，有助于避免模态特定信息被过度“平均化”，保留 RGB 与 IR 的互补优势。</li>
</ul>
</li>
<li><p><strong>实验验证充分</strong>  </p>
<ul>
<li>在三大主流 RGB–IR 检测数据集（KAIST、FLIR-aligned、LLVIP）上均取得 SOTA 性能。  </li>
<li>消融实验、滤波器设计比较、可视化分析较为完整，支持提出方法各组件的有效性。</li>
</ul>
</li>
</ol>
<h2 id="9-2-可能的局限与改进方向"><a href="#9-2-可能的局限与改进方向" class="headerlink" title="9.2 可能的局限与改进方向"></a>9.2 可能的局限与改进方向</h2><ol>
<li><p><strong>频域操作的计算与实现复杂度</strong>  </p>
<ul>
<li>RSR 需要对整幅图像进行 DFT&#x2F;IDFT 操作，虽然在当前分辨率下仍可接受，但在更高分辨率或实时系统中可能成为瓶颈。  </li>
<li>后续可探索局部频域变换或可学习的小波&#x2F;变换替代，降低计算开销。</li>
</ul>
</li>
<li><p><strong>滤波器粒度与自适应性</strong>  </p>
<ul>
<li>当前滤波器以固定 patch 划分与 Top-K 选择为主，仍然较为粗糙。  </li>
<li>可尝试引入任务自适应的频率划分或更细粒度的频域注意机制，以捕获更复杂的细节差异。</li>
</ul>
</li>
<li><p><strong>与 Transformer &#x2F; 单阶段检测器的兼容性</strong>  </p>
<ul>
<li>论文主要在 Faster R-CNN + ResNet-50 框架下验证。  </li>
<li>在通用性方面，可进一步探索与 Transformer-based 检测器（如 DETR 系列）或单阶段检测器的结合效果。</li>
</ul>
</li>
<li><p><strong>路由机制与阈值超参数</strong>  </p>
<ul>
<li>DFS 中的阈值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 需人工设定，不同数据集可能需要调节。  </li>
<li>后续可考虑引入可学习阈值或连续门控（如 Gumbel-Softmax）以减轻手工超参数依赖。</li>
</ul>
</li>
<li><p><strong>扩展到更多模态与任务</strong>  </p>
<ul>
<li>当前工作聚焦于 RGB–IR 双模态目标检测。  </li>
<li>从方法本身看，RSR 与 DFS 的设计具有一定通用性，潜在可扩展到 RGB–Depth、SAR–Optical 甚至多模态语义分割、跟踪等任务，值得进一步研究。</li>
</ul>
</li>
</ol>
<hr>
<h1 id="10-小结"><a href="#10-小结" class="headerlink" title="10. 小结"></a>10. 小结</h1><p>本文提出的 RSDet 从“<strong>先在频域去除冗余信息，再在特征域进行动态选择</strong>”这一由粗到细的视角重新审视 RGB–IR 特征融合，分别在输入层与特征层引入 RSR 与 DFS 两个关键模块，并结合共享–特定表示学习与互信息损失，构建了一套完整且具有解释性的多模态检测框架。大规模实验结果表明，该方案能够有效抑制模态冗余、增强互补融合，在高难度场景下显著优于现有方法，为后续多模态检测与多模态频域建模提供了有价值的思路。</p>
]]></content>
      <categories>
        <category>论文阅读</category>
      </categories>
      <tags>
        <tag>多光谱目标检测</tag>
        <tag>多模态融合</tag>
        <tag>图像融合</tag>
      </tags>
  </entry>
  <entry>
    <title>【论文阅读 | ICCV 2025 | M-SpecGene：面向 RGBT 多光谱视觉的通用基础模型】</title>
    <url>/2025/12/13/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20ICCV%202025%20%20M-SpecGene%EF%BC%9A%E9%9D%A2%E5%90%91%20RGBT%20%E5%A4%9A%E5%85%89%E8%B0%B1%E8%A7%86%E8%A7%89%E7%9A%84%E9%80%9A%E7%94%A8%E5%9F%BA%E7%A1%80%E6%A8%A1%E5%9E%8B%E3%80%91/</url>
    <content><![CDATA[<p><img data-src="/./../images/image-20251214104330420.png" alt="image-20251214104330420"></p>
<p>题目：M-SpecGene: Generalized Foundation Model for RGBT Multispectral Vision</p>
<p>会议：International Conference on Computer Vision（ICCV）</p>
<p>论文链接：<a href="https://arxiv.org/abs/2507.16318">Link</a></p>
<p>代码：<a href="https://github.com/CalayZhou/M-SpecGene">CalayZhou&#x2F;M-SpecGene</a></p>
<p>年份：2025</p>
<h1 id="1-研究背景与动机"><a href="#1-研究背景与动机" class="headerlink" title="1. 研究背景与动机"></a>1. 研究背景与动机</h1><h2 id="1-1-RGBT-多光谱视觉的重要性"><a href="#1-1-RGBT-多光谱视觉的重要性" class="headerlink" title="1.1 RGBT 多光谱视觉的重要性"></a>1.1 RGBT 多光谱视觉的重要性</h2><p>RGB-热红外（RGBT）多光谱视觉已成为复杂环境感知的关键技术。相较于单模态RGB视觉，RGBT融合了可见光与热辐射信息，能够在光照变化、恶劣天气、复杂遮挡等场景下提供更鲁棒的感知能力。典型应用包括：</p>
<ul>
<li>全天候目标检测与跟踪</li>
<li>低照度场景理解</li>
<li>语义分割与显著性检测</li>
<li>自动驾驶与智能监控</li>
</ul>
<p>然而，现有RGBT方法大多采用<strong>逐任务定制</strong>（case-by-case）的研究范式，针对特定任务设计专门的模型架构与融合策略。</p>
<h2 id="1-2-现有范式的局限性"><a href="#1-2-现有范式的局限性" class="headerlink" title="1.2 现有范式的局限性"></a>1.2 现有范式的局限性</h2><p>当前RGBT研究主要存在以下三个核心问题：</p>
<h3 id="1-2-1-人工归纳偏置（Artificial-Inductive-Bias）"><a href="#1-2-1-人工归纳偏置（Artificial-Inductive-Bias）" class="headerlink" title="1.2.1 人工归纳偏置（Artificial Inductive Bias）"></a>1.2.1 人工归纳偏置（Artificial Inductive Bias）</h3><p>现阶段许多融合架构针对不同任务手工设计，因此缺乏通用性，泛化能力不足，例如：</p>
<ul>
<li>目标检测任务倾向于早期融合或特征金字塔融合</li>
<li>语义分割偏好逐层注意力融合</li>
<li>目标跟踪则常采用模板匹配式融合</li>
</ul>
<p>这种设计依赖于架构设计者对任务特性的假设，限制了模型跨任务泛化能力，难以迁移到新场景。</p>
<h3 id="1-2-2-模态偏置（Modality-Bias）"><a href="#1-2-2-模态偏置（Modality-Bias）" class="headerlink" title="1.2.2 模态偏置（Modality Bias）"></a>1.2.2 模态偏置（Modality Bias）</h3><p>RGBT数据存在固有的<strong>信息不平衡</strong>（Information Imbalance）问题：</p>
<ul>
<li>RGB模态包含丰富的纹理、颜色、空间结构信息</li>
<li>热红外模态主要提供温度分布与轮廓信息，细节相对稀疏</li>
</ul>
<p>现有方法往往对两模态平等对待，导致训练过程中模型过度依赖信息密度更高的RGB模态，而未能充分利用热红外的互补优势。这种模态偏置在数据量有限时尤为严重。</p>
<h3 id="1-2-3-数据瓶颈（Data-Bottleneck）"><a href="#1-2-3-数据瓶颈（Data-Bottleneck）" class="headerlink" title="1.2.3 数据瓶颈（Data Bottleneck）"></a>1.2.3 数据瓶颈（Data Bottleneck）</h3><p>与单模态RGB任务拥有海量标注数据不同，RGBT数据集规模普遍较小：</p>
<ul>
<li>主流RGBT检测数据集仅含数千至数万对图像</li>
<li>标注成本高（需同时标注配准的双模态数据）</li>
<li>场景覆盖有限，难以支撑深度模型的充分学习</li>
</ul>
<p>有限的数据规模进一步加剧了过拟合与模态偏置问题。</p>
<p><img data-src="/./../images/image-20251214104451800.png" alt="image-20251214104451800"></p>
<h2 id="1-3-基础模型范式的启示"><a href="#1-3-基础模型范式的启示" class="headerlink" title="1.3 基础模型范式的启示"></a>1.3 基础模型范式的启示</h2><p>近年来，计算机视觉领域涌现了一系列成功的基础模型：</p>
<ul>
<li><strong>MAE</strong>（Masked Autoencoders）：通过大规模自监督预训练学习通用视觉表示</li>
<li><strong>CLIP</strong>：在图文配对数据上学习跨模态对齐表示</li>
<li><strong>SAM</strong>（Segment Anything Model）：实现图像分割的通用能力</li>
</ul>
<p>这些工作表明，<strong>自监督预训练 + 大规模数据 + 通用架构</strong>的这种组合能够突破任务特定设计的限制，学习到可迁移的表示。</p>
<p>然而，多光谱视觉领域尚缺乏此类基础模型。关键挑战在于：</p>
<ol>
<li>如何设计适用于RGBT数据特性的自监督学习范式？</li>
<li>如何克服模态信息不平衡导致的学习偏置？</li>
<li>如何在有限数据下实现有效的预训练？</li>
</ol>
<h2 id="1-4-本文贡献"><a href="#1-4-本文贡献" class="headerlink" title="1.4 本文贡献"></a>1.4 本文贡献</h2><p>针对上述挑战，本文提出<strong>M-SpecGene</strong>（Generalized RGBT MultiSpectral Foundation Model），首次尝试构建面向RGBT多光谱视觉的通用基础模型。主要贡献包括：</p>
<ol>
<li><p><strong>提出RGBT统一预训练范式</strong></p>
<p>将目标检测、语义分割、显著性检测、目标跟踪等任务统一到一个自监督学习框架下，学习模态不变的通用表示（modality-invariant representations）。</p>
</li>
<li><p><strong>跨模态结构稀疏性度量（Cross-Modality Structural Sparsity, CMSS）</strong></p>
<p>首次定量化RGBT数据的信息密度差异，为设计平衡的掩码策略提供理论依据。</p>
</li>
<li><p><strong>GMM-CMSS渐进式掩码策略</strong></p>
<p>基于高斯混合模型（GMM）和CMSS度量，设计灵活的、由易到难的、以目标为中心的渐进掩码策略，有效缓解模态偏置，提升预训练效率。</p>
</li>
<li><p><strong>跨任务跨数据集验证</strong></p>
<p>在<strong>11个数据集</strong>和<strong>4类下游任务</strong>上进行系统评估，证明M-SpecGene在不同任务上的泛化能力与迁移性能。</p>
</li>
</ol>
<hr>
<h1 id="2-相关工作"><a href="#2-相关工作" class="headerlink" title="2. 相关工作"></a>2. 相关工作</h1><h2 id="2-1-RGBT多光谱视觉任务"><a href="#2-1-RGBT多光谱视觉任务" class="headerlink" title="2.1 RGBT多光谱视觉任务"></a>2.1 RGBT多光谱视觉任务</h2><h3 id="2-1-1-RGBT目标检测"><a href="#2-1-1-RGBT目标检测" class="headerlink" title="2.1.1 RGBT目标检测"></a>2.1.1 RGBT目标检测</h3><p>早期方法采用简单的特征拼接或晚期融合，性能受限。近年来工作聚焦于：</p>
<ul>
<li><strong>跨模态注意力机制</strong>：通过注意力模块增强模态交互</li>
<li><strong>多尺度融合</strong>：在特征金字塔不同层级融合RGB与热红外特征</li>
<li><strong>动态融合</strong>：根据场景自适应调整融合权重</li>
</ul>
<p>代表性工作包括CFT、MBNet、RIFT等，但这些方法设计针对性强，难以直接迁移到其他任务。</p>
<h3 id="2-1-2-RGBT语义分割"><a href="#2-1-2-RGBT语义分割" class="headerlink" title="2.1.2 RGBT语义分割"></a>2.1.2 RGBT语义分割</h3><p>语义分割需要密集的像素级预测，融合策略更强调：</p>
<ul>
<li><strong>逐层特征对齐</strong>：在编码器-解码器架构中逐层融合</li>
<li><strong>边界增强</strong>：利用热红外轮廓信息改善分割边界</li>
<li><strong>类别感知融合</strong>：针对不同类别选择不同模态权重</li>
</ul>
<p>RTFNet、MFNet等方法在城市场景分割上取得较好效果。</p>
<h3 id="2-1-3-RGBT显著性检测"><a href="#2-1-3-RGBT显著性检测" class="headerlink" title="2.1.3 RGBT显著性检测"></a>2.1.3 RGBT显著性检测</h3><p>显著性检测旨在定位图像中最吸引注意力的区域：</p>
<ul>
<li><strong>互补性建模</strong>：显式建模RGB纹理与热红外亮度的互补性</li>
<li><strong>跨模态对比</strong>：通过对比学习增强模态差异感知</li>
</ul>
<p>APNet、CGFNet等方法利用对比损失提升显著目标检测精度。</p>
<h3 id="2-1-4-RGBT目标跟踪"><a href="#2-1-4-RGBT目标跟踪" class="headerlink" title="2.1.4 RGBT目标跟踪"></a>2.1.4 RGBT目标跟踪</h3><p>视频目标跟踪需要在时序上保持目标一致性：</p>
<ul>
<li><strong>模板匹配</strong>：分别在RGB和热红外上进行模板匹配后融合</li>
<li><strong>自适应融合</strong>：根据遮挡、光照变化动态调整模态权重</li>
</ul>
<p>MANet、CAT等方法在挑战性跟踪场景下表现优异。</p>
<h2 id="2-2-基础模型与自监督学习"><a href="#2-2-基础模型与自监督学习" class="headerlink" title="2.2 基础模型与自监督学习"></a>2.2 基础模型与自监督学习</h2><h3 id="2-2-1-视觉基础模型"><a href="#2-2-1-视觉基础模型" class="headerlink" title="2.2.1 视觉基础模型"></a>2.2.1 视觉基础模型</h3><ul>
<li><strong>MAE</strong>：通过高比例掩码重建学习图像表示，展现出强大的迁移能力</li>
<li><strong>BEiT</strong>：使用离散VAE tokenizer进行掩码图像建模</li>
<li><strong>SimMIM</strong>：简化掩码策略，直接预测像素值</li>
</ul>
<p>这些方法在ImageNet等大规模数据上预训练后，能在多个下游任务上取得优异性能。</p>
<h3 id="2-2-2-多模态基础模型"><a href="#2-2-2-多模态基础模型" class="headerlink" title="2.2.2 多模态基础模型"></a>2.2.2 多模态基础模型</h3><ul>
<li><strong>CLIP</strong>：通过对比学习在图文对上学习跨模态表示</li>
<li><strong>FLAVA</strong>：统一图像、文本、图文配对的多模态预训练</li>
<li><strong>ImageBind</strong>：将多种模态（视觉、音频、文本等）映射到统一空间</li>
</ul>
<p>但这些工作主要针对语义级多模态（如图像-文本），与RGBT这种物理级多模态存在本质差异。</p>
<h3 id="2-2-3-掩码策略设计"><a href="#2-2-3-掩码策略设计" class="headerlink" title="2.2.3 掩码策略设计"></a>2.2.3 掩码策略设计</h3><p>掩码策略直接影响自监督学习效果：</p>
<ul>
<li><strong>随机掩码</strong>（MAE）：简单有效，但未考虑语义信息</li>
<li><strong>块状掩码</strong>（BEiT）：保持空间连贯性</li>
<li><strong>注意力引导掩码</strong>：基于注意力图选择重要区域掩码</li>
</ul>
<p>然而，现有策略均针对单模态设计，未考虑多模态信息不平衡问题。</p>
<hr>
<h1 id="3-方法"><a href="#3-方法" class="headerlink" title="3. 方法"></a>3. 方法</h1><p><img data-src="/./../images/image-20251214121527043.png" alt="image-20251214121527043"></p>
<h2 id="3-1-整体框架概述"><a href="#3-1-整体框架概述" class="headerlink" title="3.1 整体框架概述"></a>3.1 整体框架概述</h2><p>M-SpecGene 采用基于 <strong>Masked Autoencoders (MAE)</strong> 的 <strong>Siamese Transformer 架构</strong>，以自监督方式学习 <strong>模态不变（modality-invariant）</strong> 的 RGBT 表示。与传统逐任务定制的方法不同，M-SpecGene 通过在预训练阶段显式处理 RGBT 数据的信息不平衡问题，为多个下游任务提供通用的特征提取器。</p>
<p>整体流程的四个关键步骤：</p>
<ol>
<li><p><strong>模态特定 Patch Embedding</strong>  </p>
<p>RGB 与热红外图像分别经过 patch embedding 映射为 token 序列，保持模态物理特性的独立性。两个模态独立地分成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn><mo>×</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">16 \times 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">16</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span> 的 patch 并投影到 768 维特征空间。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">##mae.py</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x: torch.Tensor, x2: torch.Tensor, loss1: torch.Tensor, loss2: torch.Tensor, mask: <span class="type">Optional</span>[<span class="built_in">bool</span>] = <span class="literal">True</span></span>):</span><br><span class="line">    <span class="keyword">if</span> mask <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="literal">False</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().forward(x)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        B = x.shape[<span class="number">0</span>]  <span class="comment"># batch_size</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># RGB Patch Embedding</span></span><br><span class="line">        <span class="comment"># 关键步骤1：RGB图像 (B, 3, 224, 224) -&gt; patch embedding</span></span><br><span class="line">        x = <span class="variable language_">self</span>.patch_embed(x)[<span class="number">0</span>]  <span class="comment"># 输出 (B, 196, 768)</span></span><br><span class="line">        <span class="comment"># 196 = (224/16) * (224/16) 个patch，768 是embedding维度</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 添加位置编码（不包含CLS token）</span></span><br><span class="line">        x = x + <span class="variable language_">self</span>.pos_embed[:, <span class="number">1</span>:, :]  <span class="comment"># (B, 196, 768)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Thermal Patch Embedding</span></span><br><span class="line">        <span class="comment"># 关键步骤2：Thermal图像 (B, 1, 224, 224) -&gt; patch embedding</span></span><br><span class="line">        x2 = <span class="variable language_">self</span>.patch_embed(x2)[<span class="number">0</span>]  <span class="comment"># 输出 (B, 196, 768)</span></span><br><span class="line">        <span class="comment"># 同一个patch_embed对象处理两个模态，但输入不同</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 添加位置编码（不包含CLS token）</span></span><br><span class="line">        x2 = x2 + <span class="variable language_">self</span>.pos_embed[:, <span class="number">1</span>:, :]  <span class="comment"># (B, 196, 768)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>GMM-CMSS 渐进式掩码策略</strong><br>基于跨模态结构稀疏性（CMSS）度量，动态决定不同模态、不同区域的掩码位置，实现模态平衡与由易到难的训练。<strong>这是相比MAE最重要的改进。</strong></p>
</li>
<li><p><strong>共享权重 Transformer 编码器</strong><br>未被掩码的 RGB &#x2F; Thermal token 输入同一个 ViT 编码器，促使两模态在潜在空间中对齐。共享权重避免引入模态特定的融合模块。</p>
</li>
<li><p><strong>双解码器 + 跨模态交互重建</strong><br>通过两个模态特定解码器分别重建 RGB 与热红外，被掩码区域的重建过程中引入跨模态注意力以利用互补信息。</p>
</li>
</ol>
<p>预训练完成后，仅保留 ViT 编码器作为通用特征提取 backbone，迁移到检测、分割、显著性检测和跟踪等下游任务。整个框架的设计遵循 <strong>“模态独立处理 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">⇒</span></span></span></span> 共享特征学习 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">⇒</span></span></span></span> 模态特定重建”</strong> 的原则。</p>
<hr>
<h2 id="3-2-跨模态结构稀疏性（Cross-Modality-Structural-Sparsity-CMSS）"><a href="#3-2-跨模态结构稀疏性（Cross-Modality-Structural-Sparsity-CMSS）" class="headerlink" title="3.2 跨模态结构稀疏性（Cross-Modality Structural Sparsity, CMSS）"></a>3.2 跨模态结构稀疏性（Cross-Modality Structural Sparsity, CMSS）</h2><h3 id="3-2-1-设计原因"><a href="#3-2-1-设计原因" class="headerlink" title="3.2.1 设计原因"></a>3.2.1 设计原因</h3><p>RGBT 数据存在显著的 <strong>信息不平衡（information imbalance）</strong>：</p>
<ul>
<li>RGB 图像包含丰富的纹理、颜色与细节结构；</li>
<li>热红外图像通常更平滑，语义信息集中在目标轮廓和温度分布上。</li>
</ul>
<p>若在自监督预训练中对两模态采用<strong>相同的随机掩码策略</strong>，模型往往更容易依赖 RGB 模态，导致 <strong>模态偏置（modality bias）</strong>，热红外分支学习不足。</p>
<p>因此，需要一个能够<strong>量化 RGB–T 信息分布差异</strong>的度量，以指导信息感知的掩码策略。</p>
<hr>
<h3 id="3-2-2-CMSS-的实现"><a href="#3-2-2-CMSS-的实现" class="headerlink" title="3.2.2 CMSS 的实现"></a>3.2.2 CMSS 的实现</h3><p>这里需要强调的是，<strong>论文中的 CMSS 并非在像素空间定义</strong>，而是在 <strong>ViT patch embedding 空间</strong>，用于衡量 <strong>跨模态 patch 对的结构稀疏性 &#x2F; 信息密度</strong>。</p>
<p>对于一对 RGB–Thermal patch embedding <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mn>768</mn></msup></mrow><annotation encoding="application/x-tex">a, b \in \mathbb{R}^{768}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">768</span></span></span></span></span></span></span></span></span></span></span></span>，CMSS 定义为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>CMSS</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mrow><mo fence="true">⟨</mo><mfrac><mi>a</mi><mrow><mi mathvariant="normal">∣</mi><mi>a</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mo separator="true">,</mo><mfrac><mi>b</mi><mrow><mi mathvariant="normal">∣</mi><mi>b</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mo fence="true">⟩</mo></mrow></mrow><mrow><mn>2</mn><mo>⋅</mo><msubsup><mi>σ</mi><mi>a</mi><mn>2</mn></msubsup><mo>⋅</mo><msubsup><mi>σ</mi><mi>b</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\text{CMSS}(a, b)
= \frac{1 + \left\langle \frac{a}{|a|}, \frac{b}{|b|} \right\rangle}
{2 \cdot \sigma_a^2 \cdot \sigma_b^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">CMSS</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1773em;vertical-align:-0.9873em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.464em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.3987em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">⟨</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight">a</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight">b</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">⟩</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9873em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>

<p>其中：</p>
<ul>
<li>分子为 RGB–T patch embedding 的 <strong>余弦相似度</strong>，捕捉两模态特征的对齐程度；</li>
<li>分母为两模态 embedding 的 <strong>结构方差（structural variance）</strong>，表示特征的多样性；</li>
<li>CMSS 最终被归一化到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 区间。</li>
</ul>
<blockquote>
<p>余弦相似度：</p>
<ul>
<li>两根箭头（向量）夹角是 θ</li>
<li>夹角的 <strong>cos(θ)</strong> 就能表示“方向的相似程度”</li>
</ul>
<p>余弦相似度的结果 <strong>一定在 -1 到 1 之间</strong>：</p>
<table>
<thead>
<tr>
<th>数值</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><strong>1</strong></td>
<td>几乎完全相同</td>
</tr>
<tr>
<td><strong>0</strong></td>
<td>互不相干</td>
</tr>
<tr>
<td><strong>-1</strong></td>
<td>完全相反</td>
</tr>
</tbody></table>
</blockquote>
<p><strong>实现代码</strong>（源自 <a href="M-SpecGene/pretrain/mmpretrain-main_rgbt/mmpretrain/models/selfsup/GMM_CMSS_SAMPLE.py">GMM_CMSS_SAMPLE.py</a>）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">CMSS_Similarity</span>(<span class="params">self, tensor_1, tensor_2</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算跨模态结构稀疏性度量 CMSS&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 归一化为单位向量，计算余弦相似度</span></span><br><span class="line">    normalized_tensor_1 = tensor_1 / tensor_1.norm(dim=-<span class="number">1</span>, keepdim=<span class="literal">True</span>)</span><br><span class="line">    normalized_tensor_2 = tensor_2 / tensor_2.norm(dim=-<span class="number">1</span>, keepdim=<span class="literal">True</span>)</span><br><span class="line">    r_num = torch.<span class="built_in">sum</span>(normalized_tensor_1 * normalized_tensor_2, dim=<span class="number">1</span>)</span><br><span class="line">    r_num = (r_num + <span class="number">1.0</span>) * <span class="number">0.5</span>  <span class="comment"># 映射到[0,1]</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算结构方差</span></span><br><span class="line">    var_tensor_1 = torch.var(tensor_1, dim=<span class="number">1</span>)</span><br><span class="line">    var_tensor_2 = torch.var(tensor_2, dim=<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># CMSS = sqrt(余弦相似度) / (var_rgb * var_thermal)</span></span><br><span class="line">    r_num = torch.sqrt(r_num)</span><br><span class="line">    measure = r_num / (var_tensor_1 * var_tensor_2 + <span class="number">1e-8</span>)</span><br><span class="line">    measure = measure / (torch.<span class="built_in">max</span>(measure) + <span class="number">1e-8</span>)</span><br><span class="line">    <span class="keyword">return</span> measure</span><br></pre></td></tr></table></figure>

<h4 id="CMSS-数值含义"><a href="#CMSS-数值含义" class="headerlink" title="CMSS 数值含义"></a>CMSS 数值含义</h4><ul>
<li><p><strong>CMSS 较大</strong>（接近1）：</p>
<ul>
<li>RGB–T patch embedding 相似度高</li>
<li>两模态方差都较小</li>
<li>对应 <strong>低信息密度 &#x2F; 背景区域</strong></li>
</ul>
</li>
<li><p><strong>CMSS 较小</strong>（接近0）：</p>
<ul>
<li>跨模态差异更明显</li>
<li>方差更大（特征变化丰富）</li>
<li>对应 <strong>高信息密度 &#x2F; 目标区域</strong></li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-2-3-CMSS-的数据统计特性"><a href="#3-2-3-CMSS-的数据统计特性" class="headerlink" title="3.2.3 CMSS 的数据统计特性"></a>3.2.3 CMSS 的数据统计特性</h3><p>论文在 11 个 RGBT 数据集上统计了 CMSS 分布，发现：</p>
<ul>
<li>CMSS 呈现明显的 <strong>多峰分布</strong>，对应不同类型区域（目标 &#x2F; 背景）</li>
<li>不同数据集的 CMSS 分布存在显著差异，反映场景复杂度与成像条件差异</li>
<li>少量样本中，热红外在目标区域占主导，CMSS 值相对较低</li>
</ul>
<p>这一观察为后续采用概率建模而非固定规则的掩码策略提供了依据。在此基础上，论文引入高斯混合模型（GMM）对CMSS分布进行参数化建模，而非采用简单的阈值或固定比例。</p>
<hr>
<h2 id="3-3-GMM-CMSS-渐进式掩码"><a href="#3-3-GMM-CMSS-渐进式掩码" class="headerlink" title="3.3 GMM-CMSS 渐进式掩码"></a>3.3 GMM-CMSS 渐进式掩码</h2><h3 id="3-3-1-设计原则"><a href="#3-3-1-设计原则" class="headerlink" title="3.3.1 设计原则"></a>3.3.1 设计原则</h3><p>掩码策略需要同时满足三点：</p>
<ol>
<li><p><strong>模态平衡</strong><br>信息密度高的区域 &#x2F; 模态应更容易被掩码，防止模型产生偏置。</p>
</li>
<li><p><strong>由易到难</strong><br>训练初期关注高信息区域，后期逐渐覆盖低信息区域。</p>
</li>
<li><p><strong>目标中心</strong><br>优先保留语义丰富的目标区域，避免模型过多重建无意义背景。</p>
</li>
</ol>
<hr>
<h3 id="3-3-2-CMSS-的高斯混合建模（GMM）"><a href="#3-3-2-CMSS-的高斯混合建模（GMM）" class="headerlink" title="3.3.2 CMSS 的高斯混合建模（GMM）"></a>3.3.2 CMSS 的高斯混合建模（GMM）</h3><p><img data-src="/./../images/image-20251214121726437.png" alt="image-20251214121726437"></p>
<p>为了对 <strong>全数据集的 CMSS 分布</strong> 进行建模，论文采用 <strong>Gaussian Mixture Model (GMM)</strong> 对 CMSS 进行统计拟合：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>π</mi><mi>k</mi></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>m</mi><mo>∣</mo><msub><mi>μ</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
p(m) = \sum_{k=1}^{K} \pi_k \mathcal{N}(m \mid \mu_k, \Sigma_k)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1304em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>

<p>其中：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 表示 CMSS 值；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">K=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> 表示三种典型信息密度模式；</li>
<li>GMM 参数通过迭代式 EM 算法在训练过程中动态更新。</li>
</ul>
<p><strong>GMM的EM算法实现（源自 <a href="M-SpecGene/pretrain/mmpretrain-main_rgbt/mmpretrain/models/selfsup/GMM_CMSS_SAMPLE.py">GMM_CMSS_SAMPLE.py</a>）</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">e_step</span>(<span class="params">self, X</span>):  <span class="comment"># X: shape = (N,), 所有 patch 的 CMSS 值</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    E-step（期望步）：</span></span><br><span class="line"><span class="string">    在当前 GMM 参数（均值、方差、权重）下，</span></span><br><span class="line"><span class="string">    计算每个 CMSS 样本属于每个高斯分量的后验概率（责任度）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># resp: 责任度矩阵，shape = (N, K)</span></span><br><span class="line">    <span class="comment"># resp[n, k] 表示第 n 个 CMSS 值来自第 k 个高斯分量的概率</span></span><br><span class="line">    <span class="variable language_">self</span>.resp = np.zeros((X.shape[<span class="number">0</span>], <span class="variable language_">self</span>.n_components))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 遍历每个高斯分量 k</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.n_components):</span><br><span class="line">        <span class="comment"># 权重 × 高斯概率密度</span></span><br><span class="line">        <span class="comment"># 表示：在第 k 个高斯下生成 X 的“未归一化概率”</span></span><br><span class="line">        <span class="variable language_">self</span>.resp[:, k] = (</span><br><span class="line">            <span class="variable language_">self</span>.GMM_weights[k] *</span><br><span class="line">            <span class="variable language_">self</span>.gaussian(X, <span class="variable language_">self</span>.GMM_means[k], <span class="variable language_">self</span>.GMM_covariances[k])</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对每个样本，在 K 个高斯分量上做归一化</span></span><br><span class="line">    <span class="comment"># 保证：∑_k resp[n, k] = 1</span></span><br><span class="line">    <span class="variable language_">self</span>.resp = <span class="variable language_">self</span>.resp / <span class="variable language_">self</span>.resp.<span class="built_in">sum</span>(axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">m_step</span>(<span class="params">self, X</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    M-step（最大化步）：</span></span><br><span class="line"><span class="string">    固定 E-step 得到的责任度，</span></span><br><span class="line"><span class="string">    重新估计每个高斯分量的：</span></span><br><span class="line"><span class="string">    均值、方差、混合权重</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># N_k: 每个高斯分量“有效样本数”</span></span><br><span class="line">    <span class="comment"># 表示：这个高斯大概负责了多少数据</span></span><br><span class="line">    N_k = <span class="variable language_">self</span>.resp.<span class="built_in">sum</span>(axis=<span class="number">0</span>)  <span class="comment"># shape = (K,)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新均值 μ_k</span></span><br><span class="line">    <span class="comment"># 加权平均：责任度越高，贡献越大</span></span><br><span class="line">    <span class="variable language_">self</span>.GMM_means = (<span class="variable language_">self</span>.resp.T @ X) / N_k</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新方差 σ_k^2</span></span><br><span class="line">    <span class="comment"># 同样是加权的平方偏差</span></span><br><span class="line">    <span class="variable language_">self</span>.GMM_covariances = np.array([</span><br><span class="line">        np.<span class="built_in">sum</span>(<span class="variable language_">self</span>.resp[:, k] * (X - <span class="variable language_">self</span>.GMM_means[k])**<span class="number">2</span>) / N_k[k]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.n_components)</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新混合权重 π_k</span></span><br><span class="line">    <span class="comment"># 表示每个高斯在整体中占的比例</span></span><br><span class="line">    <span class="variable language_">self</span>.GMM_weights = N_k / X.shape[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gaussian</span>(<span class="params">self, X, mean, cov</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    一维高斯分布的概率密度函数</span></span><br><span class="line"><span class="string">    X: CMSS 值</span></span><br><span class="line"><span class="string">    mean: 高斯均值 μ</span></span><br><span class="line"><span class="string">    cov: 方差 σ^2</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="number">1</span> / np.sqrt(<span class="number">2</span> * np.pi * cov) *</span><br><span class="line">        np.exp(-<span class="number">0.5</span> * ((X - mean) ** <span class="number">2</span> / cov))</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<p>需要注意，<strong>GMM 并不直接决定掩码位置</strong>，而是对CMSS分布的概率建模，为采样提供依据。</p>
<hr>
<h3 id="3-3-3-基于-GMM-的采样函数与渐进式掩码"><a href="#3-3-3-基于-GMM-的采样函数与渐进式掩码" class="headerlink" title="3.3.3 基于 GMM 的采样函数与渐进式掩码"></a>3.3.3 基于 GMM 的采样函数与渐进式掩码</h3><p>真正控制 <strong>哪些 patch 被 mask</strong> 的，是基于 GMM 构造的 <strong>采样函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></strong>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>π</mi><mi>k</mi></msub><mi mathvariant="script">N</mi><mrow><mo fence="true">(</mo><mi>x</mi><mo>∣</mo><msub><mover accent="true"><mi>μ</mi><mo>^</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mover accent="true"><mi>μ</mi><mo>^</mo></mover><mrow><mi>b</mi><mi>i</mi><mi>a</mi><mi>s</mi></mrow></msub><mo separator="true">,</mo><msub><mover accent="true"><mi mathvariant="normal">Σ</mi><mo>^</mo></mover><mi>k</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
S(x)=\sum_{k=1}^{K} \pi_k \mathcal{N}\left(x \mid \hat{\mu}_k + \hat{\mu}_{bias}, \hat{\Sigma}_k \right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1304em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">μ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">μ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bia</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord">Σ</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span>

<p><strong>采样和掩码生成的核心逻辑</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sample</span>(<span class="params">self, x, x2, loss1, loss2, mask_ratio</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;基于GMM-CMSS策略生成两模态的动态掩码&quot;&quot;&quot;</span></span><br><span class="line">    N, L, D = x.shape</span><br><span class="line">    len_keep = <span class="built_in">int</span>(L * (<span class="number">1</span> - mask_ratio))  <span class="comment"># 保留约25%的patch</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. 计算CMSS：衡量RGB-Thermal的信息密度</span></span><br><span class="line">    msdi_value = <span class="variable language_">self</span>.CMSS_Similarity(x_flat, x2_flat)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. E步：计算CMSS属于各高斯分量的责任度</span></span><br><span class="line">    <span class="variable language_">self</span>.e_step(msdi_value.cpu().numpy())</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. M步：动态更新GMM参数（均值、方差、权重）</span></span><br><span class="line">    <span class="variable language_">self</span>.m_step(msdi_value.cpu().numpy())</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. 针对Thermal模态采样（掩码比例较低以保留目标）</span></span><br><span class="line">    noise = <span class="variable language_">self</span>.generate_GMM_PDF(N, L, x, <span class="variable language_">self</span>.sample_gmm_bias)</span><br><span class="line">    len_keep1 = len_keep - <span class="built_in">int</span>(<span class="variable language_">self</span>.maskratio_bias)</span><br><span class="line">    ids_shuffle, _ = <span class="variable language_">self</span>.cal_ids_shuffle(noise, msdi_value, msdi_value2, x, len_keep1)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. 生成Thermal掩码：0=保留, 1=掩码</span></span><br><span class="line">    mask = torch.ones([N, L], device=x.device)\n    mask[:, :len_keep1] = <span class="number">0</span></span><br><span class="line">    x_masked = torch.gather(x, dim=<span class="number">1</span>, index=ids_keep.unsqueeze(-<span class="number">1</span>).repeat(<span class="number">1</span>,<span class="number">1</span>,D))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 6. 针对RGB模态采样（掩码比例较高以学习补偿）</span></span><br><span class="line">    noise2 = <span class="variable language_">self</span>.generate_GMM_PDF(N, L, x2, -<span class="variable language_">self</span>.sample_gmm_bias)</span><br><span class="line">    len_keep2 = len_keep + <span class="built_in">int</span>(<span class="variable language_">self</span>.maskratio_bias)</span><br><span class="line">    ids_shuffle2 = <span class="variable language_">self</span>.cal_ids_shuffle(noise2, msdi_value2, msdi_value2, x, len_keep2)</span><br><span class="line">    <span class="comment"># ...... RGB掩码生成逻辑类似</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 7. 关键创新：根据损失和训练进度动态调整参数</span></span><br><span class="line">    <span class="keyword">if</span> <span class="variable language_">self</span>.count &gt; <span class="variable language_">self</span>.count_flag:  <span class="comment"># 每个epoch更新一次</span></span><br><span class="line">        delta_loss = loss2 - loss1  <span class="comment"># 两模态的损失差异</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 如果Thermal损失较大，增加它的掩码比例</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.maskratio_bias &lt; threshold:</span><br><span class="line">            <span class="variable language_">self</span>.maskratio_bias += delta_loss * <span class="number">10</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 逐步调整采样的偏移幅度</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.sample_gmm_bias &lt; <span class="variable language_">self</span>.sample_gmm_bias_max:</span><br><span class="line">            <span class="variable language_">self</span>.sample_gmm_bias += delta_loss * <span class="number">0.1</span></span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.epoch += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> x_masked, mask, ids_restore, x_masked2, mask2, ids_restore2</span><br></pre></td></tr></table></figure>

<p><strong>渐进式掩码策略的三个阶段</strong>：</p>
<ul>
<li><p><strong>训练初期</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi><mo>&lt;</mo><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>n</mi><mi>u</mi><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">epoch &lt; epoch\_num/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord">/2</span></span></span></span>)：</p>
<ul>
<li><code>sample_gmm_bias</code> 逐步增加 → 采样逐步向低CMSS偏移</li>
<li>Thermal掩码比例↓，RGB掩码比例↑ → 保留目标，掩码背景</li>
<li>目的：帮助模型快速学到目标相关特征，建立两模态对齐</li>
</ul>
</li>
<li><p><strong>训练中期</strong>：</p>
<ul>
<li><code>sample_gmm_bias</code> 接近最大值 → 采样接近真实CMSS分布</li>
<li>两模态掩码比例趋于平衡 → 类似于标准MAE的随机掩码</li>
<li>目的：避免任何模态过度依赖，均衡学习</li>
</ul>
</li>
<li><p><strong>训练后期</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi><mo>≥</mo><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>n</mi><mi>u</mi><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">epoch \geq epoch\_num/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord">/2</span></span></span></span>)：</p>
<ul>
<li><code>sample_gmm_bias</code> 保持最大值 → 采样向高CMSS区域偏移</li>
<li>Thermal掩码比例↑，RGB掩码比例↓ → 掩码更多目标，保留背景</li>
<li>目的：强化模型对互补信息的利用，学会在信息缺失时从另一模态推理</li>
</ul>
</li>
</ul>
<p>其核心思想为：</p>
<ul>
<li>训练初期：采样集中在 <strong>低 CMSS 区域（高信息密度）</strong> → 保留目标区域，降低重建难度</li>
<li>训练中期：采样逐渐逼近真实 CMSS 分布 → 类似随机掩码</li>
<li>训练后期：采样向 <strong>高 CMSS 区域（低信息密度）</strong> 偏移 → 强化模型对背景和模态互补的理解</li>
</ul>
<p>通过逐步调整 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>μ</mi><mo>^</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\hat{\mu}_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">μ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>μ</mi><mo>^</mo></mover><mrow><mi>b</mi><mi>i</mi><mi>a</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{\mu}_{bias}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">μ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bia</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，实现 <strong>由易到难的渐进式自监督学习</strong>。</p>
<p><strong>核心创新点</strong>：不是固定的掩码比例（如MAE的0.75），而是基于CMSS和损失的<strong>自适应、动态、课程式</strong>掩码策略。</p>
<h2 id="3-4-Siamese-编码与跨模态重建"><a href="#3-4-Siamese-编码与跨模态重建" class="headerlink" title="3.4 Siamese 编码与跨模态重建"></a>3.4 Siamese 编码与跨模态重建</h2><h3 id="3-4-1-Siamese-编码器设计与双模态前向传播"><a href="#3-4-1-Siamese-编码器设计与双模态前向传播" class="headerlink" title="3.4.1 Siamese 编码器设计与双模态前向传播"></a>3.4.1 Siamese 编码器设计与双模态前向传播</h3><p>RGB 与热红外 token 经过共享权重的 ViT 编码器，强制两模态映射到统一潜在空间，避免引入额外的手工融合模块，有助于学习模态不变表示。</p>
<p><strong>双模态前向传播的实现</strong>（源自 <a href="M-SpecGene/pretrain/mmpretrain-main_rgbt/mmpretrain/models/selfsup/mae.py">mae.py</a>）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x, x2, loss1, loss2, mask=<span class="literal">True</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;双模态MAE的前向传播过程</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        x: RGB输入, shape (B, 3, 224, 224)</span></span><br><span class="line"><span class="string">        x2: Thermal输入, shape (B, 3, 224, 224)  # 单通道重复为3通道</span></span><br><span class="line"><span class="string">        loss1, loss2: 前一步的损失（用于动态掩码调整）</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        编码器输出和掩码信息（传递给解码器）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    B = x.shape[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. Patch Embedding：将图像分割为patch并线性投影</span></span><br><span class="line">    <span class="comment"># RGB：(B, 3, 224, 224) -&gt; (B, 196, 768) [16x16 patch, 196 patches]</span></span><br><span class="line">    x = <span class="variable language_">self</span>.patch_embed(x)[<span class="number">0</span>]  </span><br><span class="line">    x = x + <span class="variable language_">self</span>.pos_embed[:, <span class="number">1</span>:, :]  <span class="comment"># 加位置编码（不包含CLS token）</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Thermal：同样处理</span></span><br><span class="line">    x2 = <span class="variable language_">self</span>.patch_embed(x2)[<span class="number">0</span>]</span><br><span class="line">    x2 = x2 + <span class="variable language_">self</span>.pos_embed[:, <span class="number">1</span>:, :]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 创新：GMM-CMSS动态掩码策略</span></span><br><span class="line">    <span class="comment"># 不是简单的随机掩码，而是基于跨模态结构稀疏性和损失的自适应掩码</span></span><br><span class="line">    x, mask, ids_restore, x2, mask2, ids_restore2 = <span class="variable language_">self</span>.random_masking(</span><br><span class="line">        x, x2, loss1, loss2, <span class="variable language_">self</span>.mask_ratio</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># 输出：</span></span><br><span class="line">    <span class="comment"># - x: 被掩码后的RGB tokens (B, 49, 768) # 25%的patch</span></span><br><span class="line">    <span class="comment"># - mask: 掩码指示 (B, 196) # 0=keep, 1=mask</span></span><br><span class="line">    <span class="comment"># - ids_restore: 用于恢复原始顺序</span></span><br><span class="line">    <span class="comment"># - x2, mask2, ids_restore2: Thermal对应的输出</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 添加CLS token并进行Transformer编码</span></span><br><span class="line">    <span class="comment"># CLS token初始为学习参数，添加位置编码</span></span><br><span class="line">    cls_token = <span class="variable language_">self</span>.cls_token + <span class="variable language_">self</span>.pos_embed[:, :<span class="number">1</span>, :]</span><br><span class="line">    cls_tokens = cls_token.expand(B, -<span class="number">1</span>, -<span class="number">1</span>)  <span class="comment"># (B, 1, 768)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># RGB分支：[CLS] + 可见的RGB tokens</span></span><br><span class="line">    x = torch.cat((cls_tokens, x), dim=<span class="number">1</span>)  <span class="comment"># (B, 50, 768)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Transformer编码：12层自注意力</span></span><br><span class="line">    <span class="keyword">for</span> _, layer <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="variable language_">self</span>.layers):</span><br><span class="line">        x = layer(x)  <span class="comment"># 自注意力在所有层间进行跨patch建模</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 最后一层归一化</span></span><br><span class="line">    x = <span class="variable language_">self</span>.norm1(x)  <span class="comment"># (B, 50, 768)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Thermal分支：[CLS] + 可见的Thermal tokens</span></span><br><span class="line">    <span class="comment"># 关键：RGB和Thermal共享同一个编码器权重</span></span><br><span class="line">    <span class="comment"># 这强制两模态学到对齐的表示</span></span><br><span class="line">    x2 = torch.cat((cls_tokens, x2), dim=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> _, layer <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="variable language_">self</span>.layers):</span><br><span class="line">        x2 = layer(x2)  <span class="comment"># 使用同样的Transformer层</span></span><br><span class="line">    x2 = <span class="variable language_">self</span>.norm1(x2)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> x, mask, ids_restore, x2, mask2, ids_restore2</span><br></pre></td></tr></table></figure>

<p><strong>关键设计点</strong>：</p>
<ol>
<li><p><strong>共享权重的编码器</strong>：RGB和Thermal使用完全相同的Transformer参数</p>
<ul>
<li>优点：强制跨模态对齐，减少参数数量</li>
<li>避免模态特定的手工融合模块</li>
</ul>
</li>
<li><p><strong>分离的掩码策略</strong>：RGB和Thermal有不同的掩码比例</p>
<ul>
<li>RGB：掩码比例较高（如0.8），强制学习互补信息</li>
<li>Thermal：掩码比例较低（如0.7），保留更多目标信息</li>
</ul>
</li>
</ol>
<hr>
<h3 id="3-4-2-跨模态解码与重建"><a href="#3-4-2-跨模态解码与重建" class="headerlink" title="3.4.2 跨模态解码与重建"></a>3.4.2 跨模态解码与重建</h3><p>在解码阶段，模型采用：</p>
<ul>
<li><strong>两个模态特定解码器</strong>（RGB &#x2F; Thermal）  </li>
<li>解码过程中引入 <strong>跨模态注意力（cross-attention）</strong></li>
</ul>
<p>其作用并非强制特征融合，而是在重建被掩码区域时，允许模型利用另一模态的互补信息。</p>
<p>这种设计既保留了 Siamese 编码的对称性，又避免在编码阶段引入新的模态偏置。</p>
<p><strong>双模态损失计算</strong>（源自 MAE类的 <code>loss()</code> 方法）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">loss</span>(<span class="params">self, inputs, data_samples, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算RGB和Thermal的重建损失&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 分离输入：(B, 6, 224, 224) -&gt; (B, 3, 224, 224) x 2</span></span><br><span class="line">    input_rgb = inputs[:, <span class="number">0</span>:<span class="number">3</span>, :, :]</span><br><span class="line">    input_ir = inputs[:, <span class="number">3</span>:<span class="number">6</span>, :, :]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 前向传播获得编码器输出和掩码</span></span><br><span class="line">    latent, mask, ids_restore, latent2, mask2, ids_restore2 = <span class="variable language_">self</span>.backbone(</span><br><span class="line">        input_rgb, input_ir, <span class="variable language_">self</span>.loss1, <span class="variable language_">self</span>.loss2</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解码并重建RGB和Thermal</span></span><br><span class="line">    pred, pred2 = <span class="variable language_">self</span>.neck(latent, ids_restore, latent2, ids_restore2)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># **关键**：只计算被掩码区域的重建损失</span></span><br><span class="line">    <span class="comment"># 这强制模型学会从可见tokens推理被掩码的像素</span></span><br><span class="line">    loss_rgb = <span class="variable language_">self</span>.head.loss(pred, input_rgb, mask)    <span class="comment"># RGB重建损失</span></span><br><span class="line">    loss_ir = <span class="variable language_">self</span>.head.loss(pred2, input_ir, mask2)    <span class="comment"># Thermal重建损失</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 存储损失用于下一步掩码调整</span></span><br><span class="line">    <span class="variable language_">self</span>.loss1 = loss_rgb</span><br><span class="line">    <span class="variable language_">self</span>.loss2 = loss_ir</span><br><span class="line">    </span><br><span class="line">    losses = <span class="built_in">dict</span>(loss=loss_rgb, loss2=loss_ir)</span><br><span class="line">    <span class="keyword">return</span> losses</span><br></pre></td></tr></table></figure>

<p><strong>损失函数设计的妙处</strong>：</p>
<ol>
<li><strong>只掩码区域的损失</strong>：不计算保留token的重建误差，避免浪费计算</li>
<li><strong>独立的模态损失</strong>：RGB和Thermal的重建目标独立，避免交叉干扰</li>
<li><strong>损失差异驱动适应</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>L</mi><mi>o</mi><mi>s</mi><msub><mi>s</mi><mrow><mi>T</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>−</mo><mi>L</mi><mi>o</mi><mi>s</mi><msub><mi>s</mi><mrow><mi>R</mi><mi>G</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta Loss = Loss_{Thermal} - Loss_{RGB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">L</span><span class="mord mathnormal">oss</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">os</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">er</span><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">os</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">RGB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 用于下一步动态调整掩码，实现自适应平衡</li>
</ol>
<hr>
<h2 id="3-5-预训练目标函数"><a href="#3-5-预训练目标函数" class="headerlink" title="3.5 预训练目标函数"></a>3.5 预训练目标函数</h2><h3 id="3-5-1-掩码图像建模（MIM）"><a href="#3-5-1-掩码图像建模（MIM）" class="headerlink" title="3.5.1 掩码图像建模（MIM）"></a>3.5.1 掩码图像建模（MIM）</h3><p>采用归一化像素重建作为主要自监督目标，遵循 MAE 的设计：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>M</mi><mi>I</mi><mi>M</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">M</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi mathvariant="script">M</mi></mrow></munder><mi mathvariant="normal">∣</mi><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><msubsup><mi mathvariant="normal">∣</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{MIM}
= \frac{1}{|\mathcal{M}|}
\sum_{i \in \mathcal{M}}
|\hat{x}_i - x_i|_2^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6431em;vertical-align:-1.3217em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathcal">M</span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight">M</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span>

<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">M</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\mathcal{M}|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathcal">M</span><span class="mord">∣</span></span></span></span> 表示掩码区域的 patch 数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\hat{x}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分别为重建和原始图像。这种设计的优点是：</p>
<ul>
<li><strong>简洁有效</strong>：直接优化像素重建，避免中间特征的额外假设</li>
<li><strong>模态不可知</strong>：RGB和Thermal都用相同的损失，避免模态特定设计</li>
<li><strong>只掩码区域优化</strong>：降低计算量，避免浪费在显然正确的可见区域</li>
</ul>
<hr>
<h3 id="3-5-2-跨模态对比约束（辅助损失）"><a href="#3-5-2-跨模态对比约束（辅助损失）" class="headerlink" title="3.5.2 跨模态对比约束（辅助损失）"></a>3.5.2 跨模态对比约束（辅助损失）</h3><p>为增强跨模态语义一致性，论文引入全局表示的对比损失（作为可选项）：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>t</mi></mrow></msub><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mtext>sim</mtext><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>R</mi><mi>G</mi><mi>B</mi></mrow></msub><mo separator="true">,</mo><msub><mi>z</mi><mi>T</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>τ</mi><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mi>j</mi></munder><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mtext>sim</mtext><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>R</mi><mi>G</mi><mi>B</mi></mrow></msub><mo separator="true">,</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>τ</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{contrast}
= -\log
\frac{
\exp(\text{sim}(z_{RGB}, z_T)/\tau)
}{
\sum_j \exp(\text{sim}(z_{RGB}, z_j)/\tau)
}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5488em;vertical-align:-1.1218em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord text"><span class="mord">sim</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">RGB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord text"><span class="mord">sim</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">RGB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1218em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>

<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>R</mi><mi>G</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">z_{RGB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">RGB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">z_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为两模态编码器的全局 CLS token，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> 是温度参数。这个对比损失促进 RGB 和 Thermal 在特征空间中更加接近。</p>
<hr>
<h3 id="3-5-3-总体损失函数"><a href="#3-5-3-总体损失函数" class="headerlink" title="3.5.3 总体损失函数"></a>3.5.3 总体损失函数</h3><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mo>=</mo><msub><mi mathvariant="script">L</mi><mrow><mi>M</mi><mi>I</mi><mi>M</mi></mrow></msub><mo>+</mo><mi>λ</mi><msub><mi mathvariant="script">L</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\mathcal{L}
= \mathcal{L}_{MIM}
+ \lambda \mathcal{L}_{contrast}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">λ</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>

<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.1</span></span></span></span>，控制对比损失的权重。消融实验表明，对比损失对于密集预测任务（分割）和序列任务（跟踪）尤为重要。</p>
<p><strong>预训练过程的完整流程</strong>：</p>
<ol>
<li><strong>前向传播</strong>：输入RGB和Thermal → 动态掩码 → Transformer编码 → 双解码器重建</li>
<li><strong>损失计算</strong>：分别计算RGB和Thermal的MIM损失，以及全局的对比损失</li>
<li><strong>反向传播</strong>：损失反向传播更新所有参数（除去位置编码）</li>
<li><strong>掩码调整</strong>：根据两模态的损失差异，在下一个epoch调整掩码策略的参数</li>
<li><strong>迭代</strong>：重复上述过程800个epoch</li>
</ol>
<p>这种设计的创新之处在于：<strong>掩码策略不是预先固定，而是根据训练动态自适应调整</strong>。</p>
<hr>
<h2 id="3-6-下游任务中的特征融合策略"><a href="#3-6-下游任务中的特征融合策略" class="headerlink" title="3.6 下游任务中的特征融合策略"></a>3.6 下游任务中的特征融合策略</h2><p>M-SpecGene 在下游任务中采用<strong>双模态独立提取 + 早期融合</strong>的融合策略，避免引入复杂的任务特定融合模块。</p>
<h3 id="3-6-1-交叉注意力"><a href="#3-6-1-交叉注意力" class="headerlink" title="3.6.1 交叉注意力"></a>3.6.1 交叉注意力</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cross_attention3.py 第 184-268 行</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x, k=<span class="literal">None</span>, v=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        x: 查询 (RGB), shape (B, N, embed_dims)</span></span><br><span class="line"><span class="string">        k: 键 (Thermal), shape (B, N_k, embed_dims)  </span></span><br><span class="line"><span class="string">        v: 值 (Thermal), shape (B, N_v, embed_dims)</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        融合特征 shape (B, N, embed_dims)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 步骤1：将RGB投影为查询Q，Thermal投影为键K</span></span><br><span class="line">    q = F.linear(<span class="built_in">input</span>=x, weight=<span class="variable language_">self</span>.q.weight, bias=<span class="literal">None</span>)      <span class="comment"># (B, N, 256)</span></span><br><span class="line">    k = F.linear(<span class="built_in">input</span>=k, weight=<span class="variable language_">self</span>.k.weight, bias=<span class="literal">None</span>)      <span class="comment"># (B, N, 256)</span></span><br><span class="line">    v = v  <span class="comment"># 值直接使用原始Thermal特征</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 步骤2：L2归一化（重点！与标准Transformer不同）</span></span><br><span class="line">    q = torch.nn.functional.normalize(q, dim=-<span class="number">1</span>)</span><br><span class="line">    k = torch.nn.functional.normalize(k, dim=-<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 步骤3：Reshape为多头格式</span></span><br><span class="line">    q = q.reshape(B, N, <span class="number">1</span>, num_heads, -<span class="number">1</span>).permute(...)   <span class="comment"># (B, num_heads, N, dim)</span></span><br><span class="line">    k = k.reshape(B, N_k, <span class="number">1</span>, num_heads, -<span class="number">1</span>).permute(...)  <span class="comment"># (B, num_heads, N_k, dim)</span></span><br><span class="line">    v = v.reshape(B, N_v, <span class="number">1</span>, num_heads, -<span class="number">1</span>).permute(...)  <span class="comment"># (B, num_heads, N_v, dim)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 步骤4：计算注意力权重</span></span><br><span class="line">    q = q * <span class="variable language_">self</span>.scale  <span class="comment"># 缩放因子 = 1/sqrt(dim)</span></span><br><span class="line">    attn = (q @ k.transpose(-<span class="number">2</span>, -<span class="number">1</span>))  <span class="comment"># (B, num_heads, N, N_k)</span></span><br><span class="line">    attn = attn.softmax(dim=-<span class="number">1</span>)        <span class="comment"># 沿着K维度softmax</span></span><br><span class="line">    attn = <span class="variable language_">self</span>.attn_drop(attn)        <span class="comment"># 注意力dropout</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 步骤5：加权求和得到融合特征</span></span><br><span class="line">    x = (attn @ v).transpose(<span class="number">1</span>, <span class="number">2</span>).reshape(B, N, -<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> x  <span class="comment"># 融合的RGB特征</span></span><br></pre></td></tr></table></figure>

<h3 id="3-6-2-融合的核心原理"><a href="#3-6-2-融合的核心原理" class="headerlink" title="3.6.2 融合的核心原理"></a>3.6.2 融合的核心原理</h3><p>预训练阶段学习了对齐的 RGB 和 Thermal 表示，在下游任务推理时：</p>
<ol>
<li><p><strong>RGB 和 Thermal 通过共享主干</strong>（预训练的 ViT-Base）<strong>独立提取特征</strong>  </p>
<ul>
<li>每个模态进行各自的 Patch Embedding 和 Transformer 编码</li>
<li>得到 4 个不同尺度的特征（FPN）：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>256</mn><mo separator="true">,</mo><mn>512</mn><mo separator="true">,</mo><mn>1024</mn><mo separator="true">,</mo><mn>2048</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(C_1, C_2, C_3, C_4) = (256, 512, 1024, 2048)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">256</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">512</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1024</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2048</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li><p><strong>逐级特征相加（Element-wise Addition）</strong><br>最简洁的融合方式是在每个尺度直接相加：</p>
</li>
</ol>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="bold">F</mi><mrow><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><msubsup><mi mathvariant="bold">F</mi><mrow><mi>R</mi><mi>G</mi><mi>B</mi></mrow><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi mathvariant="bold">F</mi><mrow><mi>T</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">
\mathbf{F}_{fused}^{(i)} = \mathbf{F}_{RGB}^{(i)} + \mathbf{F}_{Thermal}^{(i)}, \quad i=1,2,3,4
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4822em;vertical-align:-0.4374em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4374em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3383em;vertical-align:-0.2935em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4065em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">RGB</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">er</span><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span></span></span></span></span>

<p><strong>代码实现</strong>（源自 <a href="M-SpecGene/seg/mmsegmentation-main-rgbt/mmseg/models/segmentors/encoder_decoder_concat.py">encoder_decoder_concat.py</a>）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encode_decode</span>(<span class="params">self, inputs: Tensor, batch_img_metas: <span class="type">List</span>[<span class="built_in">dict</span>]</span>) -&gt; Tensor:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;下游任务推理时的融合前向传播&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># inputs shape: (B, 6, 224, 224) # 前3通道RGB，后3通道Thermal</span></span><br><span class="line">    input_rgb = inputs[:, <span class="number">0</span>:<span class="number">3</span>, :, :]    <span class="comment"># (B, 3, 224, 224)</span></span><br><span class="line">    input_ir = inputs[:, <span class="number">3</span>:<span class="number">6</span>, :, :]     <span class="comment"># (B, 3, 224, 224)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. RGB和Thermal分别通过预训练的ViT骨干提取多尺度特征</span></span><br><span class="line">    <span class="comment"># 返回4个特征图：stage0, stage1, stage2, stage3 (从浅到深)</span></span><br><span class="line">    x_rgb = <span class="variable language_">self</span>.extract_feat(input_rgb)   <span class="comment"># (B, 256, H/4, W/4), ... , (B, 2048, H/32, W/32)</span></span><br><span class="line">    x_ir = <span class="variable language_">self</span>.extract_feat(input_ir)     <span class="comment"># 同样的分辨率和通道数</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 融合：逐级相加</span></span><br><span class="line">    <span class="comment"># 对齐表示</span></span><br><span class="line">    x_stage0 = x_rgb[<span class="number">0</span>] + x_ir[<span class="number">0</span>]   <span class="comment"># (B, 256, H/4, W/4)</span></span><br><span class="line">    x_stage1 = x_rgb[<span class="number">1</span>] + x_ir[<span class="number">1</span>]   <span class="comment"># (B, 512, H/8, W/8)</span></span><br><span class="line">    x_stage2 = x_rgb[<span class="number">2</span>] + x_ir[<span class="number">2</span>]   <span class="comment"># (B, 1024, H/16, W/16)</span></span><br><span class="line">    x_stage3 = x_rgb[<span class="number">3</span>] + x_ir[<span class="number">3</span>]   <span class="comment"># (B, 2048, H/32, W/32)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 融合特征组成特征金字塔，输入到任务特定的解码头</span></span><br><span class="line">    x_fused = (x_stage0, x_stage1, x_stage2, x_stage3)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. UperNet（分割）/ FPN (检测) / 其他解码头处理融合特征</span></span><br><span class="line">    seg_logits = <span class="variable language_">self</span>.decode_head(x_fused)  <span class="comment"># 返回分割图</span></span><br><span class="line">    <span class="keyword">return</span> seg_logits</span><br></pre></td></tr></table></figure>

<h3 id="3-6-3-为什么采用简单相加融合？"><a href="#3-6-3-为什么采用简单相加融合？" class="headerlink" title="3.6.3 为什么采用简单相加融合？"></a>3.6.3 为什么采用简单相加融合？</h3><p><strong>M-SpecGene 采用相加的原因</strong>：</p>
<ol>
<li><strong>预训练已完成对齐</strong>：共享编码器强制两模态学到对齐表示，下游任务无需再次对齐</li>
<li><strong>参数高效</strong>：无需引入新参数，避免下游任务过拟合（尤其在数据有限时）</li>
<li><strong>计算高效</strong>：单个加法操作，推理延迟最小</li>
<li><strong>理论简洁</strong>：直接加法体现了两模态的等价性，符合”通用表示”的设计哲学</li>
</ol>
<p><strong>实验验证</strong>：消融实验表明，相加融合与更复杂的注意力融合性能相当（仅差 0.2-0.5%），但参数减少 15-20%。</p>
<h2 id="3-7-方法的创新总结"><a href="#3-7-方法的创新总结" class="headerlink" title="3.7 方法的创新总结"></a>3.7 方法的创新总结</h2><p>相比标准 MAE，M-SpecGene 在RGBT预训练中的核心创新包括：</p>
<table>
<thead>
<tr>
<th>方面</th>
<th>标准MAE</th>
<th>M-SpecGene</th>
</tr>
</thead>
<tbody><tr>
<td><strong>掩码策略</strong></td>
<td>固定随机掩码（75%）</td>
<td>动态自适应掩码（基于CMSS和损失）</td>
</tr>
<tr>
<td><strong>模态处理</strong></td>
<td>单模态</td>
<td>双模态独立处理，编码器共享</td>
</tr>
<tr>
<td><strong>掩码动态调整</strong></td>
<td>无</td>
<td>根据Thermal&#x2F;RGB损失差异实时调整</td>
</tr>
<tr>
<td><strong>课程学习</strong></td>
<td>无</td>
<td>由易到难的渐进式掩码策略</td>
</tr>
<tr>
<td><strong>信息密度感知</strong></td>
<td>无</td>
<td>CMSS度量定量化模态差异</td>
</tr>
<tr>
<td><strong>模态平衡</strong></td>
<td>无</td>
<td>针对性的掩码比例差异</td>
</tr>
</tbody></table>
<h1 id="4-实验设置"><a href="#4-实验设置" class="headerlink" title="4. 实验设置"></a>4. 实验设置</h1><p>本节详细介绍了 M-SpecGene 的预训练和下游任务的实验配置，旨在充分验证方法的有效性和泛化能力。</p>
<h2 id="4-1-预训练数据与模型配置"><a href="#4-1-预训练数据与模型配置" class="headerlink" title="4.1 预训练数据与模型配置"></a>4.1 预训练数据与模型配置</h2><p><strong>预训练数据集</strong>：从多个 RGBT 数据集中收集图像对，构建大规模预训练数据：</p>
<ul>
<li><strong>数据集来源</strong>：KAIST、FLIR、LLVIP、M3FD、VEDAI 等 11 个公开数据集</li>
<li><strong>总样本量</strong>：约 <strong>150K 图像对</strong>（相比 ImageNet 的 1.2M 仍较小，但通过高效策略充分利用）</li>
<li><strong>分辨率</strong>：统一 resize 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>224</mn><mo>×</mo><mn>224</mn></mrow><annotation encoding="application/x-tex">224 \times 224</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">224</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">224</span></span></span></span></li>
<li><strong>数据增强</strong>：随机裁剪、翻转、颜色抖动（仅RGB，保留Thermal物理特性）</li>
</ul>
<p>虽然数据量有限，但通过 GMM-CMSS 的高效掩码策略，模型能够充分利用这些数据。消融实验表明，即使仅用 25% 的数据（37K样本），M-SpecGene 仍能超越从零开始训练。</p>
<p><strong>模型架构</strong>：</p>
<ul>
<li><strong>主骨干</strong>：Vision Transformer (ViT) Base<ul>
<li>层数：12 层 Transformer 块</li>
<li>隐藏维度：768</li>
<li>注意力头数：12</li>
</ul>
</li>
<li><strong>Patch 大小</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn><mo>×</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">16 \times 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">16</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span>（得到 196 个 patch）</li>
<li><strong>位置编码</strong>：固定 sine-cosine 位置编码（不可学习）</li>
</ul>
<p><strong>优化器配置</strong>：</p>
<ul>
<li><strong>优化器</strong>：AdamW</li>
<li><strong>学习率</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.5</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1.5 \times 10^{-4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span>（cosine schedule，10 epoch warmup）</li>
<li><strong>权重衰减</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.05</mn></mrow><annotation encoding="application/x-tex">0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.05</span></span></span></span></li>
<li><strong>Batch size</strong>：1024（8 卡 V100，分布式训练）</li>
<li><strong>训练 epoch</strong>：800（约 120 小时）</li>
</ul>
<hr>
<h2 id="4-2-下游任务与微调方案"><a href="#4-2-下游任务与微调方案" class="headerlink" title="4.2 下游任务与微调方案"></a>4.2 下游任务与微调方案</h2><p>评估 M-SpecGene 在四类代表性 RGBT 任务上的迁移性能：</p>
<h3 id="4-2-1-RGBT-目标检测"><a href="#4-2-1-RGBT-目标检测" class="headerlink" title="4.2.1 RGBT 目标检测"></a>4.2.1 RGBT 目标检测</h3><ul>
<li><strong>数据集</strong>：KAIST（95K 对）、FLIR（9K 对）、M3FD</li>
<li><strong>评估指标</strong>：Average Precision (AP)、Missing Rate (MR)</li>
<li><strong>微调策略</strong>：<ul>
<li>Faster R-CNN &#x2F; DETR 检测头</li>
<li>冻结位置编码，更新 Transformer 和检测头</li>
<li>50 epoch，学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1 \times 10^{-5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
</ul>
<h3 id="4-2-2-RGBT-语义分割"><a href="#4-2-2-RGBT-语义分割" class="headerlink" title="4.2.2 RGBT 语义分割"></a>4.2.2 RGBT 语义分割</h3><ul>
<li><strong>数据集</strong>：MFNet（城市）、PST900（室内）</li>
<li><strong>评估指标</strong>：mIoU（mean Intersection over Union）</li>
<li><strong>微调策略</strong>：<ul>
<li>UperNet 分割解码头</li>
<li>80 epoch，学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1 \times 10^{-4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span>，warmup 10 epoch</li>
</ul>
</li>
</ul>
<h3 id="4-2-3-RGBT-显著性检测"><a href="#4-2-3-RGBT-显著性检测" class="headerlink" title="4.2.3 RGBT 显著性检测"></a>4.2.3 RGBT 显著性检测</h3><ul>
<li><strong>数据集</strong>：VT821、VT1000、VT5000</li>
<li><strong>评估指标</strong>：F-measure、MAE、S-measure</li>
<li><strong>微调策略</strong>：全卷积解码器，40 epoch，学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">5 \times 10^{-5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h3 id="4-2-4-RGBT-目标跟踪"><a href="#4-2-4-RGBT-目标跟踪" class="headerlink" title="4.2.4 RGBT 目标跟踪"></a>4.2.4 RGBT 目标跟踪</h3><ul>
<li><strong>数据集</strong>：RGBT234（234 个视频）、LasHeR（1,224 个视频）</li>
<li><strong>评估指标</strong>：Success Rate、Precision</li>
<li><strong>微调策略</strong>：Siamese 网络框架，30 epoch，学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1 \times 10^{-5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<hr>
<h2 id="4-3-对比基线"><a href="#4-3-对比基线" class="headerlink" title="4.3 对比基线"></a>4.3 对比基线</h2><p>为了全面验证 M-SpecGene 的贡献，设计了多个消融基线：</p>
<table>
<thead>
<tr>
<th>基线</th>
<th>说明</th>
<th>目的</th>
</tr>
</thead>
<tbody><tr>
<td><strong>从头训练</strong></td>
<td>不使用任何预训练</td>
<td>验证预训练的必要性</td>
</tr>
<tr>
<td><strong>ImageNet 预训练</strong></td>
<td>ViT-B on ImageNet（仅初始化RGB）</td>
<td>对比单模态预训练的局限</td>
</tr>
<tr>
<td><strong>单模态 MAE</strong></td>
<td>分别在RGB和Thermal上独立MAE预训练</td>
<td>验证是否需要双模态预训练</td>
</tr>
<tr>
<td><strong>RGBT 联合 MAE</strong></td>
<td>相同掩码比例的简单RGBT MAE</td>
<td>对比GMM-CMSS的必要性</td>
</tr>
<tr>
<td><strong>任务特定 SOTA</strong></td>
<td>各下游任务的当前最佳方法</td>
<td>验证通用预训练能否超越定制设计</td>
</tr>
</tbody></table>
<hr>
<h1 id="5-实验结果与分析"><a href="#5-实验结果与分析" class="headerlink" title="5. 实验结果与分析"></a>5. 实验结果与分析</h1><h2 id="5-1-下游任务整体性能"><a href="#5-1-下游任务整体性能" class="headerlink" title="5.1 下游任务整体性能"></a>5.1 下游任务整体性能</h2><h3 id="5-1-1-RGBT目标检测"><a href="#5-1-1-RGBT目标检测" class="headerlink" title="5.1.1 RGBT目标检测"></a>5.1.1 RGBT目标检测</h3><p><img data-src="/./../images/image-20251214105659860.png" alt="image-20251214105659860"></p>
<p>在KAIST数据集上：</p>
<ul>
<li>M-SpecGene达到 <strong>mAP 83.7%</strong>，超过任务特定SOTA方法约 <strong>2.1%</strong></li>
<li>在困难子集（Heavy Occlusion、Far）上优势更明显，提升达 <strong>3.5%-4.2%</strong></li>
<li>相比从头训练，提升 <strong>11.3%</strong>，证明预训练的有效性</li>
<li>相比ImageNet预训练，提升 <strong>6.8%</strong>，说明RGBT域内预训练的必要性</li>
</ul>
<p>在FLIR数据集上：</p>
<ul>
<li>三类平均mAP达到 <strong>76.4%</strong>，相比第二名提升 <strong>1.9%</strong></li>
<li>对于小目标（bicycle），提升尤为显著（<strong>+4.3%</strong>）</li>
</ul>
<h3 id="5-1-2-RGBT语义分割"><a href="#5-1-2-RGBT语义分割" class="headerlink" title="5.1.2 RGBT语义分割"></a>5.1.2 RGBT语义分割</h3><p><img data-src="/./../images/image-20251214105714507.png" alt="image-20251214105714507"></p>
<p>在MFNet数据集（城市场景）：</p>
<ul>
<li>M-SpecGene取得 <strong>mIoU 56.8%</strong>，超过RTFNet <strong>+2.5%</strong></li>
<li>在人、车、道路等关键类别上均有明显提升</li>
</ul>
<p>在PST900数据集（室内场景）：</p>
<ul>
<li>mIoU达到 <strong>82.3%</strong>，刷新记录</li>
<li>对于温度差异明显的类别（fire extinguisher、backpack）准确率提升显著</li>
</ul>
<h3 id="5-1-3-RGBT显著性检测"><a href="#5-1-3-RGBT显著性检测" class="headerlink" title="5.1.3 RGBT显著性检测"></a>5.1.3 RGBT显著性检测</h3><p><img data-src="/./../images/image-20251214105737756.png" alt="image-20251214105737756"></p>
<p>三个数据集综合表现：</p>
<table>
<thead>
<tr>
<th>数据集</th>
<th>F-measure</th>
<th>MAE</th>
<th>S-measure</th>
</tr>
</thead>
<tbody><tr>
<td>VT821</td>
<td>0.891</td>
<td>0.032</td>
<td>0.917</td>
</tr>
<tr>
<td>VT1000</td>
<td>0.908</td>
<td>0.028</td>
<td>0.929</td>
</tr>
<tr>
<td>VT5000</td>
<td>0.876</td>
<td>0.041</td>
<td>0.902</td>
</tr>
</tbody></table>
<ul>
<li>在所有指标上均超过CGFNet、APNet等专门方法</li>
<li>MAE显著降低，说明预测更精准</li>
</ul>
<h3 id="5-1-4-RGBT目标跟踪"><a href="#5-1-4-RGBT目标跟踪" class="headerlink" title="5.1.4 RGBT目标跟踪"></a>5.1.4 RGBT目标跟踪</h3><p><img data-src="/./../images/image-20251214105752154.png" alt="image-20251214105752154"></p>
<p>在RGBT234数据集：</p>
<ul>
<li>Success rate达到 <strong>67.2%</strong>，超过CAT <strong>+1.8%</strong></li>
<li>Precision达到 <strong>86.5%</strong></li>
</ul>
<p>在LasHeR数据集（更大规模、更多挑战）：</p>
<ul>
<li>Success rate <strong>62.9%</strong>，Precision <strong>79.3%</strong></li>
<li>在快速运动（FM）、尺度变化（SV）等挑战属性子集上表现优异</li>
</ul>
<h2 id="5-2-消融实验"><a href="#5-2-消融实验" class="headerlink" title="5.2 消融实验"></a>5.2 消融实验</h2><h3 id="5-2-1-CMSS度量的有效性"><a href="#5-2-1-CMSS度量的有效性" class="headerlink" title="5.2.1 CMSS度量的有效性"></a>5.2.1 CMSS度量的有效性</h3><p><img data-src="/./../images/image-20251214105825888.png" alt="image-20251214105825888"></p>
<p>对比四种掩码策略：</p>
<ol>
<li><strong>Random</strong>：随机掩码，RGB和热红外比例相同（0.75）</li>
<li><strong>Fixed</strong>：固定RGB掩码0.75，热红外0.5</li>
<li><strong>CMSS-only</strong>：仅基于CMSS确定掩码比例，无GMM</li>
<li><strong>GMM-CMSS</strong>（本文方法）：完整策略</li>
</ol>
<p>在KAIST检测任务上的结果：</p>
<ul>
<li>Random: mAP 78.2%</li>
<li>Fixed: mAP 80.4%（<strong>+2.2%</strong>）</li>
<li>CMSS-only: mAP 81.9%（<strong>+1.5%</strong>）</li>
<li>GMM-CMSS: mAP 83.7%（<strong>+1.8%</strong>）</li>
</ul>
<p>结论：</p>
<ul>
<li>简单地为两模态设置不同固定比例已有提升，证实了处理信息不平衡的必要性</li>
<li>引入CMSS自适应调整进一步提升性能</li>
<li>GMM建模带来额外增益，使掩码策略更灵活</li>
</ul>
<h3 id="5-2-2-渐进式调度的影响"><a href="#5-2-2-渐进式调度的影响" class="headerlink" title="5.2.2 渐进式调度的影响"></a>5.2.2 渐进式调度的影响</h3><p><img data-src="/./../images/image-20251214105932254.png" alt="image-20251214105932254"></p>
<p>对比三种调度方式：</p>
<ul>
<li><strong>Static</strong>：始终使用最大掩码比例</li>
<li><strong>Linear</strong>：线性增加</li>
<li><strong>Cosine</strong>：余弦调度（先慢后快）</li>
</ul>
<p>收敛速度与最终性能：</p>
<ul>
<li>Static：收敛慢，最终mAP 81.3%</li>
<li>Linear（本文采用）：收敛稳定，mAP 83.7%</li>
<li>Cosine：早期收敛快，但后期提升有限，mAP 82.9%</li>
</ul>
<p>结论：线性渐进调度在稳定性与性能间取得最佳平衡。</p>
<h3 id="5-2-3-对比学习损失的作用"><a href="#5-2-3-对比学习损失的作用" class="headerlink" title="5.2.3 对比学习损失的作用"></a>5.2.3 对比学习损失的作用</h3><p>移除对比损失后：</p>
<ul>
<li>检测mAP下降 <strong>1.4%</strong></li>
<li>分割mIoU下降 <strong>0.9%</strong></li>
<li>跟踪Success rate下降 <strong>0.7%</strong></li>
</ul>
<p>结论：对比损失增强了跨模态语义一致性，对密集预测任务（分割）和匹配任务（跟踪）尤为重要。</p>
<h3 id="5-2-4-预训练数据量的影响"><a href="#5-2-4-预训练数据量的影响" class="headerlink" title="5.2.4 预训练数据量的影响"></a>5.2.4 预训练数据量的影响</h3><p>分别使用25%、50%、75%、100%预训练数据：</p>
<ul>
<li>25%数据（~37K样本）：mAP 80.1%</li>
<li>50%数据：mAP 81.8%</li>
<li>75%数据：mAP 82.9%</li>
<li>100%数据（~150K样本）：mAP 83.7%</li>
</ul>
<p>观察：</p>
<ul>
<li>数据量增加带来稳定提升，但边际收益递减</li>
<li>即使在25%数据下，仍显著优于从头训练（<strong>+6.4%</strong>）</li>
<li>说明GMM-CMSS策略具有较高的数据利用效率</li>
</ul>
<h2 id="5-3-可视化分析"><a href="#5-3-可视化分析" class="headerlink" title="5.3 可视化分析"></a>5.3 可视化分析</h2><h3 id="5-3-1-学习到的表示可视化"><a href="#5-3-1-学习到的表示可视化" class="headerlink" title="5.3.1 学习到的表示可视化"></a>5.3.1 学习到的表示可视化</h3><p>使用t-SNE可视化在KAIST验证集上提取的特征：</p>
<ul>
<li><strong>从头训练</strong>：类内分散，类间重叠严重</li>
<li><strong>ImageNet预训练</strong>：RGB分支特征较好，但热红外分支混乱</li>
<li><strong>单模态MAE</strong>：两模态特征分布不一致</li>
<li><strong>M-SpecGene</strong>：类内紧凑，类间分离清晰，两模态对齐良好</li>
</ul>
<p>结论：M-SpecGene学习到了更具判别性和模态一致性的表示。</p>
<h3 id="5-3-2-注意力图分析"><a href="#5-3-2-注意力图分析" class="headerlink" title="5.3.2 注意力图分析"></a>5.3.2 注意力图分析</h3><p>可视化最后一层Transformer的注意力权重：</p>
<ul>
<li><strong>单模态MAE</strong>：注意力分散，背景干扰多</li>
<li><strong>RGBT联合MAE</strong>：有一定目标关注，但两模态注意力不一致</li>
<li><strong>M-SpecGene</strong>：强烈聚焦于目标区域，背景被有效抑制，两模态注意力高度一致</li>
</ul>
<p>结论：目标感知掩码策略引导模型学习以对象为中心的表示。</p>
<h3 id="5-3-3-掩码重建质量"><a href="#5-3-3-掩码重建质量" class="headerlink" title="5.3.3 掩码重建质量"></a>5.3.3 掩码重建质量</h3><p>展示几组高难度场景的重建结果：</p>
<ol>
<li><strong>夜间低照度</strong>：RGB几乎全黑，模型成功从热红外推断出目标轮廓并重建RGB结构</li>
<li><strong>强光过曝</strong>：RGB过曝丢失细节，重建时从热红外补充温度信息</li>
<li><strong>遮挡场景</strong>：部分遮挡的目标被完整重建</li>
</ol>
<p>结论：模型学会了跨模态互补，能在一个模态信息缺失时利用另一模态进行推理。</p>
<h2 id="5-4-跨数据集泛化能力"><a href="#5-4-跨数据集泛化能力" class="headerlink" title="5.4 跨数据集泛化能力"></a>5.4 跨数据集泛化能力</h2><p>在KAIST上预训练，迁移到其他数据集（零样本或少样本微调）：</p>
<table>
<thead>
<tr>
<th>目标数据集</th>
<th>零样本mAP</th>
<th>10-shot mAP</th>
<th>全量微调mAP</th>
</tr>
</thead>
<tbody><tr>
<td>FLIR</td>
<td>51.2%</td>
<td>68.7%</td>
<td>76.4%</td>
</tr>
<tr>
<td>M3FD</td>
<td>48.9%</td>
<td>65.3%</td>
<td>73.1%</td>
</tr>
</tbody></table>
<p>对比基线（ImageNet预训练）：</p>
<ul>
<li>零样本：M-SpecGene <strong>+15.3%</strong></li>
<li>10-shot：M-SpecGene <strong>+8.9%</strong></li>
</ul>
<p>结论：M-SpecGene具有强大的跨数据集泛化能力，尤其在数据稀缺（零样本、少样本）场景下优势显著。</p>
<hr>
<h1 id="6-讨论与分析"><a href="#6-讨论与分析" class="headerlink" title="6. 讨论与分析"></a>6. 讨论与分析</h1><h2 id="6-1-为什么CMSS度量有效？"><a href="#6-1-为什么CMSS度量有效？" class="headerlink" title="6.1 为什么CMSS度量有效？"></a>6.1 为什么CMSS度量有效？</h2><p>CMSS的成功源于其<strong>理论简洁性</strong>与<strong>实践有效性</strong>的结合：</p>
<ol>
<li><strong>理论合理性</strong>：信息论角度，信息熵与像素方差存在关联；CMSS通过标准差近似捕获了信息密度差异</li>
<li><strong>计算高效</strong>：无需复杂模型，单次前向计算即可获得</li>
<li><strong>自适应性</strong>：不同场景、不同样本的CMSS值不同，允许样本级自适应掩码</li>
</ol>
<p>然而，CMSS也存在局限：</p>
<ul>
<li>仅考虑低层统计特征，未捕获高层语义信息</li>
<li>对噪声敏感，需预处理去噪</li>
</ul>
<p>未来可探索基于深度特征的信息密度估计方法。</p>
<h2 id="6-2-GMM建模的必要性"><a href="#6-2-GMM建模的必要性" class="headerlink" title="6.2 GMM建模的必要性"></a>6.2 GMM建模的必要性</h2><p>为什么不直接用CMSS线性映射到掩码比例？</p>
<p>GMM带来的优势：</p>
<ol>
<li><strong>非线性映射</strong>：CMSS与最优掩码比例关系可能非线性，GMM通过混合分量捕获复杂映射</li>
<li><strong>鲁棒性</strong>：GMM对异常值不敏感，避免极端CMSS导致不合理掩码</li>
<li><strong>可解释性</strong>：每个高斯分量可对应一类场景（如”RGB主导”、”平衡”、”热红外主导”）</li>
</ol>
<p>消融实验证实，GMM相比简单线性映射提升约1.8%，验证了其必要性。</p>
<h2 id="6-3-与特定任务方法的对比"><a href="#6-3-与特定任务方法的对比" class="headerlink" title="6.3 与特定任务方法的对比"></a>6.3 与特定任务方法的对比</h2><p>M-SpecGene在多数任务上超过特定任务SOTA，但在某些任务上仍有差距（如显著性检测在某些指标上与最优方法持平）。原因分析：</p>
<p><strong>优势来源</strong>：</p>
<ul>
<li><strong>通用表示</strong>：预训练学习的特征具有良好的可迁移性</li>
<li><strong>数据增强</strong>：预训练利用了多个数据集，见过更多样化的场景</li>
<li><strong>正则化效应</strong>：大规模预训练避免下游任务过拟合</li>
</ul>
<p><strong>仍存在差距的原因</strong>：</p>
<ul>
<li>某些任务特定设计（如显著性检测的边界细化模块）在微调时未充分利用</li>
<li>预训练目标（重建）与某些任务目标（如跟踪的时序建模）存在gap</li>
</ul>
<p>未来可探索多任务联合预训练或更任务相关的预训练目标。</p>
<h2 id="6-4-计算效率分析"><a href="#6-4-计算效率分析" class="headerlink" title="6.4 计算效率分析"></a>6.4 计算效率分析</h2><p>预训练开销：</p>
<ul>
<li>800 epoch，8卡V100，约<strong>120小时</strong></li>
<li>相比ImageNet预训练（300 epoch，约80小时）稍长，但考虑到多模态处理，开销可接受</li>
</ul>
<p>下游微调开销：</p>
<ul>
<li>各任务微调时间在2-8小时，与从头训练相当</li>
<li>推理速度：ViT-Base约<strong>35 FPS</strong>（单卡V100），满足实时性要求</li>
</ul>
<p>与特定任务轻量级方法相比，M-SpecGene计算量较大，但通过一次预训练支持多任务，总体效率更高。</p>
<h2 id="6-5-模态偏置的量化分析"><a href="#6-5-模态偏置的量化分析" class="headerlink" title="6.5 模态偏置的量化分析"></a>6.5 模态偏置的量化分析</h2><p>为验证M-SpecGene确实缓解了模态偏置，设计以下实验：</p>
<p><strong>方法</strong>：在测试时分别屏蔽一个模态，观察性能下降程度。若模型对某模态过度依赖，屏蔽该模态后性能将大幅下降。</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>完整双模态</th>
<th>仅RGB</th>
<th>仅热红外</th>
<th>RGB下降</th>
<th>热红外下降</th>
</tr>
</thead>
<tbody><tr>
<td>从头训练</td>
<td>72.4%</td>
<td>68.1%</td>
<td>51.2%</td>
<td>-4.3%</td>
<td><strong>-21.2%</strong></td>
</tr>
<tr>
<td>ImageNet预训练</td>
<td>76.9%</td>
<td>73.5%</td>
<td>54.7%</td>
<td>-3.4%</td>
<td><strong>-22.2%</strong></td>
</tr>
<tr>
<td>RGBT联合MAE</td>
<td>79.8%</td>
<td>75.2%</td>
<td>59.6%</td>
<td>-4.6%</td>
<td><strong>-20.2%</strong></td>
</tr>
<tr>
<td>M-SpecGene</td>
<td>83.7%</td>
<td>77.3%</td>
<td>71.9%</td>
<td>-6.4%</td>
<td><strong>-11.8%</strong></td>
</tr>
</tbody></table>
<p>观察：</p>
<ul>
<li>所有基线方法在屏蔽热红外后性能暴跌20%+，而M-SpecGene仅下降11.8%</li>
<li>M-SpecGene的RGB分支下降幅度反而更大（6.4% vs. 3-4%），说明模型更平衡地利用两模态</li>
<li>单独使用热红外时，M-SpecGene仍能达到71.9%，远超其他方法（51-59%），证明热红外分支被充分训练</li>
</ul>
<p>结论：M-SpecGene成功实现了模态平衡，避免了对RGB的过度依赖。</p>
<hr>
<h1 id="7-局限性与未来工作"><a href="#7-局限性与未来工作" class="headerlink" title="7. 局限性与未来工作"></a>7. 局限性与未来工作</h1><h2 id="7-1-当前局限性"><a href="#7-1-当前局限性" class="headerlink" title="7.1 当前局限性"></a>7.1 当前局限性</h2><ol>
<li><p><strong>预训练数据规模</strong></p>
<p>相比单模态视觉（ImageNet 1.2M），RGBT数据仍较稀缺（~150K）。虽然GMM-CMSS提高了数据效率，但更大规模数据仍可能带来进一步提升。</p>
</li>
<li><p><strong>计算成本</strong></p>
<p>ViT架构的自注意力机制计算复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，在高分辨率图像上开销较大。未来可探索线性复杂度的Transformer变体（如Linformer、Performer）。</p>
</li>
<li><p><strong>CMSS度量的简化假设</strong></p>
<p>当前CMSS基于像素标准差，未考虑语义信息。在某些极端场景（如单色背景 + 低温目标），CMSS可能失效。</p>
</li>
<li><p><strong>预训练-微调gap</strong></p>
<p>某些任务（如目标跟踪）需要时序建模，而预训练仅在静态图像上进行，导致迁移效果受限。</p>
</li>
</ol>
<h2 id="7-2-未来研究方向"><a href="#7-2-未来研究方向" class="headerlink" title="7.2 未来研究方向"></a>7.2 未来研究方向</h2><h3 id="7-2-1-扩展到更多模态"><a href="#7-2-1-扩展到更多模态" class="headerlink" title="7.2.1 扩展到更多模态"></a>7.2.1 扩展到更多模态</h3><p>RGBT仅是多光谱视觉的一个子集，未来可扩展到：</p>
<ul>
<li><strong>RGB-Depth-Thermal</strong>（三模态融合）</li>
<li><strong>多光谱卫星图像</strong>（可见光 + 多个红外波段）</li>
<li><strong>医学影像</strong>（CT + MRI融合）</li>
</ul>
<p>GMM-CMSS框架可推广到多模态场景，为每对模态计算信息密度差异。</p>
<h3 id="7-2-2-视频预训练"><a href="#7-2-2-视频预训练" class="headerlink" title="7.2.2 视频预训练"></a>7.2.2 视频预训练</h3><p>引入时序维度：</p>
<ul>
<li>在RGBT视频数据上进行时空掩码建模</li>
<li>学习运动、遮挡、光照变化等时序模式</li>
<li>提升在目标跟踪、动作识别等视频任务上的性能</li>
</ul>
<h3 id="7-2-3-可学习的信息密度估计"><a href="#7-2-3-可学习的信息密度估计" class="headerlink" title="7.2.3 可学习的信息密度估计"></a>7.2.3 可学习的信息密度估计</h3><p>用神经网络替代手工设计的CMSS：</p>
<ul>
<li>端到端学习信息密度估计器</li>
<li>联合优化掩码策略与重建目标</li>
<li>自适应不同数据分布</li>
</ul>
<h3 id="7-2-4-轻量化与移动端部署"><a href="#7-2-4-轻量化与移动端部署" class="headerlink" title="7.2.4 轻量化与移动端部署"></a>7.2.4 轻量化与移动端部署</h3><p>针对资源受限场景：</p>
<ul>
<li>知识蒸馏：用M-SpecGene教师模型训练轻量学生模型</li>
<li>模型剪枝与量化</li>
<li>神经架构搜索（NAS）自动设计高效架构</li>
</ul>
<h3 id="7-2-5-开放世界泛化"><a href="#7-2-5-开放世界泛化" class="headerlink" title="7.2.5 开放世界泛化"></a>7.2.5 开放世界泛化</h3><p>当前模型在预定义类别上表现优异，但对开放世界（novel categories）的泛化能力有限。未来可探索：</p>
<ul>
<li>零样本RGBT检测（结合视觉-语言模型如CLIP）</li>
<li>Few-shot学习（元学习框架下快速适应新类别）</li>
<li>持续学习（不断吸收新数据而不遗忘旧知识）</li>
</ul>
<hr>
<h1 id="8-结论"><a href="#8-结论" class="headerlink" title="8. 结论"></a>8. 结论</h1><p>本文提出M-SpecGene，首次尝试构建面向RGBT多光谱视觉的通用基础模型。针对RGBT数据的信息不平衡问题，创新性地提出跨模态结构稀疏性（CMSS）度量，并基于此设计GMM-CMSS渐进式掩码策略，实现灵活、平衡、以目标为中心的自监督预训练。</p>
<p>大规模实验证明，M-SpecGene在<strong>11个数据集</strong>和<strong>4类下游任务</strong>（目标检测、语义分割、显著性检测、目标跟踪）上均取得优异性能，超过任务特定设计的SOTA方法。更重要的是，M-SpecGene将此前分散的逐任务研究统一到一个预训练-微调范式下，为多光谱视觉研究提供了新的方向。</p>
<p>从方法论角度，M-SpecGene展示了如何针对物理多模态数据的特性（信息不平衡）设计自监督学习策略，这一思路可推广到其他多模态场景。从实践角度，M-SpecGene降低了RGBT应用的开发门槛——无需从头设计复杂融合架构，仅需在预训练模型上微调即可获得强大性能。</p>
<p>随着RGBT数据的持续积累和计算资源的提升，基础模型范式有望成为多光谱视觉的主流方案。未来工作将聚焦于扩展模态类型、引入时序建模、提升开放世界泛化能力，推动多光谱视觉向更通用、更鲁棒的方向发展。</p>
]]></content>
      <categories>
        <category>论文阅读</category>
      </categories>
      <tags>
        <tag>多光谱目标检测</tag>
        <tag>MAE</tag>
        <tag>共享参数</tag>
        <tag>跨参数交互</tag>
      </tags>
  </entry>
  <entry>
    <title>【论文阅读 | 2024 ICM | Problem F | 2409949 】</title>
    <url>/2025/10/31/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%202024%20ICM%20%20Problem%20F%20%202409949%E3%80%91/</url>
    <content><![CDATA[<p>[TOC]</p>
<p><img data-src="/./../images/image-20251031230636626.png" alt="image-20251031230636626"></p>
<p>题目：Roaring Silence: Can We Break the Chains of Illegal Wildlife Trade?</p>
<p>来源：2024 ICM Problem F</p>
<p>论文链接：<a href="https://www.comap.org/membership/member-resources/item/reducing-illegal-wildlife-trade">Link</a></p>
<p>年份：2024</p>
<hr>
<h1 id="Reducing-Illegal-Wildlife-Trade"><a href="#Reducing-Illegal-Wildlife-Trade" class="headerlink" title="Reducing Illegal Wildlife Trade"></a>Reducing Illegal Wildlife Trade</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>非法野生动物贸易对环境造成负面影响，并威胁全球生物多样性。据估计，该行业年交易额高达265亿美元，被视为全球第四大非法贸易。你需制定一项基于数据的五年计划，旨在显著减少非法野生动物贸易。你的目标是说服客户实施该项目。为此，你必须同时<strong>选择客户</strong>及<strong>适合该客户的项目方案</strong>。</p>
<h2 id="题目核心要求"><a href="#题目核心要求" class="headerlink" title="题目核心要求"></a>题目核心要求</h2><p>需开发一个由数据驱动的 5 年项目以显著减少非法野生动物贸易，选定合适客户并说服其执行该项目，同时要明确客户能力、项目适用性、额外资源需求、项目影响、目标达成概率及敏感性分析，最终提交含摘要、目录、完整解决方案、给客户的一页备忘录等内容的 PDF 报告。</p>
<hr>
<h2 id="选择并说服最合适的客户"><a href="#选择并说服最合适的客户" class="headerlink" title="选择并说服最合适的客户"></a>选择并说服最合适的客户</h2><h3 id="谁可以开展此项目"><a href="#谁可以开展此项目" class="headerlink" title="谁可以开展此项目"></a>谁可以开展此项目</h3><p>我们认为，一个有效的非法小型武器管控项目应当具备针对性和跨区域性。我们首先考虑客户的类型：各国政府、国际组织和企业家。由于其国家体系，各国政府在一般项目和国内项目中无疑具备更强的能力。然而，对于某一政府提出的具有针对性的跨区域项目而言，它可能面临专业知识匮乏和国际合作壁垒的问题。专业企业家和国际组织往往拥有更多专家，也有更多精力专注于一个特定项目，但在跨区域项目方面，国际组织具有天然优势。因此，我们最终将客户群缩小到以下7个最相关的专业国际组织：</p>
<h4 id="思路分析"><a href="#思路分析" class="headerlink" title="思路分析"></a>思路分析</h4><p>这段文字采用了<strong>目标导向</strong>和<strong>排除法&#x2F;聚焦法</strong>相结合的分析思路来确定项目的最合适开展方（即客户群）。</p>
<ol>
<li><p><strong>明确项目目标与特征（定性）</strong></p>
<ul>
<li><strong>项目性质&#x2F;目标：</strong> 非法小型武器管控。</li>
<li><strong>有效项目特征：</strong> 针对性、跨区域性。</li>
</ul>
</li>
<li><p><strong>确定潜在客户群（初步筛选）</strong></p>
<ul>
<li>将客户类型分为三大类：<strong>各国政府</strong>、<strong>国际组织</strong>、<strong>企业家</strong></li>
</ul>
</li>
<li><p><strong>分析各类客户的优劣势（评估）</strong></p>
<ul>
<li><strong>各国政府：</strong><ul>
<li><strong>优势：</strong> 在一般项目和国内项目中有很强的能力（因其国家体系）。</li>
<li><strong>劣势：</strong> 对于“针对性的跨区域项目”，可能面临<strong>专业知识匮乏</strong>和<strong>国际合作壁垒</strong>。</li>
</ul>
</li>
<li><strong>专业企业家：</strong><ul>
<li><strong>优势：</strong> 拥有更多专家，能更专注于特定项目。</li>
<li><strong>劣势：</strong> （未直接说明，但与国际组织相比在跨区域合作上可能存在不足）。</li>
</ul>
</li>
<li><strong>国际组织：</strong><ul>
<li><strong>优势：</strong> 拥有更多专家，能更专注于特定项目，且在<strong>跨区域项目方面具有天然优势</strong>。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>聚焦并确定最合适的客户群（结论）</strong></p>
<ul>
<li>根据项目必须具备的“<strong>针对性</strong>”和“<strong>跨区域性</strong>”特征，将各国政府排除（或定位为较弱的选择，因为存在劣势）。</li>
<li>在<strong>企业家</strong>和<strong>国际组织</strong>中，由于项目需要“<strong>跨区域性</strong>”，<strong>国际组织</strong>的“天然优势”使其成为最优选择。</li>
<li><strong>最终结论：</strong> 客户群被缩小到最相关的<strong>7个专业国际组织</strong>。</li>
</ul>
</li>
</ol>
<h3 id="优劣指标讨论"><a href="#优劣指标讨论" class="headerlink" title="优劣指标讨论"></a>优劣指标讨论</h3><p>既然我们已经确定了客户群体，就需要衡量不同IO的能力和适配程度，以评估出最合适且最符合实际的客户。</p>
<p>为了构建一个IOs能力与适应性评估系统，我们需要选取具有代表性的指标。结合以往的研究，我们得出结论，可以通过衡量组织影响力、沟通影响力和特殊影响力这三大因素来进行分析。三级指标在表3中已明确列出。</p>
<h4 id="优劣指标讨论的写作思路深度解析"><a href="#优劣指标讨论的写作思路深度解析" class="headerlink" title="优劣指标讨论的写作思路深度解析"></a>优劣指标讨论的写作思路深度解析</h4><p>这一小节在整个问题解决流程中扮演了<strong>承上启下</strong>的关键角色，是连接定性分析（选择客户）和定量建模（熵权法）的<strong>桥梁</strong>。</p>
<h5 id="一、作者的写作目标与逻辑定位"><a href="#一、作者的写作目标与逻辑定位" class="headerlink" title="一、作者的写作目标与逻辑定位"></a>一、作者的写作目标与逻辑定位</h5><table>
<thead>
<tr>
<th align="left">目标</th>
<th align="left">逻辑功能</th>
<th align="left">ICM思维模式</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>确立评估体系的科学性</strong></td>
<td align="left">为模型的计算提供<strong>合法的、可量化</strong>的数据输入（Inputs）。</td>
<td align="left"><strong>从抽象到具象</strong>：将“能力”、“适应性”等主观概念转化为可测量的指标。</td>
</tr>
<tr>
<td align="left"><strong>明确指标的方向性</strong></td>
<td align="left">区分“优越指标”（Superior）和“劣势指标”（Inferior），确定数据处理方式。</td>
<td align="left"><strong>数据预处理</strong>：确保所有指标都朝着<strong>同一方向</strong>（即数值越大，客户越好）贡献价值。</td>
</tr>
<tr>
<td align="left"><strong>对接下一小节的模型</strong></td>
<td align="left">明确指出将使用**熵权法（EWM）**来确定权重，而本节的指标体系就是EWM的输入矩阵。</td>
<td align="left"><strong>模型互锁</strong>：建立清晰的逻辑链条：<strong>指标（本节） → 权重计算（4.3） → 客户排名（4.4）</strong>。</td>
</tr>
</tbody></table>
<hr>
<h5 id="二、核心策略：指标的“优劣”划分（Benefit-vs-Cost-Attributes）"><a href="#二、核心策略：指标的“优劣”划分（Benefit-vs-Cost-Attributes）" class="headerlink" title="二、核心策略：指标的“优劣”划分（Benefit vs. Cost Attributes）"></a>二、核心策略：指标的“优劣”划分（Benefit vs. Cost Attributes）</h5><p>在数学建模中，指标的“优劣”讨论，实际上是对指标属性的界定：</p>
<ol>
<li><p><strong>优越指标（Superior Indicators &#x2F; 效益属性）</strong></p>
<ul>
<li><strong>定义：</strong> 指标数值<strong>越大</strong>，评价结果<strong>越好</strong>。</li>
<li><strong>例子：</strong> “总资产”（TA）、“全球员工数”（GES）、“社交媒体粉丝数”等。</li>
<li><strong>处理方式：</strong> 在模型中通常<strong>不需要</strong>进行反向处理（如归一化或标准化），可以直接用于计算，因为它与客户的“优秀程度”呈正相关。</li>
</ul>
</li>
<li><p><strong>劣势指标（Inferior Indicators &#x2F; 成本属性）</strong></p>
<ul>
<li><strong>定义：</strong> 指标数值<strong>越小</strong>，评价结果<strong>越好</strong>。</li>
<li><strong>作者策略：</strong> <strong>巧妙地避开了劣势指标的设定。</strong></li>
<li><strong>分析：</strong> 在您提供的三层指标体系中，作者选择的所有 15 个三级指标（例如：总资产、总收入、项目数量、粉丝数）都属于<strong>效益属性</strong>。这意味着作者在设计指标时，<strong>提前规避</strong>了需要反向处理（如**“负债率”、“项目失败率”、“运营成本”<strong>等</strong>成本属性**指标）。</li>
</ul>
</li>
</ol>
<h6 id="ICM-思路精髓：化“劣”为“优”"><a href="#ICM-思路精髓：化“劣”为“优”" class="headerlink" title="ICM 思路精髓：化“劣”为“优”"></a><strong>ICM 思路精髓：化“劣”为“优”</strong></h6><p>在 ICM 竞赛中，为了简化模型和避免复杂的反向归一化处理（例如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>X</mi></mrow><annotation encoding="application/x-tex">1/X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 或 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>max</mtext><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">\text{max}(X) - X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">max</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>），更高级的策略是<strong>只设计和采纳“优越指标”</strong>。这样，所有的指标都能直接贡献正向价值，使模型结果更清晰、更容易解释。</p>
<hr>
<h5 id="三、结构与内容布局的精妙之处"><a href="#三、结构与内容布局的精妙之处" class="headerlink" title="三、结构与内容布局的精妙之处"></a>三、结构与内容布局的精妙之处</h5><table>
<thead>
<tr>
<th align="left">写作部分</th>
<th align="left">内容阐述</th>
<th align="left">作用与启发</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>一级指标设定</strong></td>
<td align="left">组织影响力（OI）、沟通影响力（CI）、特殊影响力（SI）。</td>
<td align="left"><strong>涵盖性</strong>：确保从<strong>硬件、软件、适配度</strong>三个维度全面考察，无遗漏。</td>
</tr>
<tr>
<td align="left"><strong>二级和三级指标</strong></td>
<td align="left">详细列出15个可获取数据的具体指标。</td>
<td align="left"><strong>落地性</strong>：确保指标<strong>可测量 (Measurable)</strong> 和<strong>可获取 (Available)</strong>，这是模型可运行的前提。</td>
</tr>
<tr>
<td align="left"><strong>指标来源说明</strong></td>
<td align="left">强调数据来自官方网站、年报、社交媒体等。</td>
<td align="left"><strong>可信度</strong>：证明评估数据是基于<strong>客观公开</strong>的信息而非臆测。</td>
</tr>
</tbody></table>
<p><strong>总结：</strong> 4.2 节的成功在于它用一套<strong>有层次、可量化、方向一致</strong>的指标体系，完成了从**“我们要找一个好客户”<strong>到</strong>“我们有科学依据证明 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 是最好的客户”**的完美过渡，是模型说服力的基石。</p>
<h3 id="基于熵权法（EWM）分析次要指标的权重"><a href="#基于熵权法（EWM）分析次要指标的权重" class="headerlink" title="基于熵权法（EWM）分析次要指标的权重"></a>基于熵权法（EWM）分析次要指标的权重</h3><p>在构建指标体系并收集数据后，我们基于熵权法（Entrop Weighted Method, EWM）建立模型，用于计算不同指标的权重。该方法的核心原理是通过不同数据间的变异程度判断其反映的信息量，进而为指标分配相应权重。</p>
<h4 id="步骤1：数据标准化"><a href="#步骤1：数据标准化" class="headerlink" title="步骤1：数据标准化"></a>步骤1：数据标准化</h4><p>本文构建的指标均为效益型指标（即数值越大越好），因此首先得到正定矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>。采用向量标准化方法对数据进行处理，公式如下：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow></msqrt></mfrac></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
y_{i j}=\frac{x_{i j}}{\sqrt{\sum_{i=1}^{n} x_{i j}^{2}}}\tag{1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.8376em;vertical-align:-1.73em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.1807em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1807em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1407em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6593em;"><span></span></span></span></span></span></span></span><span style="top:-3.4107em;"><span class="pstrut" style="height:3.1807em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.8577em;"><span class="pstrut" style="height:3.1807em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.73em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.8376em;vertical-align:-1.73em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{n} x_{i j}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2089em;vertical-align:-0.3948em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span></span></span></span> 表示第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex"> j </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 列所有元素的平方和，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex"> n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 为第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex"> j </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 列的行数（样本数量）。通过该公式可得到标准化矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex"> Y </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>。</p>
<h4 id="步骤2：计算样本中指标的占比"><a href="#步骤2：计算样本中指标的占比" class="headerlink" title="步骤2：计算样本中指标的占比"></a>步骤2：计算样本中指标的占比</h4><p>对于第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个样本中第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex"> j </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个指标，其在该指标所有样本中的占比 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> p_{i j} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 计算公式为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
p_{i j}=\frac{y_{i j}}{\sum_{i=1}^{n} y_{i j}}\tag{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1016em;vertical-align:-0.994em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.1016em;vertical-align:-0.994em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> y_{i j} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 代表第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个样本中第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex"> j </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个指标的标准化值，且满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>m</mi></mrow><annotation encoding="application/x-tex"> 1 ≤ i ≤ m </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex"> m </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 为指标数量）。</p>
<h4 id="步骤3：计算指标的熵值"><a href="#步骤3：计算指标的熵值" class="headerlink" title="步骤3：计算指标的熵值"></a>步骤3：计算指标的熵值</h4><p>第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex"> j </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个指标的熵值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex"> e_{j} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 用于衡量该指标的信息无序程度，计算公式为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>e</mi><mi>j</mi></msub><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>ln</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mspace width="1em"/><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>m</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
e_{j}=-\frac{1}{\ln n} \sum_{i=1}^{n} p_{i j} \ln \left(p_{i j}\right), \quad j=1,2, ..., m\tag{3}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span></span><span class="tag"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span>


<h4 id="步骤4：计算指标的权重"><a href="#步骤4：计算指标的权重" class="headerlink" title="步骤4：计算指标的权重"></a>步骤4：计算指标的权重</h4><p>根据熵值可进一步推导第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex"> j </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个指标的权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex"> W_{j} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，公式如下：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>W</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>e</mi><mi>j</mi></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msub><mi>e</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
W_{j}=\frac{1-e_{j}}{\sum_{j=1}^{m}\left(1-e_{j}\right)}\tag{4}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4516em;vertical-align:-1.1301em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1301em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.4516em;vertical-align:-1.1301em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex"> m </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 为特定层级下的指标总数。</p>
<h4 id="步骤5：计算组织能力与适配性得分"><a href="#步骤5：计算组织能力与适配性得分" class="headerlink" title="步骤5：计算组织能力与适配性得分"></a>步骤5：计算组织能力与适配性得分</h4><p>基于上述权重计算结果，分别构建组织影响力（OI）、沟通影响力（CI）、专项影响力（SI）的计算公式：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>O</mi><mi>I</mi><mo>=</mo><msub><mi>W</mi><mn>1</mn></msub><mo>×</mo><mi>F</mi><mi>C</mi><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub><mo>×</mo><mi>H</mi><mi>R</mi><mo>+</mo><msub><mi>W</mi><mn>3</mn></msub><mo>×</mo><mi>C</mi><mi>A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mi>I</mi><mo>=</mo><msub><mi>W</mi><mn>1</mn></msub><mo>×</mo><mi>W</mi><mi>I</mi><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub><mo>×</mo><mi>S</mi><mi>M</mi><mi>I</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mi>I</mi><mo>=</mo><msub><mi>W</mi><mn>1</mn></msub><mo>×</mo><mi>F</mi><mi>S</mi><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub><mo>×</mo><mi>R</mi><mi>F</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(5)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\left\{\begin{array}{l} 
OI = W_{1} × FC + W_{2} × HR + W_{3} × CA \\ 
CI = W_{1} × WI + W_{2} × SMI \\ 
SI = W_{1} × FS + W_{2} × RF 
\end{array}\right.\tag{5}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.5em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.492em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewBox="0 0 888.89 16" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewBox="0 0 888.89 16" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"/></svg></span></span><span style="top:-4.3em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">FC</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">A</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">SM</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">FS</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RF</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5</span></span><span class="mord">)</span></span></span></span></span></span>
<p>（注：公式中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>C</mi></mrow><annotation encoding="application/x-tex"> FC </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">FC</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>R</mi></mrow><annotation encoding="application/x-tex"> HR </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>A</mi></mrow><annotation encoding="application/x-tex"> CA </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">A</span></span></span></span> 为组织影响力的下级指标；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>I</mi></mrow><annotation encoding="application/x-tex"> WI </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>M</mi><mi>I</mi></mrow><annotation encoding="application/x-tex"> SMI </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">SM</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> 为沟通影响力的下级指标；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>S</mi></mrow><annotation encoding="application/x-tex"> FS </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">FS</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>F</mi></mrow><annotation encoding="application/x-tex"> RF </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RF</span></span></span></span> 为专项影响力的下级指标，各二级指标权重计算方式同上。）</p>
<p>采用 TOPSS 模型将所有得分标准化至 0-1 区间，最终国际组织（IO）的能力与适配性得分（0-100 分制）计算公式为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>S</mi><mi>c</mi><mi>o</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>W</mi><mn>1</mn></msub><mo>×</mo><mi>O</mi><msub><mi>I</mi><mi>i</mi></msub><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub><mo>×</mo><mi>C</mi><msub><mi>I</mi><mi>i</mi></msub><mo>+</mo><msub><mi>W</mi><mn>3</mn></msub><mo>×</mo><mi>S</mi><msub><mi>I</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>×</mo><mn>100</mn></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(6)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
Score _{i}=\left(W_{1} × OI_{i} + W_{2} × CI_{i} + W_{3} × SI_{i}\right) × 100 \tag{6}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">cor</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6</span></span><span class="mord">)</span></span></span></span></span></span>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>c</mi><mi>o</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex"> Score _{i} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">cor</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个国际组织的最终得分，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mn>1</mn></msub><msub><mi>W</mi><mn>2</mn></msub><msub><mi>W</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex"> W_{1} W_{2} W_{3} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分别为组织影响力、沟通影响力、专项影响力的权重。</p>
<h4 id="思路分析-1"><a href="#思路分析-1" class="headerlink" title="思路分析"></a>思路分析</h4><p>这一小节是整篇论文中<strong>数学建模</strong>的核心部分，它将上一节（4.2）建立的指标体系转化为<strong>客观、可量化</strong>的评估标准，为最终选择客户提供坚实的<strong>数据驱动</strong>的依据。</p>
<h5 id="一、核心目的与方法选择"><a href="#一、核心目的与方法选择" class="headerlink" title="一、核心目的与方法选择"></a>一、核心目的与方法选择</h5><h6 id="1-目的：实现客观赋权"><a href="#1-目的：实现客观赋权" class="headerlink" title="1. 目的：实现客观赋权"></a>1. 目的：实现客观赋权</h6><p>本小节的核心目标是确定上一节 15 个三级指标（例如：总资产、粉丝数、反 IWT 项目数量）在客户评估中的相对重要性。</p>
<h6 id="2-思路：为何选择熵权法（EWM）而非-AHP？"><a href="#2-思路：为何选择熵权法（EWM）而非-AHP？" class="headerlink" title="2. 思路：为何选择熵权法（EWM）而非 AHP？"></a>2. 思路：为何选择熵权法（EWM）而非 AHP？</h6><ul>
<li><strong>ICM 策略：</strong> 国际竞赛中，<strong>客观赋权法</strong>（如 EWM）通常优于<strong>主观赋权法</strong>（如 AHP，层次分析法）。</li>
<li><strong>EWM 优势：</strong> 熵权法根据<strong>数据本身的分散程度</strong>来确定权重，避免了作者或评委的主观偏好，使评估结果更具<strong>科学性和说服力</strong>。<ul>
<li><strong>高变异度（差异大） <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\implies</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:0.2778em;"></span></span></span></span> 高权重：</strong> 如果某个指标在所有潜在客户之间差异很大，说明它提供了更多区分信息，应赋予更高权重。</li>
<li><strong>低变异度（差异小） <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\implies</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:0.2778em;"></span></span></span></span> 低权重：</strong> 如果所有客户在该指标上得分相近，说明它对区分客户的贡献小，应赋予更低权重。</li>
</ul>
</li>
</ul>
<hr>
<h5 id="二、熵权法（EWM）的具体执行步骤"><a href="#二、熵权法（EWM）的具体执行步骤" class="headerlink" title="二、熵权法（EWM）的具体执行步骤"></a>二、熵权法（EWM）的具体执行步骤</h5><p>作者通过以下三个核心步骤，完成了从<strong>原始数据</strong>到<strong>最终权重</strong>的转化：</p>
<h6 id="1-数据预处理与归一化（Standardization）"><a href="#1-数据预处理与归一化（Standardization）" class="headerlink" title="1. 数据预处理与归一化（Standardization）"></a>1. 数据预处理与归一化（Standardization）</h6><p>这是 EWM 的第一步，目的是消除不同指标之间的<strong>量纲影响</strong>（例如，“总资产”的单位是亿，而“粉丝数”的单位是万）。</p>
<ul>
<li><strong>处理方式：</strong> 由于上一节（4.2）的分析中，作者采取的策略是<strong>全部选择“优越指标”（效益属性）</strong>，即指标数值越大越好。因此，采用的是<strong>正向归一化公式</strong>，将所有数据映射到 [0, 1] 区间。<ul>
<li><em>启发：</em> 这种设计使计算过程简化，避免了对“劣势指标”（如成本、负债）进行反向处理的复杂性。</li>
</ul>
</li>
</ul>
<h6 id="2-计算信息熵（Entropy）"><a href="#2-计算信息熵（Entropy）" class="headerlink" title="2. 计算信息熵（Entropy）"></a>2. 计算信息熵（Entropy）</h6><p>信息熵是 EWM 的核心概念。在信息论中，<strong>熵值越大，信息的无序度越高，信息量越小。</strong></p>
<ul>
<li><strong>计算逻辑：</strong> 针对每一个指标 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>，计算其在所有客户样本中的信息熵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">E_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>结果判断：</strong> 如果一个指标 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 的数据分布越集中（客户得分都差不多），则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">E_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> <strong>越大</strong>（无序度高，信息量低）。</li>
</ul>
<h6 id="3-计算指标权重（Weight）"><a href="#3-计算指标权重（Weight）" class="headerlink" title="3. 计算指标权重（Weight）"></a>3. 计算指标权重（Weight）</h6><p>权重的确定与信息熵<strong>成反比</strong>。</p>
<ul>
<li><strong>计算逻辑：</strong> 根据每个指标的信息熵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">E_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，计算其权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">W_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>权重 </mtext><msub><mi>W</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>E</mi><mi>j</mi></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mn>15</mn></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>E</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{权重 } W_j = \frac{1 - E_j}{\sum_{j=1}^{15} (1 - E_j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord text"><span class="mord cjk_fallback">权重</span><span class="mord"> </span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6402em;vertical-align:-1.2798em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.156em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">15</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2798em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li>
<li><strong>最终结果：</strong> 这一公式确保了：<ul>
<li><strong>信息熵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">E_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 越小</strong>（即数据差异越大，信息量越高），则<strong>权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">W_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 越大</strong>。</li>
<li>所有指标的权重之和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>W</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\sum W_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 等于 1。</li>
</ul>
</li>
</ul>
<hr>
<h5 id="三、结果分析与策略影响"><a href="#三、结果分析与策略影响" class="headerlink" title="三、结果分析与策略影响"></a>三、结果分析与策略影响</h5><p>论文的附录片段显示了计算结果（如一级指标权重）：</p>
<blockquote>
<p>OI: 29%…</p>
</blockquote>
<p><strong>策略分析：</strong></p>
<ol>
<li><strong>权重分布的意义：</strong> 通过 EWM 计算得到的权重，直接体现了哪些因素在区分“最合适客户”时起到了<strong>关键作用</strong>。如果“特殊影响力”（SI，与项目匹配度相关的指标）获得了最高的权重，则证明了作者的指标设计是成功的，并且模型结果是<strong>聚焦于问题核心</strong>的（即客户的能力<strong>必须与反 IWT 和东南亚区域</strong>高度相关）。</li>
<li><strong>避免主观质疑：</strong> 这一部分是向评委证明：客户的选择<strong>并非“钦定”</strong>，而是基于一套严格的、<strong>数据说了算</strong>的数学方法得出的。</li>
<li><strong>模型衔接：</strong> 最终得到的 15 个三级指标权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">W_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，将作为下一小节（4.4 客户评估）计算<strong>客户综合得分</strong>的唯一系数。</li>
</ol>
<h2 id="选择并说服目标客户"><a href="#选择并说服目标客户" class="headerlink" title="选择并说服目标客户"></a>选择并说服目标客户</h2><h3 id="计算客户评估分数"><a href="#计算客户评估分数" class="headerlink" title="计算客户评估分数"></a>计算客户评估分数</h3><p>按照上述计算过程，我们得到了不同层级指标的权重矩阵。加权结果在图8中得到了清晰展示：</p>
<p><img data-src="/./../images/image-20251101102316023.png" alt="image-20251101102316023"></p>
<p>根据权重，我们计算了池中所有客户的得分，结果如下：国际爱护动物基金会15.81分，世界自然保护联盟26.53分，世界自然基金会（TRAFFIC）55.05分，联合国环境规划署64.35分，国际野生生物保护学会57.47分，野生救援组织11.12分，世界自然基金会（WWF）78.70分。<br>所有0-100分的评分均体现了情报机构执行本项目的执行能力与适配程度。<br>组织能力（OI）与组织意愿（CI）揭示了机构在权限、规模、资源等维度上的执行潜力，<br>而执行意愿（SI）则反映了该机构在东南亚地区开展反非法野生动物贸易项目的兴趣与经验。</p>
<h4 id="思路分析-2"><a href="#思路分析-2" class="headerlink" title="思路分析"></a>思路分析</h4><p>这一小节是<strong>客户选择模型</strong>的<strong>最终步骤</strong>，目标是利用前两节（4.2 指标体系和 4.3 熵权法权重）的成果，对所有潜在客户进行<strong>综合得分计算</strong>并<strong>排名</strong>，从而得出“最合适的客户”。</p>
<h5 id="一、核心建模方法：加权求和模型（Weighted-Sum-Model）"><a href="#一、核心建模方法：加权求和模型（Weighted-Sum-Model）" class="headerlink" title="一、核心建模方法：加权求和模型（Weighted Sum Model）"></a>一、核心建模方法：加权求和模型（Weighted Sum Model）</h5><p>作者采用的是最直接、最具说服力的<strong>线性加权求和模型 (Weighted Sum Model, WSM)</strong>，也称为<strong>综合评价法</strong>。</p>
<h6 id="1-基本思想"><a href="#1-基本思想" class="headerlink" title="1. 基本思想"></a>1. 基本思想</h6><p>客户的最终评估得分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 是其在所有指标上的<strong>归一化得分</strong>与对应<strong>指标权重</strong>的乘积之和。</p>
<h6 id="2-评分公式"><a href="#2-评分公式" class="headerlink" title="2. 评分公式"></a>2. 评分公式</h6><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mn>15</mn></munderover><mo stretchy="false">(</mo><msub><mi>W</mi><mi>j</mi></msub><mo>×</mo><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S_i = \sum_{j=1}^{15} (W_j \times P_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2149em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">15</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>

<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个潜在客户的最终评估得分。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个三级指标（共 15 个）。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">W_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个指标的**权重**。这个权重是上一节 **熵权法（EWM）**计算得出的**客观**数值。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个客户在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 个指标上的**归一化得分**。</li>
</ul>
<hr>
<h5 id="二、关键步骤与数据衔接"><a href="#二、关键步骤与数据衔接" class="headerlink" title="二、关键步骤与数据衔接"></a>二、关键步骤与数据衔接</h5><p>本步骤的成功依赖于对前两节数据的准确引用和处理：</p>
<table>
<thead>
<tr>
<th align="left">步骤</th>
<th align="left">来源&#x2F;操作</th>
<th align="left">作用与策略启发</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>1. 原始数据获取</strong></td>
<td align="left"><strong>来源：</strong> 国际组织（IOs）的官网、年报、社交媒体等。</td>
<td align="left"><strong>基础性：</strong> 确保数据的<strong>客观、真实、可查证</strong>，这是模型说服力的起点。</td>
</tr>
<tr>
<td align="left"><strong>2. 数据归一化（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>）</strong></td>
<td align="left"><strong>操作：</strong> 使用 4.3 节的<strong>正向归一化</strong>公式，将原始数据转化为 [0, 1] 区间的得分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。</td>
<td align="left"><strong>消除量纲：</strong> 消除“总资产”（数亿）和“粉丝数”（数万）等不同指标数值上的差异，使它们可以相加。</td>
</tr>
<tr>
<td align="left"><strong>3. 权重引入（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">W_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>）</strong></td>
<td align="left"><strong>来源：</strong> 4.3 节 <strong>熵权法</strong> 计算出的 15 个指标权重。</td>
<td align="left"><strong>客观性：</strong> 利用数据自身的变异度来决定指标的重要性，<strong>避免主观偏见</strong>。</td>
</tr>
<tr>
<td align="left"><strong>4. 计算最终得分（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）</strong></td>
<td align="left"><strong>操作：</strong> 应用 WSM 公式进行加权求和。</td>
<td align="left"><strong>核心结果：</strong> 得到每个客户的<strong>综合能力与匹配度分数</strong>。</td>
</tr>
</tbody></table>
<hr>
<h5 id="三、最终结果与结论形成"><a href="#三、最终结果与结论形成" class="headerlink" title="三、最终结果与结论形成"></a>三、最终结果与结论形成</h5><p>计算得分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 后，作者的工作进入<strong>结论输出</strong>阶段：</p>
<ol>
<li><p><strong>客户排名（Ranking）：</strong></p>
<ul>
<li>根据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的大小进行<strong>降序排列</strong>。</li>
<li>得分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 最高的客户（例如 <strong>WWF</strong>），即被模型确定为**“最合适的客户”**。</li>
</ul>
</li>
<li><p><strong>结论支持（Justification）：</strong></p>
<ul>
<li>这一得分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是<strong>量化且可追溯</strong>的。作者可以清楚地向评委展示：选择 WWF 不仅因为它的<strong>规模（OI）<strong>和</strong>影响力（CI）</strong>，更重要的是因为它在**“特殊影响力”（SI）<strong>指标上获得了高分和高权重（如果 EWM 结果如此），从而完美匹配了</strong>反 IWT** 和<strong>东南亚地区</strong>的项目要求。</li>
</ul>
</li>
</ol>
<p><strong>总结：</strong> 4.4.1 小节是<strong>建模流程的收官之作</strong>，它将所有定性和定量的工作收敛到一个清晰的<strong>排名结果</strong>，为任务二提供了<strong>无可辩驳的数学证据</strong>。</p>
<h3 id="说服客户"><a href="#说服客户" class="headerlink" title="说服客户"></a>说服客户</h3><p>本项目的理想客户需具备较强的执行能力、丰富的经验，且对东南亚非法野生动物贸易（IWT）治理有明确兴趣。结合前文客户评估得分（WWF 以 78.70 分位列第一），WWF 具备最优的项目执行适配性，因此我们选择 WWF 作为目标客户。</p>
<p>由于本项目聚焦于“东南亚老虎非法贸易治理”，我们从两个核心维度说服 WWF 承接该项目：一是<strong>东南亚地区在全球非法野生动物贸易中的关键地位</strong>，二是<strong>老虎在东南亚非法野生动物贸易中的核心物种属性</strong>。</p>
<h4 id="1-东南亚地区非法野生动物贸易的严重性"><a href="#1-东南亚地区非法野生动物贸易的严重性" class="headerlink" title="1. 东南亚地区非法野生动物贸易的严重性"></a>1. 东南亚地区非法野生动物贸易的严重性</h4><p><img data-src="/./../images/image-20251101102941729.png" alt="image-20251101102941729"></p>
<p>基于联合国贸易数据库（UN Comtrade Data）的分析，我们绘制了“以东南亚为中心的全球非法野生动物贸易流向图”（Figure 9）。该图清晰显示，东南亚是全球非法野生动物贸易的核心供应链节点——作为多种非法野生动物制品的主要供应地，东南亚吸引了大量跨区域非法贸易流量。从具体国家来看，印度尼西亚、马来西亚、泰国、柬埔寨、越南等国的贸易连接密度极高，共同构成了全球非法野生动物贸易的关键活动区域，凸显了该地区治理的紧迫性与必要性。</p>
<h4 id="2-老虎在东南亚非法野生动物贸易中的核心地位"><a href="#2-老虎在东南亚非法野生动物贸易中的核心地位" class="headerlink" title="2. 老虎在东南亚非法野生动物贸易中的核心地位"></a>2. 老虎在东南亚非法野生动物贸易中的核心地位</h4><p>为明确东南亚非法野生动物贸易中的关键物种，我们基于联合国毒品和犯罪问题办公室（UNODC）的东南亚野生动物走私数据，采用<strong>灰色关联分析（Grey Relational Analysis, GRA）</strong> 量化不同物种与区域总走私量的关联程度。考虑到走私数据普遍存在不确定性与不完整性，灰色关联分析可有效处理此类“小样本、贫信息”问题，精准识别核心关联物种。</p>
<h5 id="灰色关联分析实施步骤："><a href="#灰色关联分析实施步骤：" class="headerlink" title="灰色关联分析实施步骤："></a>灰色关联分析实施步骤：</h5><ol>
<li><p><strong>构建序列矩阵</strong><br>以“东南亚各国年度总走私量”为参考序列 ( Y )，以“东南亚各国年度各物种&#x2F;制品走私量”（含老虎、活体爬行动物、欧洲鳗鱼、大象、犀牛角、穿山甲）为比较序列 ( X )。</p>
</li>
<li><p><strong>序列无量纲化处理</strong><br>为消除数据量级差异，对参考序列与比较序列进行无量纲化，公式如下：  </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msubsup><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo>−</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
   x&#x27;_{ki} = \frac{x_{ki} - \min_{k}(x_{ki})}{\max_{k}(x_{ki}) - \min_{k}(x_{ki})}\tag{1}
   </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0489em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span>

<p>其中，( x_{ki} ) 表示第 ( k ) 年第 (i) 类物种&#x2F;制品的走私量，( \min_{k}(x_{ki}) )、( \max_{k}(x_{ki}) ) 分别为第 (i) 类物种&#x2F;制品走私量的年度最小值与最大值。</p>
</li>
<li><p><strong>计算关联系数</strong><br>参考序列 ( Y ) 与比较序列 (X) 中第 (i) 类物种的关联系数 ( \xi_i(k) ) 计算公式为：  </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>ξ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>i</mi></munder><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mi mathvariant="normal">∣</mi><mi>y</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>−</mo><msubsup><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi mathvariant="normal">∣</mi><mo>+</mo><mi>ζ</mi><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>i</mi></munder><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mi mathvariant="normal">∣</mi><mi>y</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>−</mo><msubsup><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi mathvariant="normal">∣</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi>y</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>−</mo><msubsup><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi mathvariant="normal">∣</mi><mo>+</mo><mi>ζ</mi><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>i</mi></munder><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mi mathvariant="normal">∣</mi><mi>y</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>−</mo><msubsup><mi>x</mi><mrow><mi>k</mi><mi>i</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
   \xi_i(k) = \frac{\min_{i}\min_{k}|y(k) - x&#x27;_{ki}| + \zeta \max_{i}\max_{k}|y(k) - x&#x27;_{ki}|}{|y(k) - x&#x27;_{ki}| + \zeta \max_{i}\max_{k}|y(k) - x&#x27;_{ki}|}\tag{2}
   </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4162em;vertical-align:-0.9873em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4289em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7337em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7337em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ki</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9873em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.4162em;vertical-align:-0.9873em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span>

<p>其中，( \zeta ) 为分辨系数（取值范围 0-1，本文取 0.5 以平衡分辨能力），( y(k) ) 为参考序列 ( Y ) 的无量纲化值。</p>
</li>
<li><p><strong>计算关联度</strong><br>第 (i) 类物种的综合关联度 ( r_i ) 为年度关联系数的平均值，公式如下：  </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>ξ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
   r_i = \frac{1}{n} \sum_{k=1}^{n} \xi_i(k)\tag{3}
   </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span>

<p>其中，( n ) 为数据年份数量。</p>
</li>
</ol>
<h5 id="灰色关联分析结果："><a href="#灰色关联分析结果：" class="headerlink" title="灰色关联分析结果："></a>灰色关联分析结果：</h5><p>各物种&#x2F;制品与东南亚总走私量的综合关联度排序为：  </p>
<ul>
<li>老虎（0.83）&gt; 活体爬行动物（0.80）&gt; 欧洲鳗鱼（0.76）&gt; 大象（0.74）&gt; 犀牛角（0.71）&gt; 穿山甲（0.68）</li>
</ul>
<p>该结果表明，<strong>老虎是东南亚非法野生动物贸易中关联度最高的核心物种</strong>，治理老虎非法贸易对区域整体非法野生动物贸易的遏制具有关键杠杆作用。</p>
<h4 id="3-与-WWF-使命的契合性"><a href="#3-与-WWF-使命的契合性" class="headerlink" title="3. 与 WWF 使命的契合性"></a>3. 与 WWF 使命的契合性</h4><p>WWF 的核心使命是“保护自然，减少地球生物多样性面临的最紧迫威胁”（to conserve nature and reduce the most pressing threats to the diversity of life on Earth）。而本项目聚焦于“东南亚老虎非法贸易治理”——既是对全球非法野生动物贸易核心区域的治理，也是对区域内核心物种的保护，与 WWF 使命高度契合。此外，当前 WWF 在东南亚老虎保护领域的投入仍有不足，本项目可填补这一空白，进一步强化 WWF 在全球生物多样性保护领域的影响力。综上，我们认为 WWF 应优先承接本项目。</p>
<h4 id="思路分析-3"><a href="#思路分析-3" class="headerlink" title="思路分析"></a>思路分析</h4><p>这一小节的写作是 ICM&#x2F;MCM 论文中<strong>最具有应用性和说服力</strong>的部分。它要求作者从<strong>数学家&#x2F;分析师</strong>的角色转变为<strong>战略说客&#x2F;咨询师</strong>。目标不再是证明模型正确，而是利用模型和数据<strong>说服</strong>高层决策者（即您选出的客户，如 WWF）采纳并资助您的项目。</p>
<h5 id="一、写作的逻辑定位：从“我”到“你”"><a href="#一、写作的逻辑定位：从“我”到“你”" class="headerlink" title="一、写作的逻辑定位：从“我”到“你”"></a>一、写作的逻辑定位：从“我”到“你”</h5><p>核心思路是：<strong>将前面的所有技术分析转化为客户可感知、可接受的利益与价值。</strong></p>
<table>
<thead>
<tr>
<th align="left">写作目标</th>
<th align="left">核心策略</th>
<th align="left">ICM 启发</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>打消疑虑</strong></td>
<td align="left">强调项目<strong>与客户自身使命</strong>的完美匹配度。</td>
<td align="left"><strong>投其所好</strong>：利用客户的官方文件、历史项目来证明您的项目是其战略的<strong>自然延伸</strong>。</td>
</tr>
<tr>
<td align="left"><strong>证明可行性</strong></td>
<td align="left">强调客户是<strong>唯一</strong>具备执行能力的组织。</td>
<td align="left"><strong>权威背书</strong>：引用 4.4.1 的<strong>量化得分</strong>，证明客户是经过科学筛选的**“最佳选择”**。</td>
</tr>
<tr>
<td align="left"><strong>强调回报</strong></td>
<td align="left">突出项目的<strong>预期效益</strong>（如影响力、品牌价值、新资金来源）。</td>
<td align="left"><strong>ROI 思维</strong>：将项目视为客户的一笔<strong>高效益投资</strong>，而非一笔开销。</td>
</tr>
</tbody></table>
<hr>
<h5 id="二、说服框架：三步递进的说服结构"><a href="#二、说服框架：三步递进的说服结构" class="headerlink" title="二、说服框架：三步递进的说服结构"></a>二、说服框架：三步递进的说服结构</h5><p>成功的说服需要一个清晰的、逻辑严密的框架。作者通常采用以下三步：</p>
<h6 id="1-突出项目的战略价值（The-“Why-Now-Why-Us”）"><a href="#1-突出项目的战略价值（The-“Why-Now-Why-Us”）" class="headerlink" title="1. 突出项目的战略价值（The “Why Now, Why Us”）"></a>1. 突出项目的战略价值（The “Why Now, Why Us”）</h6><ul>
<li><strong>痛点聚焦（Urgency）：</strong> 首先，作者会引用前面分析中关于<strong>东南亚老虎 IWT 资本流</strong>或<strong>危害性</strong>的数据，强调问题的<strong>紧迫性</strong>和该区域的<strong>独特性&#x2F;重要性</strong>。</li>
<li><strong>项目的独特优势（Uniqueness）：</strong> 简述您提出的项目（例如“Safeguarding Tigers of Southeast Asia”）是<strong>如何针对性地解决</strong> IWT 供应链的关键薄弱环节。<ul>
<li><em>启发：</em> 强调项目设计（如 RBM, LFA, SMART 原则）的<strong>专业性和高标准</strong>，表明这是一个经过深思熟虑、而非凭空想象的方案。</li>
</ul>
</li>
</ul>
<h6 id="2-论证客户是最佳执行者（The-“Why-You”）"><a href="#2-论证客户是最佳执行者（The-“Why-You”）" class="headerlink" title="2. 论证客户是最佳执行者（The “Why You”）"></a>2. 论证客户是最佳执行者（The “Why You”）</h6><p>这是连接 4.4.1 评分结果的关键。</p>
<ul>
<li><strong>利用得分（The Score）：</strong> 直接引用 4.4.1 中的<strong>综合得分和排名</strong>。例如：“根据我们的熵权加权评估模型，WWF 在 15 个关键指标上均领先于其他组织，综合得分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>0.85</mn></mrow><annotation encoding="application/x-tex">S=0.85</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.85</span></span></span></span>。”</li>
<li><strong>分解优势（The Breakdown）：</strong> 详细说明客户在<strong>一级指标</strong>上的得分表现：<ul>
<li><strong>组织影响力 (OI)：</strong> 您的财务实力、全球网络能<strong>保障</strong>项目的长期稳定和大规模实施。</li>
<li><strong>沟通影响力 (CI)：</strong> 您的品牌知名度和社媒力量能<strong>最大限度地放大</strong>项目成果和公众意识。</li>
<li><strong>特殊影响力 (SI) — 最重要：</strong> 您的<strong>历史项目经验</strong>（在反 IWT 领域的投入）和<strong>区域专长</strong>（在东南亚的深耕）证明您<strong>无需磨合</strong>，可以立即高效启动。</li>
</ul>
</li>
</ul>
<h6 id="3-强调客户可获得的回报（The-“What’s-In-It-For-You”）"><a href="#3-强调客户可获得的回报（The-“What’s-In-It-For-You”）" class="headerlink" title="3. 强调客户可获得的回报（The “What’s In It For You”）"></a>3. 强调客户可获得的回报（The “What’s In It For You”）</h6><p>说服客户，他们将获得远超投入的价值：</p>
<ul>
<li><strong>使命达成（Mission Fulfillment）：</strong> 帮助客户<strong>切实</strong>推进其核心使命（例如，WWF 的“保护濒危物种”）。</li>
<li><strong>品牌提升（Reputational Gain）：</strong> 成功执行一个<strong>高影响力、高透明度</strong>的创新项目（RBM&#x2F;LFA），将进一步巩固其作为<strong>全球反 IWT 领导者</strong>的地位。</li>
<li><strong>资金吸引力（Future Funding）：</strong> 成功项目的成果和数据将成为未来吸引<strong>更多捐赠者和政府资金</strong>的最佳案例和背书。</li>
</ul>
<hr>
<h5 id="四、写作形式：采取正式信函或提案形式"><a href="#四、写作形式：采取正式信函或提案形式" class="headerlink" title="四、写作形式：采取正式信函或提案形式"></a>四、写作形式：采取正式信函或提案形式</h5><p>为了增强代入感和专业性，这一节通常以<strong>致选定客户（如 WWF 总裁）的正式提案信函</strong>或**执行摘要（Executive Summary）**的形式呈现，以最少的篇幅传递最大的战略信息。</p>
<h2 id="任务3：建立跨组织合作模式"><a href="#任务3：建立跨组织合作模式" class="headerlink" title="任务3：建立跨组织合作模式"></a>任务3：建立跨组织合作模式</h2><h3 id="执行项目的额外要求"><a href="#执行项目的额外要求" class="headerlink" title="执行项目的额外要求"></a>执行项目的额外要求</h3><p>我们的项目还有一些世界自然基金会（WWF）可能无法满足的额外要求，其中之一是通过加强打击力度来打击野生动物犯罪。世界自然基金会专注于通过各种非军事手段解决保护和环境问题，自身没有军事力量。建议世界自然基金会建立自己的力量来打击野生动物犯罪也是不切实际的。许多非法的野生动物贩运犯罪分子全副武装，打击犯罪的工作必须与其他拥有军事力量的机构紧密合作。此外，野生动物贩运犯罪往往是跨国的，这使得各国政府更难管理。为了满足这一涉及武装力量的额外要求，我们在此提出一个想法，即通过分析复杂的全球犯罪体系以及建立最优期望效用模型，来促进与国际刑警组织的合作。</p>
<h4 id="思路分析-4"><a href="#思路分析-4" class="headerlink" title="思路分析"></a>思路分析</h4><p>在ICM&#x2F;MCM竞赛中，提出“额外要求”的目的是展示您的<strong>项目规划是全面的，且脚踏实地</strong>。一个理想的项目方案必须能够预见到<strong>现实世界</strong>中的障碍，并提出解决这些障碍所需的<strong>非资金</strong>资源或条件。</p>
<h5 id="一、该部分的战略定位：解决现实中的“灰色地带”"><a href="#一、该部分的战略定位：解决现实中的“灰色地带”" class="headerlink" title="一、该部分的战略定位：解决现实中的“灰色地带”"></a>一、该部分的战略定位：解决现实中的“灰色地带”</h5><p>本节解决了前文（项目设计和客户选择）模型中未直接包含的<strong>关键限制因素</strong>：</p>
<ol>
<li><strong>政治限制：</strong> 模型只评估了客户的能力，但没解决<strong>国家间不信任</strong>的问题。</li>
<li><strong>法律限制：</strong> 模型选择了客户，但没解决<strong>跨国执法权限</strong>的问题。</li>
<li><strong>可持续性限制：</strong> 模型设计了项目活动，但没解决<strong>长期人才供应</strong>的问题。</li>
</ol>
<p>通过提出“额外要求”，作者成功地将一个<strong>理论上完美</strong>的方案，转化为一个<strong>实践上可落地</strong>的战略行动计划。</p>
<hr>
<h5 id="二、作者提出“额外要求”的常见维度与内容"><a href="#二、作者提出“额外要求”的常见维度与内容" class="headerlink" title="二、作者提出“额外要求”的常见维度与内容"></a>二、作者提出“额外要求”的常见维度与内容</h5><p>为了确保覆盖全面，作者通常会从以下四个相互关联的维度提出要求：</p>
<h6 id="1-区域级政治与法律要求（Overcoming-Barriers）"><a href="#1-区域级政治与法律要求（Overcoming-Barriers）" class="headerlink" title="1. 区域级政治与法律要求（Overcoming Barriers）"></a>1. 区域级政治与法律要求（Overcoming Barriers）</h6><ul>
<li><strong>要求：</strong> <strong>建立高层政治承诺</strong>和<strong>签署地区情报共享协议。</strong><ul>
<li><strong>深度分析：</strong> 您的项目针对<strong>东南亚</strong>的老虎 IWT，这是一条涉及多国的供应链。任何单一国际组织（如 WWF）都没有权力强迫国家合作。因此，成功的前提是需要<strong>客户（WWF）利用其影响力</strong>，促成<strong>区域性政府会议</strong>，签署如《打击野生动物犯罪情报共享协定》之类的文件。</li>
<li><em>这展示了您对跨国合作本质的理解。</em></li>
</ul>
</li>
</ul>
<h6 id="2-技术与数据标准化要求（Enabling-Operations）"><a href="#2-技术与数据标准化要求（Enabling-Operations）" class="headerlink" title="2. 技术与数据标准化要求（Enabling Operations）"></a>2. 技术与数据标准化要求（Enabling Operations）</h6><ul>
<li><strong>要求：</strong> <strong>强制所有参与方采用统一的技术标准和数据格式。</strong><ul>
<li><strong>深度分析：</strong> 前文提到项目采用了 <strong>SMART 原则</strong>、<strong>RBM&#x2F;LFA</strong> 等方法。这些方法依赖于高质量、可比较的数据。因此，必须要求所有执法机构、监测团队和边境检查站使用<strong>统一的数据录入软件</strong>（例如特定的 SMART 监测工具）和<strong>情报分类标准</strong>，以确保数据分析中心（在 5.1 中也可提出）能够有效运行。</li>
<li><em>这确保了模型分析基础的数据质量。</em></li>
</ul>
</li>
</ul>
<h6 id="3-跨领域专业人才要求（Filling-Skill-Gaps）"><a href="#3-跨领域专业人才要求（Filling-Skill-Gaps）" class="headerlink" title="3. 跨领域专业人才要求（Filling Skill Gaps）"></a>3. 跨领域专业人才要求（Filling Skill Gaps）</h6><ul>
<li><strong>要求：</strong> <strong>建立跨领域专家人才库（Talent Pool）。</strong><ul>
<li><strong>深度分析：</strong> IWT 资本流分析需要<strong>金融犯罪</strong>和<strong>反洗钱 (AML)</strong> 专家。这些人才极少出现在环保组织中。因此，您必须要求客户<strong>额外招聘</strong>或与如 UNODC（联合国毒品和犯罪问题办公室）等组织<strong>建立正式合作</strong>，以获得这些稀缺的、项目成功的关键技能。</li>
<li><em>这体现了项目执行的专业性和复杂性。</em></li>
</ul>
</li>
</ul>
<h6 id="4-社区参与与文化适应性要求（Ensuring-Sustainability）"><a href="#4-社区参与与文化适应性要求（Ensuring-Sustainability）" class="headerlink" title="4. 社区参与与文化适应性要求（Ensuring Sustainability）"></a>4. 社区参与与文化适应性要求（Ensuring Sustainability）</h6><ul>
<li><strong>要求：</strong> <strong>为实地工作人员提供强制性的跨文化和反腐败培训。</strong><ul>
<li><strong>深度分析：</strong> 任何保护项目最终都要落到<strong>保护区和社区</strong>。项目必须获得当地社区的信任和支持。要求对项目人员进行<strong>文化敏感性培训</strong>和严格的<strong>反腐败</strong>培训（因为 IWT 腐败盛行），可以大大降低项目在当地受到的阻力，确保<strong>长期可持续性</strong>。</li>
<li><em>这表明您对实地操作的风险控制有细致考量。</em></li>
</ul>
</li>
</ul>
<p><strong>总结：</strong> 5.1 小节通过提出这些<strong>必要但不易实现</strong>的额外要求，成功地将项目方案从一份“愿景”提升为一份**“执行路线图”**，极大地增强了整篇论文的实用价值和现实意义。</p>
<h3 id="连接非法野生动物贸易与各类犯罪活动的复杂系统"><a href="#连接非法野生动物贸易与各类犯罪活动的复杂系统" class="headerlink" title="连接非法野生动物贸易与各类犯罪活动的复杂系统"></a>连接非法野生动物贸易与各类犯罪活动的复杂系统</h3><p>通过分析犯罪活动的复杂系统，我们发现非法野生动物贸易（IWT）与全球各类犯罪活动之间存在紧密关联，这一发现为国际刑警组织（Interpol）参与合作提供了核心依据。</p>
<p>非法野生动物贸易并非孤立存在的犯罪行为，其背后存在一条延伸的复合型犯罪链条。结合前文构建的非法野生动物贸易产业链（如捕猎、贩运、走私等环节）及相关研究，我们可清晰识别其与全球犯罪网络的关键连接点：</p>
<ol>
<li><strong>捕猎环节与非法武器贸易的关联</strong><br>非法捕猎老虎等野生动物的犯罪团伙，普遍依赖非法武器（如改装步枪、陷阱工具等）实施捕猎行为。这些武器主要通过非法武器交易网络获取，而该网络同时服务于恐怖活动、有组织暴力犯罪等其他恶性犯罪，形成“武器供应-野生动物捕猎”的共生链条。</li>
<li><strong>贩运与走私环节与全球非法运输网络的融合</strong><br>东南亚地区的野生动物贩运与走私活动，高度依赖跨区域非法运输系统——包括未经监管的陆路通道、非法改装的海运船只及虚假申报的航空货运。值得注意的是，这些运输渠道并非仅用于野生动物走私，还同时承载毒品、非法移民、盗掘文物等其他非法商品的跨境运输。例如，东南亚部分“灰色港口”在运输非法虎制品的同时，也通过同一航线转运毒品至其他地区，形成“多罪合一”的运输网络。</li>
</ol>
<p>综上，东南亚地区的非法野生动物贸易已深度嵌入全球犯罪系统，成为连接非法武器、毒品、移民等多种犯罪的关键节点。在此背景下，国际刑警组织参与合作具有双重价值：一方面，借助其全球执法网络和武装力量，可直接打击野生动物犯罪链条；另一方面，通过打击野生动物贸易，还能顺藤摸瓜，获取非法武器交易、毒品走私等其他犯罪的关键线索，助力全球犯罪治理。基于这一复杂系统的关联性分析，国际刑警组织与世界自然基金会（WWF）的合作具备充分的合理性与必要性。</p>
<h4 id="思路分析-5"><a href="#思路分析-5" class="headerlink" title="思路分析"></a>思路分析</h4><p>这一小节的写作是 ICM 论文中<strong>最具创新性和宏观视野</strong>的部分，它将非法野生动物贸易 (IWT) 从一个孤立的环保问题，提升到了一个<strong>全球安全和金融犯罪</strong>的战略高度。</p>
<h5 id="一、核心目的与战略定位"><a href="#一、核心目的与战略定位" class="headerlink" title="一、核心目的与战略定位"></a>一、核心目的与战略定位</h5><p>本节的核心目标是：<strong>构建 IWT 的系统性联系网络，证明其对全球犯罪生态的贡献，从而为反 IWT 斗争争取更广泛、更高级别的资源和关注。</strong></p>
<table>
<thead>
<tr>
<th align="left">目标</th>
<th align="left">核心策略</th>
<th align="left">ICM 思维模式</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>扩大问题范围</strong></td>
<td align="left">将 IWT 嵌入到更具破坏性的犯罪类型中（例如：贩毒、军火走私、洗钱、腐败）。</td>
<td align="left"><strong>系统思维</strong>：将问题视为复杂网络中的一个<strong>节点</strong>而非一条孤立的<strong>边</strong>。</td>
</tr>
<tr>
<td align="left"><strong>提升关注级别</strong></td>
<td align="left">说服<strong>非环保机构</strong>（如金融监管机构、安全部门、反恐部门）参与进来。</td>
<td align="left"><strong>跨界合作</strong>：论证 IWT 不仅威胁老虎，更威胁到<strong>国家安全和金融稳定</strong>。</td>
</tr>
<tr>
<td align="left"><strong>设计系统模型</strong></td>
<td align="left">建立一个<strong>可视化</strong>的复杂系统模型（通常是网络图或流程图）。</td>
<td align="left"><strong>模型创新</strong>：超越传统的数学模型，设计一个<strong>概念性模型</strong>来解释问题的复杂结构。</td>
</tr>
</tbody></table>
<hr>
<h5 id="二、系统构建策略：节点、连接与驱动力"><a href="#二、系统构建策略：节点、连接与驱动力" class="headerlink" title="二、系统构建策略：节点、连接与驱动力"></a>二、系统构建策略：节点、连接与驱动力</h5><p>作者需要设计一个复杂的<strong>犯罪生态系统网络</strong>，清晰地展示 IWT 如何成为其中的一个关键环节。</p>
<h6 id="1-识别核心节点（The-Criminal-Activities）"><a href="#1-识别核心节点（The-Criminal-Activities）" class="headerlink" title="1. 识别核心节点（The Criminal Activities）"></a>1. 识别核心节点（The Criminal Activities）</h6><p>除了 IWT 之外，作者会识别出与 IWT 共享<strong>资金流、物流通道和腐败网络</strong>的其他主要犯罪活动，例如：</p>
<ul>
<li><strong>洗钱（Money Laundering）：</strong> IWT 的高额收益必须通过金融系统“洗白”。</li>
<li><strong>贩毒（Drug Trafficking）：</strong> 经常共享相同的<strong>走私路线、边境腐败网络和跨境犯罪团伙</strong>。</li>
<li><strong>军火走私（Arms Trafficking）：</strong> 犯罪网络经常用 IWT 收益购买武器，或用武器换取野生动物产品。</li>
<li><strong>人口贩卖（Human Trafficking）：</strong> 在某些地区，犯罪团伙可能同时涉及这两项活动。</li>
<li><strong>腐败（Corruption）：</strong> 腐败是 IWT 得以畅通的<strong>润滑剂</strong>，涉及边境官员、执法人员和政治人物。</li>
</ul>
<h6 id="2-建立连接（The-Shared-Mechanisms）"><a href="#2-建立连接（The-Shared-Mechanisms）" class="headerlink" title="2. 建立连接（The Shared Mechanisms）"></a>2. 建立连接（The Shared Mechanisms）</h6><p>通过识别 IWT 与这些犯罪之间的<strong>共享机制</strong>来构建连接：</p>
<ul>
<li><strong>共享物流通道：</strong> IWT 产品（如虎骨）与毒品、假冒商品等通过<strong>相同的隐蔽货运、港口或边境口岸</strong>走私。</li>
<li><strong>共享金融网络：</strong> 犯罪收益通过<strong>相同的地下汇款系统（如哈瓦拉）</strong>、空壳公司和加密货币进行转移和清洗。</li>
<li><strong>共享人力资本：</strong> 团伙成员在不同犯罪活动中<strong>交叉参与</strong>，例如一个走私团伙既运输象牙也运输毒品。</li>
</ul>
<h6 id="3-驱动力与反馈回路（The-Dynamics）"><a href="#3-驱动力与反馈回路（The-Dynamics）" class="headerlink" title="3. 驱动力与反馈回路（The Dynamics）"></a>3. 驱动力与反馈回路（The Dynamics）</h6><p>作者会进一步分析系统内部的<strong>动态关系</strong>：</p>
<ul>
<li><strong>资金循环：</strong> IWT 产生的利润为其他犯罪活动（如贩毒）提供<strong>种子资金</strong>，形成资金的正反馈循环。</li>
<li><strong>风险分散：</strong> 犯罪团伙通过参与多种活动<strong>分散被捕风险</strong>，增强了整个犯罪生态系统的<strong>弹性</strong>。</li>
<li><strong>腐败渗透：</strong> IWT 资金加剧了沿线国家的<strong>腐败程度</strong>，进一步削弱了执法能力，这反过来又促进了所有形式的非法贸易。</li>
</ul>
<hr>
<h5 id="三、系统模型的表达形式与结果"><a href="#三、系统模型的表达形式与结果" class="headerlink" title="三、系统模型的表达形式与结果"></a>三、系统模型的表达形式与结果</h5><p>作者通常会使用一个<strong>图形化的模型</strong>来总结其发现，这在 ICM 论文中具有极高的展示价值。</p>
<ol>
<li><strong>模型形式：</strong> <strong>中心辐射型网络图</strong>或<strong>供应链流程图</strong>。</li>
<li><strong>模型输出：</strong> 最终的系统模型证明了：<ul>
<li><strong>IWT 的高度融合性：</strong> IWT 并非一个独立的问题，而是与全球所有主要的跨国有组织犯罪活动<strong>深度耦合</strong>。</li>
<li><strong>反 IWT 的必要性：</strong> 通过打击 IWT，可以<strong>切断</strong>全球犯罪网络的一个关键资金来源和物流通道，起到<strong>一石多鸟</strong>的打击效果。</li>
</ul>
</li>
</ol>
<p><strong>总结：</strong> 5.2 节的成功在于它将 IWT 从一个“环保问题”重新定义为一个**“全球安全威胁”**。这种宏大的叙事和系统化的分析是 ICM 竞赛中获得高分的关键要素。</p>
<h3 id="跨组织合作如何使我们的项目受益"><a href="#跨组织合作如何使我们的项目受益" class="headerlink" title="跨组织合作如何使我们的项目受益"></a>跨组织合作如何使我们的项目受益</h3><p>为解释世界自然基金会（WWF）与国际刑警组织（INTERPOL）合作的益处，我们采用最优期望效用函数，将所有个体可选择的行为视为带有特定结果（合法收入）和相关概率（非法野生动物贸易收入）的博弈。该期望效用函数可用于描述不确定性下不同个体的偏好。</p>
<p>此处，我们将个体参与活动的全部精力和能力视为投资资本，用于投资不同的活动，这与“禀赋”概念类似。为简化分析，我们仅考虑两种活动：合法活动和老虎非法贸易（ITT），并将参与这两种活动视为类似的投资行为，即按一定比例将全部资本分别投入两种活动。</p>
<p>我们遵循理性个体假设，即个体将在约束条件下尽力最大化自身效用。同时假设所有个体地位平等，拥有相同的投资资本(Z)，其中(X)用于合法活动，( Y )用于老虎非法贸易。合法活动的效用函数为(U(X))，老虎非法贸易活动的效用函数为(V(Y))。一旦决定参与老虎非法贸易活动，个体将面临被侦查和惩罚（如逮捕）的风险。我们假设侦查率为(p)，被侦查意味着无法从老虎非法贸易活动中获得收益，同时需承担惩罚成本，定义惩罚成本函数为(C(Y))。</p>
<p>在此我们做出如下说明：</p>
<ol>
<li>(U(X))和(V(Y))均为递增且凹函数，因为效用函数的性质决定其一阶导数为正，二阶导数为负。</li>
<li>(C(Y))同样为递增且凹函数，因为当(Y)增加（即参与更多老虎非法贸易活动）时，惩罚力度将加大，且假设边际惩罚成本递减。</li>
</ol>
<p>因此，我们得到以下情况：个体可同时参与两种活动，其期望效用函数为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mrow><mo fence="true">(</mo><mi>E</mi><msub><mi>U</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>V</mi><mi>l</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="false">)</mo><mo>×</mo><msub><mi>V</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>π</mi><mo>×</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="1em"/><mtext>s.t. x</mtext><mo>+</mo><mtext>y</mtext><mo>≤</mo><mtext>z</mtext></mrow></mstyle></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned} Max\left( EU_{total} \right) &amp;= V_l(x) + (1 - \pi) \times V_i(y) - \pi \times f(y),  \\ &amp;\quad \text{s.t. } \text{x} + \text{y} \leq \text{z} \end{aligned}\tag{1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">s.t. </span></span><span class="mord text"><span class="mord">x</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">y</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span>
<p>我们构建拉格朗日函数并计算一阶条件（FOCs）如下：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>V</mi><mi>l</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="false">)</mo><msub><mi>V</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>π</mi><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>λ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>−</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo>⇒</mo><mi>F</mi><mi>O</mi><mi>C</mi><mi>s</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>V</mi><mi>l</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>λ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="false">)</mo><msubsup><mi>V</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>π</mi><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>λ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>+</mo><mi>y</mi><mo>=</mo><mi>z</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned} L(x,y,\lambda) &amp;= V_l(x) + (1 - \pi) V_i(y) - \pi f(y) - \lambda (x + y - z) \\ \Rightarrow FOCs &amp;= \begin{cases} V_l&#x27;(x) = \lambda \\ (1 - \pi) V_i&#x27;(y) - \pi f&#x27;(y) = \lambda \\ x + y = z \end{cases} \end{aligned}\tag{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.12em;vertical-align:-2.81em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.31em;"><span style="top:-6.88em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span></span></span><span style="top:-3.81em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">FOC</span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.81em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.31em;"><span style="top:-6.88em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span><span style="top:-3.81em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4169em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">λ</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">λ</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.81em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:6.12em;vertical-align:-2.81em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span>
<p>基于上述结果，我们将(X)视为( Y )的函数，进而可计算( Y )与(p)的关系：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>−</mo><msubsup><mi>V</mi><mi>l</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msubsup><mo stretchy="false">(</mo><mi>z</mi><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac><mo>=</mo><mo>−</mo><msubsup><mi>V</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="false">)</mo><msubsup><mi>V</mi><mi>i</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mi>π</mi><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo lspace="0em" rspace="0em">⇒</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>−</mo><msubsup><mi>V</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><mo>−</mo><msubsup><mi>V</mi><mi>l</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msubsup><mo stretchy="false">(</mo><mi>z</mi><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="false">)</mo><msubsup><mi>V</mi><mi>i</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>π</mi><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned} &amp;- V_l&#x27;&#x27;(z - y) \frac{\partial y}{\partial \pi} = - V_i&#x27;(y) + (1 - \pi) V_i&#x27;&#x27;(y) \frac{\partial y}{\partial \pi} - f&#x27;(y) + \pi f&#x27;&#x27;(y) \frac{\partial y}{\partial \pi} \\ \Rightarrow &amp;\frac{\partial y}{\partial \pi} = \frac{ - V_i&#x27;(y) - f&#x27;(y) }{ - V_l&#x27;&#x27;(z - y) - (1 - \pi) V_i&#x27;&#x27;(y) - \pi f&#x27;&#x27;(y) } \end{aligned}\tag{3}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.0736em;vertical-align:-2.2868em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7868em;"><span style="top:-4.8443em;"><span class="pstrut" style="height:3.4289em;"></span><span class="mord"></span></span><span style="top:-2.4294em;"><span class="pstrut" style="height:3.4289em;"></span><span class="mord"><span class="mrel">⇒</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2868em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7868em;"><span style="top:-4.8443em;"><span class="pstrut" style="height:3.4289em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.4294em;"><span class="pstrut" style="height:3.4289em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4289em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7337em;"><span style="top:-2.3987em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7337em;"><span style="top:-2.4231em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9873em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2868em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:5.0736em;vertical-align:-2.2868em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span>
<p>根据上述函数的解释，分子为正，分母为负，因此(\frac{dY}{dp} &lt; 0)。同理，可计算投资比例与(p)​的关系：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mrow><mi>z</mi><mo>−</mo><mi>y</mi></mrow><mi>y</mi></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac><mi>y</mi><mo>−</mo><mo stretchy="false">(</mo><mi>z</mi><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac></mrow><msup><mi>y</mi><mn>2</mn></msup></mfrac><mo>=</mo><mfrac><mrow><mo>−</mo><mi>z</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac></mrow><msup><mi>y</mi><mn>2</mn></msup></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mfrac><mi>x</mi><mi>y</mi></mfrac></mrow><mrow><mi mathvariant="normal">∂</mi><mi>π</mi></mrow></mfrac><mo separator="true">,</mo><mtext> </mtext><mi>x</mi><mo>+</mo><mi>y</mi><mo>=</mo><mi>z</mi></mrow></mstyle></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned} \frac{\partial}{\partial \pi}\left( \frac{z - y}{y} \right) &amp;= \frac{ - \frac{\partial y}{\partial \pi} y - (z - y) \frac{\partial y}{\partial \pi} }{y^2} = \frac{ - z \frac{\partial y}{\partial \pi} }{y^2} = \frac{\partial \frac{x}{y}}{\partial \pi}, \ x + y = z \end{aligned}\tag{4}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9172em;vertical-align:-1.2086em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7086em;"><span style="top:-3.7086em;"><span class="pstrut" style="height:3.6672em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2086em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7086em;"><span style="top:-3.7086em;"><span class="pstrut" style="height:3.6672em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6672em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.735em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6672em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.735em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5665em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.8711em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2086em;"><span></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:2.9172em;vertical-align:-1.2086em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span>
<p>由此，可推断跨组织合作的益处在于提高侦查率(p)。通过合作，侦查率将提升：一方面，WWF专注于该领域，拥有更多专业的专家和野生动物犯罪应对经验；另一方面，国际刑警组织拥有更强大的武装力量来打击犯罪分子。两者合作可结合国际刑警组织的力量和WWF的专业知识，提高侦查率。随着侦查率(p)的提高，结合前文计算结果可得：</p>
<p>作为理性个体，若(p)提高，投入老虎非法贸易的资本( Y )将减少，而投资比例(Y&#x2F;Z)也将下降。这意味着合作能更好地降低个体参与老虎非法贸易活动的动机，在打击野生动物犯罪方面为我们的项目带来更有效的成果。</p>
<h4 id="思路分析-6"><a href="#思路分析-6" class="headerlink" title="思路分析"></a>思路分析</h4><p>这一小节是项目规划的<strong>风险分散</strong>和<strong>资源最大化</strong>策略。在 ICM 竞赛中，意识到任何一个组织（即使是您选出的 WWF）都无法单独解决像 IWT 这样复杂的全球性问题，是展示<strong>成熟思考</strong>的关键。</p>
<h5 id="一、核心目的：分散风险与聚合资源"><a href="#一、核心目的：分散风险与聚合资源" class="headerlink" title="一、核心目的：分散风险与聚合资源"></a>一、核心目的：分散风险与聚合资源</h5><p>本节的目标是构建一个<strong>协同网络</strong>，明确指出引入哪些外部机构可以弥补客户（WWF）在<strong>资金、权限和专业知识</strong>上的不足，从而确保项目的<strong>可行性、效率和长期影响力</strong>。</p>
<table>
<thead>
<tr>
<th align="left">合作需求</th>
<th align="left">补充资源</th>
<th align="left">策略启发</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>弥补权限不足</strong></td>
<td align="left">执法机构、国际刑警组织（Interpol）。</td>
<td align="left"><strong>法律赋能</strong>：将项目从“倡导”升级为“执法行动”。</td>
</tr>
<tr>
<td align="left"><strong>弥补资金不足</strong></td>
<td align="left">世界银行、全球环境基金（GEF）、大型基金会。</td>
<td align="left"><strong>资金放大</strong>：确保项目在五年计划结束后能获得持续的、大规模的资金支持。</td>
</tr>
<tr>
<td align="left"><strong>弥补专业知识不足</strong></td>
<td align="left">金融监管机构、数据分析公司、技术供应商。</td>
<td align="left"><strong>专业深化</strong>：为 IWT 资本流分析提供高水平的、非环保领域的专业支持。</td>
</tr>
</tbody></table>
<hr>
<h5 id="二、作者的写作策略：按机构类型划分利益"><a href="#二、作者的写作策略：按机构类型划分利益" class="headerlink" title="二、作者的写作策略：按机构类型划分利益"></a>二、作者的写作策略：按机构类型划分利益</h5><p>作者会系统地将潜在合作伙伴进行分类，并精确描述他们能给项目带来的<strong>独特利益（Value Proposition）</strong>。</p>
<h6 id="1-国际执法与安全机构（Authority-Intelligence）"><a href="#1-国际执法与安全机构（Authority-Intelligence）" class="headerlink" title="1. 国际执法与安全机构（Authority &amp; Intelligence）"></a>1. 国际执法与安全机构（Authority &amp; Intelligence）</h6><ul>
<li><strong>机构举例：</strong> 国际刑警组织（Interpol）、联合国毒品和犯罪问题办公室（UNODC）。</li>
<li><strong>合作带来的收益：</strong><ul>
<li><strong>执法权限：</strong> WWF 无法进行逮捕或跨境追踪，但 Interpol 可以。合作能使情报（来自 WWF 的监测数据）<strong>转化为实际的执法行动</strong>。</li>
<li><strong>情报共享：</strong> UNODC 拥有全球犯罪网络的宏观视图。合作能将我们的<strong>老虎 IWT 模型</strong>嵌入到更大的<strong>全球有组织犯罪</strong>数据库中，提升打击的准确性和效率（承接 5.2 的系统模型）。</li>
</ul>
</li>
</ul>
<h6 id="2-金融与发展机构（Funding-Sustainability）"><a href="#2-金融与发展机构（Funding-Sustainability）" class="headerlink" title="2. 金融与发展机构（Funding &amp; Sustainability）"></a>2. 金融与发展机构（Funding &amp; Sustainability）</h6><ul>
<li><strong>机构举例：</strong> 世界银行（World Bank）、亚洲开发银行（ADB）、全球环境基金（GEF）。</li>
<li><strong>合作带来的收益：</strong><ul>
<li><strong>扩大资金规模：</strong> 这些机构提供<strong>发展贷款和赠款</strong>，资金规模远超任何 NGO 捐赠。合作能确保项目拥有<strong>长期、政府级别的资金池</strong>。</li>
<li><strong>治理改革：</strong> 借助世行的影响力，项目可以推动<strong>相关国家的金融系统和海关边境</strong>进行反洗钱和反腐败改革，从根本上堵塞 IWT 的金融漏洞。</li>
</ul>
</li>
</ul>
<h6 id="3-科技与数据分析伙伴（Efficiency-Technology）"><a href="#3-科技与数据分析伙伴（Efficiency-Technology）" class="headerlink" title="3. 科技与数据分析伙伴（Efficiency &amp; Technology）"></a>3. 科技与数据分析伙伴（Efficiency &amp; Technology）</h6><ul>
<li><strong>机构举例：</strong> Google Earth Engine、特定的金融科技（FinTech）公司。</li>
<li><strong>合作带来的收益：</strong><ul>
<li><strong>技术支持：</strong> 利用这些公司的<strong>大数据分析、AI 建模</strong>和<strong>卫星遥感技术</strong>，可以更精确地追踪 IWT 的走私路线和资金流向，提升项目运营的<strong>效率和准确性</strong>。</li>
<li><strong>创新验证：</strong> 这些合作证明了项目采用了<strong>前沿技术</strong>，增强了对投资者的吸引力。</li>
</ul>
</li>
</ul>
<hr>
<h5 id="三、说服力总结：构建项目生态圈"><a href="#三、说服力总结：构建项目生态圈" class="headerlink" title="三、说服力总结：构建项目生态圈"></a>三、说服力总结：构建项目生态圈</h5><p>作者通过 5.3 节的分析，实际上构建了一个**“反 IWT 项目生态圈”**。</p>
<ul>
<li><strong>中心：</strong> WWF（提供品牌影响力、资金与项目管理）。</li>
<li><strong>外围：</strong> 国际刑警组织（提供执法能力）、世界银行（提供大规模资金）、FinTech 公司（提供技术支持）。</li>
</ul>
<p>这表明作者的方案是<strong>开放式</strong>的，它充分利用了<strong>全球治理体系</strong>中的现有资源，而不是要求客户从零开始建立一切。这种<strong>资源整合能力</strong>是 ICM 论文中体现战略思维的重要标准。</p>
]]></content>
      <categories>
        <category>论文阅读</category>
      </categories>
      <tags>
        <tag>数学建模</tag>
        <tag>ICM</tag>
      </tags>
  </entry>
  <entry>
    <title>【论文阅读 | TPAMI | IVIF任务进展和应用概述：从数据兼容性到任务适配性】</title>
    <url>/2025/11/29/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20TPAMI%202024%20%20IVIF%E4%BB%BB%E5%8A%A1%E8%BF%9B%E5%B1%95%E5%92%8C%E5%BA%94%E7%94%A8%E6%A6%82%E8%BF%B0%EF%BC%9A%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%85%BC%E5%AE%B9%E6%80%A7%E5%88%B0%E4%BB%BB%E5%8A%A1%E9%80%82%E9%85%8D%E6%80%A7%E3%80%91/</url>
    <content><![CDATA[<p>[TOC]</p>
<p> <img data-src="/./../images/image-20251129212052527.png" alt="image-20251129212052527"></p>
<p>题目：Infrared and Visible Image Fusion: From Data Compatibility to Task Adaption</p>
<p>会议：IEEE Transactions on Pattern Analysis and Machine Intelligence （IEEE TPAMI）</p>
<p>代码：<a href="https://github.com/RollingPlain/IVIF_ZOO">https://github.com/RollingPlain/IVIF_ZOO</a></p>
<p>时间：23 December 2024</p>
<p><strong>本文将近年来的IVIF方法进行了总结分析，可以将本文当做快速学习IVIF方法的途径</strong></p>
<hr>
<h1 id="1-引言：从光谱到-IVIF"><a href="#1-引言：从光谱到-IVIF" class="headerlink" title="1. 引言：从光谱到 IVIF"></a>1. 引言：从光谱到 IVIF</h1><h3 id="1-1-可见光（VIS）与红外（IR）回顾"><a href="#1-1-可见光（VIS）与红外（IR）回顾" class="headerlink" title="1.1 可见光（VIS）与红外（IR）回顾"></a>1.1 可见光（VIS）与红外（IR）回顾</h3><ul>
<li><p><strong>可见光 VIS</strong></p>
<ul>
<li>传感器记录可见波段的反射光，也就是我们常见的 RGB 图像</li>
<li>优点：纹理、颜色、结构信息丰富，细节清晰</li>
<li>缺点：高度依赖环境光，在夜晚、逆光、雨雾、烟雾环境下质量急剧下降</li>
</ul>
</li>
<li><p><strong>红外 IR</strong></p>
<ul>
<li>记录物体表面的热辐射，不依赖可见光</li>
<li>优点：弱光 &#x2F; 全黑环境也能看见“热目标”（行人、车辆等）</li>
<li>缺点：纹理少、对比度低，看起来“灰、糊”，不适合直接做人眼视觉展示</li>
</ul>
</li>
</ul>
<blockquote>
<p>典型互补性：<br>VIS：看清<strong>细节、结构</strong><br>IR：看清<strong>重要目标</strong><br>→ 于是不难想到：把两者融合成一张“既清晰又目标突出的”图像。</p>
</blockquote>
<h3 id="1-2-IVIF-的任务定位"><a href="#1-2-IVIF-的任务定位" class="headerlink" title="1.2 IVIF 的任务定位"></a>1.2 IVIF 的任务定位</h3><p>红外与可见光图像融合（IVIF）的目标：</p>
<blockquote>
<p>给定一对 IR &#x2F; VIS 图像，生成一张融合图像 F，使其包含：  </p>
<ul>
<li>VIS 的纹理与结构信息  </li>
<li>IR 的显著目标与轮廓信息<br>同时兼顾视觉效果（给人看）与感知性能（给机器看）。</li>
</ul>
</blockquote>
<p>IVIF 早期主要是作为<strong>图像增强技术</strong>，服务于夜视、监控等“人眼观察”；<br>近年来逐渐变成<strong>多模态感知的前端模块</strong>，服务于：</p>
<ul>
<li>目标检测（行人 &#x2F; 车辆）</li>
<li>语义分割（道路 &#x2F; 建筑 &#x2F; 行人）</li>
<li>目标跟踪、人群计数、显著目标检测、深度估计等</li>
</ul>
<h3 id="1-3-这篇-TPAMI-综述在做什么？"><a href="#1-3-这篇-TPAMI-综述在做什么？" class="headerlink" title="1.3 这篇 TPAMI 综述在做什么？"></a>1.3 这篇 TPAMI 综述在做什么？</h3><p><img data-src="/./../images/image-20251130080141964.png" alt="image-20251130080141964"></p>
<p>论文的核心点不是简单罗列方法，而是提出了一个<strong>三维视角</strong>：</p>
<ol>
<li><p><strong>数据兼容性（Data Compatibility）</strong>  </p>
<ul>
<li>未配准图像如何处理？  </li>
<li>对抗样本 &#x2F; 传感器扰动如何应对？</li>
</ul>
</li>
<li><p><strong>融合方法（Image Fusion）</strong>  </p>
<ul>
<li>AE &#x2F; CNN &#x2F; GAN &#x2F; Transformer &#x2F; 通用融合框架  </li>
<li>损失函数和网络架构如何演化？</li>
</ul>
</li>
<li><p><strong>任务适配（Task Adaption）</strong>  </p>
<ul>
<li>如何为检测 &#x2F; 分割等下游任务设计“任务驱动”的融合网络？  </li>
<li>如何评估“好看”和“好用”的平衡？</li>
</ul>
</li>
</ol>
<p>本综述整理了 <strong>180+</strong> 种深度学习 IVIF 方法，结合大量对比实验、表格与可视化结果，给出了当前研究现状与未来趋势。</p>
<hr>
<h1 id="2-任务定义与整体流程"><a href="#2-任务定义与整体流程" class="headerlink" title="2. 任务定义与整体流程"></a>2. 任务定义与整体流程</h1><h3 id="2-1-IVIF-任务定义"><a href="#2-1-IVIF-任务定义" class="headerlink" title="2.1 IVIF 任务定义"></a>2.1 IVIF 任务定义</h3><p>给定一对由不同传感器采集的 IR &#x2F; VIS 图像：</p>
<ul>
<li>记为：(I_{IR}, I_{VIS})</li>
<li>任务：学习一个融合算子 ( \mathcal{F}(·) )，得到融合图 ( I_F &#x3D; \mathcal{F}(I_{IR}, I_{VIS}))</li>
</ul>
<p>要求：</p>
<ul>
<li>信息量不低于任一模态；</li>
<li>IR 中的热目标在融合图中清晰可见；</li>
<li>VIS 中的纹理、结构细节得到较好保留；</li>
<li>融合图既可供人眼理解，又利于下游任务网络（检测 &#x2F; 分割等）处理。</li>
</ul>
<h3 id="2-2-实际应用中的两大核心难点"><a href="#2-2-实际应用中的两大核心难点" class="headerlink" title="2.2 实际应用中的两大核心难点"></a>2.2 实际应用中的两大核心难点</h3><ol>
<li><p><strong>未必有“完美配准”的数据</strong></p>
<ul>
<li>不同相机视角、安装方式、分辨率都不一样；</li>
<li>精准像素级对齐很难，特别是移动平台、动态场景。</li>
</ul>
<p>也就是说，一般没有红外与可见光两张图重合起来完美重合的情况，会有一些偏差。</p>
</li>
<li><p><strong>很多方法只优化“图像质量”，忽视“任务表现”</strong></p>
<ul>
<li><p>只看 MI &#x2F; VIF &#x2F; AG &#x2F; SF 等融合指标；</p>
</li>
<li><p>但在目标检测 &#x2F; 语义分割等任务上表现平平甚至退化。</p>
</li>
</ul>
</li>
</ol>
<p>  正因如此，我们需要“<strong>任务驱动的融合</strong>”：在训练时就把 YOLO &#x2F; SegFormer 等网络拉进来一起优化。</p>
<h3 id="2-3-从数据到任务的完整流程"><a href="#2-3-从数据到任务的完整流程" class="headerlink" title="2.3 从数据到任务的完整流程"></a>2.3 从数据到任务的完整流程</h3><p><img data-src="/./../images/image-20251130080645753.png" alt="image-20251130080645753"></p>
<p>可以将上图抽象成三步：</p>
<blockquote>
<p><strong>数据兼容性 → 融合网络 → 任务网络</strong></p>
</blockquote>
<ul>
<li><strong>Data</strong>：IR&#x2F;VIS 图像可能未对齐、含噪声、甚至遭到对抗攻击，需要配准 &#x2F; 校正 &#x2F; 防御（这里比如随机在红外或可见光图像上挖去一块，模型可能会错误地放大这部分错误，因此要进行防御）；</li>
<li><strong>Fusion</strong>：把数据映射到融合图像或多模态特征空间；</li>
<li><strong>Task</strong>：检测、分割、SOD、计数、深度估计等感知任务。</li>
</ul>
<hr>
<h1 id="3-文献综述：方法、任务与数据兼容性"><a href="#3-文献综述：方法、任务与数据兼容性" class="headerlink" title="3. 文献综述：方法、任务与数据兼容性"></a>3. 文献综述：方法、任务与数据兼容性</h1><p>本节是组会的主要部分，按三条线讲：</p>
<ol>
<li>用于<strong>视觉增强</strong>的融合方法（AE&#x2F;CNN&#x2F;GAN&#x2F;Transformer）；  </li>
<li>面向<strong>应用任务</strong>的融合（检测 &#x2F; 分割 &#x2F; 其他）；  </li>
<li>针对<strong>数据兼容性</strong>的未配准、通用融合框架与对抗攻击。</li>
</ol>
<p><img data-src="/./../images/image-20251130080539232.png" alt="image-20251130080539232"></p>
<blockquote>
<p>图4. 包含典型融合方法的分类桑基图。 </p>
</blockquote>
<p><img data-src="/./../images/image-20251130080612639.png" alt="image-20251130080612639"></p>
<hr>
<h2 id="3-1-用于视觉增强的融合方法"><a href="#3-1-用于视觉增强的融合方法" class="headerlink" title="3.1 用于视觉增强的融合方法"></a>3.1 用于视觉增强的融合方法</h2><blockquote>
<p>假设数据已经对齐，目标是“图像本身要好看、信息量大”。</p>
</blockquote>
<p>这类方法大多遵循统一 pipeline）：</p>
<blockquote>
<p>特征提取（Encoder &#x2F; Backbone）  </p>
<p>特征融合（Fusion Rule &#x2F; Attention）  </p>
<p>图像重建（Decoder &#x2F; Generator）</p>
</blockquote>
<p><img data-src="/./../images/image-20251130081520096.png" alt="image-20251130081520096"></p>
<h3 id="3-1-1-基于自编码器（Auto-Encoder）的方法"><a href="#3-1-1-基于自编码器（Auto-Encoder）的方法" class="headerlink" title="3.1.1 基于自编码器（Auto Encoder）的方法"></a>3.1.1 基于自编码器（Auto Encoder）的方法</h3><p><strong>基本范式</strong></p>
<ol>
<li><p>预训练自编码器 AE：</p>
<ul>
<li>可以用 VIS 图（单模态）或 IR&#x2F;VIS 图对（多模态）进行训练；</li>
<li>AE 学到“如何从特征重建图像”。</li>
</ul>
</li>
<li><p>图像重建（推理阶段）：</p>
<ul>
<li>IR &#x2F; VIS 分别通过共享的 Encoder 得到特征 (F_{IR}, F_{VIS})；</li>
<li>按<strong>某种融合规则</strong>得到 (F_{Fuse})；</li>
<li>Decoder 将 (F_{Fuse}) 重建为融合图。</li>
</ul>
</li>
</ol>
<p><strong>核心问题</strong>：哪种“融合规则”。</p>
<h4 id="（a）融合规则改进"><a href="#（a）融合规则改进" class="headerlink" title="（a）融合规则改进"></a>（a）融合规则改进</h4><ul>
<li><p><strong>DenseFuse</strong></p>
<ul>
<li>Encoder：多层稠密卷积，提取多尺度特征；</li>
<li>Decoder：对称结构重建；</li>
<li>提出两类经典融合策略：<ol>
<li><strong>Add</strong>：(F &#x3D; F_{IR} + F_{VIS})</li>
<li><strong>L1-based Softmax</strong>：按特征 L1 范数计算权重，显著响应权重更大；</li>
</ol>
</li>
<li>用像素重建损失（L2）+ SSIM 保证结果接近源图。</li>
</ul>
</li>
<li><p><strong>MFEIF</strong></p>
<ul>
<li>多尺度特征提取 + 边缘引导注意力；</li>
<li>在融合时给边缘位置更高权重，让细节更清晰。</li>
</ul>
</li>
<li><p><strong>SFAFuse &#x2F; SEDRFuse 等</strong></p>
<ul>
<li>自监督策略 + 注意力加权；</li>
<li>用更多“显著性 &#x2F; 结构信息”引导融合规则，而非简单加权或 max。</li>
</ul>
</li>
</ul>
<h4 id="（b）网络架构创新"><a href="#（b）网络架构创新" class="headerlink" title="（b）网络架构创新"></a>（b）网络架构创新</h4><ul>
<li><p><strong>RFN-Nest</strong></p>
<ul>
<li>引入残差融合网络（RFN），把“融合规则”本身做成一个小网络；</li>
<li>整体结构类似 U-Net++ 的嵌套连接，更利于多尺度信息流动；</li>
<li>关注在“保护结构不破坏 + 增强细节”。</li>
</ul>
</li>
<li><p><strong>Re2Fusion</strong></p>
<ul>
<li>密集残差 + 双非局部（Non-local）模块；</li>
<li>一个 Non-local 看“同模态内部长程关系”，另一个看“跨模态互补关系”。</li>
</ul>
</li>
<li><p><strong>SMoA</strong></p>
<ul>
<li>基于 NAS 自动搜索编码器结构；</li>
<li>学到“适合 IVIF 的特征层次分布”，配合显著性权重作为融合规则。</li>
</ul>
</li>
</ul>
<p>现有的 AE 方法可分为两类：</p>
<ul>
<li><p>融合规则和数据集成方面的增强，旨在改进多模态特征合成。</p>
</li>
<li><p>网络架构方面的创新，包括引入新层和修改连接。</p>
</li>
</ul>
<hr>
<h3 id="3-1-2-基于-CNN-的方法"><a href="#3-1-2-基于-CNN-的方法" class="headerlink" title="3.1.2 基于 CNN 的方法"></a>3.1.2 基于 CNN 的方法</h3><p><img data-src="/./../images/image-20251130081520096.png" alt="image-20251130081520096"></p>
<blockquote>
<p>当前数量最多的一类。此类算法的关键优势在于它们能够从数据中自主学习复杂的高级特征。</p>
</blockquote>
<p>仍然遵循三步：<strong>特征提取 → 融合 → 重建</strong>，区别在于：</p>
<ol>
<li>是否由优化模型展开（Optimization-inspired）；  </li>
<li>损失函数如何设计（Loss-driven）；  </li>
<li>网络结构如何堆叠（Architecture）。</li>
</ol>
<h4 id="（1）优化驱动-CNN（Optimization-inspired）"><a href="#（1）优化驱动-CNN（Optimization-inspired）" class="headerlink" title="（1）优化驱动 CNN（Optimization-inspired）"></a>（1）优化驱动 CNN（Optimization-inspired）</h4><p>思想：把传统的优化模型或变分模型“展开”为网络，每一层对应一次迭代。</p>
<ul>
<li><p><strong>LRRNet（低秩表示 + TPAMI）</strong></p>
<ul>
<li>假设图像可以分解为：<strong>低秩结构 + 稀疏细节</strong>；</li>
<li>原公式需要解一个带低秩约束的优化问题；</li>
<li>作者把迭代求解步骤写成可学习的网络模块（unrolling）：<ul>
<li>每一层更新低秩分量 &#x2F; 稀疏分量 &#x2F; 拉格朗日乘子；</li>
</ul>
</li>
<li>优点：结构有清晰物理含义，可解释性强。</li>
</ul>
</li>
<li><p><strong>BIMDL（双层优化）</strong></p>
<ul>
<li>外层：控制“基础层 &#x2F; 細节层”如何分解；</li>
<li>内层：在给定分解的情况下，优化融合图的重建误差；</li>
<li>通过双层目标，分别约束结构与纹理表示。</li>
</ul>
</li>
<li><p><strong>AUIF（算法展开）</strong></p>
<ul>
<li>将变分模型中的低频 &#x2F; 高频项分成两个分支；</li>
<li>使用卷积模块模拟原本的梯度下降 &#x2F; 迭代规约过程；</li>
<li>实际效果：既平滑噪声，又保留清晰边缘。</li>
</ul>
</li>
</ul>
<blockquote>
<p>优化驱动 CNN 的共同特点：<br>“每一层做一小步优化”，有可解释性，而且适合写理论&#x2F;推导。</p>
</blockquote>
<h4 id="（2）损失函数驱动（Loss-is-almost-everything）"><a href="#（2）损失函数驱动（Loss-is-almost-everything）" class="headerlink" title="（2）损失函数驱动（Loss is almost everything）"></a>（2）损失函数驱动（Loss is almost everything）</h4><p>无监督 IVIF 没有 GT 融合图 → 损失函数几乎决定模型上限。</p>
<ul>
<li><p><strong>PIAFusion（光照感知损失）</strong></p>
<ul>
<li>引入子网络预测场景光照图 (L(x))；</li>
<li>在暗区更信 IR、在亮区更信 VIS；</li>
<li>在总损失中加入光照加权项，使模型学习到“不同区域依赖不同模态”。</li>
</ul>
</li>
<li><p><strong>STDFusionNet（显著性引导损失）</strong></p>
<ul>
<li>先用显著性检测网络得到 IR 中“热目标掩模”；</li>
<li>在 Loss 中对这些区域加大权重：<ul>
<li>目标区域：更强调 IR → 保证目标突出；</li>
<li>非目标区域：平衡 IR&#x2F;VIS → 保证背景自然。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>PSFusion（Progressive Semantic Injection）</strong></p>
<ul>
<li>用语义分割网络抽取 semantic feature；</li>
<li>通过特征层渐进注入 + 语义一致性损失，使融合图保留更多语义边界（路 &#x2F; 车 &#x2F; 人）。</li>
</ul>
</li>
<li><p><strong>PromptF &#x2F; FILM（语义 &#x2F; 感知损失）</strong></p>
<ul>
<li>利用视觉-语言模型或大语言模型生成文本提示（prompts）；</li>
<li>将这些“语义提示”编码成向量，引入感知损失，引导网络在特定语义区域加强细节；</li>
<li>兼顾视觉效果与识别性能。</li>
</ul>
</li>
</ul>
<blockquote>
<p>实际上，很多方法网络”长得“差不多，真正区别在损失函数怎么写。</p>
</blockquote>
<h4 id="（3）架构创新（Architecture-matters）"><a href="#（3）架构创新（Architecture-matters）" class="headerlink" title="（3）架构创新（Architecture matters）"></a>（3）架构创新（Architecture matters）</h4><ul>
<li><p><strong>IGNet（CNN + GNN）</strong></p>
<ul>
<li>CNN 提取多尺度特征 → 构建图结构（像素块作为节点）；</li>
<li>通过图神经网络做跨模态信息传播；</li>
<li>适合建模远距离关联和跨模态一致性。</li>
</ul>
</li>
<li><p><strong>Dif-Fusion &#x2F; DDFM（扩散模型）</strong></p>
<ul>
<li>构建“融合图的扩散过程”：从噪声逐步还原；</li>
<li>通过正向加噪 + 逆向去噪学习图像分布；</li>
<li>优点：视觉质量高，细节自然；</li>
<li>缺点：计算极其昂贵，不适合实时部署。</li>
</ul>
</li>
<li><p><strong>SMoA &#x2F; TIMFusion &#x2F; 隐式架构搜索（IAS）</strong></p>
<ul>
<li>SMoA：构建“超网络”，用 NAS 自动搜索子结构（编码器 &#x2F; 融合模块）；</li>
<li>TIMFusion：在搜索目标中直接融合“视觉性能 + 硬件延迟”，找到既准又快的结构；</li>
<li>体现出“<strong>自动化结构设计 + 硬件感知</strong>”的新趋势。</li>
</ul>
</li>
</ul>
<p>在基于 CNN 的图像融合方法领域，有三种创新方法脱颖而出：</p>
<ul>
<li><p>受优化启发的 CNN 方法利用迭代集成和可学习模块来提高融合效率。 </p>
</li>
<li><p>修改损失函数对 IVIF 任务中的无监督学习结果至关重要。</p>
</li>
<li><p>架构改进侧重于优化网络设计，神经架构搜索（NAS）是一种用于结构优化的专门方法。</p>
</li>
</ul>
<hr>
<h3 id="3-1-3-基于-GAN-的方法"><a href="#3-1-3-基于-GAN-的方法" class="headerlink" title="3.1.3 基于 GAN 的方法"></a>3.1.3 基于 GAN 的方法</h3><p><img data-src="/./../images/image-20251130081520096.png" alt="image-20251130081520096"></p>
<p>GAN 天然适合“无监督分布建模”，与 IVIF 相当契合。GAN在无需标签监督的情况下对数据分布进行建模方面已证明其有效性。这种无监督方法自然适用于 IVIF 任务，GAN 已成为主要的方法之一。：</p>
<ul>
<li>生成器 G：输入 IR&#x2F;VIS，输出融合图；</li>
<li>判别器 D：判断融合图像分布是否接近某模态或多模态分布。</li>
</ul>
<p>但也存在典型问题：</p>
<ul>
<li>训练不稳定；</li>
<li>易出现伪影；</li>
<li>模态不平衡（只像 VIS 或只像 IR）。</li>
</ul>
<h4 id="（1）单判别器（Single-Discriminator）"><a href="#（1）单判别器（Single-Discriminator）" class="headerlink" title="（1）单判别器（Single Discriminator）"></a>（1）单判别器（Single Discriminator）</h4><blockquote>
<p>单判别器方法利用原始 GAN ，将融合图像约束为与一种模态相似。</p>
</blockquote>
<ul>
<li><p><strong>FusionGAN</strong></p>
<ul>
<li>生成器包含两条路径：<ul>
<li>对比路径：保 IR 强度分布；</li>
<li>梯度路径：保 VIS 纹理细节；</li>
</ul>
</li>
<li>判别器只判断“像不像 VIS”；</li>
<li>问题：往往导致融合结果偏向可见光，弱化热目标。</li>
</ul>
</li>
<li><p><strong>GANMcC</strong></p>
<ul>
<li>将判别器改为多分类：区分 IR &#x2F; VIS &#x2F; Fused 等类别；</li>
<li>希望通过多分类方式减轻模态不平衡；</li>
<li>本质仍为单判别器，无法对不同模态施加独立约束。</li>
</ul>
</li>
</ul>
<blockquote>
<p>单判别器的普遍问题：监督信号偏向单模态，难以同时保留 IR + VIS 两端的优势。</p>
</blockquote>
<h4 id="（2）双判别器（Dual-Discriminators）"><a href="#（2）双判别器（Dual-Discriminators）" class="headerlink" title="（2）双判别器（Dual Discriminators）"></a>（2）双判别器（Dual Discriminators）</h4><blockquote>
<p>双判别器方法利用两个判别器来平衡典型的模态信息。···································································</p>
</blockquote>
<ul>
<li><p><strong>DDcGAN</strong></p>
<ul>
<li>生成器 G 输出 F；</li>
<li>两个判别器：<ul>
<li>(D_{VIS})：判断 F 是否“像 VIS” → 对纹理敏感；</li>
<li>(D_{IR})：判断 F 是否“像 IR” → 对热目标和强度敏感；</li>
</ul>
</li>
<li>在对抗训练中逼迫 G 在两种模态间折中，兼顾纹理与目标。</li>
</ul>
</li>
<li><p><strong>ICAFusion</strong></p>
<ul>
<li>在生成器中加入交互注意力（Interactive Cross Attention）模块；</li>
<li>强调跨模态信息交互，而非简单拼接或加权；</li>
<li>依然是 G + 2D 的框架结构。</li>
</ul>
</li>
<li><p><strong>FreqGAN</strong></p>
<ul>
<li>采用小波分解，将图像拆成不同频带；</li>
<li>判别器在频域中约束各频带特征，使高频细节和低频结构分别得到合理保留。</li>
</ul>
</li>
</ul>
<blockquote>
<p>总结：GAN 系方法在视觉效果上很亮眼，但<br>在检测 &#x2F; 分割等任务上的提升并<strong>不必然</strong>优于 CNN &#x2F; Transformer 系。</p>
</blockquote>
<hr>
<h3 id="3-1-4-基于-Transformer-的方法"><a href="#3-1-4-基于-Transformer-的方法" class="headerlink" title="3.1.4 基于 Transformer 的方法"></a>3.1.4 基于 Transformer 的方法</h3><blockquote>
<p>核心：用自注意力建模<strong>长程依赖 + 跨模态交互</strong>。</p>
</blockquote>
<p>总体上的趋势还是：<strong>CNN + Transformer 混合结构</strong>：</p>
<ul>
<li>CNN：提局部细节（边缘、纹理）；</li>
<li>Transformer：提全局上下文和跨模态关系。</li>
</ul>
<h4 id="代表方法"><a href="#代表方法" class="headerlink" title="代表方法"></a>代表方法</h4><ul>
<li><p><strong>IFT &#x2F; SwinFusion &#x2F; YDTR &#x2F; TGFuse &#x2F; DATFuse</strong></p>
<ul>
<li>典型结构：<ul>
<li>前几层：卷积提局部浅层特征；</li>
<li>后几层：Transformer 块（window &#x2F; global attention）建模长程依赖；</li>
</ul>
</li>
<li>SwinFusion：用 Swin Transformer 构造两种注意力模块（自注意力 + 跨模态注意力）；</li>
<li>YDTR：Y 型结构，一路偏局部细节，一路偏全局上下文。</li>
</ul>
</li>
<li><p><strong>DATFuse</strong></p>
<ul>
<li>双重注意力：同时处理空间注意力与通道注意力；</li>
<li>特别强调“重要区域 + 重要通道”的选择性放大。</li>
</ul>
</li>
<li><p><strong>CMTFusion &#x2F; CDDFuse</strong></p>
<ul>
<li>CMTFusion：跨模态 Transformer，显式去冗余，保留互补信息；</li>
<li>CDDFuse：双分支 CNN-Transformer 结构，两路分别分解模态相关与模态无关特征，借助 Restormer 风格模块实现无损信息传递。</li>
</ul>
</li>
<li><p><strong>Text-IF &#x2F; PromptF &#x2F; FILM</strong></p>
<ul>
<li>Text-IF：引入文本描述（例如“车”“行人”），做文本引导的退化感知融合；</li>
<li>PromptF：通过视觉-语言模型生成语义提示，指导融合网络关注特定重要区域；</li>
<li>FILM：利用 ChatGPT 等从图像生成语义文本，再用跨注意力把文本信息注入融合过程。</li>
</ul>
</li>
</ul>
<h4 id="优缺点小结"><a href="#优缺点小结" class="headerlink" title="优缺点小结"></a>优缺点小结</h4><ul>
<li><p>优点：</p>
<ul>
<li>长程依赖建模能力强；</li>
<li>跨模态交互更充分；</li>
<li>指标（MI&#x2F;VIF&#x2F;结构保持等）往往更好。</li>
</ul>
</li>
<li><p>缺点：</p>
<ul>
<li>模型参数多，FLOPs 高；</li>
<li>显存占用大，对端侧部署不友好；</li>
<li>需要结合蒸馏 &#x2F; 剪枝 &#x2F; NAS 等做轻量化。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="3-2-面向应用的融合（任务适配）"><a href="#3-2-面向应用的融合（任务适配）" class="headerlink" title="3.2 面向应用的融合（任务适配）"></a>3.2 面向应用的融合（任务适配）</h2><blockquote>
<p>说人话，这一节就是体现“从给人看 → 给机器看”的地方。</p>
</blockquote>
<p>论文重点讲了两类任务：</p>
<ol>
<li><strong>目标检测（Detection-aware Fusion）</strong>；  </li>
<li><strong>语义分割（Segmentation-aware Fusion）</strong>。</li>
</ol>
<p>此外还提到跟踪、人群计数、显著性检测、深度估计等任务，这些与 IVIF 关系略弱，因此本节简略带过。</p>
<hr>
<h3 id="3-2-1-面向目标检测的融合"><a href="#3-2-1-面向目标检测的融合" class="headerlink" title="3.2.1 面向目标检测的融合"></a>3.2.1 面向目标检测的融合</h3><p>背景：有了像 <strong>M³FD</strong> 这样同时包含 IR&#x2F;VIS 图像对和目标检测标注的数据集，可以直接让检测网络参与融合网络训练。</p>
<h4 id="（1）TarDAL：双层优化的目标感知融合"><a href="#（1）TarDAL：双层优化的目标感知融合" class="headerlink" title="（1）TarDAL：双层优化的目标感知融合"></a>（1）TarDAL：双层优化的目标感知融合</h4><blockquote>
<p>Liu 等人率先探索了图像融合和目标检测，提出了 <strong>TarDAL</strong> 方法，并构建了最大的多模态目标检测数据集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mn>3</mn></msup><mi>F</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">M^{3} FD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>。TarDAL 提出了一种双层优化公式来建模两个任务之间的内在关系，并展开优化以构建目标感知的双层学习网络。</p>
</blockquote>
<ul>
<li><p>贡献：</p>
<ul>
<li>提出最大的多模态目标检测数据集 M³FD；</li>
<li>提出 TarDAL（Target-aware Dual Adversarial Learning）。</li>
</ul>
</li>
<li><p><strong>双层优化思想</strong>：</p>
<ul>
<li>下层（fusion-level）：给定 IR&#x2F;VIS，输出融合图；</li>
<li>上层（detection-level）：在融合图上训练检测网络（类似 YOLO），最大化检测 mAP；</li>
<li>把两个层级的优化过程展开成一个可训练网络。</li>
</ul>
</li>
<li><p>关键点：</p>
<ul>
<li>利用视觉显著性图（VSM）强调 IR 中的热目标；</li>
<li>损失函数中对目标区域加权，保证小目标（远处行人）不被淹没；</li>
<li>实验结果：在 M³FD 上 mAP 全面领先，尤其在小目标和退化场景（雾&#x2F;雨&#x2F;强光）上优势明显。</li>
</ul>
</li>
</ul>
<h4 id="（2）DetFusion：检测驱动注意力指导融合"><a href="#（2）DetFusion：检测驱动注意力指导融合" class="headerlink" title="（2）DetFusion：检测驱动注意力指导融合"></a>（2）DetFusion：检测驱动注意力指导融合</h4><blockquote>
<p>Zhao 等人引入元特征嵌入以实现目标检测和图像融合之间的兼容性。Sun 等人提出了令人瞩目的 <strong>DetFusion</strong> 方法，利用检测驱动的信息通过共享注意力机制指导融合优化。目标感知损失在从目标位置学习像素级信息方面也起着关键作用。</p>
</blockquote>
<ul>
<li>结构：<ul>
<li>融合网络 + 检测网络部分共享 backbone；</li>
<li>检测分支产生的 attention map 回馈给融合分支；</li>
</ul>
</li>
<li>思路：<ul>
<li>检测网络告诉融合网络“哪里是车 &#x2F; 人 &#x2F; 重要目标”；</li>
<li>融合网络在这些位置分配更多注意力与容量；</li>
</ul>
</li>
<li>效果：<ul>
<li>在不大幅增加计算量的前提下，提高检测性能；</li>
<li>在视觉上也偏向强化目标区域的对比度和边界。</li>
</ul>
</li>
</ul>
<h4 id="（3）MoE-Fusion：混合专家（Mixture-of-Experts）"><a href="#（3）MoE-Fusion：混合专家（Mixture-of-Experts）" class="headerlink" title="（3）MoE-Fusion：混合专家（Mixture of Experts）"></a>（3）MoE-Fusion：混合专家（Mixture of Experts）</h4><blockquote>
<p>Cao 等人提出了 <strong>MoE - Fusion</strong> 方法，集成了局部 - 全局专家混合模型来动态提取各自模态的有效特征。这种对局部信息和全局对比的动态特征学习证明了目标检测的有效性。</p>
</blockquote>
<ul>
<li>框架：<ul>
<li>设置多个“专家”：IR 专家、VIS 专家、局部专家、全局专家等；</li>
<li>门控网络依据输入内容动态分配专家权重；</li>
</ul>
</li>
<li>优点：<ul>
<li>自适应选择“此处更信 IR 还是 VIS”；</li>
<li>同一模型可适应多场景（昼夜、雾天、复杂背景）。</li>
</ul>
</li>
</ul>
<h4 id="（4）MetaFusion：元特征嵌入"><a href="#（4）MetaFusion：元特征嵌入" class="headerlink" title="（4）MetaFusion：元特征嵌入"></a>（4）MetaFusion：元特征嵌入</h4><blockquote>
<p>Zhao 等人提出了 <strong>MetaFusion</strong> 方法，利用来自目标检测的元特征嵌入来对齐语义和融合特征，实现有效的联合学习。</p>
</blockquote>
<ul>
<li>想法：<ul>
<li>从检测网络中抽取“元特征”（例如类别、尺度、置信度等）；</li>
<li>将这些 meta-feature 作为额外输入嵌入融合网络；</li>
</ul>
</li>
<li>作用：<ul>
<li>元特征提供了高层语义指导；</li>
<li>促使融合结果在语义上更“合检测器口味”。</li>
</ul>
</li>
</ul>
<h4 id="（5）不显式生成融合图的多模态检测方法（对照）"><a href="#（5）不显式生成融合图的多模态检测方法（对照）" class="headerlink" title="（5）不显式生成融合图的多模态检测方法（对照）"></a>（5）不显式生成融合图的多模态检测方法（对照）</h4><p>在此论文中也提到一些<strong>不生成融合图，只做特征级多模态检测</strong>的工作：</p>
<ul>
<li>通常结构：<ul>
<li>IR&#x2F;VIS 双流编码器；</li>
<li>中间若干层做特征级融合（注意力 &#x2F; 特征对齐 &#x2F; 概率集成等）；</li>
<li>最后单个检测头预测类别与框。</li>
</ul>
</li>
</ul>
<blockquote>
<p>这些方法从“检测任务”出发看问题，而本文综述更多是从“通用融合 + 下游任务”的角度出发。  </p>
<p>换而言之，这些方法只关心结果，不生成融合图，直接做多模态检测，只要任务完成得好就行。</p>
</blockquote>
<hr>
<h3 id="3-2-2-面向语义分割的融合"><a href="#3-2-2-面向语义分割的融合" class="headerlink" title="3.2.2 面向语义分割的融合"></a>3.2.2 面向语义分割的融合</h3><p>目标：使融合图对语义分割任务友好，提高 mIoU&#x2F;mAcc。</p>
<h4 id="（1）SeAFusion：融合-分割级联-语义损失"><a href="#（1）SeAFusion：融合-分割级联-语义损失" class="headerlink" title="（1）SeAFusion：融合 + 分割级联 + 语义损失"></a>（1）SeAFusion：融合 + 分割级联 + 语义损失</h4><blockquote>
<p><strong>SeAFusion</strong> 将图像融合与分割任务级联，通过基于循环的训练引入语义损失以增强融合的信息丰富度。</p>
</blockquote>
<ul>
<li>结构：FusionNet → SegNet 级联；</li>
<li>训练：<ol>
<li>用分割网络的预测与 GT 计算分割损失（比如交叉熵 + mIoU）；</li>
<li>把这部分损失反向传到 FusionNet；</li>
</ol>
</li>
<li>作用：<ul>
<li>分割网络像“老师”一样指导融合网络：<ul>
<li>哪些边界要更清晰；</li>
<li>哪些区域需要更高对比度。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="（2）SuperFusion：多功能配准-融合-语义感知框架"><a href="#（2）SuperFusion：多功能配准-融合-语义感知框架" class="headerlink" title="（2）SuperFusion：多功能配准 + 融合 + 语义感知框架"></a>（2）SuperFusion：多功能配准 + 融合 + 语义感知框架</h4><blockquote>
<p>Tang 等人提出了 <strong>SuperFusion</strong>，这是一个用于多模态图像配准、融合和语义感知的通用框架。</p>
</blockquote>
<ul>
<li>同时解决三个问题：<ol>
<li>未对齐图像的配准（估计双向形变场）；</li>
<li>IR&#x2F;VIS 信息融合；</li>
<li>语义感知（通过语义分支提供高层约束）。</li>
</ol>
</li>
<li>特点：<ul>
<li>在未对齐场景下表现突出；</li>
<li>是“数据兼容 + 融合 + 任务适配三合一”的代表工作。</li>
</ul>
</li>
</ul>
<h4 id="（3）PSFusion：渐进式语义注入"><a href="#（3）PSFusion：渐进式语义注入" class="headerlink" title="（3）PSFusion：渐进式语义注入"></a>（3）PSFusion：渐进式语义注入</h4><blockquote>
<p><strong>PSFusion</strong> 在特征级别引入渐进式语义注入，考虑了融合的语义需求。它还表明，在计算资源较少的情况下，图像级融合在感知任务中与特征融合具有可比的性能。</p>
</blockquote>
<ul>
<li>思路：<ul>
<li>在<strong>特征层</strong>（而不是图像层）注入语义特征；</li>
<li>分割网络多个层级的语义特征分别注入融合 backbone 的不同 stage；</li>
</ul>
</li>
<li>实验观察：<ul>
<li>在算力受限时，“图像级融合 + 单模态分割”在性能上可以接近“特征级多模态分割”；</li>
<li>对工程实现有参考价值（便于复用现成分割器）。</li>
</ul>
</li>
</ul>
<h4 id="（4）SegMiF：双任务相关性的联合学习"><a href="#（4）SegMiF：双任务相关性的联合学习" class="headerlink" title="（4）SegMiF：双任务相关性的联合学习"></a>（4）SegMiF：双任务相关性的联合学习</h4><blockquote>
<p>Liu 等人提出了 <strong>SegMiF</strong>，利用双任务相关性来提高分割和融合性能，引入分层交互注意力进行细粒度任务映射，并收集了这些任务的最大全时基准数据集。</p>
</blockquote>
<ul>
<li>特点：<ul>
<li>同时看“融合任务”和“分割任务”的相关性；</li>
<li>用分层交互注意力模块进行双向特征交换：<ul>
<li>融合分支获得语义信息；</li>
<li>分割分支利用更丰富的结构与纹理特征；</li>
</ul>
</li>
</ul>
</li>
<li>数据：<ul>
<li>作者构建了目前规模最大的融合 + 分割联合数据集 <strong>FMB</strong>（14 类），用于性能评测。</li>
</ul>
</li>
</ul>
<h4 id="（5）MRFS-CAF-TIMFusion-等统一感知驱动框架"><a href="#（5）MRFS-CAF-TIMFusion-等统一感知驱动框架" class="headerlink" title="（5）MRFS &#x2F; CAF &#x2F; TIMFusion 等统一感知驱动框架"></a>（5）MRFS &#x2F; CAF &#x2F; TIMFusion 等统一感知驱动框架</h4><ul>
<li><p><strong>MRFS</strong>：</p>
<blockquote>
<p>Zhang 等人提出了 <strong>MRFS</strong>，这是一个耦合学习框架，通过相互强化集成图像融合和分割，实现了增强的视觉质量和更准确的分割结果。</p>
</blockquote>
<ul>
<li>耦合学习框架，强调“融合结果 ↔ 分割结果”的互相强化；</li>
</ul>
</li>
<li><p><strong>CAF</strong>：</p>
<ul>
<li>自动搜索适合检测 &#x2F; 分割任务的损失组合；</li>
<li>减少人工调 loss 的工作量；</li>
</ul>
</li>
<li><p><strong>TIMFusion</strong>：</p>
<ul>
<li>用隐式架构搜索获得硬件友好、任务性能优良的融合网络；</li>
<li>一套结构适配多种下游感知任务。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-2-3-其他感知任务（略）"><a href="#3-2-3-其他感知任务（略）" class="headerlink" title="3.2.3 其他感知任务（略）"></a>3.2.3 其他感知任务（略）</h3><p>这些任务与 IVIF 是“应用层面的延伸”，与任务本身不完全以 IVIF 为核心，因此简略描述：</p>
<ul>
<li><p><strong>RGB-T 目标跟踪</strong></p>
<ul>
<li>通过像素级 &#x2F; 特征级 &#x2F; 决策级融合 IR&#x2F;VIS 提高跟踪鲁棒性；</li>
<li>抵抗遮挡、弱光、背景干扰。</li>
</ul>
</li>
<li><p><strong>人群计数（Crowd Counting）</strong></p>
<ul>
<li>利用多模态信息区分“人”和“背景热源”；</li>
<li>在高密度、遮挡严重场景下提高密度估计精度。</li>
</ul>
</li>
<li><p><strong>显著目标检测（SOD）</strong></p>
<ul>
<li>如 IRFS：将融合和显著性检测做成多任务框架；</li>
<li>通过交互增强使显著目标轮廓更准确。</li>
</ul>
</li>
<li><p><strong>深度估计 &#x2F; 其他</strong></p>
<ul>
<li>使用光谱转换 &#x2F; 风格迁移处理复杂光照；</li>
<li>辅助估计深度或其他几何信息。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="3-3-数据兼容性：未配准、通用融合与对抗攻击"><a href="#3-3-数据兼容性：未配准、通用融合与对抗攻击" class="headerlink" title="3.3 数据兼容性：未配准、通用融合与对抗攻击"></a>3.3 数据兼容性：未配准、通用融合与对抗攻击</h2><blockquote>
<p>理论上的红外和可见光图像的融合是美好的，但是现实是残酷的：未对齐、带噪声、甚至遭攻击。</p>
</blockquote>
<h3 id="3-3-1-未配准（Misaligned）图像的融合"><a href="#3-3-1-未配准（Misaligned）图像的融合" class="headerlink" title="3.3.1 未配准（Misaligned）图像的融合"></a>3.3.1 未配准（Misaligned）图像的融合</h3><p><img data-src="/./../images/image-20251130093438617.png" alt="image-20251130093438617"></p>
<p>大致分为两条路线：</p>
<ol>
<li>基于风格迁移的“伪标签”方法（Style Transfer-based）  </li>
<li>基于潜在空间的模态无关特征（Latent Space-based）</li>
</ol>
<h4 id="（1）基于风格迁移的配准-融合范式"><a href="#（1）基于风格迁移的配准-融合范式" class="headerlink" title="（1）基于风格迁移的配准 + 融合范式"></a>（1）基于风格迁移的配准 + 融合范式</h4><p>生成伪标签，将多模态配准转换为单模态配准</p>
<p>典型流程：</p>
<ol>
<li><strong>MTN（模态转换网络）</strong>：<ul>
<li>将 VIS → IR 风格 或 IR → VIS 风格，生成“伪标签图像”；</li>
</ul>
</li>
<li><strong>STN（空间变换网络）</strong>：<ul>
<li>学习源图像与伪标签之间的空间变形场；</li>
</ul>
</li>
<li>完成配准后，再用常规融合网络处理。</li>
</ol>
<p>代表方法：</p>
<ul>
<li><p><strong>Nemar &#x2F; UMIR</strong></p>
<ul>
<li>Nemar：提出使用单模态度量指标训练多模态配准网络；</li>
<li>双向训练策略：<ul>
<li>先配准再转换；</li>
<li>先转换再配准；</li>
</ul>
</li>
<li>目的是保证伪标签既风格接近目标模态，又几何结构可靠。</li>
</ul>
</li>
<li><p><strong>UMFusion</strong></p>
<ul>
<li>关注“未配准导致的重影伪影”；</li>
<li>引入跨模态生成-配准范式：<ul>
<li>生成伪标签减少模态差异；</li>
<li>联合学习配准与融合，缓解重影。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>RFNet</strong></p>
<ul>
<li>把配准与融合设计成互相促进的两个子任务：<ul>
<li>粗配准 → 融合 → 精配准 → 再融合；</li>
</ul>
</li>
<li>在配准过程中不断利用融合结果提升一致性。</li>
</ul>
</li>
</ul>
<p>优点：</p>
<ul>
<li>利用单模态指标做监督，训练相对稳定；</li>
<li>宜于处理较大视角差异。</li>
</ul>
<p>缺点：</p>
<ul>
<li>模态转换质量会直接影响最终效果；</li>
<li>有可能引入风格偏差（比如颜色失真）。</li>
</ul>
<h4 id="（2）基于潜在空间的模态无关特征"><a href="#（2）基于潜在空间的模态无关特征" class="headerlink" title="（2）基于潜在空间的模态无关特征"></a>（2）基于潜在空间的模态无关特征</h4><p>构建模态无关的特征空间，将多模态图像特征映射到共享空间，并利用共享特征预测变形场</p>
<p>核心思想：</p>
<ul>
<li>提取 IR &#x2F; VIS 的“公共特征”，让两种模态在“共享空间”对齐；</li>
<li>在共享特征空间中预测形变场，再反向约束原图配准。</li>
</ul>
<p>代表方法：</p>
<ul>
<li><p><strong>MURF</strong></p>
<ul>
<li>强调模态无关特征对配准的重要性；</li>
<li>采用粗配准 + 精配准两阶段策略：<ul>
<li>粗配准：对比学习约束共享特征的分布；</li>
<li>精配准：在共享空间上细化形变参数；</li>
</ul>
</li>
<li>融合与配准互相扶持。</li>
</ul>
</li>
<li><p><strong>SuperFusion</strong></p>
<ul>
<li>前面已经介绍：融合 + 配准 + 语义一体化；</li>
<li>在光度一致性和端点误差约束下估计双向形变场；</li>
<li>对几何扭曲修正效果好。</li>
</ul>
</li>
<li><p><strong>ReCoNet</strong></p>
<ul>
<li>递归修正网络；</li>
<li>多次迭代补偿几何扭曲，逐步减轻重影。</li>
</ul>
</li>
<li><p><strong>SemLA &#x2F; RFVIF</strong></p>
<ul>
<li>SemLA：在各阶段显式嵌入语义信息，以辅助配准；</li>
<li>RFVIF：针对融合质量做特别优化。</li>
</ul>
</li>
</ul>
<p><strong>定量结论（基于 RoadScene &#x2F; M³FD）</strong>：</p>
<ul>
<li>有真实变形场监督的 <strong>SuperFusion</strong> 在基于参考的指标（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>I</mi></mrow><annotation encoding="application/x-tex">MI</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>I</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">VIF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">CC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">CC</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>A</mi></msub><mi>B</mi><mi mathvariant="normal">/</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">Q_AB/F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>）最强；</li>
<li>风格迁移系列（UMFusion &#x2F; IMF）基于参考指标次优；</li>
<li>潜在空间系列（RFVIF &#x2F; SemLA &#x2F; ReCoNet &#x2F; MURF）在无参考指标（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">EN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">EN</span></span></span></span> &#x2F; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">SF</span></span></span></span> &#x2F; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">SD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> &#x2F; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">AG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">G</span></span></span></span>）上通常更好 → 纹理丰富。</li>
</ul>
<blockquote>
<p>说明：配准质量、融合质量、纹理丰富度、语义表现等之间存在复杂 trade-off。</p>
</blockquote>
<hr>
<h3 id="3-3-2-通用融合框架（General-Fusion）"><a href="#3-3-2-通用融合框架（General-Fusion）" class="headerlink" title="3.3.2 通用融合框架（General Fusion）"></a>3.3.2 通用融合框架（General Fusion）</h3><p>目标：一套框架尽可能适配多种模态、多种任务：</p>
<ul>
<li>IR&#x2F;VIS；</li>
<li>医学多模态（CT&#x2F;MRI&#x2F;PET 等）；</li>
<li>遥感多光谱 &#x2F; 全色等。</li>
</ul>
<p>为了解决多模态图像融合中通用融合框架的核心问题：</p>
<ul>
<li><p>损失函数增强：创新集中在先进的损失度量上，以提高图像质量。</p>
</li>
<li><p>架构创新：升级旨在更好地进行特征提取和提高网络效率。</p>
</li>
</ul>
<h4 id="（1）损失函数创新方向"><a href="#（1）损失函数创新方向" class="headerlink" title="（1）损失函数创新方向"></a>（1）损失函数创新方向</h4><ul>
<li><p><strong>U2Fusion &#x2F; FusionDN &#x2F; PMGI &#x2F; IFCNN &#x2F; SDNet 等</strong></p>
<ul>
<li>从信息论、图像质量评价（IQA）、边缘&#x2F;梯度等角度设计通用损失；</li>
<li>使得同一套损失对多种任务（IVIF、医学融合、曝光融合…）都适用。</li>
</ul>
</li>
<li><p><strong>CoCoNet</strong></p>
<ul>
<li>提出特征级对比学习损失；</li>
<li>通过拉近“好融合样本”与“源图像 &#x2F; 参考”的距离，拉远“差融合样本”；</li>
<li>在无参考指标（EN &#x2F; SF &#x2F; AG）上表现非常突出。</li>
</ul>
</li>
<li><p><strong>EMMA</strong></p>
<ul>
<li>引入伪感知模块（pseudo-perceptual module），通过自监督学习模拟人类感知；</li>
<li>再配合感知损失约束融合结果。</li>
</ul>
</li>
<li><p><strong>FILM</strong></p>
<ul>
<li>利用 LLM 生成语义提示，并通过跨模态注意力引导融合；</li>
<li>把“文本语义”引入通用融合框架中。</li>
</ul>
</li>
</ul>
<h4 id="（2）架构设计方向"><a href="#（2）架构设计方向" class="headerlink" title="（2）架构设计方向"></a>（2）架构设计方向</h4><ul>
<li>多任务共享编码器 + 任务特定解码器；</li>
<li>隐式架构搜索（IAS）：<ul>
<li>TIMFusion 等通过搜索得到既兼顾视觉（指标）又兼顾硬件（延迟）的结构；</li>
</ul>
</li>
<li>多层次分解（基础层 &#x2F; 细节层）+ 双层优化（BIMDL 的思路）。</li>
</ul>
<hr>
<h3 id="3-3-3-对抗攻击与鲁棒性"><a href="#3-3-3-对抗攻击与鲁棒性" class="headerlink" title="3.3.3 对抗攻击与鲁棒性"></a>3.3.3 对抗攻击与鲁棒性</h3><p>对抗攻击是指在图像上添加难以察觉的扰动，很容易欺骗神经网络的估计。网络在多模态视觉下对抗攻击的脆弱性尚未得到广泛研究。考虑到多模态分割在对抗攻击下的鲁棒性，PAIFusion 率先利用图像融合来增强鲁棒性。该工作通过详细分析确定了脆弱的融合操作和规则。</p>
<p>意义：对确保现实世界应用的鲁棒性和安全性至关重要。</p>
<p><strong>问题背景</strong></p>
<ul>
<li>多模态视觉网络也会被对抗攻击欺骗；</li>
<li>如果 IR 或 VIS 某一模态被添加微小扰动，融合结果和下游任务很可能出现严重错误；</li>
<li>IVIF 如何在这种情况下保持鲁棒性，是刚刚起步的方向。</li>
</ul>
<p><img data-src="/./../images/image-20251130100736225.png" alt="image-20251130100736225"></p>
<blockquote>
<p>图7. 数据兼容的红外与可见光图像融合（IVIF）方法的基本分阶段流程。 </p>
</blockquote>
<p><strong>PAIFusion</strong></p>
<ul>
<li>首个系统分析“融合操作 &#x2F; 规则在对抗攻击下的脆弱性”的工作；</li>
<li>利用图像融合增强多模态分割网络在对抗攻击下的鲁棒性；</li>
<li>分析了哪些融合模块容易被攻击、哪些更稳定。</li>
</ul>
<blockquote>
<p>未来研究：<br>设计“对抗鲁棒融合网络”，即使 IR&#x2F;VIS 中有一模态被攻击，融合结果仍可用。</p>
</blockquote>
<hr>
<h2 id="3-4-架构总结与讨论"><a href="#3-4-架构总结与讨论" class="headerlink" title="3.4 架构总结与讨论"></a>3.4 架构总结与讨论</h2><p>论文把现有深度融合网络按结构复杂度和设计思路分为四类：</p>
<ol>
<li><p><strong>使用现有架构</strong>  </p>
<ul>
<li>直接使用 ResNet &#x2F; DenseNet &#x2F; U-Net 等成熟架构；</li>
<li>典型：DenseFuse、RFN-Nest 等；</li>
<li>优点：开发成本低、训练稳定。</li>
</ul>
</li>
<li><p><strong>复杂堆叠网络</strong>  </p>
<ul>
<li>把多种模块（残差块、注意力、Transformer、金字塔、GNN 等）堆在一起；</li>
<li>典型：Re2Fusion、CDDFuse、TGFuse 等；</li>
<li>强调极致性能，但结构复杂，难以部署。</li>
</ul>
</li>
<li><p><strong>多分支 &#x2F; 多批次架构</strong>  </p>
<ul>
<li>为不同模态（IR&#x2F;VIS）设计不同编码器；</li>
<li>常见于任务适配网络（TarDAL &#x2F; DetFusion &#x2F; MoE-Fusion 等）。</li>
</ul>
</li>
<li><p><strong>递归 &#x2F; 扩散结构</strong>  </p>
<ul>
<li>使用递归网络或扩散模型逐步优化融合结果；</li>
<li>典型：ReCoNet、DDFM；</li>
<li>适合质量要求极高或序列数据，但代价是计算量巨大。</li>
</ul>
</li>
</ol>
<p>总体而言，红外和可见光图像融合的研究正朝着更复杂和精细的网络结构发展，以满足复杂的融合需求。</p>
<hr>
<h2 id="3-5-损失函数总结与讨论"><a href="#3-5-损失函数总结与讨论" class="headerlink" title="3.5 损失函数总结与讨论"></a>3.5 损失函数总结与讨论</h2><p>在无监督红外和可见光图像融合领域，损失函数的设计和选择至关重要。</p>
<p>这些函数通常可从像素级别、评估指标和数据特征三个主要维度进行理解和分类。（本节不讨论 GAN 和扩散模型等生成模型）</p>
<p>在像素级别，L1 和 MSE 损失函数通过直接比较像素来评估图像相似性。SSIM 作为关键的评估指标，通过考虑图像结构和质量扩展了这一概念，反映了人类视觉感知。针对数据特征的损失函数（如图像梯度）则侧重于在融合过程中保留详细纹理。</p>
<p>在此基础上，出现了更复杂的损失函数变体来解决图像融合中的特定挑战。例如，在像素级别应用视觉显著性图（VSM）代表了一种创新，产生了更细致的融合效果。在评估指标层面，使用空间频率（SF）等不太常见的指标作为损失函数，强调了图像的频率特征和视觉效果，从而在保持视觉舒适度的同时实现有效融合。此外，基于复杂图像特征的损失函数（如最大化梯度或边缘提取，以及包括感知和对比损失）提供了更深入的见解和解决方案。</p>
<p>损失函数的设计多种多样，除了上述类型，还引入了许多专门设计的损失函数。研究人员可以根据源图像的特征和任务要求选择、组合和优化这些损失函数，推动图像融合领域的进一步发展和创新。</p>
<p><strong>三大维度</strong>：</p>
<ol>
<li><p><strong>像素级损失</strong></p>
<ul>
<li>L1 &#x2F; MSE：直接度量像素差；</li>
<li><strong>SSIM</strong>：考虑结构 &#x2F; 亮度 &#x2F; 对比度，更符合人眼感知。</li>
</ul>
</li>
<li><p><strong>结构 &#x2F; 特征级损失</strong></p>
<ul>
<li>梯度 &#x2F; 边缘损失：保持纹理和边缘清晰；</li>
<li>频域损失（如 SF）：强调细节和高频信息；</li>
<li>视觉显著性图（VSM）：对显著区域赋予更大权重；</li>
<li>NR-IQA（无参考图像质量评价）指标也被用作损失（FusionDN 等）。</li>
</ul>
</li>
<li><p><strong>语义 &#x2F; 对比 &#x2F; 感知损失</strong></p>
<ul>
<li>语义损失：利用分类 &#x2F; 检测 &#x2F; 分割网络的中间特征；</li>
<li>对比损失：CoCoNet、EMMA 等充分利用；</li>
<li>感知损失：基于 VGG 等预训练网络的高维特征差异；</li>
<li>任务驱动损失：检测 &#x2F; 分割的任务损失直接反向训练融合网络（TarDAL、SeAFusion、SegMiF 等）。</li>
</ul>
</li>
</ol>
<blockquote>
<p>实际做法：<br>通常是多种损失混合加权，通过验证集（包括感知指标）来调整权重。</p>
</blockquote>
<hr>
<h1 id="4-基准数据集与评估指标"><a href="#4-基准数据集与评估指标" class="headerlink" title="4. 基准数据集与评估指标"></a>4. 基准数据集与评估指标</h1><h2 id="4-1-数据集概览"><a href="#4-1-数据集概览" class="headerlink" title="4.1 数据集概览"></a>4.1 数据集概览</h2><p><img data-src="/./../images/image-20251130101340887.png" alt="image-20251130101340887"></p>
<blockquote>
<p>图8. 现有红外-可见光图像融合（IVIF）数据集示意图</p>
</blockquote>
<p><img data-src="/./../images/image-20251130101421522.png" alt="image-20251130101421522"></p>
<p>大致分三类：</p>
<h3 id="4-1-1-早期面向融合的数据集"><a href="#4-1-1-早期面向融合的数据集" class="headerlink" title="4.1.1 早期面向融合的数据集"></a>4.1.1 早期面向融合的数据集</h3><ul>
<li><p><strong>TNO</strong></p>
<ul>
<li>军事 &#x2F; 户外场景；</li>
<li>图像对数较少（261 对），分辨率较低（768×576）；</li>
<li>常用作视觉效果展示与定性评估。</li>
</ul>
</li>
<li><p><strong>RoadScene</strong></p>
<ul>
<li>道路驾驶场景，包含不同天气；</li>
<li>图像数量 221 对，分辨率不固定；</li>
<li>更接近自动驾驶场景。</li>
</ul>
</li>
<li><p><strong>VIFB</strong></p>
<ul>
<li>整理多个来源数据；</li>
<li>更偏向“benchmark 性质”，用于对比传统方法。</li>
</ul>
</li>
</ul>
<h3 id="4-1-2-目标检测数据集"><a href="#4-1-2-目标检测数据集" class="headerlink" title="4.1.2 目标检测数据集"></a>4.1.2 目标检测数据集</h3><ul>
<li><p><strong>MS</strong></p>
<ul>
<li>多光谱目标检测数据集；</li>
<li>主要是驾驶场景，包含 6 类目标；</li>
<li>有标注框，可用于检测任务。</li>
</ul>
</li>
<li><p><strong>LLVIP</strong></p>
<ul>
<li>监控场景，1280×720 分辨率；</li>
<li>主要关注行人检测；</li>
<li>适合做低光 &#x2F; 夜间监控场景研究。</li>
</ul>
</li>
<li><p><strong>M³FD</strong></p>
<ul>
<li>当前最重要的 IVIF 检测数据集；</li>
<li>4200 对图像，1024×768 分辨率，多角度拍摄；</li>
<li>涵盖白天 &#x2F; 夜晚 &#x2F; 雾 &#x2F; 雨等多种天气；</li>
<li>标注 6 类目标，含 3 万+ 标注框；</li>
<li>大量任务驱动方法（TarDAL &#x2F; DetFusion 等）都在上面评测。</li>
</ul>
</li>
</ul>
<h3 id="4-1-3-语义分割数据集"><a href="#4-1-3-语义分割数据集" class="headerlink" title="4.1.3 语义分割数据集"></a>4.1.3 语义分割数据集</h3><ul>
<li><p><strong>MFNet</strong></p>
<ul>
<li>1569 对图像，640×480 分辨率；</li>
<li>驾驶场景，8 类语义标签；</li>
<li>适用于 RGB-T 语义分割研究。</li>
</ul>
</li>
<li><p><strong>FMB</strong></p>
<ul>
<li>1500 对图像，800×600 分辨率；</li>
<li>多角度，14 类语义标签；</li>
<li>由 SegMiF 提出，专门用于“融合 + 分割”的联合评估。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="4-2-评估指标"><a href="#4-2-评估指标" class="headerlink" title="4.2 评估指标"></a>4.2 评估指标</h2><h3 id="4-2-1-融合质量指标（9-个）"><a href="#4-2-1-融合质量指标（9-个）" class="headerlink" title="4.2.1 融合质量指标（9 个）"></a>4.2.1 融合质量指标（9 个）</h3><p><strong>有参考（基于源图像）</strong>：</p>
<ol>
<li><p><strong>MI（Mutual Information，互信息）</strong>  </p>
<p>衡量源图像信息被传递到融合图的程度（信息量）；</p>
</li>
<li><p><strong>VIF（Visual Information Fidelity）</strong>  </p>
<p>评估融合的保真度，与人类视觉系统对齐，值越高表示性能越好；</p>
</li>
<li><p><strong>CC（Correlation Coefficient）</strong>  </p>
<p>评估融合图像对源图像的反映程度，侧重于线性相关性；</p>
</li>
<li><p><strong>SCD（Sum of Correlation of Differences）</strong>  </p>
<p>衡量源图像独特信息的整合情况。CC 强调现有关系，而 SCD 关注新元素；</p>
</li>
<li><p><strong><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Q</mi><mi>A</mi></msub><mi>B</mi><mi mathvariant="normal">/</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">Q_AB/F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span></span>（基于梯度的融合质量指标）</strong>  </p>
<p>看边缘 &#x2F; 梯度细节是否得到良好保留（越接近 1 越好）。</p>
</li>
</ol>
<p><strong>无参考指标</strong>：</p>
<ol start="6">
<li><strong>EN（Entropy，熵）</strong>：衡量融合图像中的信息内容（信息量大小）（但对噪声敏感）；</li>
<li><strong>SF（Spatial Frequency，空间频率）</strong>：评估细节和纹理的清晰度，值越高表示边缘和纹理信息越丰富；</li>
<li><strong>SD（Standard Deviation，标准差）</strong>：从分布和对比度方面反映图像质量，对比度越高，SD 值越大；</li>
<li><strong>AG（Average Gradient，平均梯度）</strong>：衡量纹理特征和细节，AG 值越高表示融合性能越好。</li>
</ol>
<blockquote>
<p>注意：EN &#x2F; SF &#x2F; AG 等指标高不一定就好，有可能是噪声多。</p>
</blockquote>
<hr>
<h3 id="4-2-2-配准指标"><a href="#4-2-2-配准指标" class="headerlink" title="4.2.2 配准指标"></a>4.2.2 配准指标</h3><ol>
<li><p><strong>MSE（Mean Squared Error）</strong>  </p>
<p>测量两幅图像像素之间的平均平方差，用于评估它们的对齐程度。MSE 值越低，表示相似度越高，是图像配准和融合中的关键指标；</p>
</li>
<li><p><strong>MI（互信息）</strong>  </p>
<p>是图像配准中常用的相似性指标。MI 值越高，表明两幅图像对齐越好；</p>
</li>
<li><p><strong>NCC（Normalized Cross Correlation）</strong>  </p>
<p>是评估两幅图像中对应窗口相似性的指标，用于评价配准精度。</p>
</li>
</ol>
<hr>
<h3 id="4-2-3-感知任务指标"><a href="#4-2-3-感知任务指标" class="headerlink" title="4.2.3 感知任务指标"></a>4.2.3 感知任务指标</h3><ul>
<li><p><strong>语义分割</strong></p>
<ul>
<li>IoU &#x2F; mIoU：交并比及其类别平均；</li>
<li>Acc &#x2F; mAcc：像素准确率及其类别平均。</li>
</ul>
</li>
<li><p><strong>目标检测</strong></p>
<ul>
<li>Precision &#x2F; Recall：精确率 &#x2F; 召回率；</li>
<li>AP &#x2F; mAP：单类 &#x2F; 多类平均精度。</li>
</ul>
</li>
</ul>
<blockquote>
<p>评估时最好把“融合指标 + 感知指标”一起看，单纯依赖 MI &#x2F; VIF 容易误判。</p>
</blockquote>
<hr>
<h1 id="5-性能总结与消融对比"><a href="#5-性能总结与消融对比" class="headerlink" title="5. 性能总结与消融对比"></a>5. 性能总结与消融对比</h1><h2 id="5-1-图像融合质量（TNO-RoadScene-M³FD）"><a href="#5-1-图像融合质量（TNO-RoadScene-M³FD）" class="headerlink" title="5.1 图像融合质量（TNO &#x2F; RoadScene &#x2F; M³FD）"></a>5.1 图像融合质量（TNO &#x2F; RoadScene &#x2F; M³FD）</h2><p><strong>定性分析</strong></p>
<p><img data-src="/./../images/image-20251130101959966.png" alt="image-20251130101959966"></p>
<ul>
<li>在 M³FD 的烟雾场景中对比多种方法：<ul>
<li>IGNet：为了压制烟雾，倾向 IR 模态，结果颜色失真严重；</li>
<li>CoCoNet：人物和背景车都清楚，但草地区域发生明显颜色偏差；</li>
<li>CAF &#x2F; MoEFusion：在压制烟雾的同时，保持颜色自然。</li>
</ul>
</li>
</ul>
<p><strong>定量分析</strong></p>
<p><img data-src="/./../images/image-20251130102235155.png" alt="image-20251130102235155"></p>
<ul>
<li><p>参考指标：</p>
<ul>
<li>使用传统基于源图像损失函数的方法（如 DenseFuse 的 CC 指标）由于充分保留了源图像信息而具有显著优势；</li>
<li>针对分割进行优化的方法在视觉保真度指标（如 PromptF 的 VIF 指标）上也表现出优势；</li>
<li>原因：它们充分利用了语义信息。</li>
</ul>
</li>
<li><p>无参考指标：</p>
<ul>
<li>CoCoNet 利用特征级对比损失优化整个训练过程，其表示能力远超传统损失函数，从而在性能上脱颖而出。</li>
<li>说明对比学习在无 GT 场景中的优势。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="5-2-未对齐图像融合性能（RoadScene-M³FD）"><a href="#5-2-未对齐图像融合性能（RoadScene-M³FD）" class="headerlink" title="5.2 未对齐图像融合性能（RoadScene &#x2F; M³FD）"></a>5.2 未对齐图像融合性能（RoadScene &#x2F; M³FD）</h2><p><strong>定性结果</strong></p>
<p><img data-src="/./../images/image-20251130102417905.png" alt="image-20251130102417905"></p>
<blockquote>
<p>图10. 未对齐的多模态图像在两个典型图像对上的表现，与多种最新的图像融合方法进行了对比。</p>
</blockquote>
<ul>
<li>SuperFusion &#x2F; UMFusion &#x2F; IMF 等提供了比较好的配准与融合效果：<ul>
<li>有效消除结构失真与边缘重影；</li>
</ul>
</li>
<li>潜在空间系列（RFVIF &#x2F; SemLA &#x2F; ReCoNet &#x2F; MURF）仍有少量残留变形，但纹理更丰富。</li>
</ul>
<p><strong>定量结果</strong></p>
<p><img data-src="/./../images/image-20251130102532854.png" alt="image-20251130102532854"></p>
<ul>
<li>SuperFusion 凭借真实变形场监督，在 MI &#x2F; VIF &#x2F; CC &#x2F; Q_AB&#x2F;F 上表现最佳；</li>
<li>UMFusion &#x2F; IMF 在大多数参考指标上次优；</li>
<li>MURF 等在无参考指标（EN &#x2F; SF &#x2F; SD &#x2F; AG）表现更好。</li>
</ul>
<blockquote>
<p>结论：风格迁移 + 潜在空间方法各有优劣；<br>若能结合两者优势，可能得到更通用的未配准融合框架。</p>
</blockquote>
<hr>
<h2 id="5-3-面向目标检测的融合性能（M³FD-YOLOv5）"><a href="#5-3-面向目标检测的融合性能（M³FD-YOLOv5）" class="headerlink" title="5.3 面向目标检测的融合性能（M³FD + YOLOv5）"></a>5.3 面向目标检测的融合性能（M³FD + YOLOv5）</h2><p><strong>定性对比</strong></p>
<p><img data-src="/./../images/image-20251130102609933.png" alt="image-20251130102609933"></p>
<ul>
<li>小目标场景（桥上行人 + 雾 &#x2F; 强光）：<ul>
<li>DDFM &#x2F; LRRNet &#x2F; ReCoNet：对比度低，小目标不突出；</li>
<li>DDcGAN &#x2F; IRFS：伪影明显，引入错误检测；</li>
<li>TarDAL &#x2F; PAIFusion：行人全部被检出，小目标召回高。</li>
</ul>
</li>
</ul>
<p><strong>定量结果</strong></p>
<p><img data-src="/./../images/image-20251130102629383.png" alt="image-20251130102629383"></p>
<ul>
<li>TarDAL 在 mAP 上最高，特别是 People、Car、Bus 等重点类别；</li>
<li>TIMFusion &#x2F; SegMiF &#x2F; SDNet 等感知驱动方法也有不错表现；</li>
<li>一些视觉上很优的 GAN &#x2F; 扩散方法，在检测任务上并不占优势。</li>
</ul>
<blockquote>
<p>进一步说明：“<strong>任务驱动训练的融合方法 &gt; 只看图像指标的融合方法</strong>”。</p>
</blockquote>
<hr>
<h2 id="5-4-面向语义分割的融合性能（FMB-SegFormer）"><a href="#5-4-面向语义分割的融合性能（FMB-SegFormer）" class="headerlink" title="5.4 面向语义分割的融合性能（FMB + SegFormer）"></a>5.4 面向语义分割的融合性能（FMB + SegFormer）</h2><p>统一使用先进的 SegFormer 作为基础分割器，在一致的设置下对各种先进融合方法进行训练，以衡量它们的性能。采用 FMB 数据集的官方训练集和测试集划分。</p>
<p><strong>定性比较</strong>：</p>
<p><img data-src="/./../images/image-20251130103612720.png" alt="image-20251130103612720"></p>
<blockquote>
<p>图12. 基于图像融合的语义分割结果与几种最先进的方法进行了比较</p>
</blockquote>
<p>在这个场景中，由于能见度低，位于黑暗区域的行人对大多数方法来说都难以准确分割。同时，公交车发出的强光导致场景过曝，使得许多方法将公交车误分类为汽车，且无法捕捉其完整轮廓。这些挑战凸显了处理极端光照条件场景的持续困难。</p>
<p><strong>定量比较</strong>：在表 6 中，我们报告了语义分割任务的数值结果。</p>
<p><img data-src="/./../images/image-20251130103701946.png" alt="image-20251130103701946"></p>
<ul>
<li><p>实验设置：</p>
<ul>
<li>采用 SegFormer 作为统一分割器；</li>
<li>各融合方法先生成融合图，再用融合图训练 SegFormer；</li>
<li>使用 FMB 官方划分训练 &#x2F; 测试。</li>
</ul>
</li>
<li><p>观察结论：</p>
<ul>
<li>MoEFusion &#x2F; DetFusion &#x2F; SegMiF &#x2F; MRFS 等任务驱动方法在 mIoU &#x2F; mAcc 上表现最优；</li>
<li>单纯视觉驱动的融合方法在极端光照（黑夜 &#x2F; 强光）场景的分割边界上有明显误差；</li>
<li>再次验证：<strong>语义信息（分割 &#x2F; 检测）对融合网络设计有直接帮助。</strong></li>
</ul>
</li>
</ul>
<hr>
<h2 id="5-5-计算效率与资源消耗"><a href="#5-5-计算效率与资源消耗" class="headerlink" title="5.5 计算效率与资源消耗"></a>5.5 计算效率与资源消耗</h2><p><img data-src="/./../images/image-20251130103948338.png" alt="image-20251130103948338"></p>
<p>论文统计了在 M³FD 上处理 10 张 1024×768 图像的三项指标：</p>
<ul>
<li>运行时间（ms）  </li>
<li>参数量（M）  </li>
<li>FLOPs（G）</li>
</ul>
<p><strong>总体趋势：</strong></p>
<ul>
<li>DenseFuse &#x2F; U2Fusion 等早期方法结构简单，速度最快，参数最少，但性能略落后；</li>
<li>Transformer &#x2F; 扩散模型（如 DDFM）计算开销巨大，运行时间可达数十万 ms，不适合实时应用；</li>
<li>TIMFusion 借助隐式架构搜索，在速度与性能间做了一个比较好的平衡；</li>
<li>任务驱动方法通常比纯视觉优化方法稍重，但收益体现在感知任务上。</li>
</ul>
<blockquote>
<p>实际应用（自动驾驶 &#x2F; 边缘设备）中，需要注意<br>“mAP &#x2F; mIoU 与 FPS &#x2F; 耗能之间的 trade-off”。</p>
</blockquote>
<hr>
<h1 id="6-挑战与未来研究方向"><a href="#6-挑战与未来研究方向" class="headerlink" title="6. 挑战与未来研究方向"></a>6. 挑战与未来研究方向</h1><p>论文最后总结了若干重要开放问题，这里挑与 IVIF 强相关的部分：</p>
<h2 id="6-1-未配准-对抗鲁棒性"><a href="#6-1-未配准-对抗鲁棒性" class="headerlink" title="6.1 未配准 &amp; 对抗鲁棒性"></a>6.1 未配准 &amp; 对抗鲁棒性</h2><ul>
<li>未对齐问题：<ul>
<li>当前方法只能应对“中等程度”的视角偏差；</li>
<li>大视角变化、非刚性形变、动态场景仍待解决。</li>
</ul>
</li>
<li>对抗攻击：<ul>
<li>多模态网络在对抗扰动下表现不明朗；</li>
<li>如何“利用多模态互补性提升鲁棒性”是值得深入挖掘的问题。</li>
</ul>
</li>
</ul>
<h2 id="6-2-任务驱动的融合设计"><a href="#6-2-任务驱动的融合设计" class="headerlink" title="6.2 任务驱动的融合设计"></a>6.2 任务驱动的融合设计</h2><ul>
<li>传统：只优化融合指标；</li>
<li>未来：以 Detection &#x2F; Segmentation &#x2F; Tracking &#x2F; SOD 等任务的表现为第一目标；</li>
<li>关键挑战：<ul>
<li>怎样设计 loss 与网络结构，使视觉质量和任务性能不过分冲突；</li>
<li>怎样在多任务（检测+分割+跟踪）联合训练时避免互相干扰。</li>
</ul>
</li>
</ul>
<h2 id="6-3-更大、更真实、更难的数据集"><a href="#6-3-更大、更真实、更难的数据集" class="headerlink" title="6.3 更大、更真实、更难的数据集"></a>6.3 更大、更真实、更难的数据集</h2><ul>
<li>现有数据集在场景多样性、极端天气、复杂动态环境方面仍然有限；</li>
<li>期待：<ul>
<li>城市 &#x2F; 高速 &#x2F; 隧道 &#x2F; 森林 &#x2F; 灾害现场等多场景大规模多模态数据；</li>
<li>带有检测 &#x2F; 分割 &#x2F; 深度 &#x2F; SOD 等多任务标注的统一数据集。</li>
</ul>
</li>
</ul>
<h2 id="6-4-更合理的评价体系"><a href="#6-4-更合理的评价体系" class="headerlink" title="6.4 更合理的评价体系"></a>6.4 更合理的评价体系</h2><ul>
<li>单一的 EN &#x2F; SF &#x2F; AG 等指标无法全面反映质量；</li>
<li>单看 mAP &#x2F; mIoU 也不能体现“观感差异”；</li>
<li>未来可能需要：<ul>
<li>结合 IQA &#x2F; VQA &#x2F; 感知指标的综合评分体系；</li>
<li>甚至“人 + 模型”的混合评价框架。</li>
</ul>
</li>
</ul>
<h2 id="6-5-轻量化与部署友好"><a href="#6-5-轻量化与部署友好" class="headerlink" title="6.5 轻量化与部署友好"></a>6.5 轻量化与部署友好</h2><ul>
<li>Transformer &#x2F; 扩散 &#x2F; GAN 型网络部署到无人机、车载、智能相机时常常超出算力预算；</li>
<li>可能方向：<ul>
<li>网络剪枝、蒸馏、权值共享；</li>
<li>硬件感知的 NAS &#x2F; IAS；</li>
<li>面向 IR&#x2F;VIS 特性的专用算子设计。</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>论文阅读</category>
      </categories>
      <tags>
        <tag>多光谱目标检测</tag>
        <tag>IVIF任务</tag>
      </tags>
  </entry>
  <entry>
    <title>【论文阅读 | TCSVT 2024 | MMI-Det：探索可见光与红外目标检测的多模态融合】</title>
    <url>/2025/10/14/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20TCSVT%202024%20%20MMI-Det%EF%BC%9A%E6%8E%A2%E7%B4%A2%E5%8F%AF%E8%A7%81%E5%85%89%E4%B8%8E%E7%BA%A2%E5%A4%96%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E7%9A%84%E5%A4%9A%E6%A8%A1%E6%80%81%E8%9E%8D%E5%90%88%E3%80%91/</url>
    <content><![CDATA[<p>[TOC]</p>
<p><img data-src="/./../images/image-20251014174923042-1760435411753-1.png" alt="image-20251014174923042"></p>
<p>题目：MMI-Det: Exploring Multi-Modal Integration for<br>Visible and Infrared Object Detection</p>
<p>期刊：TCSVT(IEEE Transactions on Circuits and Systems for Video Technology)</p>
<p>论文链接：<a href="https://ieeexplore.ieee.org/document/10570450">Link</a></p>
<p>关键词：Multi-spectral object detection(多光谱目标检测), multi-modal integration(多模态融合), image fusion(图像融合), Fourier transformation(傅里叶变换).</p>
<p>代码：开源</p>
<p>年份：2024</p>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>可见光-红外(VIS-IR)目标检测是一项具有挑战性的目标检测任务，其通过融合<strong>可见光(RGB)图像数据</strong>和<strong>红外(IR)图像数据</strong>，以提供场景中目标的类别和位置信息。因此，该任务的核心在于融合可见光和红外模态中的<strong>互补</strong>信息，从而为检测提供更优的目标检测结果。现有方法主要面临对可见光-红外模态信息的感知与融合能力不足，以及难以平衡融合与检测任务优化方向的问题。为解决这些问题，我们提出了<strong>MMI-Det</strong>，一种用于可见光-红外目标检测的多模态融合方法。该方法能够实现可见光-红外模态中互补信息的良好融合，并输出准确且鲁棒的目标信息。具体而言，为提升模型在可见光-红外图像层面的环境感知能力，我们设计了<strong>轮廓增强模块(Contour Enhancement Module)</strong>。此外，为从可见光和红外模态中提取互补信息，我们设计了<strong>融合聚焦模块(Fusion Focus Module)</strong>，该模块能够提取可见光和红外模态的不同频率谱特征，并聚焦于不同空间位置的目标关键信息。同时，我们设计了<strong>对比度桥接模块(Contrast Bridge Module)</strong>，以提升在可见光-红外场景中提取模态不变特征的能力。最后，为确保模型能够平衡图像融合与目标检测的优化方向，我们设计了<strong>信息引导模块(Info Guided Module)</strong>，以提升模型训练优化的有效性。我们在公开的FLIR、M3FD、LLVIP、TNO和MSRS数据集上进行了大量实验，与现有方法相比，我们的方法凭借强大的多模态信息感知能力取得了更优的性能。</p>
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><h3 id="先前方法"><a href="#先前方法" class="headerlink" title="先前方法"></a>先前方法</h3><p>目标检测是计算机视觉领域的一个基本问题。为了确认和定位图像中某些特定类别的实例，目标检测已经被研究了许多年。然而，现有方法主要聚焦于可见光(RGB)下的目标检测，因此这便限制了目标检测的检测范围——难以在夜间准确识别目标。为了实现全天候、动态环境下的目标检测，满足多领域的需求，可见光-红外目标检测因具有更广泛的应用前景而被提出，并日益受到该领域研究者的关注。可见光-红外目标检测需要融合两种模态下目标的互补信息，以感知场景中目标的位置和类别。然而，由于两种模态之间存在较大的异质性差异，如何感知并提取模态间的关键信息成为一个具有挑战性的问题。</p>
<p>可见光和红外线这两种模态的图像之间存在显著差异。为了补充这些差异显著的可见光-红外图像的信息，目前一些可见光-红外(VIS-IR)目标检测方法采用两阶段方法设计模型，此方法可概括为“先融合，后检测”。这些方法通过设计多种图像融合策略生成包含更丰富信息的融合图像，并基于这些融合图像，利用单模态目标检测方法对融合图像中的目标进行检测。然而当前的实现方法将融合与检测划分为两个独立的优化任务，难以保持两个任务的优化方向一致。因此这些方法可能导致更差的检测结果。因此，如何使模型能够充分提取两种模态的互补信息，为后续检测任务提供更丰富的目标特征信息，已成为一个重要问题。</p>
<p>为了解决可见光-红外目标检测中的上述问题，我们尝试设计一种利用多级模态融合的新架构。在本文中，我们提出一种针对可见光和红外目标的多模态融合方法：<strong>MMI-Det</strong></p>
<h3 id="主要贡献"><a href="#主要贡献" class="headerlink" title="主要贡献"></a>主要贡献</h3><ul>
<li><p>我们提出了<strong>MMI-Det</strong>，一种用于VIS-IR目标检测的新框架。该框架提供了一种联合优化融合与检测任务的解决方案，从而实现了准确且鲁棒的多光谱目标检测结果。在公开数据集(FLIR、M3FD、LLVIP、TNO、MSRS)上进行的大量实验证明了我们的<strong>MMI-Det</strong> 的有效性，其性能优于先前的方法；</p>
</li>
<li><p>我们提出<strong>轮廓增强模块(Contour Enhancement Module)</strong>，该模块有助于方法感知复杂动态场景中物体的轮廓，并提升目标检测性能；</p>
</li>
<li><p>我们设计了<strong>融合聚焦模块(Fusion Focus Module)</strong>，以使得该方法能够在不同空间区域下感知并融合可见光-红外模态的目标细节信息；</p>
</li>
<li><p><strong>对比度桥接模块(Contrast Bridge Module)</strong> 旨在利用对比学习的思想，将可见光-红外数据分离为正负样本对。其能够引导模型提升在可见光-红外场景中感知模态不变特征的能力；</p>
</li>
<li><p><strong>信息引导模块(Info Guided Module)</strong> 旨在引导我们的模型在训练过程中更有效地融合两种模态的特征信息。</p>
</li>
</ul>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><h3 id="先前方法-1"><a href="#先前方法-1" class="headerlink" title="先前方法"></a>先前方法</h3><h4 id="A-图像融合"><a href="#A-图像融合" class="headerlink" title="A. 图像融合"></a>A. 图像融合</h4><p>目前已经有许多较为成熟的图像融合方法：</p>
<ul>
<li><strong>CCAFusion</strong>由Li 等人提出，设计了一种基于坐标注意力的跨模态图像融合策略，该策略由特征感知融合模块和特征增强融合模块组成；</li>
<li><strong>UNFusion</strong>由Wang 等人提出，他们引入了一个统一的多尺度密集连接融合网络，使用一个多尺度编码-解码架构来提取和重建多尺度深度特征；</li>
<li><strong>Laplacian pyramid fusion network</strong>由Yao 等人提出利用层级指导来使用像素级的可见性保留的Laplacian 阳光来生成层级可见性地图；</li>
<li><strong>DATFuse</strong>由Tang 等人提出，它引入了一个用于重要特征提取的双注意力残余模块来实现图像融合；</li>
<li><strong>Unsupervised Image Fusion Network</strong>由Xu 等人提出，该网络可通过特征提取和信息测量源图像的重要性；</li>
<li><strong>Deep Network Cascade Feature Learning Module</strong>由Liu 等人提出。他们的方法采用了一种从粗到细的深度架构来从多模态图像中学习多尺度特征；</li>
<li>Tang 等人受生物视觉系统的启发，深入研究了早期视觉信息处理的建模机制建模。他们的可见光-红外图像融合方法利用了两种模式的优势。他们随后提出了一种光感知渐进式图像融合网络，称为 PIAF融合网络。</li>
</ul>
<p>然而，尽管上述方法探索了可见光红外图像融合的各种潜力，但这些方法将融合和检测分为两个独立的优化任务，很难保持两个任务的优化方向一致。<br>这意味着图像融合的最佳区域通常不是物体检测的最佳区域，从而导致图像融合效果不理想。</p>
<h4 id="B-多光谱目标检测"><a href="#B-多光谱目标检测" class="headerlink" title="B. 多光谱目标检测"></a>B. 多光谱目标检测</h4><p>多光谱目标检测方法采用<strong>两阶段训练</strong>方式，将<strong>融合</strong>与<strong>检测</strong>看作两个独立的任务分别进行优化，这可能导致两者之间的优化目标不一致。研究人员，意识到这一局限性，因此开发了新的多光谱目标检测方法，将图像融合与检测整合到一个统一的框架中。</p>
<ul>
<li><p>Wagner等人提出了一种<strong>融合-精化(fuse-and-refine)方法</strong>，该方法采用循环图像融合方式，通过迭代精化每个光谱特征以提升检测性能；</p>
</li>
<li><p>Fang等人则采用了不同的方法，将<strong>Transformer</strong>与<strong>YOLO检测框架</strong>相结合，设计了一种适用于可见光-红外(VIS-IR)检测任务的多光谱检测方法；</p>
</li>
<li><p>Yun等人提出了<strong>跨模态与模态内加权交叉融合网络(Infusion-Net)</strong>，该网络通过利用可见光-红外图像对的优势来增强目标检测性能；</p>
</li>
<li><p>Zhou等人提出了一种<strong>可见光-红外特征融合网络</strong>，该网络通过双边逆融合提取目标边界，并通过多级融合捕获互补信息。</p>
</li>
</ul>
<p>然而，尽管这些方法将融合与检测任务整合到单一建模框架中，但它们在探索面向检测的可见光-红外模态特征融合方面仍存在不足，且在自主且全面地融合多光谱信息方面尚未得到充分研究。因此，如何使模型充分提取两种模态的互补信息，为后续检测任务提供更丰富的目标特征信息，成为一个重要问题。</p>
<h4 id="C-基于频率的特征提取方法"><a href="#C-基于频率的特征提取方法" class="headerlink" title="C. 基于频率的特征提取方法"></a>C. 基于频率的特征提取方法</h4><p>频域分析作为图像信号处理领域的基石，在图像分类、纹理提取、图像融合以及超分辨率等众多领域发挥了重要作用。</p>
<ul>
<li><p>为解决人脸活体检测问题，Stuchi等人提出了一种基于<strong>傅里叶分析</strong>的特征提取方法。</p>
</li>
<li><p>Xiao等人设计的<strong>FAFusion</strong>通过提取可见光-红外图像对中的高频信息来感知物体边缘和纹理细节，从而增强融合图像的细节。</p>
</li>
<li><p>此外，针对图像超分辨率问题，Li等人设计了一种基于频域变换的网络，该网络利用卷积定理将空间域的卷积运算转化为频域的乘积运算。</p>
</li>
<li><p>Fang等人提出了一种基于高频Transformer的网络，用于磁共振图像的超分辨率重建。</p>
</li>
</ul>
<p>尽管上述方法已从不同角度研究了多种基于频率的特征提取方法，但如何在可见光-红外场景中利用频域分析以提升模型在复杂场景中感知物体位置和轮廓的能力仍有待进一步探索和研究。</p>
<h4 id="不足"><a href="#不足" class="headerlink" title="不足"></a>不足</h4><p>总而言之，现有方法存在的不足主要聚焦于以下方面：</p>
<ol>
<li><strong>模态信息感知与融合能力不足</strong>：可见光（380-780nm）侧重纹理色彩，细节偏多，红外（760nm-1mm）侧重温度差异，注重目标，二者异质性强，现有方法难以充分提取互补特征，甚至融合后会削弱目标判别性。</li>
<li><strong>融合与检测任务优化方向失衡</strong>：传统 “先融合后检测” 的两阶段方法，将融合和检测视为独立任务，优化目标不一致；“单阶段联合模型” 虽整合两者，但未深入探索 “面向检测的模态融合”，对于多光谱信息的利用不够充分。</li>
</ol>
<h3 id="本文所提出的方法"><a href="#本文所提出的方法" class="headerlink" title="本文所提出的方法"></a>本文所提出的方法</h3><h4 id="A-整体流程"><a href="#A-整体流程" class="headerlink" title="A. 整体流程"></a>A. 整体流程</h4><p>输入可见光（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">X_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）和红外图像（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">X_I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）→ 经轮廓增强模块（CEM）提取目标轮廓 → 经 FOC 模块降维 + Conv&#x2F;C3 模块增强特征 → 对比桥接模块（CBM）学习模态不变特征信息 → 融合聚焦模块（FFM）融合多模态特征 → 多次循环后经 Detect Head 输出结果 → 信息引导模块（IGM）平衡图像融合与目标检测优化方向 → 检测头输出目标类别与位置</p>
<p><img data-src="/./../images/image-20251019205013680.png" alt="image-20251019205013680"></p>
<h4 id="B-总体结构"><a href="#B-总体结构" class="headerlink" title="B. 总体结构"></a>B. 总体结构</h4><ul>
<li>基于双流YOLOv5框架</li>
</ul>
<h5 id="轮廓增强模块-Contour-Enhancement-Module（CEM）"><a href="#轮廓增强模块-Contour-Enhancement-Module（CEM）" class="headerlink" title="轮廓增强模块 Contour Enhancement Module（CEM）"></a>轮廓增强模块 Contour Enhancement Module（CEM）</h5><p>在输入模态上用 <strong>2D 卷积</strong>和 <strong>LeakyReLU</strong> 激活函数初步提取并增加特征通道，将传统的<strong>固定轮廓增强算子</strong>改为<strong>强度自适应算子（IAO）</strong>，通过<strong>自适应参数 a</strong> 提升模型对复杂<strong>动态场景中物体轮廓感知能力</strong>，多个 IAO 在不同深度组合并利用残差连接优化，帮助模型浅层整合模态信息。</p>
<p><img data-src="/./../images/image-20251019205357623.png" alt="image-20251019205357623"></p>
<p>轮廓增强模块。(a) 自适应经典算子变换。该模块的策略：先将经典算子与输入图像进行卷积，再通过自适应学习调整结果。(b) 强度自适应算子，其中8个算子形成一个自适应二维卷积，基于当前环境自适应地增强模型对目标的轮感知能力，直接用强度自适应算子与输入图像卷积，然后将不同深度的特征图经残差连接融合，形成多尺度特征表示，以实现精确的可见光-红外目标检测。</p>
<p>对于输入图像，令V和I分别表示可见光图像和红外图像。则可见光图像的输入可表示为</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>X</mi><mi>V</mi></msub><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mi>V</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>V</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>C</mi><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">
X_V = \{x_V | x_V \in \mathbb{R}^{C \times H \times W}\}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>
<p>红外图像的输入可表示为</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>X</mi><mi>I</mi></msub><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mi>I</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>I</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>C</mi><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">
X_I = \{x_I | x_I \in \mathbb{R}^{C \times H \times W}\}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>
<p>其中C、H和W分别对应图像的通道、高度和宽度。</p>
<p>在一个批次的训练过程中，共有B幅图像，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>V</mi></msubsup></mrow><annotation encoding="application/x-tex">x_i^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>I</mi></msubsup></mrow><annotation encoding="application/x-tex">x_i^I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span>的数量相同，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>B</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">i \in \{1, 2, \ldots, B/2\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">/2</span><span class="mclose">}</span></span></span></span>。输入的可见光-红外图像将首先通过轮廓增强模块(Contour Enhancement Module)，如下式所示：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>C</mi><mi>E</mi><mi>M</mi></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>C</mi><mi>E</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mtext>V</mtext></msub><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>C</mi><mi>E</mi><mi>M</mi></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>C</mi><mi>E</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mtext>I</mtext></msub><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{split}
F_{\text{V}}^{CEM} &amp;= CEM(X_{\text{V}}), \\
F_{\text{I}}^{CEM} &amp;= CEM(X_{\text{I}}).
\end{split}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1027em;vertical-align:-1.3013em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8013em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">CEM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3587em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">CEM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3013em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8013em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">CEM</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.3587em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">CEM</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3013em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>在此，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>C</mi><mi>E</mi><mi>M</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">F_{\text{V}}^{CEM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1167em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">CEM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>C</mi><mi>E</mi><mi>M</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">F_{\text{I}}^{CEM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1167em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">CEM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span>表示经过CEM处理后的可见光-红外特征。接下来，为了使特征在不丢失过多信息的前提下能够在计算上进行降维，我们引入了FOC，该方法使用切片操作，将高分辨率特征图分割为多个低分辨率特征图。FOC的这种策略性分割以紧凑形式保留了关键空间信息，在促进更快处理的同时，保持了准确目标检测所需的特征完整性。这些FOC模块的输出特征被输入至Conv和C3模块。C3采用多尺度特征融合方法和跨通道信息传递机制来提升特征表示能力。通过将FOC与C3有效结合，网络同时受益于降维和特征丰富性，从而提升了检测性能。需要注意的是，FOC和C3均已在YOLOv5中可用。该过程如下所示：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>C</mi><mn>3</mn><mo stretchy="false">(</mo><mtext>Conv</mtext><mo stretchy="false">(</mo><mtext>FOC</mtext><mo stretchy="false">(</mo><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>C</mi><mi>E</mi><mi>M</mi></mrow></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>C</mi><mn>3</mn><mo stretchy="false">(</mo><mtext>Conv</mtext><mo stretchy="false">(</mo><mtext>FOC</mtext><mo stretchy="false">(</mo><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>C</mi><mi>E</mi><mi>M</mi></mrow></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{split}
F_{\text{V}}^{C3} &amp;= C3(\text{Conv}(\text{FOC}(F_{\text{V}}^{CEM}))), \\
F_{\text{I}}^{C3} &amp;= C3(\text{Conv}(\text{FOC}(F_{\text{I}}^{CEM}))).
\end{split}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1027em;vertical-align:-1.3013em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8013em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3587em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3013em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8013em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">3</span><span class="mopen">(</span><span class="mord text"><span class="mord">Conv</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">FOC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">CEM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)))</span><span class="mpunct">,</span></span></span><span style="top:-2.3587em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">3</span><span class="mopen">(</span><span class="mord text"><span class="mord">Conv</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">FOC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">CEM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)))</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3013em;"><span></span></span></span></span></span></span></span></span></span></span></span>

<p>公式2中的Conv模块和C3模块能够提升模型的特征提取能力。为了引导模型进行有效的训练优化，我们借鉴对比学习的思想设计了对比桥接模块(Contrastive Bridge Module, CBM)，并设计了损失函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{CB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub><mo>=</mo><mi>C</mi><mi>B</mi><mi>M</mi><mo stretchy="false">(</mo><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{CB} = CBM(F_{\text{V}}^{C3}, F_{\text{I}}^{C3}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">CBM</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<h5 id="融合聚焦模块-Fusion-Focus-Module（FFM）"><a href="#融合聚焦模块-Fusion-Focus-Module（FFM）" class="headerlink" title="融合聚焦模块 Fusion Focus Module（FFM）"></a>融合聚焦模块 Fusion Focus Module（FFM）</h5><p>该模块结合<strong>频谱提取</strong>、<strong>模式判别</strong>和 <strong>Transformer</strong>。</p>
<ul>
<li>频谱提取模块依<strong>傅里叶变换</strong>提取高低频特征分离细节与背景信息；</li>
<li>模式判别模块融合多种特征并通过损失函数促进特征分化与空间注意力生成；</li>
<li>Transformer 自注意力机制融合互补信息，增强模型对不同模态特征提取融合能力。</li>
</ul>
<p><img data-src="/./../images/image-20251020075327237.png" alt="image-20251020075327237"></p>
<p>上图展示了融合聚焦模块。FFM 从频谱提取模块开始、提取特征的高频信息以获取物体的细节信息。其在频谱提取模块先将图像从空间域转换到频域，再提取频域中的高频信息，然后通过逆快速傅里叶变换（IFFT）将频域信息转换回空间域。频谱提取模块输出的特征进入此模块，模块内有损失函数用于优化特征的判别能力，还有多个线性层和归一化操作，用于进一步处理特征，通过这些操作增强特征的空间感知能力，使得目标检测准确进行。在特征融合与输出部分，经过模式判别模块处理的特征进入 Transformer 块，在其中可见光和红外特征被合并，最终分别输出可见光和红外特征经过 FFM 处理后的结果。</p>
<p>在这个过程中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{CB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>可用作损失函数以引导模型学习模态不变信息。经过上述模块后，可见光特征<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">F_{\text{V}}^{C3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1167em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span>与红外特征<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">F_{\text{I}}^{C3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1167em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span>被输入至融合聚焦模块(Fusion Focus Module, FFM)。MMI-Det设计了多个FFM用于不同深度的特征融合。具体而言，FFM的结构如下式所示：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>F</mi><mi>F</mi><mi>M</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>F</mi><mi>F</mi><mi>M</mi></mrow></msubsup><mo>=</mo><mi>F</mi><mi>F</mi><mi>M</mi><mo stretchy="false">(</mo><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
F_{\text{V}}^{FFM}, F_{\text{I}}^{FFM} = FFM(F_{\text{V}}^{C3}, F_{\text{I}}^{C3}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1383em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FFM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FFM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">FFM</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>

<p>FFM 充分融合两种模态特征，并将融合后的特征反馈至两个分支。它们与在各自的分支上的特征相加，并一同被发送至下一个特征提取-融合阶段：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>F</mi><mi>F</mi><mi>M</mi></mrow></msubsup><mo>+</mo><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>F</mi><mi>F</mi><mi>M</mi></mrow></msubsup><mo>+</mo><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>C</mi><mn>3</mn></mrow></msubsup><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>F</mi><mtext>V-I</mtext><mrow><mi>a</mi><mi>d</mi><msub><mi>d</mi><mn>1</mn></msub></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow></msubsup><mo>+</mo><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow></msubsup><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
F_{\text{V}}^{add} &amp;= F_{\text{V}}^{FFM} + F_{\text{V}}^{C3}, \\
F_{\text{I}}^{add} &amp;= F_{\text{I}}^{FFM} + F_{\text{I}}^{C3}, \\
F_{\text{V-I}}^{add_1} &amp;= F_{\text{V}}^{add} + F_{\text{I}}^{add}.
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.7092em;vertical-align:-2.1046em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6046em;"><span style="top:-4.7055em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">dd</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1464em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">dd</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.5554em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.931em;"><span style="top:-2.4065em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V-I</span></span></span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1046em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6046em;"><span style="top:-4.7055em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FFM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-3.1464em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FFM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-1.5554em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">dd</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">dd</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1046em;"><span></span></span></span></span></span></span></span></span></span></span></span>

<p>在上式中，相加特征<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mtext>V</mtext><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">F_{\text{V}}^{add}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">dd</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mtext>I</mtext><mrow><mi>a</mi><mi>d</mi><mi>d</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">F_{\text{I}}^{add}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">I</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">dd</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span>被传送到后续阶段，我们设计了共<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>组此类阶段，以从不同深度充分提取两种模态中的目标信息。当前阶段的融合特征将被保存为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mtext>V-I</mtext><mrow><mi>a</mi><mi>d</mi><msub><mi>d</mi><mn>1</mn></msub></mrow></msubsup></mrow><annotation encoding="application/x-tex">F_{\text{V-I}}^{add_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2245em;vertical-align:-0.2935em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.931em;"><span style="top:-2.4065em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V-I</span></span></span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span></span></span></span>。最终结果通过检测头(Detect Head)输出，如下图所示。相关公式如下：</p>
<p><img data-src="/./../images/image-20251014201352915.png" alt="image-20251014201352915"></p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mi>r</mi><mi>e</mi><mi>d</mi><mo>=</mo><mi>D</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>H</mi><mi>e</mi><mi>a</mi><mi>d</mi><mo stretchy="false">(</mo><msubsup><mi>F</mi><mtext>V-I</mtext><mrow><mi>a</mi><mi>d</mi><msub><mi>d</mi><mn>1</mn></msub></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mtext>V-I</mtext><mrow><mi>a</mi><mi>d</mi><msub><mi>d</mi><mn>2</mn></msub></mrow></msubsup><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msubsup><mi>F</mi><mtext>V-I</mtext><mrow><mi>a</mi><mi>d</mi><msub><mi>d</mi><mi>i</mi></msub></mrow></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
Pred = DetectHead(F_{\text{V-I}}^{add_1}, F_{\text{V-I}}^{add_2}, \ldots, F_{\text{V-I}}^{add_i}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">re</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2245em;vertical-align:-0.2935em;"></span><span class="mord mathnormal">De</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">t</span><span class="mord mathnormal">He</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.931em;"><span style="top:-2.4065em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V-I</span></span></span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.931em;"><span style="top:-2.4065em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V-I</span></span></span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.931em;"><span style="top:-2.4065em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">V-I</span></span></span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>

<h5 id="对比度桥接模块-Contrast-Bridge-Module（CBM）"><a href="#对比度桥接模块-Contrast-Bridge-Module（CBM）" class="headerlink" title="对比度桥接模块 Contrast Bridge Module（CBM）"></a>对比度桥接模块 Contrast Bridge Module（CBM）</h5><p>一句话概括便是——学习模态不变特征，缩小模态差距</p>
<p>基于对比学习思想，构建正负样本对：将同组 VIS-IR 特征设为正样本（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi><mi>i</mi><mi>r</mi><msup><mi>s</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">Pairs^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">ai</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>），不同组设为负样本（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi><mi>i</mi><mi>r</mi><msup><mi>s</mi><mo>−</mo></msup></mrow><annotation encoding="application/x-tex">Pairs^-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">ai</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span></span></span></span>），用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{CB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>损失优化：让正样本特征距离更近、负样本距离更远，引导模型自主发现模态共性（如目标边界梯度）。即计算样本对距离并构建对比损失函数，引导模型自主发现模态不变信息，提升对复杂场景适应能力。</p>
<h6 id="对比学习机制的工作原理"><a href="#对比学习机制的工作原理" class="headerlink" title="对比学习机制的工作原理"></a>对比学习机制的工作原理</h6><p>对比学习机制就像是让机器学会“找不同”和“找相同”。</p>
<p>找不同（负样本对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi><mi>i</mi><mi>r</mi><msup><mi>s</mi><mo>−</mo></msup></mrow><annotation encoding="application/x-tex">Pairs^-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">ai</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span></span></span></span>）</p>
<p><strong>1数据准备</strong></p>
<p>我们有可见光图像和红外图像（呈现热量分布的图像）。</p>
<p>从这两种图像里找出不同的东西组成一对，这就是负样本对。比如可见光图像里是个人，红外图像里是辆车，这就是一对负样本。</p>
<p><strong>2学习过程</strong></p>
<p>机器要学习把这对负样本中的特征尽量分得开。想象一下，机器要把可见光里的人和红外里的车看成完全不一样的东西。</p>
<p>这样，机器在处理新的图像时，就能很容易区分出不同的物体了。</p>
<p>找相同（正样本对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi><mi>i</mi><mi>r</mi><msup><mi>s</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">Pairs^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">ai</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>）</p>
<p><strong>1数据准备</strong></p>
<p>还是从可见光和红外图像里找，不过这次是找相同的东西组成一对，这就是正样本对。比如可见光图像里是个人，红外图像里也是这个人，这就是一对正样本。</p>
<p><strong>2学习过程</strong></p>
<p>机器要学习把这对正样本中的特征尽量拉得近。就好像机器要知道，不管是在可见光里还是红外里，这个人都是同一个人。这样，机器在处理新的图像时，就能很容易认出同一个物体了。</p>
<p>通过不断地这样 “找不同” 和 “找相同”，机器就能更好地理解和处理可见光和红外图像，在目标检测、识别等任务中表现得更好</p>
<h5 id="信息引导模块-Info-Guided-Module（IGM）"><a href="#信息引导模块-Info-Guided-Module（IGM）" class="headerlink" title="信息引导模块 Info Guided Module（IGM）"></a>信息引导模块 Info Guided Module（IGM）</h5><p>基于 FFM 输入输出的结构相似性和信息熵设计损失函数，通过调整权重因子平衡两者贡献，引导模型有效学习复杂模态信息，平衡图像融合与目标检测优化方向。</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>I</mi><mi>G</mi></mrow></msub><mo>=</mo><mi>I</mi><mi>G</mi><mi>M</mi><mo stretchy="false">(</mo><msubsup><mi>F</mi><mi>V</mi><mrow><mi>C</mi><mn>3</mn></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mi>I</mi><mrow><mi>C</mi><mn>3</mn></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mi>V</mi><mrow><mi>F</mi><mi>F</mi><mi>M</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mi>I</mi><mrow><mi>F</mi><mi>F</mi><mi>M</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{IG} = IGM(F_V^{C3}, F_I^{C3}, F_V^{FFM}, F_I^{FFM})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.10903em;">GM</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FFM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FFM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p>由上式可得知， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>I</mi><mi>G</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{IG}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是由C3模块和FFM模块决定的。简单来说，模块可以在运行时自调节自优化，这尤其体现在多模态融合和目标检测方面。</p>
<p>具体来说，IGM 函数可能会根据这些特征的结构相似性信息熵等指标来计算损失，以确保模型在融合多模态信息时能够有效地平衡图像融合与目标检测的优化方向。</p>
<h4 id="C-总损失函数"><a href="#C-总损失函数" class="headerlink" title="C.总损失函数"></a>C.总损失函数</h4><p>通过加权组合各模块损失，实现多任务联合优化：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi mathvariant="script">L</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi mathvariant="script">L</mi><mrow><mi>I</mi><mi>G</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msub><mi mathvariant="script">L</mi><mrow><mi>P</mi><mi>D</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>4</mn></msub><msub><mi mathvariant="script">L</mi><mrow><mi>D</mi><mi>e</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{total} = \beta_1\mathcal{L}_{CB} + \beta_2\mathcal{L}_{IG} + \beta_3\mathcal{L}_{PD} + \beta_4\mathcal{L}_{Det}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">De</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>其中：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><mo>=</mo><msub><mi>β</mi><mn>3</mn></msub><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\beta_1=\beta_2=\beta_3=0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.1</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>4</mn></msub><mo>=</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">\beta_4=1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.0</span></span></span></span>（检测损失权重最高，确保检测性能）；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>D</mi><mi>e</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{Det}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">De</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为 YOLOv5 原检测损失（边界框 + 类别 + 置信度损失）。</p>
<h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p>论文在 5 个公开数据集（FLIR、M3FD、LLVIP、TNO、MSRS）上做了全面实验，核心结果如下：</p>
<h3 id="1-定量实验：性能领先"><a href="#1-定量实验：性能领先" class="headerlink" title="1. 定量实验：性能领先"></a>1. 定量实验：性能领先</h3><p>对比单模态（YOLOv5&#x2F;YOLOv7）、两阶段（如 U2Fusion、SwinFusion）和单阶段（如 CFT、Infusion-Net）方法，MMI-Det 在关键指标（mAP50、mAP）上均最优，以代表性数据集为例：</p>
<ul>
<li><strong>FLIR 数据集</strong>（驾驶场景）：MMI-Det 的 mAP50 达 79.8%，超过 Infusion-Net（79.1%）和 CFT（78.7%）；</li>
<li><strong>M3FD 数据集</strong>（多场景）：MMI-Det 的 mAP50 达 76.6%，mAP 达 42.7%，且 GFLOPs（229.2）低于 SwinFusion（764.8），兼顾性能与效率；</li>
<li><strong>LLVIP 数据集</strong>（安防场景）：mAP50 达 98.9%，mAP75 达 73.5%，在低光场景下表现突出。</li>
</ul>
<h3 id="2-消融实验：模块必要性验证"><a href="#2-消融实验：模块必要性验证" class="headerlink" title="2. 消融实验：模块必要性验证"></a>2. 消融实验：模块必要性验证</h3><p>逐一添加模块到基线模型（YOLOv5 双分支），结果证明各模块均有贡献：</p>
<ul>
<li>仅加 CEM：mAP 从 40.8% 提升至 41.2%，验证轮廓增强的作用；</li>
<li>加 CEM+FFM：mAP 提升至 42.4%，体现融合模块的核心价值；</li>
<li>加全模块：mAP 达 42.7%，且参数（207.6M）和计算量（229.2 GFLOPs）可控，证明模块协同有效性。</li>
</ul>
<h3 id="3-定性实验：复杂场景鲁棒性"><a href="#3-定性实验：复杂场景鲁棒性" class="headerlink" title="3. 定性实验：复杂场景鲁棒性"></a>3. 定性实验：复杂场景鲁棒性</h3><p>在雾、烟、远距离重叠等场景中，MMI-Det 优势明显：</p>
<ul>
<li>雾天 &#x2F; 烟场景：传统方法（如 ICAFusion、UNFuse）易漏检或误检（如将远山轮廓判为行人），MMI-Det 通过 CEM 和 FFM，能准确捕捉目标轮廓；</li>
<li>远距离重叠场景：U2Fusion 等两阶段方法因优化失衡漏检，MMI-Det 通过 IGM 平衡任务，实现精准检测。</li>
</ul>
]]></content>
      <categories>
        <category>论文阅读</category>
      </categories>
      <tags>
        <tag>多光谱目标检测</tag>
        <tag>多模态融合</tag>
        <tag>图像融合</tag>
        <tag>傅里叶变换</tag>
      </tags>
  </entry>
  <entry>
    <title>【论文阅读 | Inf. Fusion 2025 | MS2Fusion：多重光谱状态空间特征融合】</title>
    <url>/2025/10/30/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20Inf.%20Fusion%202025%20%20MS2Fusion%EF%BC%9A%E5%A4%9A%E9%87%8D%E5%85%89%E8%B0%B1%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E3%80%91/</url>
    <content><![CDATA[<p>[TOC]</p>
<p><img data-src="/./../images/image-20251029230125038-1761991594416-18-1765726490765-36-1765726786789-87.png" alt="image-20251029230125038"></p>
<p>题目：Multispectral State-Space Feature Fusion: Bridging Shared and Cross-Parametric Interactions for Object Detection</p>
<p>期刊：Inf. Fusion(Information Fusion)</p>
<p>论文链接：<a href="https://arxiv.org/abs/2507.14643">Link</a></p>
<p>关键词：Multispectral Object Detection(多光谱目标检测), State Space Model(状态空间模型), Shared-Parameter(共享参数), Cross-Parameter Interaction(跨参数交互).</p>
<p>代码：<a href="https://github.com/61s61min/MS2Fusion.git">GitHub</a></p>
<p>年份：2025</p>
<hr>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>现代多光谱特征融合用于目标检测面临两个关键限制：</p>
<ul>
<li>过度偏好局部互补特征而非跨模态共享语义，这对泛化性能产生不利影响；</li>
<li>感受野大小与计算复杂度之间的权衡，成为可扩展特征建模的关键瓶颈。</li>
</ul>
<blockquote>
<p>感受野大小：模型中单个神经元（或特征图上的单个像素）在原始输入图像上能够 “感知” 到的区域大小</p>
</blockquote>
<p>为解决这些问题，基于<strong>状态空间模型（SSM）</strong>，提出了一种新颖的多光谱状态空间特征融合框架，称为<strong>MS2Fusion</strong>，该框架通过<strong>双路径参数交互机制</strong>实现高效且有效的融合。</p>
<p>具体而言：</p>
<ol>
<li><p>第一个交叉参数交互分支继承了交叉注意力在挖掘互补信息方面的优势，并结合了SSM中的跨模态隐藏状态解码；</p>
</li>
<li><p>第二个共享参数分支通过SSM中的参数共享，利用联合嵌入探索跨模态对齐，以获取跨模态的相似语义特征和结构；</p>
</li>
<li><p>最后，对这两条路径进行联合优化。通过SSM在统一框架中融合多光谱特征，使MS2Fusion能够兼具功能互补性和共享语义空间。</p>
</li>
</ol>
<p>得益于双分支SSM的设计，MS2Fusion<strong>同时继承了计算效率和全局感受野</strong>，显著提升了多光谱目标检测的性能。实验表明，MS2Fusion在强大的基线模型上持续表现更优：</p>
<ul>
<li>在目标检测（FLIR）中，<a href="mailto:&#109;&#x41;&#80;&#64;&#48;&#x2e;&#x35;">mAP@0.5</a>提升了3.3%；</li>
<li>在RGB-T语义分割（MFNet）中，mIoU提高了2.8%；</li>
<li>在显著目标检测（VT5000）中，MAE降低了0.7%。</li>
</ul>
<p>值得注意的是，无需进行特定任务的修改，MS2Fusion就在多个多光谱感知任务上取得了新的最先进结果，展现出卓越的泛化能力。</p>
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><h3 id="多光谱目标检测优势"><a href="#多光谱目标检测优势" class="headerlink" title="多光谱目标检测优势"></a>多光谱目标检测优势</h3><p>近年来多光谱目标检测得到了越来越多的关注，这得益于其通过融合多个光谱波段（如RGB和热波段（即IR)）的信息所实现的鲁棒性能。</p>
<h3 id="单模态缺陷"><a href="#单模态缺陷" class="headerlink" title="单模态缺陷"></a>单模态缺陷</h3><p>RGB图像通常具有高分辨率，颜色丰富和纹理特征细腻的特点。但在弱光、恶劣天气或遮挡等复杂场景下，其性能会急剧下降。相比之下，热图像能够有效克服这些环境限制，但在颜色和纹理细节方面存在明显不足。当前通用的单模态目标检测方法难以很好地应对上述挑战。然而，多光谱特征融合为在这类具有挑战性的条件下提供可靠的目标检测解决方案开辟了道路。</p>
<p><img data-src="/./../images/image-20251030092635833-1761991594416-19-1765726490765-38-1765726786789-88.png" alt="image-20251030092635833"></p>
<p>图1：RGB图像（左）和热成像图像（右）的优缺点；（a）两种模态提供互补信息，它们的融合能够实现更稳健的目标检测；（b）双模态共享特征变得至关重要，因为两种模态中没有一种具有绝对优势。（例如，纹理和热辐射等模态特定特征变得模糊，而物体轮廓和结构等跨模态一致特征有助于检测）</p>
<p>如图1a所示，现有研究普遍认为，当一种模态不足时，互补特征发挥着关键作用。例如，当热成像物体缺乏清晰轮廓时，RGB图像能提供具有区分性的颜色和纹理线索；而当RGB成像受到低光照或遮挡影响时，热成像图像则能提供热特征。</p>
<p>然而，如图1b所示，在两种模态均表现出较弱区分性特征的场景中（例如，RGB图像中的纹理模糊和热成像图像中的低对比度），仅靠互补信息无法解决问题。在这些情况下，跨模态一致的形状和结构模式等共享特征变得至关重要，因为它们能够捕捉模态不变的表征，以实现可靠的检测。因此，作者推测，一个强大的多光谱目标检测框架应该<strong>动态地利用互补特征和共享特征</strong>，以应对各种来自现实世界的挑战。</p>
<blockquote>
<p>互补特征：指不同光谱模态（如 RGB 与热成像）各自具备、可相互补充的独特信息。</p>
</blockquote>
<blockquote>
<p>共享特征：不同光谱模态间共有的、具备模态不变性的信息，通常对应物体的通用语义或结构属性，如物体的轮廓、形状、整体结构等。</p>
</blockquote>
<h3 id="先前研究的不足"><a href="#先前研究的不足" class="headerlink" title="先前研究的不足"></a>先前研究的不足</h3><p>先前的研究主要集中于跨模态的互补特征学习，往往忽视了对模态间共享特征表示或固有结构相似性的探索。</p>
<p><strong>概括：重互补而轻共享，导致了泛化能力不足</strong></p>
<p>此外，现有方法通常采用单一的融合策略来直接组合多模态输入，忽略了自适应或分层融合机制的潜在优势。这些方法没有充分探索或利用跨模态共享特征，忽视了提升单模态特征性能的潜在作用。这种融合模式在跨模态整合过程中常常会压制较弱但具有判别性的特征，导致大量信息丢失。</p>
<p><strong>概括：融合策略单一，没有自适应机制</strong></p>
<p>对于多光谱目标检测而言，共享特征表示在多模态融合中起着关键作用。它不仅能减轻跨模态差异，还能增强单模态特征，从而在复杂环境中显著提高特征表达能力和检测鲁棒性。</p>
<h3 id="CNN与Transformer之缺陷"><a href="#CNN与Transformer之缺陷" class="headerlink" title="CNN与Transformer之缺陷"></a>CNN与Transformer之缺陷</h3><p>大多数主流方法采用CNN或Transformer进行特征融合。尽管这些方法有效，但现有的基于CNN的方法由于感受野有限，往往难以捕捉跨模态的更广泛上下文信息。另一方面，尽管基于Transformer的方法在建模全局依赖关系方面表现出色，但随着输入序列变长，其性能可能会下降，并且随着模型复杂度的增加，计算成本也会更高。这些因素限制了它们在资源受限环境中的实用性，凸显了在多光谱目标检测中需要更高效的融合策略。</p>
<p><strong>概括：感受野有限，上下文有限，输入越大性能越低</strong></p>
<h3 id="现阶段状况"><a href="#现阶段状况" class="headerlink" title="现阶段状况"></a>现阶段状况</h3><ul>
<li><p>多光谱目标检测领域近年来取得了一些进展，但现有方法仍主要侧重于<strong>学习跨模态的互补特征</strong>，忽视了对共享特征表示和固有结构相似性的探索。</p>
</li>
<li><p>大多数现有方法采用单一且直接的融合策略，这往往会抑制具有辨别力但较弱的特征，并导致大量有效信息丢失。</p>
</li>
<li><p>基于CNN的方法在捕捉跨模态上下文时受限于感受野，而基于Transformer的技术则存在计算效率低下的问题，且在处理长序列时性能会下降。</p>
</li>
<li><p>在语音识别和图像压缩中，特征表示的效率直接决定了系统性能——这一原则同样适用于多光谱检测。因此要增强系统性能即需要提高特征表示的效率。</p>
</li>
</ul>
<p>这些局限性凸显了对一种更具适应性和效率的融合范式的需求，这种范式不仅要<strong>弥合模态差异</strong>，还要<strong>通过共享表示增强单模态特征</strong>，最终提高在复杂环境中的鲁棒性。</p>
<h3 id="MS2Fusion的提出"><a href="#MS2Fusion的提出" class="headerlink" title="MS2Fusion的提出"></a>MS2Fusion的提出</h3><p>序列建模领域的最新进展表明，基于SSM的方法通过将特征压缩为紧凑的隐藏状态而表现出色，能够以恒定时间进行全序列处理，实现高效推理。Mamba通过选择性状态空间增强了这一点，动态保留与任务相关的特征。Vision Mamba（Vim）进一步证明了其在视觉任务中的有效性，同时提升了效率和性能。</p>
<blockquote>
<p>序列建模领域：专注于处理具有时序或空间顺序数据（如文本序列、图像像素序列、多模态特征序列等）的技术领域，其核心目标是通过建模数据间的顺序依赖关系，实现对数据特征的有效提取、压缩与利用。</p>
</blockquote>
<p>受此启发，本文作者提出了<strong>MS2Fusion</strong>，这是一个新颖的框架，它能同时利用跨模态的互补特征和共享特征，同时克服卷积神经网络（CNN）和Transformer在多光谱特征融合方面的局限性。</p>
<h3 id="MS2Fusion的优势体现"><a href="#MS2Fusion的优势体现" class="headerlink" title="MS2Fusion的优势体现"></a>MS2Fusion的优势体现</h3><h4 id="据图分析"><a href="#据图分析" class="headerlink" title="据图分析"></a>据图分析</h4><p><img data-src="/./../images/image-20251030102737886-1761991594416-20-1765726490765-35-1765726786789-86.png" alt="image-20251030102737886"></p>
<p>这张图比较三种<strong>多模态特征融合方法</strong> （主要用于红外图像 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 与可见光图像 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 的融合）：</p>
<hr>
<h5 id="a-Transformer-based-fusion"><a href="#a-Transformer-based-fusion" class="headerlink" title="(a) Transformer-based fusion"></a>(a) Transformer-based fusion</h5><ul>
<li><strong>原理</strong>：将 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 和 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 输入到 Transformer 编码器，通过 <strong>多头注意力机制 (Multi-Head Attention)</strong> 实现信息交互。</li>
<li><strong>特点</strong>：能有效捕捉两种模态的互补特征，但计算开销较大。</li>
<li><strong>优点</strong>：融合充分，性能较好。</li>
<li><strong>缺点</strong>：注意力机制成本高，且可能对对齐和噪声敏感。</li>
</ul>
<hr>
<h5 id="b-Mamba-based-fusion"><a href="#b-Mamba-based-fusion" class="headerlink" title="(b) Mamba-based fusion"></a>(b) Mamba-based fusion</h5><ul>
<li><strong>原理</strong>：直接将 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 和 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 输入线性层生成状态空间模型 (SSM) 的参数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi></mrow><annotation encoding="application/x-tex">\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span>)。</li>
<li><strong>特点</strong>：融合过程简洁，但缺乏细粒度的模态交互。</li>
<li><strong>缺点</strong>：容易出现<strong>模态错位（misalignment）<strong>与</strong>特征冗余（redundancy）</strong>。</li>
</ul>
<blockquote>
<p>模态错位（misalignment）：不同模态（例如红外图像和可见光图像）之间信息不对应、空间或语义不对齐的情况。两种模态“看”的不是同一个位置或语义点，融合错了对象。</p>
</blockquote>
<blockquote>
<p>特征冗余（redundancy）：指不同模态中存在重复或相似的特征信息，导致融合后的表示中有大量“重复内容”。即两种模态提供了“重复的信息”，融合后没增加有效信息量，反而增加噪声。</p>
</blockquote>
<hr>
<h5 id="c-MS2Fusion（作者提出的方法）"><a href="#c-MS2Fusion（作者提出的方法）" class="headerlink" title="(c) MS2Fusion（作者提出的方法）"></a>(c) MS2Fusion（作者提出的方法）</h5><ul>
<li><p><strong>步骤</strong>：</p>
<ol>
<li>对每个模态内部先进行 <strong>Intra-modal Interaction（模态内交互）</strong> → 加强自身特征；</li>
<li>提取 <strong>Shared features（共享特征）</strong>；</li>
<li>再进行 <strong>Cross-modal Interaction（模态间交互）</strong> → 实现深层融合；</li>
<li>输出统一融合特征 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F_{fused}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>)。</li>
</ol>
</li>
<li><p><strong>特点</strong>：通过先内后外的双层交互机制（模态内→模态间），获得更好的模态对齐与特征统一。</p>
</li>
<li><p><strong>优势</strong>：融合更稳健、信息更充分，减少特征重复与模态偏差。</p>
</li>
</ul>
<hr>
<p>简单总结：Transformer融合注重全局注意力、Mamba融合侧重线性高效计算，而MS2Fusion通过“模态内增强 + 模态间共享”双阶段策略，实现了更精确、鲁棒的多模态特征融合。</p>
<hr>
<p>通过本图2与实验数据即可得出MS2Fusion的优势</p>
<p>图2显示，基于Transformer的方法（a）和现有的Mamba解决方案（b）未能充分利用跨模态共享特征。相比之下，MS2Fusion方法（c）通过三个关键组件<strong>明确地对互补性和共享性的跨模态交互进行建模</strong>：</p>
<ul>
<li><strong>跨参数状态空间模型 (CP-SSM)</strong>：通过在特定模态的状态空间之间交换输出矩阵来促进隐式的特征互补，从而在保留特定模态特征的同时实现跨模态特征丰富；</li>
<li><strong>共享参数状态空间模型 (SP-SSM)</strong>：通过参数共享学习一个统一的特征空间，对齐异构模态分布，以提取能够增强单一模态特征的、有区别性的共享表示；</li>
<li><strong>特征融合状态空间模型 (FF-SSM)</strong>：引入一种双向输入机制以扩展状态空间的有效感受野 (ERF)，在减轻特征衰减的同时，实现跨模态信息的自适应融合。</li>
</ul>
<p>有效感受野分析（ERF）也可表明MS2Fusion有效性</p>
<p><img data-src="/./../images/image-20251030104145257-1761991594416-21-1765726490765-37-1765726786789-90.png" alt="image-20251030104145257"></p>
<p>图3：基于CNN的融合方法（a）、基于Transformer的融合方法（b）以及所提出的MS2Fusion方法（c）的有效感受野可视化对比。定量分析表明，与其他方法相比，MS2Fusion实现了显著更广泛的感受野覆盖。</p>
<p>由图3可得知，与CNN和Transformer相比，MS2Fusion实现了更出色的空间覆盖范围，成功地将局部细节与全局语境相结合。</p>
<p>简单来说，MS2Fusion模块在保持高计算效率的同时，有效解决了CNN在建模长距离依赖关系方面的限制。实验表明（依据下表数据），与Transformer和CNN基线相比，MS2Fusion均能以更低的计算成本和参数量实现更高的检测精度（mAP50分别提升8.3和9.0个点），且处理速度与CNN相当，远快于Transformer。这些证据表明MS2Fusion成功打破了多光谱目标检测中传统的效率-精度权衡，确立了新的SOTA性能。</p>
<p>表1：不同多光谱特征融合方法的比较（YoloV5框架，FLIR数据集）</p>
<table>
<thead>
<tr>
<th align="center">模型</th>
<th align="center">GFLOPs</th>
<th align="center">Params (M)</th>
<th align="center">FPS</th>
<th align="center"><a href="mailto:&#109;&#65;&#x50;&#64;&#x30;&#x2e;&#x35;">mAP@0.5</a></th>
<th align="center"><a href="mailto:&#109;&#65;&#80;&#x40;&#48;&#x2e;&#x37;&#53;">mAP@0.75</a></th>
<th align="center">mAP</th>
</tr>
</thead>
<tbody><tr>
<td align="center">CNN</td>
<td align="center">190.3</td>
<td align="center">159.7</td>
<td align="center">30.8</td>
<td align="center">74.3</td>
<td align="center">23.8</td>
<td align="center">32.5</td>
</tr>
<tr>
<td align="center">Transformer</td>
<td align="center">421.9</td>
<td align="center">440.6</td>
<td align="center">19.2</td>
<td align="center">75.0</td>
<td align="center">24.1</td>
<td align="center">33.4</td>
</tr>
<tr>
<td align="center">MS2Fusion</td>
<td align="center">140.8</td>
<td align="center">130.3</td>
<td align="center">29.7</td>
<td align="center">83.3</td>
<td align="center">33.0</td>
<td align="center">40.3</td>
</tr>
</tbody></table>
<h3 id="MS2Fusion的优势来源"><a href="#MS2Fusion的优势来源" class="headerlink" title="MS2Fusion的优势来源"></a>MS2Fusion的优势来源</h3><p>MS2Fusion引入了一种新颖的状态空间框架。其<strong>CP-SSM</strong>捕捉了隐含的特征互补性，而<strong>SP-SSM</strong>增强了共享表示，在特定模态学习和跨模态学习之间实现了最佳平衡。</p>
<ul>
<li><p>出于将全局上下文建模与计算效率相结合的需求，FF-SSM机制独特地实现了Transformer级别的感受野，同时保持了类CNN的效率。这一突破解决了多模态系统中性能与计算成本之间长期存在的权衡问题。</p>
</li>
<li><p>MS2Fusion架构提供灵活的多模态集成，支持各种检测框架和骨干网络。它能无缝处理RGB、热成像和其他模态，无需更改架构即可在不同视觉任务中广泛应用。</p>
</li>
<li><p>MS2Fusion在基准数据集上实现了最先进的性能，包括RGB-T目标检测、语义分割和显著目标检测，验证了其在多光谱图像感知方面的有效性。</p>
</li>
</ul>
<h2 id="相关工作"><a href="#相关工作" class="headerlink" title="相关工作"></a>相关工作</h2><h3 id="目标检测"><a href="#目标检测" class="headerlink" title="目标检测"></a>目标检测</h3><ul>
<li><strong>主流方法</strong>：主要分为两大类：<ul>
<li><strong>两阶段检测器</strong> （如 Faster R-CNN）：先生成候选区域，再进行分类和边界框回归，通常精度较高。</li>
<li><strong>单阶段检测器</strong> （如 YOLO、SSD）：直接在图像上进行检测，速度更快。</li>
</ul>
</li>
<li><strong>边界框预测机制</strong>：<ul>
<li>**基于锚点（Anchor-based）**方法：利用预定义的锚点进行回归调整。</li>
<li>**无锚点（Anchor-free）**方法（如 FCOS）：直接预测边界或中心，简化流程，效率更高。</li>
</ul>
</li>
<li><strong>新兴的基于 Transformer 的方法</strong>：<ul>
<li><strong>DETR</strong>：引入 Transformer 实现完全端到端检测，将检测视为集合预测问题，消除了锚点和 NMS 等人工设计组件。但存在计算成本高和收敛慢的问题。</li>
</ul>
</li>
<li><strong>本文方法的优势</strong>：为验证所提方法（MS2Fusion，结合上下文推测）的有效性，选择了 <strong>YOLOv5</strong> 和 <strong>CoDetr</strong> 进行对比实验，结果显示该方法具有<strong>线性时间复杂度</strong> （高效率）和<strong>全局感受野</strong> （捕获更丰富上下文信息）两大优势。</li>
</ul>
<h3 id="多光谱目标检测"><a href="#多光谱目标检测" class="headerlink" title="多光谱目标检测"></a>多光谱目标检测</h3><ul>
<li><strong>早期方法</strong>：侧重于平衡特征集成，例如<strong>循环融合模块 (Cyclic Fusion Module)</strong> 显式建模模态间的互补性和一致性。</li>
<li><strong>注意力机制的引入</strong>：通过 <strong>引导注意力特征融合 (GAFF)</strong> 等方法，利用自适应的模态内和跨模态注意力动态加权特征，提高了融合性能。</li>
<li><strong>基于 Transformer 的架构</strong>：<strong>跨模态融合 Transformer (CFT)</strong> 和 <strong>CMX</strong> 等利用自注意力机制捕获跨模态的<strong>长距离依赖</strong>和全局上下文；后续的 <strong>ICAFusion</strong> 和 <strong>INSANet</strong> 等变体则通过参数共享或专用光谱注意力块优化了效率和灵活性。</li>
<li><strong>解决特定挑战的创新方法</strong>：<ul>
<li><strong>DAMSDet</strong> 使用可变形交叉注意力处理模态<strong>不对齐</strong>和动态互补特性。</li>
<li><strong>MS-DETR</strong> 引入<strong>参考约束融合</strong>改进 RGB-热成像对齐。</li>
<li><strong>轻量级设计</strong>，如 <strong>CPCF 模块</strong>，结合通道和块级交叉注意力实现高效融合。</li>
<li><strong>TFDet</strong> 采用融合-精修范式以自适应感受野抑制假阳性。</li>
<li><strong>MMFN</strong> 提出了一个全面的<strong>分层融合框架</strong>，整合了局部、全局和通道级交互。</li>
</ul>
</li>
<li><strong>本文方法的区别</strong>：所提出的方法采用一种<strong>新颖的状态空间模型 (SSM)</strong> 进行特征融合，这与以往使用 <strong>CNN</strong> 或 <strong>Transformer</strong> 进行特征融合的方法不同。</li>
</ul>
<h3 id="Mamba"><a href="#Mamba" class="headerlink" title="Mamba"></a>Mamba</h3><ul>
<li><strong>Mamba 模型</strong>：<ul>
<li>Mamba 是一种<strong>选择性结构化状态空间模型</strong>，专为高效的<strong>长序列建模</strong>设计。</li>
<li>它通过结合<strong>全局感知场</strong>和<strong>动态加权</strong>，克服了 CNN 的局限性，实现了与 Transformer 相当的高级建模能力，但避免了 Transformer 典型的<strong>二次复杂度</strong>。</li>
</ul>
</li>
<li><strong>Mamba 在视觉领域的应用</strong>：<ul>
<li><strong>VMamba</strong>：一种视觉状态空间模型，引入了<strong>交叉扫描模块 (CSM)</strong> 来提高跨维度扫描效率，在计算机视觉任务中性能超越了 CNN 和 ViT。</li>
<li><strong>VM-UNet</strong>：将 Mamba 集成到 UNet 框架中用于医学分割，利用视觉状态空间块捕获广泛的<strong>上下文信息</strong>。</li>
<li>Mamba 还被应用于多模态语义分割，通过<strong>暹罗编码器</strong>和创新融合机制，以<strong>线性复杂度</strong>增强了<strong>全局感受野</strong>覆盖。</li>
</ul>
</li>
<li><strong>本文提出的 MS2Fusion</strong>：<ul>
<li>受上述进展启发，本文基于 Mamba <strong>动态状态空间</strong>提出了 <strong>MS2Fusion</strong>。</li>
<li>该方法旨在有效利用模态间的<strong>共享特征和互补性</strong>，从而在<strong>降低模型复杂度</strong>的同时，<strong>提高目标检测的精度</strong>。</li>
</ul>
</li>
</ul>
<h2 id="引言总结"><a href="#引言总结" class="headerlink" title="引言总结"></a>引言总结</h2><h3 id="研究问题"><a href="#研究问题" class="headerlink" title="研究问题"></a>研究问题</h3><p>多光谱目标检测（RGB + 热红外）能在复杂场景下保持鲁棒性，但现有方法存在两大痛点：</p>
<ol>
<li><strong>偏重互补特征，忽略共享语义</strong>，导致泛化能力不足；</li>
<li><strong>感受野与效率权衡难</strong> —— CNN 看得近、Transformer 看得远但太慢。</li>
</ol>
<h3 id="论文核心思想"><a href="#论文核心思想" class="headerlink" title="论文核心思想"></a>论文核心思想</h3><p>作者提出 <strong>MS2Fusion（Multispectral State-Space Feature Fusion）</strong> 框架，利用**状态空间模型（SSM）**实现高效的多模态特征融合。它通过双路径结构：</p>
<ul>
<li>一条学习<strong>互补特征</strong>（不同模态的信息互补）</li>
<li>一条学习<strong>共享特征</strong>（模态间一致的语义）</li>
</ul>
<p>最终，融合结果既具有跨模态互补性，也具有共享语义一致性。</p>
<h3 id="主要贡献"><a href="#主要贡献" class="headerlink" title="主要贡献"></a>主要贡献</h3><ol>
<li>提出 <strong>双路径状态空间特征融合框架 MS2Fusion</strong>；</li>
<li>将 <strong>Mamba 动态状态空间结构</strong>引入多模态特征建模；</li>
<li>同时实现 <strong>Transformer 级感受野 + CNN 级效率</strong>；</li>
<li>在多任务上取得 <strong>SOTA 性能</strong>（检测、分割、显著目标识别）。</li>
</ol>
<h2 id="整体组件概览"><a href="#整体组件概览" class="headerlink" title="整体组件概览"></a>整体组件概览</h2><p><img data-src="/./../images/MS2Fusion-overreview-1761991594416-22-1765726490765-39-1765726786789-92.png" alt="img"></p>
<h3 id="MS2Fusion-总体框架流程详解"><a href="#MS2Fusion-总体框架流程详解" class="headerlink" title="MS2Fusion 总体框架流程详解"></a>MS2Fusion 总体框架流程详解</h3><p>整个网络包含三个阶段：</p>
<ol>
<li><strong>特征提取阶段</strong>：<ul>
<li>两个独立主干网络分别提取 RGB 与红外特征；</li>
</ul>
</li>
<li><strong>跨模态融合阶段</strong>：<ul>
<li>将三层特征（P3, P4, P5）分别送入 MS2Fusion 模块；</li>
</ul>
</li>
<li><strong>检测阶段</strong>：<ul>
<li>使用 YOLOv5 或 CoDetr Head 生成检测结果。</li>
</ul>
</li>
</ol>
<p>融合公式如下：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>F</mi><mrow><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow><mi>i</mi></msubsup><mo>=</mo><msub><mi>ϕ</mi><mrow><mi>M</mi><mi>S</mi><mn>2</mn><mi>F</mi><mi>u</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub><mo stretchy="false">(</mo><msubsup><mi>F</mi><mi>V</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>F</mi><mi>T</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
F_{fused}^i = \phi_{MS2Fusion}(F_V^i, F_T^i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2578em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">MS</span><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p> 其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>V</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">F_V^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>T</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">F_T^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2753em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span> 分别为两模态特征，输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mrow><mi>f</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">F_{fused}^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-0.4192em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4192em;"><span></span></span></span></span></span></span></span></span></span> 为融合结果。</p>
<h3 id="关键创新点"><a href="#关键创新点" class="headerlink" title="关键创新点"></a>关键创新点</h3><p>MS2Fusion 流程的优势在于它通过双路径（CP-SSM+SP-SSM）机制实现了对多光谱特征的<strong>高效</strong>且<strong>全面</strong>的融合：</p>
<ul>
<li><strong>利用 SSM:</strong> SSM 模型能够有效地建模<strong>长程依赖关系</strong> （大感受野），同时保持<strong>与 CNN 相当的计算效率</strong>，打破了传统架构的局限性。</li>
<li><strong>双路径优势:</strong><ul>
<li><strong>CP-SSM:</strong> 捕捉互补特征。专注于<strong>互补性</strong>，确保两个模态的独特信息得到有效利用。</li>
<li><strong>SP-SSM:</strong> 学习共享语义。专注于<strong>共享语义</strong>，提高了模型的泛化能力和对齐度。</li>
<li><strong>联合优化:</strong> 以上两路径使得MS2Fusion模型能够兼顾<strong>功能互补性</strong>和<strong>共享语义空间</strong>。</li>
</ul>
</li>
</ul>
<p>也就是说：MS2Fusion 同时让模型“看到不同”和“理解相同”。</p>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><h3 id="状态空间模型（SSM）"><a href="#状态空间模型（SSM）" class="headerlink" title="状态空间模型（SSM）"></a>状态空间模型（SSM）</h3><p>SSM（状态空间模型）本身并不是本文作者发明的模块，它起源于控制理论，并在 Mamba 模型中被引入深度学习。<br>它的最大优势是：能像 Transformer 一样捕捉全局关系（具有大感受野），但计算复杂度只有线性级别（也就是和 CNN 一样高效）。</p>
<p>本文所提出模型 MS2Fusion 的创新点是：把 SSM 结构应用到多模态特征融合中，并设计了三种变体（CP、SP、FF）来分别建模互补信息与共享语义。这使得模型在保持高效率的同时，具备了强大的跨模态理解能力。</p>
<p>SSM结合了循环神经网络（RNNs）和卷积神经网络（CNNs）的优势，能够高效处理长依赖关系。它通过状态方程将输入序列(x(t))转换为中间状态(h(t))，然后通过输出方程生成输出(y(t))。SSM通常表示为一个线性常微分方程：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">A</mi><mo>⋅</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="bold">B</mi><mo>⋅</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">C</mi><mo>⋅</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="bold">D</mi><mo>⋅</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
h&#x27;(t) &amp;= \mathbf{A} \cdot h(t) + \mathbf{B} \cdot x(t) \\
y(t) &amp;= \mathbf{C} \cdot h(t) + \mathbf{D} \cdot x(t)
\end{align}
\tag{1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">D</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span>
<p>为了使状态空间模型（SSM）适应深度学习，需将其离散化如下：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>h</mi><mi>k</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mover accent="true"><mi mathvariant="bold">A</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>h</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mover accent="true"><mi mathvariant="bold">B</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>x</mi><mi>k</mi></msub></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>y</mi><mi>k</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mover accent="true"><mi mathvariant="bold">C</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>h</mi><mi>k</mi></msub><mo>+</mo><mi mathvariant="bold">D</mi><mo>⋅</mo><msub><mi>x</mi><mi>k</mi></msub></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>e</mi><mi>x</mi><msup><mi>p</mi><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="bold">A</mi></mrow></msup></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>B</mi><mo stretchy="true">‾</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi>e</mi><mi>x</mi><msup><mi>p</mi><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="bold">A</mi></mrow></msup><mo>−</mo><mi mathvariant="bold">I</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">Δ</mi><mi mathvariant="bold">A</mi></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>C</mi><mo stretchy="true">‾</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">C</mi></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
h_k &amp;= \overline{\mathbf{A}} \cdot h_{k-1} + \overline{\mathbf{B}} \cdot x_k \\
y_k &amp;= \overline{\mathbf{C}} \cdot h_k + \mathbf{D} \cdot x_k \\
\overline{A} &amp;= exp^{\Delta \mathbf{A}} \\
\overline{B} &amp;= (exp^{\Delta \mathbf{A}} - \mathbf{I}) / \Delta \mathbf{A} \\
\overline{C} &amp;= \mathbf{C}
\end{align}
\tag{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.7421em;vertical-align:-3.6211em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1211em;"><span style="top:-6.2349em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6888em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1356em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span><span style="top:-1.5823em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span><span style="top:-0.0389em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6211em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1211em;"><span style="top:-6.2349em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8861em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">A</span></span></span><span style="top:-3.8061em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8861em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">B</span></span></span><span style="top:-3.8061em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6888em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8861em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">C</span></span></span><span style="top:-3.8061em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">D</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1356em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8933em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mathbf mtight">A</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.5823em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8933em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mathbf mtight">A</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">I</span><span class="mclose">)</span><span class="mord">/Δ</span><span class="mord mathbf">A</span></span></span><span style="top:-0.0389em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6211em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:7.7421em;vertical-align:-3.6211em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span>
<p>离散化后，SSM使用卷积操作进行并行计算。为了克服参数固定的问题，SSM引入了动态调整机制，使模型能够灵活处理复杂数据并改进长序列建模。</p>
<p>如图4所示，状态空间模型（SSM）通过由三项关键操作组成的结构化转换对输入序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>L</mi></msub><mo stretchy="false">}</mo><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>L</mi><mo>×</mo><mi>d</mi></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\{x_{1},x_{2},...,x_{L}\}\in \mathbb{R}^{L\times d})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">({</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>进行转化处理。</p>
<p><img data-src="/./../images/image-20251030142035432-1761991594416-23-1765726490765-40-1765726786789-95.png" alt="image-20251030142035432"></p>
<p><strong>图4：SSM（状态空间模型），其中红色、绿色和黑色的线分别对应于公式 (2) 的方程。</strong></p>
<h4 id="SSM-是什么？"><a href="#SSM-是什么？" class="headerlink" title="SSM 是什么？"></a>SSM 是什么？</h4><p>可以把 SSM 想成一个<strong>有记忆的滤波器</strong>：</p>
<ul>
<li>每一时刻（或者每一个像素位置）都有一个「隐藏状态」<code>h</code>，就像大脑里当前记着的东西</li>
<li>当前输入 <code>x</code>（图像的一小块特征）会和前面记住的 <code>h</code> 一起，算出新的 <code>h</code></li>
<li>然后根据这个新的 <code>h</code> 和当前 <code>x</code>，算出输出 <code>y</code>（更新后的特征）</li>
</ul>
<p>论文里连续时间的 SSM 一般写成类似这样：</p>
<blockquote>
<p>状态变化 &#x3D; A × 状态 + B × 输入<br>输出 &#x3D; C × 状态 + D × 输入 </p>
</blockquote>
<ul>
<li><strong>A、B、C、D</strong>：可以理解成四张「参数表」，告诉模型：<ul>
<li>以前的记忆（h）是如何影响现在</li>
<li>当前输入（x）是如何影响现在</li>
<li>输出 y 怎么从记忆和输入里“读”出来</li>
</ul>
</li>
</ul>
<p>因为我们在电脑里是一步一步处理序列（像一串像素），所以会把上面的「连续方程」离散化成：</p>
<blockquote>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><msub><mi>h</mi><mi>k</mi></msub><mo>=</mo><mover accent="true"><mi mathvariant="bold">A</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>h</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mover accent="true"><mi mathvariant="bold">B</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><msub><mi>x</mi><mi>k</mi></msub><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">
&gt; h_k = \overline{\mathbf{A}} \cdot h_{k-1} + \overline{\mathbf{B}} \cdot x_k \\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8861em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8861em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">A</span></span></span><span style="top:-3.8061em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8861em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8861em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">B</span></span></span><span style="top:-3.8061em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span>> y_k = \overline{\mathbf{C}} \cdot h_k + \mathbf{D} \cdot x_k
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex">
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span>**SSM（State Space Model）** 是一种“记忆+预测”模型：</blockquote>
<ul>
<li>输入：序列特征（如图像 patch 序列）</li>
<li>输出：同维度特征</li>
<li>核心：四个矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo separator="true">,</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A,B,C,D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> 控制信息流动：<ul>
<li><strong>A：</strong> 控制“记忆前面内容”；</li>
<li><strong>B：</strong> 决定“新信息如何进入”；</li>
<li><strong>C：</strong> 决定“输出什么特征”；</li>
<li><strong>D：</strong> 帮助防止梯度消失。</li>
</ul>
</li>
</ul>
<h4 id="1-核心扫描算子：SelectiveScan"><a href="#1-核心扫描算子：SelectiveScan" class="headerlink" title="(1) 核心扫描算子：SelectiveScan"></a>(1) 核心扫描算子：SelectiveScan</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> selective_scan_cuda_core <span class="keyword">as</span> selective_scan_cuda // 公式二调用</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SelectiveScan</span>(torch.autograd.Function):</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line"><span class="meta">    @torch.cuda.amp.custom_fwd(<span class="params">cast_inputs=torch.float32</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">ctx, u, delta, A, B, C, D=<span class="literal">None</span>, delta_bias=<span class="literal">None</span>, delta_softplus=<span class="literal">False</span>, nrows=<span class="number">1</span></span>):</span><br><span class="line">        <span class="keyword">assert</span> nrows <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">f&#x27;<span class="subst">&#123;nrows&#125;</span>&#x27;</span></span><br><span class="line">        <span class="keyword">assert</span> u.shape[<span class="number">1</span>] % (B.shape[<span class="number">1</span>] * nrows) == <span class="number">0</span>, <span class="string">f&#x27;<span class="subst">&#123;nrows&#125;</span>, <span class="subst">&#123;u.shape&#125;</span>, <span class="subst">&#123;B.shape&#125;</span>&#x27;</span></span><br><span class="line">        ctx.delta_softplus = delta_softplus</span><br><span class="line">        ctx.nrows = nrows</span><br><span class="line">        <span class="keyword">if</span> u.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            u = u.contiguous()</span><br><span class="line">        <span class="keyword">if</span> delta.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            delta = delta.contiguous()</span><br><span class="line">        <span class="keyword">if</span> D <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            D = D.contiguous()</span><br><span class="line">        <span class="keyword">if</span> B.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            B = B.contiguous()</span><br><span class="line">        <span class="keyword">if</span> C.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            C = C.contiguous()</span><br><span class="line">        <span class="keyword">if</span> B.dim() == <span class="number">3</span>:</span><br><span class="line">            B = B.unsqueeze(dim=<span class="number">1</span>)</span><br><span class="line">            ctx.squeeze_B = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> C.dim() == <span class="number">3</span>:</span><br><span class="line">            C = C.unsqueeze(dim=<span class="number">1</span>)</span><br><span class="line">            ctx.squeeze_C = <span class="literal">True</span></span><br><span class="line">        // 以下为公式二的代码实现</span><br><span class="line">        out, x, *rest = selective_scan_cuda.fwd(u, delta, A, B, C, D, delta_bias, delta_softplus, nrows) </span><br><span class="line">        // 公式二结束</span><br><span class="line">        ctx.save_for_backward(u, delta, A, B, C, D, delta_bias, x)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line"><span class="meta">    @torch.cuda.amp.custom_bwd</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">backward</span>(<span class="params">ctx, dout, *args</span>):</span><br><span class="line">        u, delta, A, B, C, D, delta_bias, x = ctx.saved_tensors</span><br><span class="line">        <span class="keyword">if</span> dout.stride((-<span class="number">1</span>))!= <span class="number">1</span>:</span><br><span class="line">            dout = dout.contiguous()</span><br><span class="line">        du, ddelta, dA, dB, dC, *dD, ddelta_bias, rest = selective_scan_cuda.bwd(u, delta, A, B, C, D, delta_bias, dout, x, ctx.delta_softplus, <span class="number">1</span>)</span><br><span class="line">        dB = dB.squeeze(<span class="number">1</span>) <span class="keyword">if</span> <span class="built_in">getattr</span>(ctx, <span class="string">&#x27;squeeze_B&#x27;</span>, <span class="literal">False</span>) <span class="keyword">else</span> dB</span><br><span class="line">        dC = dC.squeeze(<span class="number">1</span>) <span class="keyword">if</span> <span class="built_in">getattr</span>(ctx, <span class="string">&#x27;squeeze_C&#x27;</span>, <span class="literal">False</span>) <span class="keyword">else</span> dC</span><br><span class="line">        <span class="keyword">return</span> (du, ddelta, dA, dB, dC, dD, ddelta_bias, <span class="literal">None</span>, <span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p>此处代码对应公式(2)。</p>
<ul>
<li><code>u</code>  对应论文里的输入序列 xₖ</li>
<li><code>delta</code> 对应 Δ（时间步长）</li>
<li><code>A, B, C, D</code> 就是 SSM 参数</li>
<li>输出 <code>out</code> 对应 y 序列</li>
</ul>
<h4 id="2-单模态-1D-SSM：代码里的-SSM-SS2D"><a href="#2-单模态-1D-SSM：代码里的-SSM-SS2D" class="headerlink" title="(2) 单模态 1D SSM：代码里的 SSM &#x2F; SS2D"></a>(2) 单模态 1D SSM：代码里的 SSM &#x2F; SS2D</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x: torch.Tensor</span>):</span><br><span class="line">    selective_scan = selective_scan_fn_v1</span><br><span class="line">    B, L, d = x.shape        <span class="comment"># B=批大小, L=长度(H*W), d=通道数</span></span><br><span class="line">    x = x.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)   <span class="comment"># 变成 B, d, L</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 线性投影出 dt, B, C</span></span><br><span class="line">    x_dbl = <span class="variable language_">self</span>.x_proj(rearrange(x, <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>))</span><br><span class="line">    dt, B, C = torch.split(x_dbl, [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 把 dt 投影成每个通道的 Δ</span></span><br><span class="line">    dt = <span class="variable language_">self</span>.dt_proj.weight @ dt.t()</span><br><span class="line">    dt = rearrange(dt, <span class="string">&#x27;d (b l) -&gt; b d l&#x27;</span>, l=L)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 把 B、C reshape 回 B, d_state, L</span></span><br><span class="line">    A = -torch.exp(<span class="variable language_">self</span>.A_log.<span class="built_in">float</span>())</span><br><span class="line">    B = rearrange(B, <span class="string">&#x27;(b l) dstate -&gt; b dstate l&#x27;</span>, l=L).contiguous()</span><br><span class="line">    C = rearrange(C, <span class="string">&#x27;(b l) dstate -&gt; b dstate l&#x27;</span>, l=L).contiguous()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 跑 SelectiveScan，也就是公式(2)</span></span><br><span class="line">    y = selective_scan(x, dt, A, B, C, <span class="variable language_">self</span>.D.<span class="built_in">float</span>(),</span><br><span class="line">                       delta_bias=<span class="variable language_">self</span>.dt_proj.bias.<span class="built_in">float</span>(), delta_softplus=<span class="literal">True</span>)</span><br><span class="line">    y = rearrange(y, <span class="string">&#x27;b d l -&gt; b l d&#x27;</span>)</span><br><span class="line">    y = <span class="variable language_">self</span>.out_norm(y)</span><br><span class="line">    <span class="keyword">return</span> y </span><br></pre></td></tr></table></figure>

<p>对应关系（图4 &amp; 式(2)）：</p>
<ul>
<li>论文中 Linear(·) 生出 Δ、B、C<br>对应代码中 <code>self.x_proj(...)</code> + <code>torch.split(... dt, B, C ...)</code> </li>
<li>论文中的 A、D<br>对应代码中 <code>self.A_log</code> 通过 <code>A = -exp(A_log)</code> 得到 A，<code>self.D</code> 就是 D 参数</li>
<li>论文中的「沿序列扫描」<br>对应代码中 <code>selective_scan(x, dt, A, B, C, D, ...)</code></li>
</ul>
<p>这个就是最基本的 <strong>单模态 Mamba&#x2F;SSM 单元</strong>。</p>
<hr>
<p>Mamba 的创新在于：这些矩阵是动态生成的，因此模型能根据输入自动调节“记忆与更新”的比例。</p>
<p>MS2Fusion 把这一机制应用到多模态特征上，实现了：</p>
<ul>
<li>线性复杂度（高效率）；</li>
<li>全局感受野（强语义建模能力）。</li>
</ul>
<h3 id="所提出的模型架构"><a href="#所提出的模型架构" class="headerlink" title="所提出的模型架构"></a>所提出的模型架构</h3><p><img data-src="/./../images/image-20251030144143991-1761991594416-24-1765726490765-41-1765726786789-89.png" alt="image-20251030144143991"></p>
<p><strong>图5：模型架构概述。</strong> 该模型由三个主要阶段构成：(1) 使用两个主干网络进行<strong>特征提取</strong>；(2) 通过 <strong>MS2Fusion 模块</strong>对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">P_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">P_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 层的特征进行<strong>跨模态特征融合</strong>；(3) 通过颈部（Neck）和头部（Head）层生成<strong>检测结果</strong>。</p>
<h3 id="多光谱状态空间特征融合（MS2Fusion）"><a href="#多光谱状态空间特征融合（MS2Fusion）" class="headerlink" title="多光谱状态空间特征融合（MS2Fusion）"></a>多光谱状态空间特征融合（MS2Fusion）</h3><p>如图5的下半部分所示，MS2Fusion模块由三个核心组件构成：跨参数状态空间模型（CP-SSM）、共享参数状态空间模型（SP-SSM）和特征融合状态空间模型（FF-SSM）。</p>
<p>下面对这几个模块进行分析。</p>
<p>在 <code>common.py</code> 里，真正对应 MS2Fusion 的模块名叫 <strong><code>SSF</code></strong>（Shared &amp; Cross SSM Fusion，可以理解成 S³Fusion）。</p>
<p>简化代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SSF</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">..., hidden_dim: <span class="built_in">int</span>=<span class="number">0</span>, Cross: <span class="built_in">bool</span>=<span class="literal">True</span>, scan: <span class="built_in">bool</span>=<span class="literal">False</span>, ...</span>):</span><br><span class="line">        ...</span><br><span class="line">        <span class="comment"># DBI 部分：做 CP-SSM + SP-SSM</span></span><br><span class="line">        <span class="variable language_">self</span>.dbi_fusion = DBISSF(..., Cross=Cross)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># CM 部分：做 FF-SSM（concat + Mamba 2D）</span></span><br><span class="line">        <span class="variable language_">self</span>.cm_fusion = CMSSF(...)</span><br><span class="line">        <span class="variable language_">self</span>.cm_fusion_rgb = CMSSF(...)</span><br><span class="line">        <span class="variable language_">self</span>.cm_fusion_e   = CMSSF(...) </span><br></pre></td></tr></table></figure>

<p><code>SSF.forward</code>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">    <span class="comment"># x = [x_rgb, x_e]</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.only_cm <span class="keyword">and</span> (<span class="keyword">not</span> <span class="variable language_">self</span>.only_dbi):</span><br><span class="line">        x_cross_rgb, x_share_rgb, x_cross_e, x_share_e = <span class="variable language_">self</span>.dbi_fusion(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 先各自 RGB / E 内部融合（FF-SSM）</span></span><br><span class="line">        x_fuse_rgb = [x_cross_rgb, x_share_rgb]</span><br><span class="line">        x_fuse_e   = [x_cross_e,   x_share_e]</span><br><span class="line">        x_rgb = <span class="variable language_">self</span>.cm_fusion_rgb(x_fuse_rgb)</span><br><span class="line">        x_e   = <span class="variable language_">self</span>.cm_fusion_e(x_fuse_e)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 再把两个模态一起再融合一次（FF-SSM 最后一层）</span></span><br><span class="line">        x_new = [x_rgb, x_e]</span><br><span class="line">        x_feat = <span class="variable language_">self</span>.cm_fusion(x_new)</span><br><span class="line">    <span class="keyword">return</span> x_feat</span><br></pre></td></tr></table></figure>

<p>对应论文式(3)：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>i</mi><mi>V</mi></msubsup></mrow><annotation encoding="application/x-tex">Fᵢ^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">x_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">b</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>i</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">Fᵢ^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">x_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>M</mi></msub><mi>S</mi><mn>2</mn><mi>F</mi><mi>u</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Φ_MS2Fusion</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span></span> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">SSF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">SSF</span></span></span></span> 模块里的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>b</mi><msub><mi>i</mi><mi>f</mi></msub><mi>u</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">dbi_fusion</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span></span> + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>m</mi><mi>f</mi></msub><mi>u</mi><mi>s</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mo>∗</mo></msub></mrow><annotation encoding="application/x-tex">cm_fusion_*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9456em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1757em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 整套</li>
<li>输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>f</mi></msub><mi>e</mi><mi>a</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">x_feat</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span></span></span></span> 就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>i</mi><mi>f</mi></msubsup><mi>u</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Fᵢ^fused</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.967em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mord mathnormal">se</span><span class="mord mathnormal">d</span></span></span></span>，接着会被送进 YOLOv5 的 neck&#x2F;head 继续预测</li>
</ul>
<h4 id="CP-SSM-模块"><a href="#CP-SSM-模块" class="headerlink" title="CP-SSM 模块"></a>CP-SSM 模块</h4><p><img data-src="/./../images/image-20251030151609728-1761991594416-25-1765726490765-42-1765726786789-91.png" alt="image-20251030151609728"></p>
<p>图 6 CP-SSM模块的细节 跨参数状态空间模型</p>
<p><strong>图注：</strong> CP-SSM 模块的细节图。特征图 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 首先通过行和列扫描被重塑为序列 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>V</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{Vi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Vi</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>T</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{Ti}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)，并通过一个线性层（Linear layer）生成参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi></mrow><annotation encoding="application/x-tex"> \Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span>。其次，作者通过交换两个分支的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 矩阵来执行跨模态互补特征的交互。最后，通过SSM模块进行跨模态互补特征交互，以生成输出 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>F</mi><mo>~</mo></mover><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{F}_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>F</mi><mo>~</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{F}_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)。</p>
<p><strong>目标：</strong> 挖掘 RGB 与热成像间的互补特征。</p>
<p><strong>思路：</strong></p>
<ul>
<li>RGB 与热红外各自进入 SSM；</li>
<li>在计算时交换参数 C（相当于互换“视角”）；</li>
<li>让 RGB 学到热红外的“温度信息”，热红外学到 RGB 的“纹理信息”。</li>
</ul>
<p>在仓库中，此模块相关代码位于<code>common.py</code></p>
<p>在类<code>DBISSF_Attention.forward</code>中</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x_rgb, x_share_rgb, x_e, x_share_e</span>):</span><br><span class="line">    selective_scan = selective_scan_fn_v1</span><br><span class="line">    B, L, d = x_rgb.shape</span><br><span class="line">    <span class="comment"># 调整维度</span></span><br><span class="line">    x_rgb        = x_rgb.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    x_e          = x_e.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    x_share_rgb  = x_share_rgb.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    x_share_e    = x_share_e.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 线性投影，分别得到 RGB / E / share 的 dt, B, C</span></span><br><span class="line">    x_dbl_rgb   = <span class="variable language_">self</span>.x_proj_1(rearrange(x_rgb, <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>))</span><br><span class="line">    x_dbl_e     = <span class="variable language_">self</span>.x_proj_2(rearrange(x_e,   <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>))</span><br><span class="line">    x_dbl_share = <span class="variable language_">self</span>.x_proj_share(rearrange(torch.add(x_share_rgb, x_share_e),</span><br><span class="line">                                              <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    dt_rgb,   B_rgb,   C_rgb   = torch.split(x_dbl_rgb,   [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line">    dt_e,     B_e,     C_e     = torch.split(x_dbl_e,     [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line">    dt_share, B_share, C_share = torch.split(x_dbl_share, [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. dt 投影成 Δ</span></span><br><span class="line">    dt_rgb   = <span class="variable language_">self</span>.dt_proj_1.weight @ dt_rgb.t()</span><br><span class="line">    dt_e     = <span class="variable language_">self</span>.dt_proj_2.weight @ dt_e.t()</span><br><span class="line">    dt_share = <span class="variable language_">self</span>.dt_proj_share.weight @ dt_share.t()</span><br><span class="line">    ...</span><br><span class="line">    A_rgb   = -torch.exp(<span class="variable language_">self</span>.A_log_rgb.<span class="built_in">float</span>())</span><br><span class="line">    A_e     = -torch.exp(<span class="variable language_">self</span>.A_log_e.<span class="built_in">float</span>())</span><br><span class="line">    A_share = -torch.exp(<span class="variable language_">self</span>.A_log_share.<span class="built_in">float</span>())</span><br><span class="line">    D_rgb, D_e, D_share = <span class="variable language_">self</span>.D_rgb, <span class="variable language_">self</span>.D_e, <span class="variable language_">self</span>.D_share</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment"># 3. CP-SSM：在 Cross=True 时交换 C</span></span><br><span class="line">    <span class="keyword">if</span> <span class="variable language_">self</span>.Cross:</span><br><span class="line">        y_rgb = selective_scan(x_rgb, dt_rgb, A_rgb, B_rgb, C_e,      D_rgb,   ...)</span><br><span class="line">        y_e   = selective_scan(x_e,   dt_e,   A_e,   B_e,   C_rgb,    D_e,     ...)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        y_rgb = selective_scan(x_rgb, dt_rgb, A_rgb, B_rgb, C_rgb,    D_rgb,   ...)</span><br><span class="line">        y_e   = selective_scan(x_e,   dt_e,   A_e,   B_e,   C_e,      D_e,     ...)</span><br></pre></td></tr></table></figure>

<p>CP-SSM 的关键是：</p>
<ul>
<li>RGB 分支用自己的一套 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">A_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">B_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">D_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，但输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">y_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的时候用 <strong>红外那边的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">C_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></li>
<li>红外分支用自己的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">A_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">B_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">D_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，但输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">y_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 时用 <strong>RGB 的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">C_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></li>
</ul>
<p>公式(4) 就是在写这个「<strong>只交换 C</strong>」的过程。</p>
<p>对应关系：</p>
<ul>
<li>图6里的两条分支（RGB 和 T 模态） 👉 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">x_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">b</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">x_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>公式(4) 里各自的 Aᵢ, Bᵢ, Dᵢ 👉 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">A_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">b</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">B_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">b</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">D_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">b</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">A_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">B_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">D_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>互换 C</strong>：<ul>
<li>RGB 分支用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">C_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>红外分支用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">C_rgb</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">b</span></span></span></span><br>这就是 CP-SSM 的“跨模态参数交互”。</li>
</ul>
</li>
</ul>
<p>注意：</p>
<ul>
<li>上面这一段 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub><mi>g</mi><mi>b</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">y_rgb, y_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的输出，就是论文中 CP-SSM 那条“互补特征路径”。</li>
<li>稍后 DBISSF_SS 会把这些结果 reshape 回 B×C×H×W 的二维特征。</li>
</ul>
<h4 id="SP-SSM-模块"><a href="#SP-SSM-模块" class="headerlink" title="SP-SSM 模块"></a>SP-SSM 模块</h4><p><img data-src="/./../images/image-20251030151823019-1761991594416-26-1765726490765-43-1765726786789-93.png" alt="image-20251030151823019"></p>
<p>图 7 SP-SSM模块的细节及流程叙述</p>
<p><strong>图注：</strong> SP-SSM模块的细节图。SP-SSM模块从具有共享参数的状态空间模型（SSM）中提取两种模态（RGB和热红外）的共享特征。输入特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 被组合以生成参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">B_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">C_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，同时输出特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>F</mi><mo>~</mo></mover><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{F}_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>F</mi><mo>~</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{F}_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 由这两个SSM进行重建。</p>
<p><strong>具体过程由公式描述：</strong></p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mi>i</mi></msub><mo>=</mo><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\mathbf{F}_i = \varphi^{SSM} (\mathbf{F}_i, \Delta_s, \mathbf{B}_s, \mathbf{C}_s)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mi>s</mi></msub><mo stretchy="false">]</mo><mo>=</mo><msub><mi mathvariant="script">L</mi><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mi>V</mi></msub><mo>⊕</mo><msub><mi mathvariant="bold">F</mi><mi>T</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
[\Delta_s, \mathbf{B}_s, \mathbf{C}_s] = \mathcal{L}_{Linear} (\mathbf{F}_V \oplus \mathbf{F}_T)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo>∈</mo><mo stretchy="false">{</mo><mi>V</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{F}_i (i \in \{V, T\})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">})</span></span></span></span> 是共享特征，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{SSM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span></span></span></span></span></span></span></span> 是状态空间模型。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mi>s</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_s, \mathbf{B}_s, \mathbf{C}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是从加权融合特征中获得的参数。</p>
<p>SP-SSM模块构建了一种<strong>层次化的特征共享架构</strong>，通过参数共享和特征重建实现跨模态表示对齐。如图7所示，该模块的流程由两个精心设计的阶段组成：</p>
<p>在<strong>参数共享阶段</strong>，模块采用<strong>粗粒度的加法特征融合方法</strong>对RGB和热红外特征进行初步整合。然后，通过一个线性网络动态生成三组关键的共享参数。这些参数不仅编码了双模态的共同特征模式，而且保留了模态特定的调整能力。</p>
<p>在<strong>特征重建阶段</strong>，这些共享参数被注入到两个模态的SSM中。这种设计创建了一个双流耦合架构：一方面，共享参数约束了两种模态在状态空间中的演化轨迹，驱动异构特征收敛到共享特征空间；另一方面，每个模态保留了独立的初始化状态，确保了模态特定信息的完整性。通过这种共享参数计算范式，模块能够提取出不受光照条件和环境干扰等因素影响的<strong>深度共享特征</strong>。</p>
<p>简而言之：</p>
<p>SP-SSM 的目的：<strong>抓住两个模态共同的语义</strong>。</p>
<p>方法是：</p>
<ol>
<li><p>先把两路特征相加：</p>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">F_share</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">re</span></span></span></span> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
</li>
<li><p>用这个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">F_share</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">re</span></span></span></span> 去生成一套共享参数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">Δ_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">B_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">C_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)</p>
</li>
<li><p>然后把这套共享参数用在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>G</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">RGB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">RGB</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> 两个分支上，跑同一套 SSM：</p>
</li>
</ol>
<p><strong>方法：</strong></p>
<ul>
<li>将 RGB 与热特征先相加（或拼接）成联合特征；</li>
<li>使用<strong>参数共享</strong>的 SSM 处理这两种输入；</li>
<li>因为参数相同，模型会倾向学习“共性信息”——比如物体轮廓、形状等。</li>
</ul>
<p>还是在类<code>DBISSF_Attention.forward</code>中，刚才看到share分支</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># share 输入：x_share_rgb, x_share_e</span></span><br><span class="line">x_dbl_share = <span class="variable language_">self</span>.x_proj_share(</span><br><span class="line">    rearrange(torch.add(x_share_rgb, x_share_e), <span class="string">&#x27;b d l -&gt; (b l) d&#x27;</span>)</span><br><span class="line">)</span><br><span class="line">dt_share, B_share, C_share = torch.split(</span><br><span class="line">    x_dbl_share, [<span class="variable language_">self</span>.dt_rank, <span class="variable language_">self</span>.d_state, <span class="variable language_">self</span>.d_state], dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">dt_share = <span class="variable language_">self</span>.dt_proj_share.weight @ dt_share.t()</span><br><span class="line">dt_share = rearrange(dt_share, <span class="string">&#x27;d (b l) -&gt; b d l&#x27;</span>, l=L)</span><br><span class="line"></span><br><span class="line">A_share = -torch.exp(<span class="variable language_">self</span>.A_log_share.<span class="built_in">float</span>())</span><br><span class="line">B_share = rearrange(B_share, <span class="string">&#x27;(b l) dstate -&gt; b dstate l&#x27;</span>, l=L).contiguous()</span><br><span class="line">C_share = rearrange(C_share, <span class="string">&#x27;(b l) dstate -&gt; b dstate l&#x27;</span>, l=L).contiguous()</span><br><span class="line">D_share = <span class="variable language_">self</span>.D_share.<span class="built_in">float</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SP-SSM：共享一套 (A_share, B_share, C_share, D_share)</span></span><br><span class="line">y_share_rgb = selective_scan(x_share_rgb, dt_share, A_share, B_share, C_share,</span><br><span class="line">                             D_share, delta_bias=<span class="variable language_">self</span>.dt_proj_share.bias.<span class="built_in">float</span>(), delta_softplus=<span class="literal">True</span>)</span><br><span class="line">y_share_e   = selective_scan(x_share_e,   dt_share, A_share, B_share, C_share,</span><br><span class="line">                             D_share, delta_bias=<span class="variable language_">self</span>.dt_proj_share.bias.<span class="built_in">float</span>(), delta_softplus=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>对应关系：</p>
<ul>
<li>论文里 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">F_share</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">re</span></span></span></span> &#x3D; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">F_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">F_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 对应 <code>torch.add(x_share_rgb, x_share_e)</code></li>
<li>论文里 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">Linear</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">in</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> 生成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">Δ_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">B_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">C_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 对应 <code>self.x_proj_share(...)</code> + <code>torch.split(... dt_share, B_share, C_share ...)</code></li>
<li>论文里「同一套 SSM 同时作用在两路」 对应 两个 <code>selective_scan</code> 调用：<ul>
<li>一个输入 <code>x_share_rgb</code></li>
<li>一个输入 <code>x_share_e</code><br>使用的都是同一组 <code>(A_share, B_share, C_share, D_share, dt_share)</code></li>
</ul>
</li>
</ul>
<h4 id="DBISSF-SS"><a href="#DBISSF-SS" class="headerlink" title="DBISSF_SS"></a>DBISSF_SS</h4><p>把 CP-SSM 和 SP-SSM 套在 2D 特征上（扫描方向）</p>
<p>刚才只是序列层面（L 维度）的 CP&#x2F;SP，需要再放回到 2D 特征图上，这部分对应图6 底下那种「按 H×W 扫描」的结构。</p>
<p>在 <code>DBISSF_SS.forward</code> 里大致是这样：</p>
<ol>
<li><p>输入是 <code>x_rgb, x_e</code>，形状 B×C×H×W</p>
</li>
<li><p>用 1×1 卷积变换到适合 SSM 的通道数：</p>
<p><code>x_rgb_conv</code>, <code>x_e_conv</code></p>
<p>再得到 share 分支 <code>x_share_rgb_conv</code>, <code>x_share_e_conv</code></p>
</li>
<li><p>把 H×W 摊平成一条长序列 L &#x3D; H×W</p>
<p>可能还会做 CrossScan：既沿着行扫、又沿着列扫，再加正向+反向（对应图6 中多方向扫描）</p>
</li>
<li><p>喂给 <code>CMA_ssm</code>（也就是 <code>DBISSF_Attention</code>）</p>
</li>
<li><p>如果 <code>scan=True</code>，再用 <code>CMA_ssm2</code> 沿着另一个维度再扫一遍（更丰富的空间关系）</p>
</li>
<li><p>最后把结果 reshape 回 B×C×H×W</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DBISSF_SS</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;\n    Cross Mamba Attention Fusion Selective Scan 2D Module with SSM\n    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_model=<span class="number">96</span>, d_state=<span class="number">16</span>, ssm_ratio=<span class="number">2</span>, dt_rank=<span class="string">&#x27;auto&#x27;</span>, Cross=<span class="literal">True</span>, learnableweight=<span class="literal">False</span>, scan=<span class="literal">False</span>, d_conv=<span class="number">3</span>, conv_bias=<span class="literal">True</span>, dropout=<span class="number">0.0</span>, bias=<span class="literal">False</span>, dt_min=<span class="number">0.001</span>, dt_max=<span class="number">0.1</span>, dt_init=<span class="string">&#x27;random&#x27;</span>, dt_scale=<span class="number">1.0</span>, dt_init_floor=<span class="number">0.0001</span>, softmax_version=<span class="literal">False</span>, **kwargs</span>):</span><br><span class="line">        factory_kwargs = &#123;<span class="string">&#x27;device&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;dtype&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="variable language_">self</span>.softmax_version = softmax_version</span><br><span class="line">        <span class="variable language_">self</span>.d_model = d_model</span><br><span class="line">        <span class="variable language_">self</span>.d_state = math.ceil(<span class="variable language_">self</span>.d_model / <span class="number">6</span>) <span class="keyword">if</span> d_state == <span class="string">&#x27;auto&#x27;</span> <span class="keyword">else</span> d_state</span><br><span class="line">        <span class="variable language_">self</span>.d_conv = d_conv</span><br><span class="line">        <span class="variable language_">self</span>.expand = ssm_ratio</span><br><span class="line">        <span class="variable language_">self</span>.d_inner = <span class="built_in">int</span>(<span class="variable language_">self</span>.expand * <span class="variable language_">self</span>.d_model)</span><br><span class="line">        <span class="variable language_">self</span>.dt_rank = math.ceil(<span class="variable language_">self</span>.d_model / <span class="number">16</span>) <span class="keyword">if</span> dt_rank == <span class="string">&#x27;auto&#x27;</span> <span class="keyword">else</span> dt_rank</span><br><span class="line">        <span class="variable language_">self</span>.Cross = Cross</span><br><span class="line">        <span class="variable language_">self</span>.learnableweight = learnableweight</span><br><span class="line">        <span class="variable language_">self</span>.in_proj = nn.Linear(<span class="variable language_">self</span>.d_model, <span class="variable language_">self</span>.d_inner, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.in_proj_modalx = nn.Linear(<span class="variable language_">self</span>.d_model, <span class="variable language_">self</span>.d_inner, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.in_proj_share = nn.Linear(<span class="variable language_">self</span>.d_model, <span class="variable language_">self</span>.d_inner, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="keyword">if</span> learnableweight:</span><br><span class="line">            <span class="variable language_">self</span>.learnableweight_rgb = LearnableWeights()</span><br><span class="line">            <span class="variable language_">self</span>.learnableweight_e = LearnableWeights()</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.d_conv &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="variable language_">self</span>.conv2d = nn.Conv2d(in_channels=<span class="variable language_">self</span>.d_inner, out_channels=<span class="variable language_">self</span>.d_inner, groups=<span class="variable language_">self</span>.d_inner, bias=conv_bias, kernel_size=d_conv, padding=(d_conv - <span class="number">1</span>) // <span class="number">2</span>, **factory_kwargs)</span><br><span class="line">            <span class="variable language_">self</span>.act = nn.SiLU()</span><br><span class="line">        <span class="variable language_">self</span>.out_proj_rgb = nn.Linear(<span class="variable language_">self</span>.d_inner, <span class="variable language_">self</span>.d_model, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.out_proj_e = nn.Linear(<span class="variable language_">self</span>.d_inner, <span class="variable language_">self</span>.d_model, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.out_proj_share = nn.Linear(<span class="variable language_">self</span>.d_inner, <span class="variable language_">self</span>.d_model, bias=bias, **factory_kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.dropout_rgb = nn.Dropout(dropout) <span class="keyword">if</span> dropout &gt; <span class="number">0.0</span> <span class="keyword">else</span> nn.Identity()</span><br><span class="line">        <span class="variable language_">self</span>.dropout_e = nn.Dropout(dropout) <span class="keyword">if</span> dropout &gt; <span class="number">0.0</span> <span class="keyword">else</span> nn.Identity()</span><br><span class="line">        <span class="variable language_">self</span>.dropout_share = nn.Dropout(dropout) <span class="keyword">if</span> dropout &gt; <span class="number">0.0</span> <span class="keyword">else</span> nn.Identity()</span><br><span class="line">        <span class="variable language_">self</span>.CMA_ssm = DBISSF_Attention(d_model=<span class="variable language_">self</span>.d_model, d_state=<span class="variable language_">self</span>.d_state, ssm_ratio=ssm_ratio, dt_rank=dt_rank, Cross=Cross, dt_min=dt_min, dt_max=dt_max, dt_init=dt_init, dt_scale=dt_scale, dt_init_floor=dt_init_floor, **kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.scan = scan</span><br><span class="line">        <span class="keyword">if</span> scan:</span><br><span class="line">            <span class="variable language_">self</span>.CMA_ssm2 = DBISSF_Attention(d_model=<span class="variable language_">self</span>.d_model, d_state=<span class="variable language_">self</span>.d_state, ssm_ratio=ssm_ratio, dt_rank=dt_rank, Cross=Cross, dt_min=dt_min, dt_max=dt_max, dt_init=dt_init, dt_scale=dt_scale, dt_init_floor=dt_init_floor, **kwargs)</span><br></pre></td></tr></table></figure>

<p>这一大块就是<strong>把式(4)(5) 落到实际的二维特征上</strong>。</p>
<h4 id="FF-SSM-模块"><a href="#FF-SSM-模块" class="headerlink" title="FF-SSM 模块"></a>FF-SSM 模块</h4><p><img data-src="/./../images/image-20251030152057669-1761991594416-27-1765726490765-44-1765726786789-96.png" alt="image-20251030152057669"></p>
<p><strong>图注：</strong> FF-SSM 模块的细节图。该模块通过将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 以两种不同顺序组合来实现特征融合。在顶部分支中，输入特征以 1-2 的顺序（例如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_1, F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）组合形成拼接特征，然后通过一个线性层（Linear layer）生成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">B_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\Delta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 参数，随后通过 SSM 执行跨特征交互。最终，将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">F_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">F_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 合并（merge）生成融合特征图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>F</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span>。</p>
<p><strong>模块流程叙述：</strong></p>
<p>FF-SSM 模块旨在解决 Mamba 固有的<strong>特征遗忘问题</strong>，同时实现<strong>彻底且自适应的跨模态特征融合</strong>。它通过引入<strong>双向架构</strong>，结合互补的前向和反向处理路径来系统性地弥补单向建模的局限性。</p>
<ol>
<li><p><strong>输入特征：</strong> 模块接收来自 CP-SSM 输出的特征图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>（例如，RGB 和热红外互补特征）。</p>
</li>
<li><p><strong>双向异构序列构建（Bidirectional Sequence Construction）：</strong> 模块采用双向异构序列构建策略，将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 以<strong>两种不同顺序</strong>进行拼接：</p>
<ul>
<li><strong>前向路径 (Top Path):</strong> 序列为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_1, \mathbf{F}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。</li>
<li><strong>反向路径 (Bottom Path):</strong> 序列为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_2, \mathbf{F}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。</li>
</ul>
</li>
<li><p><strong>参数生成：</strong></p>
<ul>
<li><strong>前向路径：</strong> 拼接序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_1, \mathbf{F}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 通过线性变换层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mn>1</mn><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{1}^{Linear}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span> 生成状态空间模型参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\Delta_1, \mathbf{B}_1, \mathbf{C}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。</li>
<li><strong>反向路径：</strong> 拼接序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_2, \mathbf{F}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 通过另一个线性变换层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mn>2</mn><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{2}^{Linear}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span> 生成状态空间模型参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\Delta_2, \mathbf{B}_2, \mathbf{C}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。</li>
</ul>
</li>
<li><p><strong>状态空间处理与特征交互：</strong></p>
<ul>
<li><strong>前向 SSM：</strong> 参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\Delta_1, \mathbf{B}_1, \mathbf{C}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 和序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_1, \mathbf{F}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 输入 SSM (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{SSM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span></span></span></span></span></span></span></span>) 得到输出特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">F_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>反向 SSM：</strong> 参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\Delta_2, \mathbf{B}_2, \mathbf{C}_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 和序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{F}_2, \mathbf{F}_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 输入 SSM (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{SSM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span></span></span></span></span></span></span></span>) 得到输出特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">F_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>作用：</strong> 反向路径 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">F_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 专门用于捕获在前向传播中可能发生的特征损失，通过<strong>方向自适应参数生成</strong>来补偿单向建模的局限性。</li>
</ul>
</li>
<li><p><strong>最终融合（Adaptive Fusion）：</strong> 模块通过一个合并函数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mrow><mi>M</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\psi_{Merge}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">er</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>) 将来自双向 SSM 路径的输出特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">F_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">F_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 进行融合，生成最终的融合特征图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">F</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.923em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.923em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">F</span></span><span style="top:-3.6051em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span>。</p>
</li>
</ol>
<p><strong>目标：</strong> 这种双路径机制能够更全面地捕获<strong>长距离跨模态依赖关系</strong>，动态地缓解特征遗忘，同时在不牺牲 Mamba 线性复杂度的前提下，确保更丰富、更精确的特征表示，显著提高检测精度。</p>
<p><strong>数学表达：</strong></p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi mathvariant="bold">F</mi><mo>~</mo></mover><mo>=</mo><msub><mi>ψ</mi><mrow><mi>M</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mn>12</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>21</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\tilde{\mathbf{F}} = \psi_{Merge} (\mathbf{F}_{12}, \mathbf{F}_{21})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.923em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.923em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">F</span></span><span style="top:-3.6051em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">er</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>12</mn></msub><mo>=</mo><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup><mo stretchy="false">(</mo><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\mathbf{F}_{12} = \varphi^{SSM} ([\mathbf{F}_1, \mathbf{F}_2], \Delta_1, \mathbf{B}_1, \mathbf{C}_1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span></span></span></span></span><span class="mopen">([</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>21</mn></msub><mo>=</mo><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup><mo stretchy="false">(</mo><mo stretchy="false">[</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\mathbf{F}_{21} = \varphi^{SSM} ([\mathbf{F}_2, \mathbf{F}_1], \Delta_2, \mathbf{B}_2, \mathbf{C}_2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span></span></span></span></span><span class="mopen">([</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo>=</mo><msubsup><mi mathvariant="script">L</mi><mn>1</mn><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
[\Delta_1, \mathbf{B}_1, \mathbf{C}_1] = \mathcal{L}_{1}^{Linear} (\mathbf{F}_1, \mathbf{F}_2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo>=</mo><msubsup><mi mathvariant="script">L</mi><mn>2</mn><mrow><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>r</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
[\Delta_2, \mathbf{B}_2, \mathbf{C}_2] = \mathcal{L}_{2}^{Linear} (\mathbf{F}_2, \mathbf{F}_1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>

<p>尽管CP-SSM模块能够捕获模态间隐式的互补关系，但它在特征融合层面上仍存在局限性。为了解决Mamba固有的<strong>特征遗忘问题</strong>，同时保持其计算效率，作者提出了一个结合<strong>互补前向</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_1, \mathbf{F}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 和<strong>反向</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_2, \mathbf{F}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 处理路径的<strong>双向架构</strong>。</p>
<p>这种创新设计通过<strong>方向自适应参数生成</strong>系统地弥补了单向建模的局限性，其中反向路径专门用于捕获前向传播中可能发生的特征损失。与传统Transformer因分块操作导致信息丢失不同，作者的方法不仅保持了Mamba原有的序列依赖和线性复杂度的优势，而且通过反向序列补偿显著增强了特征保留。双路径机制能够更全面地捕获<strong>长距离跨模态依赖关系</strong>，同时动态地缓解特征遗忘，在不牺牲效率的情况下实现了鲁棒的序列建模。</p>
<p>具体来说，给定CP-SSM输出的特征图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，该模块采用<strong>双向异构序列构建策略</strong>：以不同顺序 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_1, \mathbf{F}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_2, \mathbf{F}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 对特征进行拼接。这种设计不仅扩展了模型的感受野，还增强了特征表示的多样性。</p>
<p>在实现中，特征首先被展开并拼接成两个方向序列，然后通过线性变换层生成相应的状态空间模型参数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{B}_1, \mathbf{C}_1, \Delta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{B}_2, \mathbf{C}_2, \Delta_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)。最后，通过融合来自双向SSM路径的输出特征 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)，模块实现了彻底的跨模态特征交互和自适应融合，显著提高了检测精度。FF-SSM模块有效地保留了两种模态内的细节信息，确保了更丰富、更精确的特征表示，这在公式 (6) 中被描述：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>F</mi><mo stretchy="true">^</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>ψ</mi><mrow><mi>M</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi>F</mi><mn>12</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>21</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>F</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msub><mrow><mo fence="true">(</mo><mo stretchy="false">[</mo><msub><mi>F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>F</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msub><mrow><mo fence="true">(</mo><mo stretchy="false">[</mo><msub><mi>F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>1</mn></msub><mo fence="true">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>Linear</mtext><mn>1</mn></msubsup><mrow><mo fence="true">(</mo><msub><mi>F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">[</mo><msub><mi mathvariant="normal">Δ</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo fence="true">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>L</mi><mtext>Linear</mtext><mn>2</mn></msubsup><mrow><mo fence="true">(</mo><msub><mi>F</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(6)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\widehat{F} &amp;= \psi_{Merge} \left( F_{12}, F_{21} \right) \\
F_{12} &amp;= \varphi_{SSM} \left( [F_1, F_2], \Delta_1, B_1, C_1 \right) \\
F_{21} &amp;= \varphi_{SSM} \left( [F_2, F_1], \Delta_2, B_2, C_2 \right) \\
\left[ \Delta_1, B_1, C_1 \right] &amp;= L_{\text{Linear}}^1 \left( F_1, F_2 \right) \\
\left[ \Delta_2, B_2, C_2 \right] &amp;= L_{\text{Linear}}^2 \left( F_2, F_1 \right)
\end{align}
\tag{6}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.6315em;vertical-align:-3.5658em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0658em;"><span style="top:-6.1424em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9233em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span class="svg-align" style="width:calc(100% - 0.1667em);margin-left:0.1667em;top:-3.6833em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span><span style="top:-4.6424em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1424em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.6183em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span><span style="top:-0.0942em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5658em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0658em;"><span style="top:-6.1424em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">er</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-4.6424em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.1424em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-1.6183em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Linear</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-0.0942em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Linear</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5658em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:7.6315em;vertical-align:-3.5658em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6</span></span><span class="mord">)</span></span></span></span></span></span>
<p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>φ</mi><mrow><mi>S</mi><mi>S</mi><mi>M</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{SSM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">SSM</span></span></span></span></span></span></span></span></span></span></span></span> 表示图4中的SSM，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">F</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{F}_1, \mathbf{F}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是特征图。</p>
<p>简而言之：</p>
<p>有了 CP-SSM 和 SP-SSM，我们得到两种特征：</p>
<ul>
<li>F₁：互补信息（差异）</li>
<li>F₂：共享信息（共性）</li>
</ul>
<p>FF-SSM 想干的是：</p>
<blockquote>
<p>把 F₁、F₂ 再“来回搅拌”，既考虑「先看 F₁ 再看 F₂」，也考虑「先看 F₂ 再看 F₁」，最后得到一个融合特征 F_fused。</p>
</blockquote>
<p>式(6) 的大致意思是：</p>
<ol>
<li>把 (F₁, F₂) 作为一对输入，喂进一个线性层，得到一组 (Δ₁, B₁, C₁)</li>
<li>把 (F₂, F₁) 再喂一次，得到 (Δ₂, B₂, C₂)</li>
<li>用这两组参数跑两次 SSM，得到两个方向的输出 F₁₂ 和 F₂₁</li>
<li>再把 F₁₂ 和 F₂₁ 结合起来就是 F_fused</li>
</ol>
<p>图8 就是把这些步骤画成了一个带两路输入、两路输出再融合的结构。</p>
<h4 id="CMSSF-CM-Attention"><a href="#CMSSF-CM-Attention" class="headerlink" title="CMSSF + CM_Attention"></a>CMSSF + CM_Attention</h4><p><code>CMSSF</code> 是一个「Concat Mamba 2D 融合模块」：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CMSSF</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Concat Mamba (ConMB) fusion, with 2d SSM&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, hidden_dim: <span class="built_in">int</span>=<span class="number">0</span>, ...</span>):</span><br><span class="line">        ...</span><br><span class="line">        <span class="variable language_">self</span>.op = CM_Attention(d_model=hidden_dim, ...)</span><br><span class="line">        <span class="variable language_">self</span>.drop_path = DropPath(drop_path)</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_forward</span>(<span class="params">self, x: torch.Tensor</span>):</span><br><span class="line">        x_rgb = x[<span class="number">0</span>]</span><br><span class="line">        x_e   = x[<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 用 CM_Attention 得到融合特征</span></span><br><span class="line">        <span class="comment"># 然后加上残差/MLP（略）</span></span><br></pre></td></tr></table></figure>

<p><code>CM_Attention</code> 的核心是 <code>forward_corev2_multimodal</code>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CM_Attention</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Multimodal Mamba Selective Scan 2D&quot;&quot;&quot;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward_corev2_multimodal</span>(<span class="params">self, x_rgb, x_e, nrows=-<span class="number">1</span></span>):</span><br><span class="line">        <span class="keyword">return</span> cross_selective_scan_multimodal_k2(</span><br><span class="line">            x_rgb, x_e,</span><br><span class="line">            <span class="variable language_">self</span>.x_proj_weight, <span class="literal">None</span>,</span><br><span class="line">            <span class="variable language_">self</span>.dt_projs_weight, <span class="variable language_">self</span>.dt_projs_bias,</span><br><span class="line">            <span class="variable language_">self</span>.A_logs, <span class="variable language_">self</span>.Ds,</span><br><span class="line">            <span class="built_in">getattr</span>(<span class="variable language_">self</span>, <span class="string">&quot;out_norm1&quot;</span>, <span class="literal">None</span>),</span><br><span class="line">            <span class="built_in">getattr</span>(<span class="variable language_">self</span>, <span class="string">&quot;out_norm2&quot;</span>, <span class="literal">None</span>),</span><br><span class="line">            <span class="variable language_">self</span>.softmax_version,</span><br><span class="line">            nrows=nrows</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x_rgb, x_e</span>):</span><br><span class="line">        <span class="comment"># 先把 tensor 排成 B,H,W,C</span></span><br><span class="line">        x_rgb = x_rgb.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>).contiguous()</span><br><span class="line">        x_e   = x_e.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>).contiguous()</span><br><span class="line">        <span class="comment"># 做一次 in_proj</span></span><br><span class="line">        x_rgb = <span class="variable language_">self</span>.in_proj(x_rgb)</span><br><span class="line">        x_e   = <span class="variable language_">self</span>.in_proj_modalx(x_e)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 深度卷积增强局部信息</span></span><br><span class="line">        ...</span><br><span class="line">        y_rgb, y_e = <span class="variable language_">self</span>.forward_corev2_multimodal(x_rgb_conv, x_e_conv)</span><br><span class="line">        ...</span><br><span class="line">        <span class="comment"># SE 类似的通道注意力，再 concat 两路</span></span><br><span class="line">        y = torch.concat([y_rgb, y_e], dim=-<span class="number">1</span>)</span><br><span class="line">        out = <span class="variable language_">self</span>.dropout(<span class="variable language_">self</span>.out_proj(y)).permute(<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>).contiguous()</span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>

<p>真正实现“式(6)”的是 <code>cross_selective_scan_multimodal_k2</code>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cross_selective_scan_multimodal_k2</span>(<span class="params">x_rgb, x_e, x_proj_weight, x_proj_bias,</span></span><br><span class="line"><span class="params">                                       dt_projs_weight, dt_projs_bias,</span></span><br><span class="line"><span class="params">                                       A_logs, Ds, out_norm1, out_norm2,</span></span><br><span class="line"><span class="params">                                       softmax_version=-<span class="number">1</span>, nrows=<span class="literal">True</span></span>):</span><br><span class="line">    B, D, H, W = x_rgb.shape</span><br><span class="line">    D, N = A_logs.shape</span><br><span class="line">    K, D, R = dt_projs_weight.shape</span><br><span class="line">    L = <span class="number">2</span> * H * W</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. CrossScan_multimodal: 拼成两条序列（正向 &amp; 反向）</span></span><br><span class="line">    x_fuse = CrossScan_multimodal.apply(x_rgb, x_e)  <span class="comment"># B, 2, C, 2HW</span></span><br><span class="line">    <span class="comment"># x_fuse[:,0] = [rgb 序列, e 序列]</span></span><br><span class="line">    <span class="comment"># x_fuse[:,1] = 上面那条的反向</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 线性投影 -&gt; [dt, B, C]</span></span><br><span class="line">    x_dbl = torch.einsum(<span class="string">&#x27;b k d l, k c d -&gt; b k c l&#x27;</span>, x_fuse, x_proj_weight)</span><br><span class="line">    ...</span><br><span class="line">    dts, Bs, Cs = torch.split(x_dbl, [R, N, N], dim=<span class="number">2</span>)</span><br><span class="line">    dts = torch.einsum(<span class="string">&#x27;b k r l, k d r -&gt; b k d l&#x27;</span>, dts, dt_projs_weight)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 准备 A, D</span></span><br><span class="line">    x_fuse = x_fuse.view(B, -<span class="number">1</span>, L).to(torch.<span class="built_in">float</span>)</span><br><span class="line">    dts    = dts.contiguous().view(B, -<span class="number">1</span>, L).to(torch.<span class="built_in">float</span>)</span><br><span class="line">    As = -torch.exp(A_logs.to(torch.<span class="built_in">float</span>))</span><br><span class="line">    ...</span><br><span class="line">    delta_bias = dt_projs_bias.view(-<span class="number">1</span>).to(torch.<span class="built_in">float</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 跑 SelectiveScan（就是 SSM）</span></span><br><span class="line">    ys = selective_scan(x_fuse, dts, As, Bs, Cs, Ds, delta_bias, delta_softplus, nrows)\</span><br><span class="line">           .view(B, K, -<span class="number">1</span>, <span class="number">2</span> * H * W).to(x_rgb.dtype)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. CrossMerge_multimodal: 把两条序列再拆/合回两路</span></span><br><span class="line">    y_rgb, y_e = CrossMerge_multimodal.apply(ys)</span><br><span class="line">    y_rgb = y_rgb.transpose(<span class="number">1</span>, <span class="number">2</span>).contiguous().view(B, H, W, -<span class="number">1</span>)</span><br><span class="line">    y_e   = y_e.transpose(<span class="number">1</span>, <span class="number">2</span>).contiguous().view(B, H, W, -<span class="number">1</span>)</span><br><span class="line">    y_rgb = out_norm1(y_rgb)</span><br><span class="line">    y_e   = out_norm2(y_e)</span><br><span class="line">    <span class="keyword">return</span> (y_rgb, y_e)</span><br></pre></td></tr></table></figure>

<p>对应关系（图8 &amp; 式(6)）：</p>
<ul>
<li>图8 里「两路输入 F₁&#x2F;F₂、正向&#x2F;反向」 👉 这里的 <code>CrossScan_multimodal</code> 生成两条序列（正向与反向）。</li>
<li>图8 里「两次 Linear 生成不同参数」 👉 这里一次 <code>x_fuse</code> 里已经含有两路信息（[RGB, E] 的拼接），通过 <code>x_proj_weight</code> + <code>dt_projs_weight</code> 把它们变成多组 (Δ,B,C)；不同的 k 维度相当于式(6) 中“不同组合（F₁F₂ &#x2F; F₂F₁）”的效果。</li>
<li>图8 里「两次 SSM 再融合」 👉 这里的 <code>SelectiveScan.apply(...)</code> 输出 <code>ys</code>，然后 <code>CrossMerge_multimodal.apply(ys)</code> 把它们合成 <code>y_rgb, y_e</code> 两个结果（相当于 F₁₂ 与 F₂₁ 的融合）。</li>
</ul>
<p>在 <code>SSF.forward</code> 里，FF-SSM 被用了 <strong>三次</strong>：</p>
<ol>
<li><code>x_fuse_rgb -&gt; self.cm_fusion_rgb(...)</code>：融合「RGB 互补特征 + RGB 共享特征」</li>
<li><code>x_fuse_e   -&gt; self.cm_fusion_e(...)</code>：融合「E 互补特征 + E 共享特征」</li>
<li><code>[x_rgb, x_e] -&gt; self.cm_fusion(...)</code>：最后再融合「融合后的 RGB 与 融合后的 E」</li>
</ol>
<p>这整体就是论文里 FF-SSM 的那一整套“前后双向、模态间来回流动”的过程。</p>
<h3 id="损失函数"><a href="#损失函数" class="headerlink" title="损失函数"></a>损失函数</h3><p>由MS2Fusion模块生成的融合特征被送入颈部网络（Neck）和检测头（Detection Head），整个流程以<strong>端到端</strong>的方式进行优化。在本文中，作者分别在基于<strong>YOLOv5</strong>和<strong>Co-Detr</strong>的两种检测框架中对MS2Fusion进行了评估。</p>
<h4 id="YOLO-框架下的总损失函数"><a href="#YOLO-框架下的总损失函数" class="headerlink" title="YOLO 框架下的总损失函数"></a>YOLO 框架下的总损失函数</h4><p>在YOLO框架中，总损失函数可以表示为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>y</mi><mi>o</mi><mi>l</mi><mi>o</mi></mrow></msub><mo>=</mo><msub><mi>λ</mi><mtext>bbox</mtext></msub><mo>⋅</mo><msub><mi mathvariant="script">L</mi><mtext>bbox</mtext></msub><mo>+</mo><msub><mi>λ</mi><mtext>obj</mtext></msub><mo>⋅</mo><msub><mi mathvariant="script">L</mi><mtext>obj</mtext></msub><mo>+</mo><msub><mi>λ</mi><mtext>cls</mtext></msub><mo>⋅</mo><msub><mi mathvariant="script">L</mi><mtext>cls</mtext></msub></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(7)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\mathcal{L}_{yolo} = \lambda_{\text{bbox}} \cdot \mathcal{L}_{\text{bbox}} + \lambda_{\text{obj}} \cdot \mathcal{L}_{\text{obj}} + \lambda_{\text{cls}} \cdot \mathcal{L}_{\text{cls}}
\end{align}
\tag{7}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">yo</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bbox</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bbox</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obj</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obj</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7</span></span><span class="mord">)</span></span></span></span></span></span>
<p>其中：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>b</mi><mi>b</mi><mi>o</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{bbox}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bb</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是**定位损失** （Localization Loss）。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>o</mi><mi>b</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{obj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">bj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 是**置信度损失** （Confidence Loss）。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>c</mi><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{cls}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是**分类损失** （Classification Loss）。</li>
<li>超参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>b</mi><mi>b</mi><mi>o</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{bbox}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bb</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>o</mi><mi>b</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{obj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">bj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>c</mi><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda_{cls}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 用于调整各项损失的权重，这些权重保持了基线模型的默认设置。</li>
</ul>
<h4 id="CoDetr-框架下的总损失函数"><a href="#CoDetr-框架下的总损失函数" class="headerlink" title="CoDetr 框架下的总损失函数"></a>CoDetr 框架下的总损失函数</h4><p>CoDetr框架采用了一个<strong>多任务损失函数</strong>，该函数由<strong>四个组成部分</strong>构成：一个主要的CoDINOHead 和三个辅助检测头（包括RPN头、ROI头和Bbox头）。</p>
<p>总损失函数可以表示为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="script">L</mi><mtext>CoDetr</mtext></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>λ</mi><mtext>primary</mtext></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>QFL</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>L1</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>GIoU</mtext></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>λ</mi><mtext>RPN</mtext></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>CE</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>L1</mtext></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><msub><mi>λ</mi><mtext>ROI</mtext></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>CE</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>GIoU</mtext></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>λ</mi><mtext>Bbox</mtext></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>Focal</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>GIoU</mtext></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mtext>CE</mtext></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(8)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align}
\mathcal{L}_{\text{CoDetr}} &amp;= \lambda_{\text{primary}} \cdot \left( \mathcal{L}_{\text{QFL}} + \mathcal{L}_{\text{L1}} + \mathcal{L}_{\text{GIoU}} \right) + \lambda_{\text{RPN}} \cdot \left( \mathcal{L}_{\text{CE}} + \mathcal{L}_{\text{L1}} \right) \\
&amp;+ \lambda_{\text{ROI}} \cdot \left( \mathcal{L}_{\text{CE}} + \mathcal{L}_{\text{GIoU}} \right) + \lambda_{\text{Bbox}} \cdot \left( \mathcal{L}_{\text{Focal}} + \mathcal{L}_{\text{GIoU}} + \mathcal{L}_{\text{CE}} \right)
\end{align}
\tag{8}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CoDetr</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">primary</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">QFL</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">L1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">GIoU</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">RPN</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">L1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ROI</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">GIoU</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Bbox</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Focal</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">GIoU</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">8</span></span><span class="mord">)</span></span></span></span></span></span>
<p>其中：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>Q</mi><mi>F</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{QFL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">QF</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 是**质量焦点损失** （Quality Focal Loss）。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>L</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">L_{L1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>L</mtext><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{L}1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">L</span></span><span class="mord">1</span></span></span></span> **损失**。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>G</mi><mi>I</mi><mi>o</mi><mi>U</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{GIoU}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是 **GIoU损失**。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>C</mi><mi>E</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{CE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">CE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是**交叉熵损失** （Cross-Entropy Loss）。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>F</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{Focal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mord mathnormal mtight">oc</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是**焦点损失** （Focal Loss）。</li>
<li>超参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span> 为各项损失项的<strong>加权因子</strong>。</li>
</ul>
<h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p>本章节详细介绍了MS2Fusion模型所进行的系列实验，包括实验设置、SOTA（State-of-the-art）比较、泛化能力测试、消融研究和定性分析。</p>
<h3 id="数据集和评估指标"><a href="#数据集和评估指标" class="headerlink" title="数据集和评估指标"></a>数据集和评估指标</h3><p><strong>数据集：</strong><br>本文在四个多光谱目标检测数据集上进行了评估：</p>
<ol>
<li><strong>FLIR (aligned)</strong>: 包含5,142对RGB-T图像，分为4,129对训练集和1,013对测试集</li>
<li><strong>LLVIP</strong>: 包含15,488对RGB-T图像，12,025对用于训练，3,463对用于测试，主要标注热成像图像</li>
<li><strong>M3FD</strong>: 包含4,200对RGB-T对齐图像，涵盖多种条件和六个类别，按8:2划分训练&#x2F;测试集</li>
<li><strong>VEDAI</strong>: 包含3,640个目标实例（9个类别）的航拍图像，共1,210张1024x1024图像，包含RGB和NIR（近红外）通道，按9:1划分训练&#x2F;测试集</li>
</ol>
<p><strong>评估指标：</strong></p>
<ul>
<li><strong>AP (Average Precision)</strong>: 标源于精确率-召回率（PR）曲线下的面积，该曲线以召回率为横轴、精确率为纵轴</li>
<li><strong>mAP (mean Average Precision)</strong>: 所有类别的AP加权平均值。实验中，<a href="mailto:&#109;&#x41;&#80;&#x40;&#48;&#x2e;&#53;">mAP@0.5</a>（IoU阈值为0.5）是主要指标。该指标的值越高，表明性能越好</li>
</ul>
<h3 id="实验设置"><a href="#实验设置" class="headerlink" title="实验设置"></a>实验设置</h3><ul>
<li><strong>硬件</strong>: Intel i7-9700 CPU, 64GB RAM, Nvidia RTX 3090 GPU (24GB)</li>
<li><strong>软件</strong>: PyTorch</li>
<li><strong>超参数</strong>: 消融研究使用60个epoch，批量大小(batch size)为4，使用SGD优化器，初始学习率为0.01，动量0.937，权重衰减0.0005，余弦学习率衰减</li>
<li><strong>输入尺寸</strong>: 训练时为640x640，测试时为640x512</li>
<li><strong>数据增强</strong>: 使用Mosaic（马赛克）增强</li>
</ul>
<h3 id="SOTA比较"><a href="#SOTA比较" class="headerlink" title="SOTA比较"></a>SOTA比较</h3><p>实验在YOLOv5（速度快、精度稍低）和CoDetr（速度慢、精度高）两个框架上进行。YOLOv5检测器的推理速度更快，但精度较低；而CoDetr的检测精度更高，但推理速度较慢。</p>
<h4 id="FLIR-数据集比较"><a href="#FLIR-数据集比较" class="headerlink" title="FLIR 数据集比较"></a>FLIR 数据集比较</h4><p><strong>表2: FLIR-align 数据集比较</strong><br>(‘-’ 表示缺失值. ‘‡’ 符号表示使用CoDetr框架的实验结果，输入图像被调整为640×640像素的固定分辨率)</p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center"><a href="mailto:&#109;&#x41;&#x50;&#64;&#x30;&#x2e;&#x35;">mAP@0.5</a></th>
<th align="center">mAP</th>
<th align="center">自行车</th>
<th align="center">汽车</th>
<th align="center">人</th>
</tr>
</thead>
<tbody><tr>
<td align="center">MMTOD-CG</td>
<td align="center">61.4</td>
<td align="center">-</td>
<td align="center">50.3</td>
<td align="center">70.6</td>
<td align="center">63.3</td>
</tr>
<tr>
<td align="center">MMTOD-UNIT</td>
<td align="center">61.5</td>
<td align="center">-</td>
<td align="center">49.4</td>
<td align="center">70.7</td>
<td align="center">64.5</td>
</tr>
<tr>
<td align="center">CMPD</td>
<td align="center">69.4</td>
<td align="center">-</td>
<td align="center">59.9</td>
<td align="center">78.1</td>
<td align="center">69.6</td>
</tr>
<tr>
<td align="center">CFR</td>
<td align="center">72.4</td>
<td align="center">-</td>
<td align="center">57.8</td>
<td align="center">84.9</td>
<td align="center">74.5</td>
</tr>
<tr>
<td align="center">GAFF</td>
<td align="center">72.9</td>
<td align="center">37.5</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">BU-ATT</td>
<td align="center">73.1</td>
<td align="center">-</td>
<td align="center">56.1</td>
<td align="center">87.0</td>
<td align="center">76.1</td>
</tr>
<tr>
<td align="center">BU-LTT</td>
<td align="center">73.2</td>
<td align="center">-</td>
<td align="center">57.4</td>
<td align="center">86.5</td>
<td align="center">75.6</td>
</tr>
<tr>
<td align="center">UA_CMDet</td>
<td align="center">78.6</td>
<td align="center">-</td>
<td align="center">64.3</td>
<td align="center">88.4</td>
<td align="center">83.2</td>
</tr>
<tr>
<td align="center">CFT</td>
<td align="center">78.7</td>
<td align="center">40.2</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">CSAA</td>
<td align="center">79.2</td>
<td align="center">41.3</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">ICAFusion</td>
<td align="center">79.2</td>
<td align="center">41.4</td>
<td align="center">66.9</td>
<td align="center">89.0</td>
<td align="center">81.6</td>
</tr>
<tr>
<td align="center">CrossFormer</td>
<td align="center">79.3</td>
<td align="center">42.1</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">MFPT</td>
<td align="center">80.0</td>
<td align="center">-</td>
<td align="center">67.7</td>
<td align="center">89.0</td>
<td align="center">83.2</td>
</tr>
<tr>
<td align="center">MMFN</td>
<td align="center">80.8</td>
<td align="center">41.7</td>
<td align="center">65.5</td>
<td align="center">91.2</td>
<td align="center">85.7</td>
</tr>
<tr>
<td align="center">RSDet</td>
<td align="center">81.1</td>
<td align="center">41.4</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">MiPa</td>
<td align="center">81.3</td>
<td align="center">44.8</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">UniRGB-IR</td>
<td align="center">81.4</td>
<td align="center">44.1</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">CPCF</td>
<td align="center">82.1</td>
<td align="center">44.6</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">GM-DETR</td>
<td align="center">83.9</td>
<td align="center">45.8</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">Fusion-Mamba(yolov5)</td>
<td align="center">84.3</td>
<td align="center">44.4</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">Fusion-Mamba(yolov8)</td>
<td align="center">84.9</td>
<td align="center">47.0</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">TFDet</td>
<td align="center">86.6</td>
<td align="center">46.6</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">DAMSDet</td>
<td align="center">86.6</td>
<td align="center">49.3</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">Ours</td>
<td align="center">83.3</td>
<td align="center">40.3</td>
<td align="center">74.9</td>
<td align="center">89.8</td>
<td align="center">85.1</td>
</tr>
<tr>
<td align="center">Ours‡</td>
<td align="center">87.8</td>
<td align="center">49.7</td>
<td align="center">79.6</td>
<td align="center">93.4</td>
<td align="center">90.2</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表2所示，MS2Fusion在YOLOv5框架下达到83.3%的<a href="mailto:&#x6d;&#65;&#80;&#x40;&#x30;&#46;&#x35;">mAP@0.5</a>，在CoDetr框架下达到87.8%的<a href="mailto:&#109;&#65;&#80;&#64;&#x30;&#x2e;&#x35;">mAP@0.5</a>，均取得了SOTA性能，分别比当前最优方法提升了2.2%和6.7%。尤其在“人”和“自行车”这两个非热源和小目标类别上增益明显。</p>
<h4 id="LLVIP-数据集比较"><a href="#LLVIP-数据集比较" class="headerlink" title="LLVIP 数据集比较"></a>LLVIP 数据集比较</h4><p><strong>表3: LLVIP 数据集比较</strong></p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center"><a href="mailto:&#109;&#x41;&#80;&#x40;&#x30;&#x2e;&#53;">mAP@0.5</a></th>
<th align="center">mAP</th>
</tr>
</thead>
<tbody><tr>
<td align="center">DIVFusion</td>
<td align="center">89.8</td>
<td align="center">52.0</td>
</tr>
<tr>
<td align="center">GAFF</td>
<td align="center">94.0</td>
<td align="center">55.8</td>
</tr>
<tr>
<td align="center">CSAA</td>
<td align="center">94.3</td>
<td align="center">41.3</td>
</tr>
<tr>
<td align="center">ECISNet</td>
<td align="center">95.7</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">RSDet</td>
<td align="center">95.8</td>
<td align="center">61.3</td>
</tr>
<tr>
<td align="center">UniRGB-IR</td>
<td align="center">96.1</td>
<td align="center">63.2</td>
</tr>
<tr>
<td align="center">UA_CMDet</td>
<td align="center">96.3</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">CPCF</td>
<td align="center">96.4</td>
<td align="center">65.0</td>
</tr>
<tr>
<td align="center">Fusion-Mamba(yolov5)</td>
<td align="center">96.8</td>
<td align="center">62.8</td>
</tr>
<tr>
<td align="center">Fusion-Mamba(yolov8)</td>
<td align="center">97.0</td>
<td align="center">64.3</td>
</tr>
<tr>
<td align="center">MMFN</td>
<td align="center">97.2</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">GM-DETR</td>
<td align="center">97.4</td>
<td align="center">70.2</td>
</tr>
<tr>
<td align="center">TFDet</td>
<td align="center">97.9</td>
<td align="center">71.1</td>
</tr>
<tr>
<td align="center">DAMSDet</td>
<td align="center">97.9</td>
<td align="center">69.6</td>
</tr>
<tr>
<td align="center">MiPa</td>
<td align="center">98.2</td>
<td align="center">66.5</td>
</tr>
<tr>
<td align="center">Ours</td>
<td align="center">97.5</td>
<td align="center">65.5</td>
</tr>
<tr>
<td align="center">Ours‡</td>
<td align="center">98.4</td>
<td align="center">70.6</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表3所示，MS2Fusion在LLVIP数据集上同样表现出色，YOLOv5框架下<a href="mailto:&#x6d;&#65;&#x50;&#64;&#x30;&#46;&#x35;">mAP@0.5</a>达到97.5%，CoDetr框架下达到98.4%，优于传统的CNN和Transformer方法。</p>
<h4 id="M3FD-数据集比较"><a href="#M3FD-数据集比较" class="headerlink" title="M3FD 数据集比较"></a>M3FD 数据集比较</h4><p><strong>表4: M3FD 数据集比较</strong></p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center"><a href="mailto:&#109;&#65;&#80;&#64;&#x30;&#46;&#x35;">mAP@0.5</a></th>
<th align="center">mAP</th>
<th align="center">People</th>
<th align="center">Bus</th>
<th align="center">Car</th>
<th align="center">Motorcycle</th>
<th align="center">Lamp</th>
<th align="center">Truck</th>
</tr>
</thead>
<tbody><tr>
<td align="center">DIDFuse</td>
<td align="center">79.0</td>
<td align="center">52.6</td>
<td align="center">79.6</td>
<td align="center">79.7</td>
<td align="center">92.5</td>
<td align="center">68.7</td>
<td align="center">84.7</td>
<td align="center">68.8</td>
</tr>
<tr>
<td align="center">SDNet</td>
<td align="center">79.0</td>
<td align="center">52.9</td>
<td align="center">79.4</td>
<td align="center">81.4</td>
<td align="center">92.3</td>
<td align="center">67.4</td>
<td align="center">84.1</td>
<td align="center">69.3</td>
</tr>
<tr>
<td align="center">RFNet</td>
<td align="center">79.4</td>
<td align="center">53.2</td>
<td align="center">79.4</td>
<td align="center">78.2</td>
<td align="center">91.1</td>
<td align="center">72.8</td>
<td align="center">85.0</td>
<td align="center">69.0</td>
</tr>
<tr>
<td align="center">ReC</td>
<td align="center">79.5</td>
<td align="center">-</td>
<td align="center">79.4</td>
<td align="center">78.9</td>
<td align="center">91.8</td>
<td align="center">69.3</td>
<td align="center">87.4</td>
<td align="center">70.0</td>
</tr>
<tr>
<td align="center">U2F</td>
<td align="center">79.6</td>
<td align="center">-</td>
<td align="center">80.7</td>
<td align="center">79.2</td>
<td align="center">92.3</td>
<td align="center">66.8</td>
<td align="center">87.6</td>
<td align="center">71.4</td>
</tr>
<tr>
<td align="center">DAMSDet</td>
<td align="center">80.2</td>
<td align="center">52.9</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">TarDAL</td>
<td align="center">80.5</td>
<td align="center">54.1</td>
<td align="center">81.5</td>
<td align="center">81.3</td>
<td align="center">94.8</td>
<td align="center">69.3</td>
<td align="center">87.1</td>
<td align="center">68.7</td>
</tr>
<tr>
<td align="center">DeFusion</td>
<td align="center">80.8</td>
<td align="center">53.8</td>
<td align="center">80.8</td>
<td align="center">83.0</td>
<td align="center">92.5</td>
<td align="center">69.4</td>
<td align="center">87.8</td>
<td align="center">71.4</td>
</tr>
<tr>
<td align="center">CDDFusion</td>
<td align="center">81.1</td>
<td align="center">54.3</td>
<td align="center">81.6</td>
<td align="center">82.6</td>
<td align="center">92.5</td>
<td align="center">71.6</td>
<td align="center">86.9</td>
<td align="center">71.5</td>
</tr>
<tr>
<td align="center">IGNet</td>
<td align="center">81.5</td>
<td align="center">54.5</td>
<td align="center">81.6</td>
<td align="center">82.4</td>
<td align="center">92.8</td>
<td align="center">73.0</td>
<td align="center">86.9</td>
<td align="center">72.1</td>
</tr>
<tr>
<td align="center">SuperFusion</td>
<td align="center">83.5</td>
<td align="center">56.0</td>
<td align="center">83.7</td>
<td align="center">93.2</td>
<td align="center">91.0</td>
<td align="center">77.4</td>
<td align="center">70.0</td>
<td align="center">85.8</td>
</tr>
<tr>
<td align="center">Fusion-Mamba(yolov5)</td>
<td align="center">85.0</td>
<td align="center">57.5</td>
<td align="center">80.3</td>
<td align="center">92.8</td>
<td align="center">91.9</td>
<td align="center">73.0</td>
<td align="center">84.8</td>
<td align="center">87.1</td>
</tr>
<tr>
<td align="center">MMFN</td>
<td align="center">86.2</td>
<td align="center">-</td>
<td align="center">83.0</td>
<td align="center">92.1</td>
<td align="center">93.2</td>
<td align="center">73.7</td>
<td align="center">87.6</td>
<td align="center">87.4</td>
</tr>
<tr>
<td align="center">Fusion-Mamba(yolov8)</td>
<td align="center">88.0</td>
<td align="center">61.9</td>
<td align="center">84.3</td>
<td align="center">94.2</td>
<td align="center">92.9</td>
<td align="center">80.5</td>
<td align="center">87.5</td>
<td align="center">88.8</td>
</tr>
<tr>
<td align="center">Ours</td>
<td align="center">89.4</td>
<td align="center">59.7</td>
<td align="center">85.6</td>
<td align="center">93.7</td>
<td align="center">93.9</td>
<td align="center">82.4</td>
<td align="center">90.8</td>
<td align="center">89.9</td>
</tr>
<tr>
<td align="center">Ours‡</td>
<td align="center">91.4</td>
<td align="center">65.6</td>
<td align="center">89.8</td>
<td align="center">95.0</td>
<td align="center">94.7</td>
<td align="center">88.2</td>
<td align="center">88.3</td>
<td align="center">92.4</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表4所示，MS2Fusion在M3FD数据集上表现出显著优势，YOLOv5框架提升3.2% (<a href="mailto:&#x6d;&#x41;&#80;&#x40;&#x30;&#46;&#x35;">mAP@0.5</a>)，CoDetr框架提升5.2% (<a href="mailto:&#x6d;&#65;&#x50;&#64;&#48;&#x2e;&#53;">mAP@0.5</a>)。特别是在摩托车等高热源物体上提升明显，显示了其有效融合热成像特征的能力。</p>
<h4 id="VEDAI-数据集比较"><a href="#VEDAI-数据集比较" class="headerlink" title="VEDAI 数据集比较"></a>VEDAI 数据集比较</h4><p><strong>表5: VEDAI 数据集比较</strong></p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center"><a href="mailto:&#109;&#65;&#x50;&#x40;&#48;&#46;&#53;">mAP@0.5</a></th>
<th align="center">Car</th>
<th align="center">Truck</th>
<th align="center">Pickup</th>
<th align="center">Tractor</th>
<th align="center">Camper</th>
<th align="center">Ship</th>
<th align="center">Van</th>
<th align="center">Plane</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ICAFusion</td>
<td align="center">76.6</td>
<td align="center">88.0</td>
<td align="center">67.5</td>
<td align="center">80.9</td>
<td align="center">74.9</td>
<td align="center">78.3</td>
<td align="center">56.9</td>
<td align="center">69.8</td>
<td align="center">96.7</td>
</tr>
<tr>
<td align="center">MidFusion1</td>
<td align="center">77.4</td>
<td align="center">88.2</td>
<td align="center">84.9</td>
<td align="center">81.7</td>
<td align="center">68.4</td>
<td align="center">72.2</td>
<td align="center">71.0</td>
<td align="center">53.6</td>
<td align="center">99.5</td>
</tr>
<tr>
<td align="center">MidFusion2</td>
<td align="center">78.9</td>
<td align="center">89.2</td>
<td align="center">78.8</td>
<td align="center">87.6</td>
<td align="center">66.2</td>
<td align="center">73.2</td>
<td align="center">62.5</td>
<td align="center">73.9</td>
<td align="center">99.5</td>
</tr>
<tr>
<td align="center">Input Fusion1</td>
<td align="center">80.0</td>
<td align="center">88.7</td>
<td align="center">77.7</td>
<td align="center">79.5</td>
<td align="center">72.3</td>
<td align="center">75.7</td>
<td align="center">78.6</td>
<td align="center">72.1</td>
<td align="center">95.7</td>
</tr>
<tr>
<td align="center">Input Fusion2</td>
<td align="center">80.5</td>
<td align="center">89.1</td>
<td align="center">84.9</td>
<td align="center">78.7</td>
<td align="center">84.2</td>
<td align="center">70.1</td>
<td align="center">69.9</td>
<td align="center">68.8</td>
<td align="center">98.4</td>
</tr>
<tr>
<td align="center">YOLOFusion</td>
<td align="center">81.6</td>
<td align="center">91.7</td>
<td align="center">78.1</td>
<td align="center">85.9</td>
<td align="center">71.9</td>
<td align="center">78.9</td>
<td align="center">71.7</td>
<td align="center">75.2</td>
<td align="center">99.5</td>
</tr>
<tr>
<td align="center">Ours</td>
<td align="center">80.2</td>
<td align="center">89.5</td>
<td align="center">75.6</td>
<td align="center">84.2</td>
<td align="center">81.6</td>
<td align="center">75.9</td>
<td align="center">61.8</td>
<td align="center">76.4</td>
<td align="center">97.0</td>
</tr>
<tr>
<td align="center">Ours‡</td>
<td align="center">84.2</td>
<td align="center">93.3</td>
<td align="center">78.9</td>
<td align="center">88.5</td>
<td align="center">85.8</td>
<td align="center">80.6</td>
<td align="center">65.5</td>
<td align="center">83.6</td>
<td align="center">97.1</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表5所示，在VEDAI（航拍）数据集上，MS2Fusion (CoDetr) 达到了84.2%的<a href="mailto:&#x6d;&#65;&#x50;&#x40;&#x30;&#x2e;&#x35;">mAP@0.5</a>，取得了SOTA性能。这表明模型即使没有针对小目标检测进行专门优化，该模型依然能有效关注小目标的多模态特征，在无人机图像应用中表现出鲁棒性。</p>
<h3 id="泛化到其他多模态任务"><a href="#泛化到其他多模态任务" class="headerlink" title="泛化到其他多模态任务"></a>泛化到其他多模态任务</h3><h4 id="RGB-T-语义分割"><a href="#RGB-T-语义分割" class="headerlink" title="RGB-T 语义分割"></a>RGB-T 语义分割</h4><ul>
<li><strong>评估指标</strong>: 平均交并比 mIoU (Mean Intersection over Union)，是语义分割模型常用的评估指标，它通过计算预测分割与真实分割的交并比来衡量模型性能</li>
<li><strong>数据集</strong>: MFNet (1,569对图像, 8类) 和 SemanticRT (11,371对图像, 13类)</li>
</ul>
<p><strong>表6: MFNet 数据集比较</strong></p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center">mIoU</th>
<th align="center">Car</th>
<th align="center">Person</th>
<th align="center">Bike</th>
<th align="center">Curve</th>
<th align="center">Car Stop</th>
<th align="center">Guardrail</th>
<th align="center">Color Cone</th>
<th align="center">Bump</th>
</tr>
</thead>
<tbody><tr>
<td align="center">PSTNet</td>
<td align="center">48.4</td>
<td align="center">76.8</td>
<td align="center">52.6</td>
<td align="center">55.3</td>
<td align="center">29.6</td>
<td align="center">25.1</td>
<td align="center">15.1</td>
<td align="center">39.4</td>
<td align="center">45.0</td>
</tr>
<tr>
<td align="center">RTFNet</td>
<td align="center">53.2</td>
<td align="center">87.4</td>
<td align="center">70.3</td>
<td align="center">62.7</td>
<td align="center">45.3</td>
<td align="center">29.8</td>
<td align="center">0.0</td>
<td align="center">29.1</td>
<td align="center">55.7</td>
</tr>
<tr>
<td align="center">FuseSeg</td>
<td align="center">54.5</td>
<td align="center">87.9</td>
<td align="center">71.7</td>
<td align="center">64.6</td>
<td align="center">44.8</td>
<td align="center">22.7</td>
<td align="center">6.4</td>
<td align="center">46.9</td>
<td align="center">47.9</td>
</tr>
<tr>
<td align="center">AFNet</td>
<td align="center">54.6</td>
<td align="center">86.0</td>
<td align="center">67.4</td>
<td align="center">62.0</td>
<td align="center">43.0</td>
<td align="center">28.9</td>
<td align="center">4.6</td>
<td align="center">44.9</td>
<td align="center">56.6</td>
</tr>
<tr>
<td align="center">ABMDRNet</td>
<td align="center">54.8</td>
<td align="center">84.8</td>
<td align="center">69.6</td>
<td align="center">60.3</td>
<td align="center">45.1</td>
<td align="center">33.1</td>
<td align="center">5.1</td>
<td align="center">47.4</td>
<td align="center">50.0</td>
</tr>
<tr>
<td align="center">FEANet</td>
<td align="center">55.3</td>
<td align="center">87.8</td>
<td align="center">71.1</td>
<td align="center">61.1</td>
<td align="center">46.5</td>
<td align="center">22.1</td>
<td align="center">6.6</td>
<td align="center">55.3</td>
<td align="center">48.9</td>
</tr>
<tr>
<td align="center">GMNet</td>
<td align="center">57.3</td>
<td align="center">86.5</td>
<td align="center">73.1</td>
<td align="center">61.7</td>
<td align="center">44.0</td>
<td align="center">42.3</td>
<td align="center">14.5</td>
<td align="center">48.7</td>
<td align="center">47.4</td>
</tr>
<tr>
<td align="center">EGFNet</td>
<td align="center">57.5</td>
<td align="center">89.8</td>
<td align="center">71.6</td>
<td align="center">63.9</td>
<td align="center">46.7</td>
<td align="center">31.3</td>
<td align="center">6.7</td>
<td align="center">52.0</td>
<td align="center">57.4</td>
</tr>
<tr>
<td align="center">DPLNet</td>
<td align="center">59.3</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">CMX</td>
<td align="center">59.7</td>
<td align="center">90.1</td>
<td align="center">75.2</td>
<td align="center">64.5</td>
<td align="center">50.2</td>
<td align="center">35.3</td>
<td align="center">8.5</td>
<td align="center">54.2</td>
<td align="center">60.6</td>
</tr>
<tr>
<td align="center">CRM-RGBT-Seg</td>
<td align="center">61.4</td>
<td align="center">90.0</td>
<td align="center">75.1</td>
<td align="center">67.0</td>
<td align="center">45.2</td>
<td align="center">49.7</td>
<td align="center">18.4</td>
<td align="center">54.2</td>
<td align="center">54.4</td>
</tr>
<tr>
<td align="center">MFNet(baseline)</td>
<td align="center">63.5</td>
<td align="center">92.6</td>
<td align="center">82.1</td>
<td align="center">78.2</td>
<td align="center">89.6</td>
<td align="center">24.1</td>
<td align="center">1.2</td>
<td align="center">46.2</td>
<td align="center">94.2</td>
</tr>
<tr>
<td align="center">MS2Fusion-MFNet</td>
<td align="center">66.3</td>
<td align="center">94.4</td>
<td align="center">82.5</td>
<td align="center">81.0</td>
<td align="center">89.9</td>
<td align="center">34.7</td>
<td align="center">0.0</td>
<td align="center">49.7</td>
<td align="center">98.3</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表6所示，在MFNet数据集上，MS2Fusion (MS2Fusion-MFNet) 取得了66.3%的最佳mIoU，相比基线提升了2.8%。在凸起和曲线类别上提升尤为明显，这表明MS2Fusion能有效利用跨模态的共享特征（如局部几何特征），显著提升这两个类别的分割性能。</p>
<p><strong>表7: SemanticRT 数据集比较</strong></p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">mIoU</th>
<th align="left">CarStop</th>
<th align="left">Bike</th>
<th align="left">Bicyclist</th>
<th align="left">Mtcycle</th>
<th align="left">Mtcyclist</th>
<th align="left">Car</th>
<th align="left">Tricycle</th>
<th align="left">TrafLight</th>
<th align="left">Box</th>
<th align="left">Pole</th>
<th align="left">Curve</th>
<th align="left">Person</th>
</tr>
</thead>
<tbody><tr>
<td align="left">PSTNet</td>
<td align="left">68.0</td>
<td align="left">71.1</td>
<td align="left">62.3</td>
<td align="left">58.5</td>
<td align="left">47.3</td>
<td align="left">55.2</td>
<td align="left">85.4</td>
<td align="left">44.2</td>
<td align="left">75.7</td>
<td align="left">83.0</td>
<td align="left">71.7</td>
<td align="left">62.2</td>
<td align="left">72.2</td>
</tr>
<tr>
<td align="left">RTFNet</td>
<td align="left">75.5</td>
<td align="left">79.6</td>
<td align="left">68.0</td>
<td align="left">67.4</td>
<td align="left">63.7</td>
<td align="left">61.6</td>
<td align="left">90.4</td>
<td align="left">66.0</td>
<td align="left">78.3</td>
<td align="left">85.9</td>
<td align="left">78.0</td>
<td align="left">67.2</td>
<td align="left">78.9</td>
</tr>
<tr>
<td align="left">EGFNet</td>
<td align="left">77.4</td>
<td align="left">78.6</td>
<td align="left">71.3</td>
<td align="left">70.9</td>
<td align="left">68.4</td>
<td align="left">66.1</td>
<td align="left">90.5</td>
<td align="left">71.5</td>
<td align="left">80.4</td>
<td align="left">85.4</td>
<td align="left">76.5</td>
<td align="left">66.9</td>
<td align="left">83.7</td>
</tr>
<tr>
<td align="left">ECM</td>
<td align="left">79.3</td>
<td align="left">80.2</td>
<td align="left">75.0</td>
<td align="left">75.5</td>
<td align="left">71.4</td>
<td align="left">70.4</td>
<td align="left">90.3</td>
<td align="left">74.0</td>
<td align="left">85.9</td>
<td align="left">85.6</td>
<td align="left">77.2</td>
<td align="left">68.3</td>
<td align="left">85.0</td>
</tr>
<tr>
<td align="left">MFNet(baseline)</td>
<td align="left">77.8</td>
<td align="left">75.3</td>
<td align="left">77.1</td>
<td align="left">63.2</td>
<td align="left">71.1</td>
<td align="left">57.3</td>
<td align="left">97.9</td>
<td align="left">66</td>
<td align="left">85.9</td>
<td align="left">89.5</td>
<td align="left">82.4</td>
<td align="left">85.0</td>
<td align="left">83.2</td>
</tr>
<tr>
<td align="left">MS2Fusion-MFNet</td>
<td align="left">78.8</td>
<td align="left">75.3</td>
<td align="left">77.7</td>
<td align="left">66.3</td>
<td align="left">72.3</td>
<td align="left">59.4</td>
<td align="left">97.9</td>
<td align="left">68.2</td>
<td align="left">86.0</td>
<td align="left">89.6</td>
<td align="left">81.8</td>
<td align="left">84.6</td>
<td align="left">86.7</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表7所示，在SemanticRT数据集上，MS2Fusion (MS2Fusion-MFNet) 同样表现优异，mIoU达到78.8%，相比基线提升1.0%，且与SOTA方法 (ECM) 仅相差0.5%，证明了其在多光谱特征融合上的鲁棒性和多功能性。</p>
<h4 id="RGB-T-显著性目标检测-RGB-T-SOD"><a href="#RGB-T-显著性目标检测-RGB-T-SOD" class="headerlink" title="RGB-T 显著性目标检测 (RGB-T SOD)"></a>RGB-T 显著性目标检测 (RGB-T SOD)</h4><ul>
<li><strong>评估指标</strong>: 平均绝对误差 MAE (↓越低越好), F度量 adpF (↑越高越好), S度量 S-Measure (S↑), E度量 E-Measure (adpE↑)</li>
<li><strong>数据集</strong>: VT821, VT1000, VT5000</li>
<li><strong>基线模型</strong>: MSEDNET</li>
</ul>
<p><strong>表8: VT821, VT1000 和 VT5000 数据集比较</strong><br>(↓ 表示值越小越好, ↑ 表示值越大越好)</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">VT821</th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left">VT1000</th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
<th align="left">VT5000</th>
<th align="left"></th>
<th align="left"></th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left"></td>
<td align="left">S↑</td>
<td align="left">adpE↑</td>
<td align="left">adpF↑</td>
<td align="left">MAE↓</td>
<td align="left">S↑</td>
<td align="left">adpE↑</td>
<td align="left">adpF↑</td>
<td align="left">MAE↓</td>
<td align="left">S↑</td>
<td align="left">adpE↑</td>
<td align="left">adpF↑</td>
<td align="left">MAE↓</td>
</tr>
<tr>
<td align="left">MTMR</td>
<td align="left">72.5</td>
<td align="left">81.5</td>
<td align="left">66.2</td>
<td align="left">10.9</td>
<td align="left">70.6</td>
<td align="left">83.6</td>
<td align="left">71.5</td>
<td align="left">11.9</td>
<td align="left">68.0</td>
<td align="left">79.5</td>
<td align="left">59.5</td>
<td align="left">11.4</td>
</tr>
<tr>
<td align="left">M3S-NIR</td>
<td align="left">72.3</td>
<td align="left">85.9</td>
<td align="left">76.4</td>
<td align="left">14.0</td>
<td align="left">72.6</td>
<td align="left">82.7</td>
<td align="left">71.7</td>
<td align="left">14.5</td>
<td align="left">65.2</td>
<td align="left">78.0</td>
<td align="left">57.5</td>
<td align="left">16.8</td>
</tr>
<tr>
<td align="left">SGDL</td>
<td align="left">76.5</td>
<td align="left">84.7</td>
<td align="left">76.1</td>
<td align="left">8.5</td>
<td align="left">78.7</td>
<td align="left">85.6</td>
<td align="left">76.4</td>
<td align="left">9.0</td>
<td align="left">75.0</td>
<td align="left">82.4</td>
<td align="left">67.2</td>
<td align="left">8.9</td>
</tr>
<tr>
<td align="left">PoolNet</td>
<td align="left">75.1</td>
<td align="left">73.9</td>
<td align="left">57.8</td>
<td align="left">10.9</td>
<td align="left">83.4</td>
<td align="left">81.3</td>
<td align="left">71.4</td>
<td align="left">6.7</td>
<td align="left">76.9</td>
<td align="left">75.5</td>
<td align="left">58.8</td>
<td align="left">8.9</td>
</tr>
<tr>
<td align="left">R3Net</td>
<td align="left">78.6</td>
<td align="left">80.9</td>
<td align="left">66.0</td>
<td align="left">7.3</td>
<td align="left">84.2</td>
<td align="left">85.9</td>
<td align="left">76.1</td>
<td align="left">5.5</td>
<td align="left">75.7</td>
<td align="left">79.0</td>
<td align="left">61.5</td>
<td align="left">8.3</td>
</tr>
<tr>
<td align="left">CPD</td>
<td align="left">82.7</td>
<td align="left">83.7</td>
<td align="left">71.0</td>
<td align="left">5.7</td>
<td align="left">90.6</td>
<td align="left">90.2</td>
<td align="left">83.4</td>
<td align="left">3.2</td>
<td align="left">84.8</td>
<td align="left">86.7</td>
<td align="left">74.1</td>
<td align="left">5.0</td>
</tr>
<tr>
<td align="left">MMCI</td>
<td align="left">76.3</td>
<td align="left">78.4</td>
<td align="left">61.8</td>
<td align="left">8.7</td>
<td align="left">88.6</td>
<td align="left">89.2</td>
<td align="left">80.3</td>
<td align="left">3.9</td>
<td align="left">82.7</td>
<td align="left">85.9</td>
<td align="left">71.4</td>
<td align="left">5.5</td>
</tr>
<tr>
<td align="left">AFNet</td>
<td align="left">77.8</td>
<td align="left">81.6</td>
<td align="left">66.1</td>
<td align="left">6.9</td>
<td align="left">88.8</td>
<td align="left">91.2</td>
<td align="left">83.8</td>
<td align="left">3.3</td>
<td align="left">83.4</td>
<td align="left">87.7</td>
<td align="left">75.0</td>
<td align="left">5.0</td>
</tr>
<tr>
<td align="left">TANet</td>
<td align="left">81.8</td>
<td align="left">85.2</td>
<td align="left">71.7</td>
<td align="left">5.2</td>
<td align="left">90.2</td>
<td align="left">91.2</td>
<td align="left">83.8</td>
<td align="left">3.0</td>
<td align="left">84.7</td>
<td align="left">88.3</td>
<td align="left">75.4</td>
<td align="left">4.7</td>
</tr>
<tr>
<td align="left">S2MA</td>
<td align="left">81.1</td>
<td align="left">81.3</td>
<td align="left">70.9</td>
<td align="left">9.8</td>
<td align="left">91.8</td>
<td align="left">91.2</td>
<td align="left">84.8</td>
<td align="left">2.9</td>
<td align="left">85.3</td>
<td align="left">86.4</td>
<td align="left">74.3</td>
<td align="left">5.3</td>
</tr>
<tr>
<td align="left">JLDCF</td>
<td align="left">83.9</td>
<td align="left">83.0</td>
<td align="left">72.6</td>
<td align="left">7.6</td>
<td align="left">91.2</td>
<td align="left">89.9</td>
<td align="left">82.9</td>
<td align="left">3.0</td>
<td align="left">86.1</td>
<td align="left">86.0</td>
<td align="left">73.9</td>
<td align="left">5.0</td>
</tr>
<tr>
<td align="left">FMCF</td>
<td align="left">76.0</td>
<td align="left">79.6</td>
<td align="left">64.0</td>
<td align="left">8.0</td>
<td align="left">87.3</td>
<td align="left">89.9</td>
<td align="left">82.3</td>
<td align="left">3.7</td>
<td align="left">81.4</td>
<td align="left">86.4</td>
<td align="left">73.4</td>
<td align="left">5.5</td>
</tr>
<tr>
<td align="left">ADF</td>
<td align="left">81.0</td>
<td align="left">84.2</td>
<td align="left">71.7</td>
<td align="left">7.7</td>
<td align="left">91.0</td>
<td align="left">92.1</td>
<td align="left">84.7</td>
<td align="left">3.4</td>
<td align="left">86.4</td>
<td align="left">89.1</td>
<td align="left">77.8</td>
<td align="left">4.8</td>
</tr>
<tr>
<td align="left">MIDD</td>
<td align="left">87.1</td>
<td align="left">89.5</td>
<td align="left">80.3</td>
<td align="left">4.5</td>
<td align="left">91.5</td>
<td align="left">93.3</td>
<td align="left">88.0</td>
<td align="left">2.7</td>
<td align="left">86.8</td>
<td align="left">89.6</td>
<td align="left">79.9</td>
<td align="left">4.3</td>
</tr>
<tr>
<td align="left">LSNet</td>
<td align="left">87.2</td>
<td align="left">91.0</td>
<td align="left">81.4</td>
<td align="left">3.6</td>
<td align="left">92.1</td>
<td align="left">94.9</td>
<td align="left">88.1</td>
<td align="left">2.3</td>
<td align="left">87.5</td>
<td align="left">92.0</td>
<td align="left">81.7</td>
<td align="left">3.7</td>
</tr>
<tr>
<td align="left">CAVER</td>
<td align="left">89.8</td>
<td align="left">92.8</td>
<td align="left">87.7</td>
<td align="left">2.7</td>
<td align="left">93.6</td>
<td align="left">94.9</td>
<td align="left">91.1</td>
<td align="left">1.7</td>
<td align="left">89.9</td>
<td align="left">94.1</td>
<td align="left">84.9</td>
<td align="left">2.8</td>
</tr>
<tr>
<td align="left">DPLNet</td>
<td align="left">87.8</td>
<td align="left">90.8</td>
<td align="left">81.0</td>
<td align="left">4.3</td>
<td align="left">92.8</td>
<td align="left">95.1</td>
<td align="left">88.1</td>
<td align="left">2.2</td>
<td align="left">87.9</td>
<td align="left">91.6</td>
<td align="left">82.8</td>
<td align="left">3.8</td>
</tr>
<tr>
<td align="left">MSEDNET(baseline)</td>
<td align="left">87.6</td>
<td align="left">89.7</td>
<td align="left">80.3</td>
<td align="left">3.9</td>
<td align="left">92.8</td>
<td align="left">93.9</td>
<td align="left">86.8</td>
<td align="left">2.2</td>
<td align="left">88.1</td>
<td align="left">91.6</td>
<td align="left">82.1</td>
<td align="left">3.7</td>
</tr>
<tr>
<td align="left">MS2Fusion-MSEDNET</td>
<td align="left">90.4</td>
<td align="left">93.5</td>
<td align="left">86.3</td>
<td align="left">3.2</td>
<td align="left">94.4</td>
<td align="left">97.2</td>
<td align="left">91.8</td>
<td align="left">1.6</td>
<td align="left">90.2</td>
<td align="left">94.2</td>
<td align="left">86.4</td>
<td align="left">3.0</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表8所示，MS2Fusion (MS2Fusion-MSEDNET) 在三个RGB-T SOD数据集上均达到了SOTA性能。例如，在VT5000上，MAE指标从基线的3.7降低到3.0；在VT1000上，adpF指标从86.8提升到91.8。MS2Fusion在所有评估指标上均排名第一或第二，展示了其在RGB-T SOD任务中的卓越特征融合能力。</p>
<h3 id="消融研究"><a href="#消融研究" class="headerlink" title="消融研究"></a>消融研究</h3><p>所有消融研究均在FLIR数据集和YOLOv5框架上进行。</p>
<h4 id="不同检测框架的影响"><a href="#不同检测框架的影响" class="headerlink" title="不同检测框架的影响"></a>不同检测框架的影响</h4><p><strong>表9: 不同骨干网络和检测框架的影响</strong></p>
<table>
<thead>
<tr>
<th align="center">编号</th>
<th align="center">框架</th>
<th align="center">融合模型</th>
<th align="center">人</th>
<th align="center">汽车</th>
<th align="center">自行车</th>
<th align="center"><a href="mailto:&#x6d;&#x41;&#x50;&#x40;&#x30;&#x2e;&#x35;">mAP@0.5</a></th>
<th align="center">FPS</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">YOLOv5</td>
<td align="center">Baseline</td>
<td align="center">83.8</td>
<td align="center">88.9</td>
<td align="center">67.3</td>
<td align="center">80.0</td>
<td align="center">43.2</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center"></td>
<td align="center">MS2Fusion</td>
<td align="center">85.1</td>
<td align="center">89.8</td>
<td align="center">74.9</td>
<td align="center">83.3 (+3.3)</td>
<td align="center">24.4</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">CoDetr</td>
<td align="center">Baseline</td>
<td align="center">88.0</td>
<td align="center">91.7</td>
<td align="center">73.8</td>
<td align="center">84.5</td>
<td align="center">5.9</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center"></td>
<td align="center">MS2Fusion</td>
<td align="center">90.2</td>
<td align="center">93.4</td>
<td align="center">79.6</td>
<td align="center">87.8 (+3.3)</td>
<td align="center">4.8</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表9所示，MS2Fusion模块在YOLOv5和CoDetr两个主流检测框架上，均比基线（add fusion）带来了**3.3%**的<a href="mailto:&#109;&#65;&#80;&#x40;&#48;&#x2e;&#x35;">mAP@0.5</a>提升。这证明了MS2Fusion具有出色的“即插即用”特性和强大的泛化能力。</p>
<h4 id="不同骨干网络的影响"><a href="#不同骨干网络的影响" class="headerlink" title="不同骨干网络的影响"></a>不同骨干网络的影响</h4><p><strong>表10: 不同骨干网络的影响</strong></p>
<table>
<thead>
<tr>
<th align="center">编号</th>
<th align="center">骨干网络</th>
<th align="center">融合模型</th>
<th align="center">人</th>
<th align="center">汽车</th>
<th align="center">自行车</th>
<th align="center"><a href="mailto:&#x6d;&#65;&#x50;&#x40;&#x30;&#46;&#x35;">mAP@0.5</a></th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">VGG16</td>
<td align="center">Baseline</td>
<td align="center">78.9</td>
<td align="center">87.7</td>
<td align="center">51.2</td>
<td align="center">72.6</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center"></td>
<td align="center">MS2Fusion</td>
<td align="center">79.0</td>
<td align="center">87.8</td>
<td align="center">53.8</td>
<td align="center">73.6 (+1.0)</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">ResNet50</td>
<td align="center">Baseline</td>
<td align="center">76.8</td>
<td align="center">85.7</td>
<td align="center">44.6</td>
<td align="center">69.0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center"></td>
<td align="center">MS2Fusion</td>
<td align="center">80.2</td>
<td align="center">88.4</td>
<td align="center">52.8</td>
<td align="center">73.8 (+4.8)</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">CSPDarkNet53</td>
<td align="center">Baseline</td>
<td align="center">83.8</td>
<td align="center">88.9</td>
<td align="center">67.3</td>
<td align="center">80.0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center"></td>
<td align="center">MS2Fusion</td>
<td align="center">85.1</td>
<td align="center">89.8</td>
<td align="center">74.9</td>
<td align="center">83.3 (+3.3)</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表10所示，MS2Fusion在VGG16、ResNet50和CSPDarkNet53三种不同骨干网络上均实现了一致的性能增益，分别提升了1.0%、4.8%和3.3% (<a href="mailto:&#109;&#x41;&#80;&#64;&#48;&#46;&#53;">mAP@0.5</a>)。这进一步证实了MS2Fusion模块对不同骨干架构的强大泛化能力和兼容性。</p>
<h4 id="不同模块的影响"><a href="#不同模块的影响" class="headerlink" title="不同模块的影响"></a>不同模块的影响</h4><p><strong>表11: 不同融合模块的影响</strong></p>
<table>
<thead>
<tr>
<th align="center">编号</th>
<th align="center">CP-SSM</th>
<th align="center">SP-SSM</th>
<th align="center">FF-SSM</th>
<th align="center">人</th>
<th align="center">汽车</th>
<th align="center">自行车</th>
<th align="center"><a href="mailto:&#109;&#x41;&#80;&#64;&#x30;&#46;&#x35;">mAP@0.5</a></th>
<th align="center">Params(M)</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">83.8</td>
<td align="center">88.9</td>
<td align="center">67.3</td>
<td align="center">80.0</td>
<td align="center">72.7</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">83.8</td>
<td align="center">89.8</td>
<td align="center">72.7</td>
<td align="center">82.1 (+2.1)</td>
<td align="center">84.5</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center"></td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">85.6</td>
<td align="center">90.4</td>
<td align="center">70.6</td>
<td align="center">82.2 (+2.2)</td>
<td align="center">90.4</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">✓</td>
<td align="center">84.9</td>
<td align="center">90.1</td>
<td align="center">72.4</td>
<td align="center">82.5 (+2.5)</td>
<td align="center">86.0</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">84.9</td>
<td align="center">90.3</td>
<td align="center">72.9</td>
<td align="center">82.7 (+2.7)</td>
<td align="center">117.0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">✓</td>
<td align="center">85.5</td>
<td align="center">90.0</td>
<td align="center">72.5</td>
<td align="center">82.7 (+2.7)</td>
<td align="center">97.8</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center"></td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">85.5</td>
<td align="center">90.3</td>
<td align="center">72.9</td>
<td align="center">82.9 (+2.9)</td>
<td align="center">103.7</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">85.1</td>
<td align="center">89.8</td>
<td align="center">74.9</td>
<td align="center">83.3 (+3.3)</td>
<td align="center">130.2</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表11所示，基线（第1行）mAP为80.0%。</p>
<ul>
<li>单独使用<strong>CP-SSM</strong> （第2行）提升2.1% mAP，显著提升了“自行车”类别（+5.4%），表明它善于增强模态特定特征</li>
<li>单独使用<strong>SP-SSM</strong> （第3行）提升2.2% mAP，表明提取跨模态共享特征的有效性</li>
<li>单独使用<strong>FF-SSM</strong> （第4行）提升2.5% mAP，表明其异构特征融合的高效性</li>
<li>组合使用（第5-7行）均有提升，而<strong>集成所有三个模块</strong> （第8行）达到了83.3% mAP的最佳性能（+3.3%），尤其在“自行车”类别上提升了7.6%</li>
<li>这证明了CP-SSM（互补）、SP-SSM（共享）和FF-SSM（融合）三者协同作用，实现了模态特异性增强、跨模态泛化和自适应融合的平衡</li>
</ul>
<h4 id="不同融合层的影响"><a href="#不同融合层的影响" class="headerlink" title="不同融合层的影响"></a>不同融合层的影响</h4><p><strong>表12: 在不同层进行融合的影响</strong></p>
<table>
<thead>
<tr>
<th align="center">编号</th>
<th align="center">P3</th>
<th align="center">P4</th>
<th align="center">P5</th>
<th align="center">人</th>
<th align="center">汽车</th>
<th align="center">自行车</th>
<th align="center"><a href="mailto:&#x6d;&#65;&#x50;&#64;&#48;&#46;&#53;">mAP@0.5</a></th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">83.8</td>
<td align="center">88.9</td>
<td align="center">67.3</td>
<td align="center">80.0</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">83.4</td>
<td align="center">88.5</td>
<td align="center">71.4</td>
<td align="center">81.1 (+1.1)</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center"></td>
<td align="center">85.8</td>
<td align="center">90.1</td>
<td align="center">70.0</td>
<td align="center">82.0 (+2.0)</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">85.1</td>
<td align="center">89.8</td>
<td align="center">74.9</td>
<td align="center">83.3 (+3.3)</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表12所示，对比了在不同特征层（P3, P4, P5）应用MS2Fusion模块的效果。</p>
<ul>
<li>仅在P3（浅层）融合（第2行），“自行车”AP大幅提升5.7%，但“人”和“车”略降，总mAP升至81.1%</li>
<li>在P3和P4融合（第3行），“人”和“车”的AP反弹，总mAP升至82.0%</li>
<li>在P3、P4和P5（深层）全部融合（第4行），达到了最佳平衡，<a href="mailto:&#x6d;&#x41;&#80;&#x40;&#x30;&#x2e;&#x35;">mAP@0.5</a>达到83.3%，并且“自行车”的AP达到74.9%，为所有配置中最高</li>
<li>这表明多层次特征融合（浅层细节+深层语义）对于跨模态特征集成至关重要，特别是对“自行车”等挑战性类别</li>
</ul>
<h4 id="CP-SSM-的讨论"><a href="#CP-SSM-的讨论" class="headerlink" title="CP-SSM 的讨论"></a>CP-SSM 的讨论</h4><p><strong>表13: CP-SSM 的微调</strong></p>
<table>
<thead>
<tr>
<th align="center">编号</th>
<th align="center">微调</th>
<th align="center">人</th>
<th align="center">汽车</th>
<th align="center">自行车</th>
<th align="center"><a href="mailto:&#109;&#x41;&#80;&#x40;&#x30;&#x2e;&#53;">mAP@0.5</a></th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">rows</td>
<td align="center">85.1</td>
<td align="center">89.8</td>
<td align="center">74.9</td>
<td align="center">83.3</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">columns</td>
<td align="center">64.1</td>
<td align="center">90.3</td>
<td align="center">72.8</td>
<td align="center">82.4</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">rows and columns</td>
<td align="center">85.4</td>
<td align="center">90.4</td>
<td align="center">70.2</td>
<td align="center">82.0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">w&#x2F;o exchange C</td>
<td align="center">85.7</td>
<td align="center">90.6</td>
<td align="center">71.7</td>
<td align="center">82.7</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">exchange C</td>
<td align="center">85.1</td>
<td align="center">89.8</td>
<td align="center">74.9</td>
<td align="center">83.3</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 表13探索了CP-SSM的两个关键设计：</p>
<ol>
<li><strong>扫描方向 (row 1-3)</strong>: 实验发现，仅按行（rows）扫描（第1行）效果最好（83.3% mAP）。使用多方向扫描（rows and columns，第3行）反而导致性能下降（82.0% mAP），可能是因为它改变了目标特征，不利于检测任务所需的稳定性</li>
<li><strong>C参数交换 (row 4-5)</strong>: 对比“不交换C”（第4行，82.7% mAP）和“交换C”（第5行，83.3% mAP），发现<strong>交换C参数</strong>的机制（即跨模态分支交换隐藏状态投影矩阵）带来了**0.6%**的稳定性能提升。这证明了该设计能有效优化跨特征交互效率</li>
</ol>
<h4 id="不同输入模态的比较"><a href="#不同输入模态的比较" class="headerlink" title="不同输入模态的比较"></a>不同输入模态的比较</h4><p><strong>表14: 不同输入的性能</strong><br>(V, T 分别表示可见光和热成像。V+T表示双模态输入，V+V或T+T表示单模态输入。)</p>
<table>
<thead>
<tr>
<th align="center">编号</th>
<th align="center">模型</th>
<th align="center">输入</th>
<th align="center"><a href="mailto:&#x6d;&#x41;&#80;&#64;&#48;&#x2e;&#53;">mAP@0.5</a></th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">YOLOv5</td>
<td align="center">V</td>
<td align="center">67.8</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center"></td>
<td align="center">T</td>
<td align="center">73.9</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">Baseline</td>
<td align="center">V+V</td>
<td align="center">61.2</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center"></td>
<td align="center">T+T</td>
<td align="center">77.8</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center"></td>
<td align="center">V+T</td>
<td align="center">80.0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">Ours</td>
<td align="center">V+V</td>
<td align="center">68.4 (+7.2)</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center"></td>
<td align="center">T+T</td>
<td align="center">82.1 (+4.3)</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center"></td>
<td align="center">V+T</td>
<td align="center">83.3 (+3.3)</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 表14展示了MS2Fusion在处理缺失模态时的鲁棒性。</p>
<ul>
<li>在所有输入配置下（V+V, T+T, V+T），Ours（MS2Fusion）均显著优于Baseline（基线）</li>
<li>当仅使用热成像（T+T）时（第7行），Ours的性能（82.1% mAP）仅比使用双模态（V+T）时（第8行，83.3% mAP）低1.2%，显示了极强的鲁棒性</li>
<li>这表明MS2Fusion能有效利用异构数据的共享空间特征，利用一个可用的模态信息来增强另一个模态的特征</li>
</ul>
<h4 id="FF-SSM-输入配置分析"><a href="#FF-SSM-输入配置分析" class="headerlink" title="FF-SSM 输入配置分析"></a>FF-SSM 输入配置分析</h4><p><strong>表15: FF-SSM 模块的输入配置</strong></p>
<table>
<thead>
<tr>
<th align="center">FF-SSM input</th>
<th align="center"><a href="mailto:&#x6d;&#x41;&#x50;&#x40;&#48;&#46;&#x35;">mAP@0.5</a></th>
<th align="center">person</th>
<th align="center">car</th>
<th align="center">bicycle</th>
</tr>
</thead>
<tbody><tr>
<td align="center">(V, T)</td>
<td align="center">83.1</td>
<td align="center">85.4</td>
<td align="center">90.2</td>
<td align="center">73.9</td>
</tr>
<tr>
<td align="center">(T, V)</td>
<td align="center">82.5</td>
<td align="center">85.1</td>
<td align="center">90.1</td>
<td align="center">72.4</td>
</tr>
<tr>
<td align="center">((V, T), (T, V))</td>
<td align="center">83.3</td>
<td align="center">85.1</td>
<td align="center">89.8</td>
<td align="center">74.9</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 表15研究了FF-SSM模块的输入顺序。</p>
<ul>
<li>使用单向输入 (V, T)（第1行）或 (T, V)（第2行）时，mAP分别为83.1%和82.5%，均低于基线（83.3%）</li>
<li>这揭示了状态空间模型中存在的<strong>特征衰减（遗忘）现象</strong>：较早输入的特征在状态传播过程中逐渐被遗忘</li>
<li>而使用本文提出的<strong>双向架构 ((V, T), (T, V))</strong> （第3行）时，性能恢复并达到最佳（83.3% mAP），“自行车”检测（74.9%）也得到改善</li>
<li>如图9（ERF可视化，未显示）所示，双向策略建立了鲁棒的跨模态特征记忆路径，显著扩大了有效感受野（ERF），从而在保持线性复杂度的同时缓解了特征衰减</li>
</ul>
<p><img data-src="/./../images/image-20251031213920975-1761991594416-28-1765726490765-45-1765726786789-97.png" alt="image-20251031213920975"></p>
<h3 id="定性分析"><a href="#定性分析" class="headerlink" title="定性分析"></a>定性分析</h3><h4 id="模型统计分析"><a href="#模型统计分析" class="headerlink" title="模型统计分析"></a>模型统计分析</h4><p><strong>表16: 模型的统计分析 (释放随机种子进行10次实验)</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">Mean(%)</th>
<th align="center"></th>
<th align="center">VAR(%)</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center"><a href="mailto:&#x6d;&#x41;&#80;&#x40;&#x30;&#46;&#53;">mAP@0.5</a></td>
<td align="center">mAP</td>
<td align="center"><a href="mailto:&#109;&#x41;&#x50;&#64;&#x30;&#x2e;&#x35;">mAP@0.5</a></td>
<td align="center">mAP</td>
</tr>
<tr>
<td align="center">FLIR</td>
<td align="center">82.99</td>
<td align="center">40.60</td>
<td align="center">0.15</td>
<td align="center">2.47</td>
</tr>
<tr>
<td align="center">LLVIP</td>
<td align="center">97.41</td>
<td align="center">63.46</td>
<td align="center">0.03</td>
<td align="center">2.31</td>
</tr>
<tr>
<td align="center">M3FD</td>
<td align="center">89.11</td>
<td align="center">59.76</td>
<td align="center">0.18</td>
<td align="center">0.42</td>
</tr>
</tbody></table>
<p><strong>分析</strong>: 如表16所示，通过10次随机种子实验，MS2Fusion表现出极高的稳定性。在FLIR上<a href="mailto:&#109;&#65;&#80;&#x40;&#x30;&#46;&#53;">mAP@0.5</a>方差仅为0.15%，在LLVIP上方差低至0.03%。这表明模型对初始条件变化具有很强的抵抗力，在不同数据分布上保持一致性能。</p>
<h4 id="热图可视化-图10"><a href="#热图可视化-图10" class="headerlink" title="热图可视化 (图10)"></a>热图可视化 (图10)</h4><p>对比Baseline、ICAFusion和MS2Fusion：</p>
<ul>
<li>在停车场（第一行）、夜间街道（第二行）和道路（第三行）等多种场景下，MS2Fusion均表现最佳。</li>
<li><strong>优势</strong>: (1) 相比CNN基线，MS2Fusion的感受野更广，能捕获更宽的对象区域；(2) 相比Transformer (ICAFusion)，它实现了更精确的轮廓拟合；(3) 假阴性率（漏检）最低，尤其是在低光照条件下。</li>
</ul>
<p><img data-src="/./../images/image-20251031214157371-1761991594416-29-1765726490765-46-1765726786789-94.png" alt="image-20251031214157371"></p>
<h4 id="特征融合比较可视化-图11"><a href="#特征融合比较可视化-图11" class="headerlink" title="特征融合比较可视化 (图11)"></a>特征融合比较可视化 (图11)</h4><p>对比P5层的特征图 (Baseline vs MS2Fusion)：</p>
<ul>
<li>Baseline（简单求和）导致信息丢失或模态冲突。</li>
<li>MS2Fusion通过其多阶段框架（CP&#x2F;SP&#x2F;FF），能选择性保留每个模态中最具辨识度的特征，同时抑制冗余，生成更丰富、更清晰的特征图。</li>
</ul>
<p><img data-src="/./../images/image-20251031214216261-1761991594416-30-1765726490765-47-1765726786789-99.png" alt="image-20251031214216261"></p>
<h4 id="共享和互补特征的可视化分析-图12"><a href="#共享和互补特征的可视化分析-图12" class="headerlink" title="共享和互补特征的可视化分析 (图12)"></a>共享和互补特征的可视化分析 (图12)</h4><p>在低光照条件下可视化CP-SSM和SP-SSM的输出：</p>
<ul>
<li>由于RGB模态特征弱，CP-SSM（互补特征）主要关注模态特定差异（如热梯和纹理）。</li>
<li>SP-SSM（共享特征）则有效融合了两个模态，生成了跨RGB和热域一致的共享语义表示（如物体轮廓、行人区域）。SP-SSM通过强制语义一致性补偿了可见光谱的退化。</li>
</ul>
<p><img data-src="/./../images/image-20251031214233322-1761991594416-31-1765726490765-48-1765726786790-102.png" alt="image-20251031214233322"></p>
<h4 id="RGB-T-语义分割样本可视化-图13"><a href="#RGB-T-语义分割样本可视化-图13" class="headerlink" title="RGB-T 语义分割样本可视化 (图13)"></a>RGB-T 语义分割样本可视化 (图13)</h4><p>对比Baseline和MS2Fusion的分割结果：</p>
<ul>
<li>Baseline在处理行人和车辆边界时表现模糊且存在误分类。</li>
<li>MS2Fusion在这些挑战区域表现出显著改进，能保持对象轮廓的精细细节和复杂背景下的分割一致性。</li>
</ul>
<p><img data-src="/./../images/image-20251031214255210-1761991594416-32-1765726490766-49-1765726786789-100.png" alt="image-20251031214255210"></p>
<h4 id="RGB-T-显著性目标检测样本可视化-图14"><a href="#RGB-T-显著性目标检测样本可视化-图14" class="headerlink" title="RGB-T 显著性目标检测样本可视化 (图14)"></a>RGB-T 显著性目标检测样本可视化 (图14)</h4><p>对比Ours (MS2Fusion) 和其他SOTA方法：</p>
<ul>
<li><strong>优势</strong>: (1) 利用跨模态互补性生成精确的对象边界，噪声干扰最小（第1, 5行）；(2) 在遮挡场景中鲁棒性强，保持了完整的物体形态（第2行）；(3) 对小物体（第4行）和复杂形状（第3, 6行）具有出色的敏感性。</li>
</ul>
<p><img data-src="/./../images/image-20251031214312729-1761991594416-33-1765726490766-50-1765726786789-98.png" alt="image-20251031214312729"></p>
<h3 id="局限性-图15"><a href="#局限性-图15" class="headerlink" title="局限性 (图15)"></a>局限性 (图15)</h3><p>分析了几个失败案例：</p>
<ol>
<li><strong>远处物体</strong>: 当物体距离远且在热图像中不突出（热信号与背景接近）时，模型难以区分物体和背景。</li>
<li><strong>遮挡物体</strong>: 模型倾向于忽略部分或完全被遮挡的物体，导致漏检。</li>
<li><strong>热相似物体的假阳性</strong>: 具有与人相似热特征的物体（如第3行）会导致假阳性检测，尤其是在低分辨率图像中，模型难以区分。</li>
</ol>
<p><img data-src="/./../images/image-20251031214326873-1761991594416-34-1765726490766-51-1765726786789-101.png" alt="image-20251031214326873"></p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>本论文提出了**多光谱状态空间特征融合（MS2Fusion）**框架，旨在解决现代多光谱目标检测中存在的两个关键限制：一是过度偏向局部互补特征，而忽略跨模态共享语义，影响了泛化性能；二是感受野尺寸和计算复杂度之间的权衡，是可扩展特征建模的关键瓶颈。</p>
<p>MS2Fusion基于<strong>状态空间模型（SSM）</strong>，通过<strong>双路径参数交互机制</strong>实现了高效且有效的特征融合。</p>
<ul>
<li>**共享参数交互（SP-SSM）**分支：通过在SSM中共享参数，探索跨模态对齐，以获得相似的语义特征和结构。</li>
<li>**交叉参数交互（CP-SSM）**分支：利用SSM中的跨模态隐藏状态解码，继承了交叉注意力的优势，以挖掘互补信息。</li>
</ul>
<p>这两种路径在一个统一的框架内通过SSM进行联合优化，使MS2Fusion能够同时享有功能互补性和共享语义空间。得益于这种双分支SSM设计，本方法同时继承了<strong>计算效率</strong>和<strong>全局感受野</strong>的优点，显著提高了多光谱目标检测的性能。</p>
<p>实验结果表明，MS2Fusion持续优于现有强大的基线方法：</p>
<ul>
<li>在目标检测（FLIR）任务中，<a href="mailto:&#109;&#65;&#x50;&#64;&#x30;&#46;&#53;">mAP@0.5</a>提高了3.3%。</li>
<li>在RGB-T语义分割（MFNet）任务中，mIoU提升了2.8%。</li>
<li>在显著性目标检测（VT5000）任务中，MAE降低了0.7%。</li>
</ul>
<p>值得注意的是，MS2Fusion无需针对特定任务进行修改，即可在多个多光谱感知任务上实现<strong>新的最先进（SOTA）结果</strong>，充分证明了其卓越的<strong>泛化能力</strong>。</p>
]]></content>
      <categories>
        <category>论文阅读</category>
      </categories>
      <tags>
        <tag>多光谱目标检测</tag>
        <tag>共享参数</tag>
        <tag>跨参数交互</tag>
        <tag>状态空间模型</tag>
      </tags>
  </entry>
  <entry>
    <title>【论文阅读 | TCSVT 2025 | T²EA：目标感知泰勒展开近似网络】</title>
    <url>/2025/12/18/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%20%20TCSVT%202025%20%20T%C2%B2EA%EF%BC%9A%E7%9B%AE%E6%A0%87%E6%84%9F%E7%9F%A5%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80%E8%BF%91%E4%BC%BC%E7%BD%91%E7%BB%9C%E3%80%91/</url>
    <content><![CDATA[<p><img data-src="/./../images/image-20251221071909426.png" alt="image-20251221071909426"></p>
<p>题目：T²EA: Target-Aware Taylor Expansion Approximation Network for Infrared and Visible Image Fusion  </p>
<p>期刊：IEEE Transactions on Circuits and Systems for Video Technology (TCSVT), Vol.35, No.5, 2025  </p>
<p>论文链接：<a href="https://ieeexplore.ieee.org/abstract/document/10819442">T2EA: Target-Aware Taylor Expansion Approximation Network for Infrared and Visible Image Fusion | IEEE Journals &amp; Magazine | IEEE Xplore</a></p>
<p>代码：<a href="https://github.com/MysterYxby/T2EA">MysterYxby&#x2F;T2EA</a></p>
<p>年份：2025</p>
<h1 id="1-研究背景与动机"><a href="#1-研究背景与动机" class="headerlink" title="1. 研究背景与动机"></a>1. 研究背景与动机</h1><h2 id="1-1-红外-可见光融合的需求"><a href="#1-1-红外-可见光融合的需求" class="headerlink" title="1.1 红外-可见光融合的需求"></a>1.1 红外-可见光融合的需求</h2><ul>
<li>红外：低照&#x2F;遮挡&#x2F;恶劣天气下仍能突出目标，但纹理弱、分辨率低。  </li>
<li>可见：纹理细节丰富，但受光照影响大。  </li>
<li>目标：生成兼具“目标显著 + 场景纹理”的融合图，兼顾人眼观测与下游检测&#x2F;分割。</li>
</ul>
<h2 id="1-2-现有方法局限"><a href="#1-2-现有方法局限" class="headerlink" title="1.2 现有方法局限"></a>1.2 现有方法局限</h2><ul>
<li>规则式&#x2F;多尺度：可解释但策略固定，场景适应性差。  </li>
<li>端到端深度：特征强但偏“黑箱”，易忽略梯度&#x2F;结构一致性，目标保持不足。  </li>
<li>缺口：亟需“可解释 + 可学习”的统一框架，显式建模强度与高阶导并注入目标感知。</li>
</ul>
<h2 id="1-3-本文贡献"><a href="#1-3-本文贡献" class="headerlink" title="1.3 本文贡献"></a>1.3 本文贡献</h2><ol>
<li><strong>目标感知泰勒展开近似（TEA）</strong>：用多阶导显式刻画纹理与形状，可解释、可控。  </li>
<li><strong>双分支特征融合 (DBFF)</strong>：按泰勒阶分别融合IR&#x2F;VIS特征，CBAM关注目标区域。  </li>
<li><strong>逆泰勒重构 + 分割联合优化</strong>：保持导数一致性，分割梯度反哺融合，强化目标呈现。  </li>
<li>在MSRS&#x2F;TNO&#x2F;LLVIP数据集及分割&#x2F;检测任务上验证，兼顾跨域泛化与任务友好性。</li>
</ol>
<hr>
<h1 id="2-整体框架"><a href="#2-整体框架" class="headerlink" title="2. 整体框架"></a>2. 整体框架</h1><p><img data-src="/./../images/image-20251221072301509.png" alt="image-20251221072301509"></p>
<p>输入IR&#x2F;VIS → 泰勒展开近似网络（TEA）分解 → 分阶双分支特征融合网络（DBFF网络）特征融合 → 逆泰勒展开（ITE）网络重构 →分割头联合优化（利用语义分割网络对融合图像进行细化）</p>
<p>核心即 <strong>“分解-融合-重构” + 目标梯度监督</strong>。</p>
<p><strong>损失函数</strong>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>J</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>L</mi><mi>F</mi></msub><mo>+</mo><mi>μ</mi><msub><mi>L</mi><mrow><mi>s</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
L_{Joint} = L_{F} + \mu L_{semantic}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">man</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>该公式结合了融合损失（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>F</mi></msub></mrow><annotation encoding="application/x-tex">L_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）和语义分割损失（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>s</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{semantic}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">man</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>），通过平衡这两者优化网络性能。</p>
<hr>
<h1 id="3-泰勒展开近似（TEA）网络"><a href="#3-泰勒展开近似（TEA）网络" class="headerlink" title="3. 泰勒展开近似（TEA）网络"></a>3. 泰勒展开近似（TEA）网络</h1><p>代码来自 <code>network/TEM.py</code>、<code>loss/Taylor.py</code>、<code>train_TEM.py</code>。</p>
<p><img data-src="/./../images/image-20251221081723587.png" alt="image-20251221081723587"></p>
<h2 id="3-1-泰勒展开理论"><a href="#3-1-泰勒展开理论" class="headerlink" title="3.1 泰勒展开理论"></a>3.1 泰勒展开理论</h2><p>泰勒展开是数学中用于将函数在某一点处展开的一个工具。在图像处理中，可以利用泰勒展开对图像进行特征提取。假设图像可以用函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 表示，泰勒展开的表达式如下：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mo stretchy="false">!</mo></mrow></mfrac><mo>⋅</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><mfrac><mrow><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow></mfrac><mo>⋅</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">
f(x) = f(x_0) + f&#x27;(x_0) \cdot (x - x_0) + \frac{f&#x27;&#x27;(x_0)}{2!} \cdot (x - x_0)^2 + \cdots + \frac{f^{(n)}(x_0)}{n!} \cdot (x - x_0)^n
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1149em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4289em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.251em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.565em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>

<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 表示原始图像，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 是基础特征层，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">f&#x27;(x_0), f&#x27;&#x27;(x_0), \dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span> 表示不同阶次的导数特征。通过这种分解方法，能够提取图像的全局结构（低频信息）和细节（高频信息）。</p>
<p>对应代码（泰勒项的生成与阶乘系数累加）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/TEM.py</span></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> factorial  <span class="comment"># 引入阶乘用于泰勒系数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span>, n</span>):  <span class="comment"># 前向：生成各阶泰勒项</span></span><br><span class="line">    y_list = []  <span class="comment"># 保存每一阶特征</span></span><br><span class="line">    x = <span class="variable language_">self</span>.base(<span class="built_in">input</span>)  <span class="comment"># 计算基础层 f(x0)</span></span><br><span class="line">    y_list.append(x)  <span class="comment"># 记录0阶项</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):  <span class="comment"># 逐阶生成导数特征</span></span><br><span class="line">        y_list.append(<span class="variable language_">self</span>.gradient(torch.cat([y_list[i - <span class="number">1</span>], <span class="built_in">input</span>], dim=<span class="number">1</span>)))  <span class="comment"># 拼接上一阶与输入</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(y_list)):  <span class="comment"># 按阶累加泰勒项</span></span><br><span class="line">        result += (<span class="number">1</span> / factorial(i)) * y_list[i]  <span class="comment"># 1/i! 权重累加到结果</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-网络架构与实现"><a href="#3-2-网络架构与实现" class="headerlink" title="3.2 网络架构与实现"></a>3.2 网络架构与实现</h2><p>根据泰勒展开公式，TEA 网络包括两大主要部分：基础层的提取和导数层的提取。网络分别由<strong>映射网络</strong>和<strong>导数网络</strong>组成。</p>
<h3 id="3-2-1-映射网络"><a href="#3-2-1-映射网络" class="headerlink" title="3.2.1 映射网络"></a>3.2.1 映射网络</h3><p>映射网络的作用是提取图像的基础层特征，即泰勒展开的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。该网络由卷积层和残差模块（ResBlock）构成，具体结构如下：</p>
<ul>
<li>卷积层：一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">5 \times 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span>的卷积核。</li>
<li>残差模块：由多个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">3 \times 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>卷积层构成，用于提取全局信息，防止大尺度细节丢失。</li>
</ul>
<p>对应代码（基础层<code>base</code> 与ResB）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/TEM.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResB</span>(nn.Module):  <span class="comment"># 残差模块</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_c, out_c</span>):  <span class="comment"># 初始化输入/输出通道</span></span><br><span class="line">        <span class="built_in">super</span>(ResB, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.Res = nn.Sequential(  <span class="comment"># 主分支卷积序列</span></span><br><span class="line">            nn.Conv2d(in_c, out_c, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>),  <span class="comment"># 1x1调整通道</span></span><br><span class="line">            nn.LeakyReLU(),  <span class="comment"># 非线性激活</span></span><br><span class="line">            nn.Conv2d(out_c, out_c, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>),  <span class="comment"># 3x3提取局部</span></span><br><span class="line">            nn.LeakyReLU(),  <span class="comment"># 非线性激活</span></span><br><span class="line">            nn.Conv2d(out_c, out_c, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>),  <span class="comment"># 1x1融合特征</span></span><br><span class="line">        )  <span class="comment"># 主分支结束</span></span><br><span class="line">        <span class="variable language_">self</span>.Conv = nn.Conv2d(in_c, out_c, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>)  <span class="comment"># shortcut 1x1</span></span><br><span class="line">        <span class="variable language_">self</span>.activate = nn.LeakyReLU()  <span class="comment"># 残差后激活</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        y = <span class="variable language_">self</span>.Res(x) + <span class="variable language_">self</span>.Conv(x)  <span class="comment"># 主分支与shortcut相加</span></span><br><span class="line">        y = <span class="variable language_">self</span>.activate(y)  <span class="comment"># 激活输出</span></span><br><span class="line">        <span class="keyword">return</span> y  <span class="comment"># 返回残差结果</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Taylor_Encoder</span>(nn.Module):  <span class="comment"># TEA编码器主体</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:  <span class="comment"># 初始化</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.base = nn.Sequential(  <span class="comment"># 基础层分支</span></span><br><span class="line">            nn.Conv2d(<span class="number">1</span>, <span class="number">32</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>),  <span class="comment"># 5x5卷积提取低频</span></span><br><span class="line">            nn.LeakyReLU(),  <span class="comment"># 激活</span></span><br><span class="line">            ResB(<span class="number">32</span>, <span class="number">64</span>),  <span class="comment"># ResB扩大通道</span></span><br><span class="line">            ResB(<span class="number">64</span>, <span class="number">32</span>),  <span class="comment"># ResB压回通道</span></span><br><span class="line">            ResB(<span class="number">32</span>, <span class="number">1</span>),  <span class="comment"># ResB输出到1通道</span></span><br><span class="line">        )  <span class="comment"># 基础分支结束</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-2-导数网络"><a href="#3-2-2-导数网络" class="headerlink" title="3.2.2 导数网络"></a>3.2.2 导数网络</h3><p>导数网络的目的是通过多阶泰勒展开提取图像的高阶特征（即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">f&#x27;(x_0), f&#x27;&#x27;(x_0), \dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span>）。该网络由两个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">5 \times 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span>卷积层和三个残差模块（ResDBlocks）组成，采用Mish激活函数和密集连接来保留细节特征。在图像特征的提取中，每一阶导数不仅依赖于前一阶的特征，还与基础层（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>）以及上层导数特征（如<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f&#x27;(x_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>）相关。为了保持这些特征之间的高相关性，网络通过拼接基础层特征和导数层特征来递归提取各阶特征。</p>
<p>例如，对于泰勒展开的第一阶导数，将输入图像特征和上一阶（基础层或更低阶的导数）特征进行拼接，送入网络进行进一步的处理，以确保各阶导数层的准确提取。通过这种方式，网络能够有效提取图像的全局结构与局部细节。</p>
<p>此过程中的重要机制是拼接操作（Concatenate），它通过将低阶导数和输入图像的特征结合，从而为高阶导数提供更完整的上下文信息。</p>
<p>对应代码（Mish激活 + RDBLOCK + gradient分支）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/TEM.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Conv</span>(nn.Module):  <span class="comment"># 基础卷积块</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_c, o_c, size, stride</span>):  <span class="comment"># 输入/输出通道与核大小</span></span><br><span class="line">        <span class="built_in">super</span>(Conv, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.conv = nn.Conv2d(  <span class="comment"># 卷积层</span></span><br><span class="line">            in_channels=in_c,  <span class="comment"># 输入通道数</span></span><br><span class="line">            out_channels=o_c,  <span class="comment"># 输出通道数</span></span><br><span class="line">            kernel_size=size,  <span class="comment"># 卷积核尺寸</span></span><br><span class="line">            stride=stride,  <span class="comment"># 步长</span></span><br><span class="line">            padding=size // <span class="number">2</span>,  <span class="comment"># 保持尺寸的填充</span></span><br><span class="line">        )  <span class="comment"># 卷积层结束</span></span><br><span class="line">        <span class="variable language_">self</span>.activation = nn.Mish()  <span class="comment"># Mish激活</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span></span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        x = <span class="variable language_">self</span>.conv(<span class="built_in">input</span>)  <span class="comment"># 卷积计算</span></span><br><span class="line">        y = <span class="variable language_">self</span>.activation(x)  <span class="comment"># Mish激活</span></span><br><span class="line">        <span class="keyword">return</span> y  <span class="comment"># 输出特征</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RDBLOCK</span>(nn.Module):  <span class="comment"># 残差密集连接块</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, outchannel</span>):  <span class="comment"># 基础通道数</span></span><br><span class="line">        <span class="built_in">super</span>(RDBLOCK, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.conv1 = Conv(in_c=outchannel, o_c=outchannel, size=<span class="number">1</span>, stride=<span class="number">1</span>)  <span class="comment"># 1x1特征</span></span><br><span class="line">        <span class="variable language_">self</span>.conv2 = Conv(in_c=<span class="number">2</span> * outchannel, o_c=outchannel, size=<span class="number">3</span>, stride=<span class="number">1</span>)  <span class="comment"># 3x3融合</span></span><br><span class="line">        <span class="variable language_">self</span>.conv3 = Conv(in_c=<span class="number">3</span> * outchannel, o_c=outchannel, size=<span class="number">1</span>, stride=<span class="number">1</span>)  <span class="comment"># 1x1压缩</span></span><br><span class="line">        <span class="variable language_">self</span>.conv4 = Conv(in_c=<span class="number">4</span> * outchannel, o_c=<span class="number">2</span> * outchannel, size=<span class="number">1</span>, stride=<span class="number">1</span>)  <span class="comment"># 1x1扩展</span></span><br><span class="line">        <span class="variable language_">self</span>.shortcut = nn.Sequential(  <span class="comment"># shortcut分支</span></span><br><span class="line">            nn.Conv2d(in_channels=outchannel, out_channels=<span class="number">2</span> * outchannel, kernel_size=<span class="number">1</span>, stride=<span class="number">1</span>)  <span class="comment"># 1x1对齐</span></span><br><span class="line">        )  <span class="comment"># shortcut结束</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        x1 = <span class="variable language_">self</span>.conv1(x)  <span class="comment"># 第1层</span></span><br><span class="line">        y = torch.cat((x, x1), <span class="number">1</span>)  <span class="comment"># 拼接x与x1</span></span><br><span class="line">        x2 = <span class="variable language_">self</span>.conv2(y)  <span class="comment"># 第2层</span></span><br><span class="line">        z = torch.cat((x, x1, x2), <span class="number">1</span>)  <span class="comment"># 拼接到更密集特征</span></span><br><span class="line">        x3 = <span class="variable language_">self</span>.conv3(z)  <span class="comment"># 第3层</span></span><br><span class="line">        x4 = <span class="variable language_">self</span>.conv4(torch.cat((z, x3), <span class="number">1</span>))  <span class="comment"># 第4层并再拼接</span></span><br><span class="line">        output = <span class="variable language_">self</span>.shortcut(x) + x4  <span class="comment"># 残差相加</span></span><br><span class="line">        output = F.mish(output)  <span class="comment"># Mish激活</span></span><br><span class="line">        <span class="keyword">return</span> output  <span class="comment"># 输出特征</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Taylor_Encoder</span>(nn.Module):  <span class="comment"># TEA编码器主体</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:  <span class="comment"># 初始化</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.gradient = nn.Sequential(  <span class="comment"># 导数分支</span></span><br><span class="line">            nn.Conv2d(<span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>),  <span class="comment"># 5x5卷积提取导数特征</span></span><br><span class="line">            nn.LeakyReLU(),  <span class="comment"># 激活</span></span><br><span class="line">            RDBLOCK(<span class="number">8</span>),  <span class="comment"># RDBLOCK保持细节</span></span><br><span class="line">            RDBLOCK(<span class="number">16</span>),  <span class="comment"># 通道逐级扩展</span></span><br><span class="line">            RDBLOCK(<span class="number">32</span>),  <span class="comment"># 更深层密集连接</span></span><br><span class="line">            nn.Conv2d(<span class="number">64</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>),  <span class="comment"># 5x5回到1通道</span></span><br><span class="line">            nn.LeakyReLU(),  <span class="comment"># 激活</span></span><br><span class="line">        )  <span class="comment"># 导数分支结束</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-3-网络架构"><a href="#3-2-3-网络架构" class="headerlink" title="3.2.3 网络架构"></a>3.2.3 网络架构</h3><p>根据泰勒展开公式，需要同时估算基础层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 和各阶导数层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>k</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f^{(k)}(x_0) \ (k \in [1, n])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">])</span></span></span></span>。为了充分提取这些特征，可通过以下方式组合网络：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi>b</mi></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub><mrow><mo fence="true">(</mo><mtext>Concat</mtext><mo stretchy="false">(</mo><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
f(x) = \Phi_b(f(x)) + \sum_{k=1}^{n} \Phi_d \left( \text{Concat}(f^{(k-1)}(x_0), f(x)) \right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord text"><span class="mord">Concat</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span>

<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为映射网络，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为导数网络，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Concat</mtext></mrow><annotation encoding="application/x-tex">\text{Concat}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Concat</span></span></span></span></span> 表示将基础层和各阶导数层特征进行拼接。</p>
<p>对应代码（base + gradient + concat + 累加）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/TEM.py</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span>, n</span>):  <span class="comment"># 前向：组合基础层与导数层</span></span><br><span class="line">    y_list = []  <span class="comment"># 保存各阶特征</span></span><br><span class="line">    x = <span class="variable language_">self</span>.base(<span class="built_in">input</span>)  <span class="comment"># 基础层输出</span></span><br><span class="line">    y_list.append(x)  <span class="comment"># 加入0阶</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):  <span class="comment"># 生成1..n阶</span></span><br><span class="line">        y_list.append(<span class="variable language_">self</span>.gradient(torch.cat([y_list[i - <span class="number">1</span>], <span class="built_in">input</span>], dim=<span class="number">1</span>)))  <span class="comment"># concat并估计导数</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(y_list)):  <span class="comment"># 按阶累加</span></span><br><span class="line">        result += (<span class="number">1</span> / factorial(i)) * y_list[i]  <span class="comment"># 1/i! 加权</span></span><br><span class="line">    <span class="keyword">return</span> result, y_list  <span class="comment"># 返回重建结果与各阶项</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-4-损失函数"><a href="#3-2-4-损失函数" class="headerlink" title="3.2.4 损失函数"></a>3.2.4 损失函数</h3><p>在优化过程中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{pixel}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>负责控制重建的图像与源图像之间的像素级差异，而<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{grad}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>则强调图像中的细节特征。为了平衡这两者的影响，这里引入了超参数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span>，它用于调整这两个损失项的权重。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span>的合理选择对于优化过程至关重要，它决定了网络在保留全局信息（通过像素损失）和细节信息（通过梯度损失）之间的权衡。</p>
<p>在训练过程中，通过逐步调整<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span>的值，可以帮助网络在保留图像整体结构的同时，增强细节的表现，尤其是在低对比度和高噪声的区域。</p>
<p>为了优化网络参数，作者采用了联合损失函数来训练 TEA 网络：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mi>T</mi></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>+</mo><mi>λ</mi><msub><mi>L</mi><mrow><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
L_T = L_{pixel} + \lambda L_{grad}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">λ</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span>

<ul>
<li><p><strong>像素损失</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{pixel}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>：计算输入图像与网络输出图像在像素级的差异，用于保证图像重构的精度。</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi>H</mi><mi>W</mi></mrow></mfrac><mi mathvariant="normal">∥</mi><msub><mi>I</mi><mi>x</mi></msub><mo>−</mo><msub><mi>I</mi><mi>o</mi></msub><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">
  L_{pixel} = \frac{1}{H W} \| I_x - I_o \|_1 
  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>

<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">I_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">I_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分别表示输入图像（红外或可见光图像）和输出图像。</p>
</li>
<li><p><strong>梯度细节损失</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{grad}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>：用于优化图像细节的保留，通过计算图像的梯度差异来增强细节。</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi>H</mi><mi>W</mi></mrow></mfrac><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mi>o</mi></msub><mi mathvariant="normal">∣</mi><mo>−</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mi>x</mi></msub><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mi>n</mi></msub><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">
  L_{grad} = \frac{1}{H W} \| |\nabla I_o| - \max (|\nabla I_x| , |\nabla I_n|) \|_1 
  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥∣∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">∣∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>

<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi></mrow><annotation encoding="application/x-tex">\nabla</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span></span></span></span> 表示梯度操作，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mo>⋅</mo><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\cdot|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span></span></span></span> 表示绝对值操作，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\max</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mop">max</span></span></span></span> 表示取最大值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">I_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是导数网络提取的特征。</p>
</li>
</ul>
<p>对应代码（像素 L1 + 梯度损失 + derivative max聚合）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># loss/Taylor.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">L_Intensity</span>(nn.Module):  <span class="comment"># 像素L1损失</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, image_A, image_B</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        Loss_intensity = F.l1_loss(image_A, image_B)  <span class="comment"># 计算L1差</span></span><br><span class="line">        <span class="keyword">return</span> Loss_intensity  <span class="comment"># 返回像素损失</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">L_Grad</span>(nn.Module):  <span class="comment"># 梯度损失</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, image_A, image_B</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        image_A_Y = image_A[:, :<span class="number">1</span>, :, :]  <span class="comment"># 取A的Y通道</span></span><br><span class="line">        image_B_Y = image_B[:, :<span class="number">1</span>, :, :]  <span class="comment"># 取B的Y通道</span></span><br><span class="line">        gradient_A = <span class="variable language_">self</span>.sobelconv(image_A_Y)  <span class="comment"># Sobel梯度A</span></span><br><span class="line">        gradient_B = <span class="variable language_">self</span>.sobelconv(image_B_Y)  <span class="comment"># Sobel梯度B</span></span><br><span class="line">        Loss_gradient = F.l1_loss(gradient_A, gradient_B)  <span class="comment"># 梯度L1</span></span><br><span class="line">        <span class="keyword">return</span> Loss_gradient  <span class="comment"># 返回梯度损失</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Taylor_loss</span>(nn.Module):  <span class="comment"># 泰勒联合损失</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span>, result, gd</span>):  <span class="comment"># input为原图，gd为各阶导数</span></span><br><span class="line">        b, c, h, w = result.shape  <span class="comment"># 读取输出尺寸</span></span><br><span class="line">        grad_map = torch.zeros([b, c, h, w]).to(<span class="variable language_">self</span>.device)  <span class="comment"># 初始化梯度图</span></span><br><span class="line">        loss_L1 = <span class="variable language_">self</span>.<span class="built_in">int</span>(<span class="built_in">input</span>, result)   <span class="comment"># L_pixel：像素L1</span></span><br><span class="line">        loss_g1 = <span class="variable language_">self</span>.grad(<span class="built_in">input</span>, result)  <span class="comment"># 输出与输入梯度差</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(gd)):  <span class="comment"># 遍历导数阶次</span></span><br><span class="line">            grad_map = torch.<span class="built_in">max</span>(grad_map, gd[i])  <span class="comment"># 聚合各阶最大响应</span></span><br><span class="line">        loss_g2 = <span class="variable language_">self</span>.<span class="built_in">int</span>(<span class="variable language_">self</span>.sobelconv(<span class="built_in">input</span>), grad_map)  <span class="comment"># 梯度与导数最大图</span></span><br><span class="line">        loss_g = loss_g1 + <span class="number">0.3</span> * loss_g2  <span class="comment"># 梯度损失加权</span></span><br><span class="line">        <span class="keyword">return</span> loss_L1, loss_g, loss_L1 + loss_g  <span class="comment"># 返回分项与总损失</span></span><br></pre></td></tr></table></figure>

<h2 id="3-3-网络优化"><a href="#3-3-网络优化" class="headerlink" title="3.3 网络优化"></a>3.3 网络优化</h2><p>通过最小化上述损失函数，TEA 网络能够从红外和可见光图像中提取有效的特征，既保留了图像的整体结构，又能够细致地提取图像中的细节特征，为后续的图像融合和目标检测任务提供支持。</p>
<p>对应代码（训练中使用联合损失并反向传播优化）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># train_TEM.py</span></span><br><span class="line">loss_int, loss_grad, loss = loss_ft(img, out, y)  <span class="comment"># 计算像素与梯度损失</span></span><br><span class="line">optimizer.zero_grad()  <span class="comment"># 清空梯度</span></span><br><span class="line">loss.backward()  <span class="comment"># 反向传播</span></span><br><span class="line">optimizer.step()  <span class="comment"># 更新参数</span></span><br></pre></td></tr></table></figure>


<hr>
<h1 id="4-双分支特征融合（DBFF）网络"><a href="#4-双分支特征融合（DBFF）网络" class="headerlink" title="4. 双分支特征融合（DBFF）网络"></a>4. 双分支特征融合（DBFF）网络</h1><p>代码来自 <code>network/FusionNet.py</code>、<code>loss/Fusion.py</code>、<code>train_Fusion.py</code>。</p>
<p><img data-src="/./../images/image-20251221081738903.png" alt="image-20251221081738903"></p>
<h2 id="4-1-网络架构概述"><a href="#4-1-网络架构概述" class="headerlink" title="4.1 网络架构概述"></a>4.1 网络架构概述</h2><p>双分支特征融合（DBFF）网络的核心目标是将分解得到的红外和可见光图像特征进行有效融合，从而生成高质量的融合图像。DBFF网络采用两条并行的分支结构，每条分支分别从红外图像和可见光图像中提取特征。每条分支的结构完全相同，具体包括卷积层和梯度残差密集块（GRDB）模块。通过这种结构，DBFF能够在多尺度上提取图像的浅层特征，并进行有效融合。</p>
<h3 id="4-1-1-双分支结构"><a href="#4-1-1-双分支结构" class="headerlink" title="4.1.1 双分支结构"></a>4.1.1 双分支结构</h3><p>在DBFF网络中，有两条并行的分支来分别处理红外图像和可见光图像。这两条分支具有相同的架构，通过卷积操作提取浅层特征，增强图像的局部细节。</p>
<ul>
<li><strong>卷积层</strong>：用于提取图像的基本特征。</li>
<li><strong>梯度残差密集块（GRDB）</strong>：GRDB是一种改进的残差模块，采用了密集连接和梯度残差网络，能够更好地保留细节信息并进行多尺度特征提取。</li>
</ul>
<p>对应代码（GRDB的实现：密集连接 + Sobel梯度残差）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/FusionNet.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConvLeakyRelu2d</span>(nn.Module):  <span class="comment"># 基础卷积块</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>, stride=<span class="number">1</span>, dilation=<span class="number">1</span>, groups=<span class="number">1</span></span>):  <span class="comment"># 初始化超参</span></span><br><span class="line">        <span class="built_in">super</span>(ConvLeakyRelu2d, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.conv = nn.Conv2d(in_channels, out_channels, kernel_size=kernel_size, padding=padding, stride=stride, dilation=dilation, groups=groups)  <span class="comment"># 卷积层</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        <span class="keyword">return</span> F.leaky_relu(<span class="variable language_">self</span>.conv(x), negative_slope=<span class="number">0.2</span>)  <span class="comment"># LeakyReLU 激活</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sobelxy</span>(nn.Module):  <span class="comment"># Sobel 梯度模块</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, channels, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>, stride=<span class="number">1</span>, dilation=<span class="number">1</span>, groups=<span class="number">1</span></span>):  <span class="comment"># 初始化超参</span></span><br><span class="line">        <span class="built_in">super</span>(Sobelxy, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        sobel_filter = np.array([[<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>], [<span class="number">2</span>, <span class="number">0</span>, -<span class="number">2</span>], [<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>]])  <span class="comment"># Sobel 核</span></span><br><span class="line">        <span class="variable language_">self</span>.convx = nn.Conv2d(channels, channels, kernel_size=kernel_size, padding=padding, stride=stride, dilation=dilation, groups=channels, bias=<span class="literal">False</span>)  <span class="comment"># x方向梯度</span></span><br><span class="line">        <span class="variable language_">self</span>.convx.weight.data.copy_(torch.from_numpy(sobel_filter))  <span class="comment"># 载入权重</span></span><br><span class="line">        <span class="variable language_">self</span>.convy = nn.Conv2d(channels, channels, kernel_size=kernel_size, padding=padding, stride=stride, dilation=dilation, groups=channels, bias=<span class="literal">False</span>)  <span class="comment"># y方向梯度</span></span><br><span class="line">        <span class="variable language_">self</span>.convy.weight.data.copy_(torch.from_numpy(sobel_filter.T))  <span class="comment"># 载入权重</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        sobelx = <span class="variable language_">self</span>.convx(x)  <span class="comment"># x方向梯度</span></span><br><span class="line">        sobely = <span class="variable language_">self</span>.convy(x)  <span class="comment"># y方向梯度</span></span><br><span class="line">        x = torch.<span class="built_in">abs</span>(sobelx) + torch.<span class="built_in">abs</span>(sobely)  <span class="comment"># 幅值叠加</span></span><br><span class="line">        <span class="keyword">return</span> x  <span class="comment"># 返回梯度特征</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Conv1</span>(nn.Module):  <span class="comment"># 1x1 卷积块</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels, kernel_size=<span class="number">1</span>, padding=<span class="number">0</span>, stride=<span class="number">1</span>, dilation=<span class="number">1</span>, groups=<span class="number">1</span></span>):  <span class="comment"># 初始化超参</span></span><br><span class="line">        <span class="built_in">super</span>(Conv1, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.conv = nn.Conv2d(in_channels, out_channels, kernel_size=kernel_size, padding=padding, stride=stride, dilation=dilation, groups=groups)  <span class="comment"># 1x1卷积</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.conv(x)  <span class="comment"># 返回卷积结果</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DenseBlock</span>(nn.Module):  <span class="comment"># 密集连接块</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, channels</span>):  <span class="comment"># 输入通道数</span></span><br><span class="line">        <span class="built_in">super</span>(DenseBlock, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.conv1 = ConvLeakyRelu2d(channels, channels)  <span class="comment"># 第1层</span></span><br><span class="line">        <span class="variable language_">self</span>.conv2 = ConvLeakyRelu2d(<span class="number">2</span> * channels, channels)  <span class="comment"># 第2层</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        x = torch.cat((x, <span class="variable language_">self</span>.conv1(x)), dim=<span class="number">1</span>)  <span class="comment"># 拼接第1层输出</span></span><br><span class="line">        x = torch.cat((x, <span class="variable language_">self</span>.conv2(x)), dim=<span class="number">1</span>)  <span class="comment"># 拼接第2层输出</span></span><br><span class="line">        <span class="keyword">return</span> x  <span class="comment"># 返回密集特征</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RGBD</span>(nn.Module):  <span class="comment"># 梯度残差密集块（GRDB 对应实现）</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels</span>):  <span class="comment"># 输入/输出通道</span></span><br><span class="line">        <span class="built_in">super</span>(RGBD, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.dense = DenseBlock(in_channels)  <span class="comment"># 密集连接分支</span></span><br><span class="line">        <span class="variable language_">self</span>.convdown = Conv1(<span class="number">3</span> * in_channels, out_channels)  <span class="comment"># 通道压缩</span></span><br><span class="line">        <span class="variable language_">self</span>.sobelconv = Sobelxy(in_channels)  <span class="comment"># 梯度分支</span></span><br><span class="line">        <span class="variable language_">self</span>.convup = Conv1(in_channels, out_channels)  <span class="comment"># 通道对齐</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        x1 = <span class="variable language_">self</span>.dense(x)  <span class="comment"># 密集分支特征</span></span><br><span class="line">        x1 = <span class="variable language_">self</span>.convdown(x1)  <span class="comment"># 压缩通道</span></span><br><span class="line">        x2 = <span class="variable language_">self</span>.sobelconv(x)  <span class="comment"># 梯度分支特征</span></span><br><span class="line">        x2 = <span class="variable language_">self</span>.convup(x2)  <span class="comment"># 对齐通道</span></span><br><span class="line">        <span class="keyword">return</span> F.leaky_relu(x1 + x2, negative_slope=<span class="number">0.1</span>)  <span class="comment"># 残差融合后激活</span></span><br></pre></td></tr></table></figure>

<p>对应代码（双分支结构：红外&#x2F;可见光对称提取）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/FusionNet.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FusionNetwork</span>(nn.Module):  <span class="comment"># DBFF 主体</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, output</span>):  <span class="comment"># 初始化输出通道</span></span><br><span class="line">        <span class="built_in">super</span>(FusionNetwork, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        vis_ch = [<span class="number">16</span>, <span class="number">32</span>, <span class="number">48</span>]  <span class="comment"># 可见光分支通道</span></span><br><span class="line">        inf_ch = [<span class="number">16</span>, <span class="number">32</span>, <span class="number">48</span>]  <span class="comment"># 红外分支通道</span></span><br><span class="line">        output = <span class="number">1</span>  <span class="comment"># 输出单通道</span></span><br><span class="line">        <span class="variable language_">self</span>.vis_conv = ConvLeakyRelu2d(<span class="number">1</span>, vis_ch[<span class="number">0</span>])  <span class="comment"># 可见光卷积层</span></span><br><span class="line">        <span class="variable language_">self</span>.vis_rgbd1 = RGBD(vis_ch[<span class="number">0</span>], vis_ch[<span class="number">1</span>])  <span class="comment"># 可见光 GRDB-1</span></span><br><span class="line">        <span class="variable language_">self</span>.vis_rgbd2 = RGBD(vis_ch[<span class="number">1</span>], vis_ch[<span class="number">2</span>])  <span class="comment"># 可见光 GRDB-2</span></span><br><span class="line">        <span class="variable language_">self</span>.inf_conv = ConvLeakyRelu2d(<span class="number">1</span>, inf_ch[<span class="number">0</span>])  <span class="comment"># 红外卷积层</span></span><br><span class="line">        <span class="variable language_">self</span>.inf_rgbd1 = RGBD(inf_ch[<span class="number">0</span>], inf_ch[<span class="number">1</span>])  <span class="comment"># 红外 GRDB-1</span></span><br><span class="line">        <span class="variable language_">self</span>.inf_rgbd2 = RGBD(inf_ch[<span class="number">1</span>], inf_ch[<span class="number">2</span>])  <span class="comment"># 红外 GRDB-2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, image_vis, image_ir</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        x_vis_origin = image_vis[:, :<span class="number">1</span>]  <span class="comment"># 提取可见光Y通道</span></span><br><span class="line">        x_inf_origin = image_ir  <span class="comment"># 红外单通道</span></span><br><span class="line">        x_vis_p = <span class="variable language_">self</span>.vis_conv(x_vis_origin)  <span class="comment"># 可见光浅层特征</span></span><br><span class="line">        x_vis_p1 = <span class="variable language_">self</span>.vis_rgbd1(x_vis_p)  <span class="comment"># 可见光 GRDB-1</span></span><br><span class="line">        x_vis_p2 = <span class="variable language_">self</span>.vis_rgbd2(x_vis_p1)  <span class="comment"># 可见光 GRDB-2</span></span><br><span class="line">        x_inf_p = <span class="variable language_">self</span>.inf_conv(x_inf_origin)  <span class="comment"># 红外浅层特征</span></span><br><span class="line">        x_inf_p1 = <span class="variable language_">self</span>.inf_rgbd1(x_inf_p)  <span class="comment"># 红外 GRDB-1</span></span><br><span class="line">        x_inf_p2 = <span class="variable language_">self</span>.inf_rgbd2(x_inf_p1)  <span class="comment"># 红外 GRDB-2</span></span><br></pre></td></tr></table></figure>

<h3 id="4-1-2-特征融合"><a href="#4-1-2-特征融合" class="headerlink" title="4.1.2 特征融合"></a>4.1.2 特征融合</h3><p>在两条分支分别提取出红外和可见光图像的特征后，将这两部分特征进行融合。融合操作采用了元素级加法，将提取的红外和可见光图像特征进行加和，得到融合后的特征图。这一步确保了图像的多模态信息能够被有效整合，从而增强了目标的突出显示和场景细节的保留。</p>
<p>对应代码（分支特征拼接 + CBAM + 解码融合）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/FusionNet.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FusionNetwork</span>(nn.Module):  <span class="comment"># DBFF 主体</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, output</span>):  <span class="comment"># 初始化输出通道</span></span><br><span class="line">        <span class="built_in">super</span>(FusionNetwork, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        vis_ch = [<span class="number">16</span>, <span class="number">32</span>, <span class="number">48</span>]  <span class="comment"># 可见光分支通道</span></span><br><span class="line">        inf_ch = [<span class="number">16</span>, <span class="number">32</span>, <span class="number">48</span>]  <span class="comment"># 红外分支通道</span></span><br><span class="line">        output = <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.attention = cbam_block(vis_ch[<span class="number">2</span>] + inf_ch[<span class="number">2</span>])  <span class="comment"># CBAM 注意力</span></span><br><span class="line">        <span class="variable language_">self</span>.decode4 = ConvBnLeakyRelu2d(vis_ch[<span class="number">2</span>] + inf_ch[<span class="number">2</span>], vis_ch[<span class="number">1</span>] + vis_ch[<span class="number">1</span>], padding=<span class="number">3</span>, dilation=<span class="number">3</span>)  <span class="comment"># 解码层</span></span><br><span class="line">        <span class="variable language_">self</span>.decode3 = ConvBnLeakyRelu2d(vis_ch[<span class="number">1</span>] + inf_ch[<span class="number">1</span>], vis_ch[<span class="number">0</span>] + inf_ch[<span class="number">0</span>], padding=<span class="number">3</span>, dilation=<span class="number">3</span>)  <span class="comment"># 解码层</span></span><br><span class="line">        <span class="variable language_">self</span>.decode2 = ConvBnLeakyRelu2d(vis_ch[<span class="number">0</span>] + inf_ch[<span class="number">0</span>], vis_ch[<span class="number">0</span>], padding=<span class="number">3</span>, dilation=<span class="number">3</span>)  <span class="comment"># 解码层</span></span><br><span class="line">        <span class="variable language_">self</span>.decode1 = ConvBnTanh2d(vis_ch[<span class="number">0</span>], output)  <span class="comment"># 输出层</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, image_vis, image_ir</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        x_attention = <span class="variable language_">self</span>.attention(torch.cat((x_vis_p2, x_inf_p2), dim=<span class="number">1</span>))  <span class="comment"># 特征拼接后做注意力</span></span><br><span class="line">        x = <span class="variable language_">self</span>.decode4(x_attention)  <span class="comment"># 解码融合</span></span><br><span class="line">        x = <span class="variable language_">self</span>.decode3(x)  <span class="comment"># 逐级解码</span></span><br><span class="line">        x = <span class="variable language_">self</span>.decode2(x)  <span class="comment"># 逐级解码</span></span><br><span class="line">        x = <span class="variable language_">self</span>.decode1(x)  <span class="comment"># 输出融合图</span></span><br><span class="line">        <span class="keyword">return</span> x  <span class="comment"># 返回融合结果</span></span><br></pre></td></tr></table></figure>

<h3 id="4-1-3-注意力机制"><a href="#4-1-3-注意力机制" class="headerlink" title="4.1.3 注意力机制"></a>4.1.3 注意力机制</h3><p>为了进一步增强特征融合效果，作者在DBFF网络中引入了注意力机制。具体而言，采用了空间-通道注意力机制（CBAM）来优化特征融合的过程。CBAM通过在空间和通道维度上对特征图进行加权处理，能够有效抑制背景信息，突出目标区域，从而提高融合图像的质量。</p>
<p>对应代码（CBAM：通道注意力 + 空间注意力）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/FusionNet.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChannelAttention</span>(nn.Module):  <span class="comment"># 通道注意力</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_planes, ratio=<span class="number">8</span></span>):  <span class="comment"># 输入通道与压缩比</span></span><br><span class="line">        <span class="built_in">super</span>(ChannelAttention, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.avg_pool = nn.AdaptiveAvgPool2d(<span class="number">1</span>)  <span class="comment"># 全局平均池化</span></span><br><span class="line">        <span class="variable language_">self</span>.max_pool = nn.AdaptiveMaxPool2d(<span class="number">1</span>)  <span class="comment"># 全局最大池化</span></span><br><span class="line">        <span class="variable language_">self</span>.fc1 = nn.Conv2d(in_planes, in_planes // ratio, <span class="number">1</span>, bias=<span class="literal">False</span>)  <span class="comment"># 降维</span></span><br><span class="line">        <span class="variable language_">self</span>.relu1 = nn.ReLU()  <span class="comment"># ReLU</span></span><br><span class="line">        <span class="variable language_">self</span>.fc2 = nn.Conv2d(in_planes // ratio, in_planes, <span class="number">1</span>, bias=<span class="literal">False</span>)  <span class="comment"># 升维</span></span><br><span class="line">        <span class="variable language_">self</span>.sigmoid = nn.Sigmoid()  <span class="comment"># Sigmoid 归一化</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        avg_out = <span class="variable language_">self</span>.fc2(<span class="variable language_">self</span>.relu1(<span class="variable language_">self</span>.fc1(<span class="variable language_">self</span>.avg_pool(x))))  <span class="comment"># 平均池化分支</span></span><br><span class="line">        max_out = <span class="variable language_">self</span>.fc2(<span class="variable language_">self</span>.relu1(<span class="variable language_">self</span>.fc1(<span class="variable language_">self</span>.max_pool(x))))  <span class="comment"># 最大池化分支</span></span><br><span class="line">        out = avg_out + max_out  <span class="comment"># 分支相加</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.sigmoid(out)  <span class="comment"># 输出通道权重</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpatialAttention</span>(nn.Module):  <span class="comment"># 空间注意力</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, kernel_size=<span class="number">7</span></span>):  <span class="comment"># 卷积核大小</span></span><br><span class="line">        <span class="built_in">super</span>(SpatialAttention, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="keyword">assert</span> kernel_size <span class="keyword">in</span> (<span class="number">3</span>, <span class="number">7</span>), <span class="string">&#x27;kernel size must be 3 or 7&#x27;</span>  <span class="comment"># 约束核尺寸</span></span><br><span class="line">        padding = <span class="number">3</span> <span class="keyword">if</span> kernel_size == <span class="number">7</span> <span class="keyword">else</span> <span class="number">1</span>  <span class="comment"># 设置padding</span></span><br><span class="line">        <span class="variable language_">self</span>.conv1 = nn.Conv2d(<span class="number">2</span>, <span class="number">1</span>, kernel_size, padding=padding, bias=<span class="literal">False</span>)  <span class="comment"># 空间卷积</span></span><br><span class="line">        <span class="variable language_">self</span>.sigmoid = nn.Sigmoid()  <span class="comment"># Sigmoid 归一化</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        avg_out = torch.mean(x, dim=<span class="number">1</span>, keepdim=<span class="literal">True</span>)  <span class="comment"># 通道平均</span></span><br><span class="line">        max_out, _ = torch.<span class="built_in">max</span>(x, dim=<span class="number">1</span>, keepdim=<span class="literal">True</span>)  <span class="comment"># 通道最大</span></span><br><span class="line">        x = torch.cat([avg_out, max_out], dim=<span class="number">1</span>)  <span class="comment"># 拼接两路</span></span><br><span class="line">        x = <span class="variable language_">self</span>.conv1(x)  <span class="comment"># 空间卷积</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.sigmoid(x)  <span class="comment"># 输出空间权重</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cbam_block</span>(nn.Module):  <span class="comment"># CBAM 组合块</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, channel, ratio=<span class="number">8</span>, kernel_size=<span class="number">7</span></span>):  <span class="comment"># 初始化超参</span></span><br><span class="line">        <span class="built_in">super</span>(cbam_block, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.channelattention = ChannelAttention(channel, ratio=ratio)  <span class="comment"># 通道注意力</span></span><br><span class="line">        <span class="variable language_">self</span>.spatialattention = SpatialAttention(kernel_size=kernel_size)  <span class="comment"># 空间注意力</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        x = x * <span class="variable language_">self</span>.channelattention(x)  <span class="comment"># 通道加权</span></span><br><span class="line">        x = x * <span class="variable language_">self</span>.spatialattention(x)  <span class="comment"># 空间加权</span></span><br><span class="line">        <span class="keyword">return</span> x  <span class="comment"># 返回加权特征</span></span><br></pre></td></tr></table></figure>

<h2 id="4-2-损失函数"><a href="#4-2-损失函数" class="headerlink" title="4.2 损失函数"></a>4.2 损失函数</h2><p>双分支结构是DBFF网络的核心，旨在分别处理红外图像和可见光图像的特征。每个分支采用相同的网络架构，包括卷积层和梯度残差密集块（GRDB），以便在多个尺度上提取图像的浅层特征。</p>
<p>在两条并行分支中，红外和可见光图像被独立地处理，提取出各自的特征。然后，利用加权融合策略，将这两部分特征进行融合，最终得到更具代表性的融合图像。与传统的单分支结构不同，DBFF网络通过引入注意力机制，能够更精细地处理红外图像中的低光区域和可见光图像中的细节部分，极大提升了图像的质量。</p>
<p>为了优化DBFF网络，确保其能够有效融合红外和可见光图像的特征，作者设计了一个联合损失函数，该损失函数包括强度损失和纹理细节损失两个部分：</p>
<h3 id="4-2-1-强度损失（Intensity-Loss）"><a href="#4-2-1-强度损失（Intensity-Loss）" class="headerlink" title="4.2.1 强度损失（Intensity Loss）"></a>4.2.1 强度损失（Intensity Loss）</h3><p>强度损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{int}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 主要用于约束融合图像的整体强度，使其与源图像在强度上保持一致。其公式为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi>H</mi><mi>W</mi></mrow></mfrac><mi mathvariant="normal">∥</mi><msub><mi>I</mi><mi>f</mi></msub><mo>−</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>I</mi><mi>r</mi></msub><mo separator="true">,</mo><msub><mi>I</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">
L_{int} = \frac{1}{H W} \| I_f - \max(I_r, I_{vis}) \|_1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>

<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">I_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 表示融合后的图像，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">I_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{vis}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分别表示红外图像和可见光图像，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> 分别是图像的高度和宽度。</p>
<h3 id="4-2-2-纹理细节损失（Texture-Loss）"><a href="#4-2-2-纹理细节损失（Texture-Loss）" class="headerlink" title="4.2.2 纹理细节损失（Texture Loss）"></a>4.2.2 纹理细节损失（Texture Loss）</h3><p>纹理细节损失 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>t</mi><mi>e</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{tex}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 主要用于保留图像中的细节信息，尤其是图像中的边缘和纹理。其公式为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>t</mi><mi>e</mi><mi>x</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi>H</mi><mi>W</mi></mrow></mfrac><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mi>f</mi></msub><mo>−</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mi>r</mi></msub><mo separator="true">,</mo><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">
L_{tex} = \frac{1}{H W} \| \nabla I_f - \max(\nabla I_r, \nabla I_{vis}) \|_1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>

<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi></mrow><annotation encoding="application/x-tex">\nabla</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span></span></span></span> 表示图像的梯度操作，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mi>f</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\nabla I_f|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord">∣∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span> 表示融合图像的梯度，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mi>r</mi></msub><mo separator="true">,</mo><mi mathvariant="normal">∇</mi><msub><mi>I</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\max(\nabla I_r, \nabla I_{vis})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∇</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 表示红外和可见光图像的梯度的最大值。</p>
<h3 id="4-2-3-总损失函数"><a href="#4-2-3-总损失函数" class="headerlink" title="4.2.3 总损失函数"></a>4.2.3 总损失函数</h3><p>联合损失函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>F</mi></msub></mrow><annotation encoding="application/x-tex">L_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 由强度损失和纹理细节损失组成，其公式为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mi>F</mi></msub><mo>=</mo><msub><mi>L</mi><mrow><mi>i</mi><mi>n</mi><mi>t</mi></mrow></msub><mo>+</mo><mi>α</mi><msub><mi>L</mi><mrow><mi>t</mi><mi>e</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
L_F = L_{int} + \alpha L_{tex}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>

<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> 是一个超参数，用于平衡强度损失和纹理细节损失的影响。</p>
<p>对应代码（强度与纹理梯度损失）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># loss/Fusion.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sobelxy</span>(nn.Module):  <span class="comment"># Sobel 梯度</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):  <span class="comment"># 初始化</span></span><br><span class="line">        <span class="built_in">super</span>(Sobelxy, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        kernelx = [[-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>], [-<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>], [-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]]  <span class="comment"># x方向核</span></span><br><span class="line">        kernely = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [-<span class="number">1</span>, -<span class="number">2</span>, -<span class="number">1</span>]]  <span class="comment"># y方向核</span></span><br><span class="line">        kernelx = torch.FloatTensor(kernelx).unsqueeze(<span class="number">0</span>).unsqueeze(<span class="number">0</span>)  <span class="comment"># 转Tensor</span></span><br><span class="line">        kernely = torch.FloatTensor(kernely).unsqueeze(<span class="number">0</span>).unsqueeze(<span class="number">0</span>)  <span class="comment"># 转Tensor</span></span><br><span class="line">        <span class="variable language_">self</span>.device = torch.device(<span class="string">&quot;cuda:0&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)  <span class="comment"># 设备</span></span><br><span class="line">        <span class="variable language_">self</span>.weightx = nn.Parameter(data=kernelx, requires_grad=<span class="literal">False</span>).to(<span class="variable language_">self</span>.device)  <span class="comment"># 固定权重x</span></span><br><span class="line">        <span class="variable language_">self</span>.weighty = nn.Parameter(data=kernely, requires_grad=<span class="literal">False</span>).to(<span class="variable language_">self</span>.device)  <span class="comment"># 固定权重y</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):  <span class="comment"># 前向传播</span></span><br><span class="line">        sobelx = F.conv2d(x, <span class="variable language_">self</span>.weightx, padding=<span class="number">1</span>)  <span class="comment"># x方向梯度</span></span><br><span class="line">        sobely = F.conv2d(x, <span class="variable language_">self</span>.weighty, padding=<span class="number">1</span>)  <span class="comment"># y方向梯度</span></span><br><span class="line">        <span class="keyword">return</span> torch.<span class="built_in">abs</span>(sobelx) + torch.<span class="built_in">abs</span>(sobely)  <span class="comment"># 幅值叠加</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fusionloss</span>(nn.Module):  <span class="comment"># 融合损失</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):  <span class="comment"># 初始化</span></span><br><span class="line">        <span class="built_in">super</span>(Fusionloss, <span class="variable language_">self</span>).__init__()  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.sobelconv = Sobelxy()  <span class="comment"># 梯度算子</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, image_vis, image_ir, generate_img</span>):  <span class="comment"># 前向传播损失</span></span><br><span class="line">        image_y = image_vis[:, :<span class="number">1</span>, :, :]  <span class="comment"># 可见光Y通道</span></span><br><span class="line">        x_in_max = torch.<span class="built_in">max</span>(image_y, image_ir)  <span class="comment"># 强度目标：max(Ir,Ivis)</span></span><br><span class="line">        loss_in = F.l1_loss(x_in_max, generate_img)  <span class="comment"># 强度损失</span></span><br><span class="line">        y_grad = <span class="variable language_">self</span>.sobelconv(image_y)  <span class="comment"># 可见光梯度</span></span><br><span class="line">        ir_grad = <span class="variable language_">self</span>.sobelconv(image_ir)  <span class="comment"># 红外梯度</span></span><br><span class="line">        generate_img_grad = <span class="variable language_">self</span>.sobelconv(generate_img)  <span class="comment"># 融合图梯度</span></span><br><span class="line">        x_grad_joint = torch.<span class="built_in">max</span>(y_grad, ir_grad)  <span class="comment"># 梯度目标：max(grad)</span></span><br><span class="line">        loss_grad = F.l1_loss(x_grad_joint, generate_img_grad)  <span class="comment"># 纹理细节损失</span></span><br><span class="line">        loss_total = loss_in + <span class="number">10</span> * loss_grad  <span class="comment"># 总损失（含权重）</span></span><br><span class="line">        <span class="keyword">return</span> loss_in, loss_grad, loss_total  <span class="comment"># 返回分项与总损失</span></span><br></pre></td></tr></table></figure>

<h2 id="4-3-逆泰勒重构（ITE）网络"><a href="#4-3-逆泰勒重构（ITE）网络" class="headerlink" title="4.3 逆泰勒重构（ITE）网络"></a>4.3 逆泰勒重构（ITE）网络</h2><p>在完成IR与VIS特征的融合后，DBFF生成的融合特征需要通过逆泰勒展开（ITE）过程恢复为最终的融合图像。这一步骤是将多阶泰勒分解的结果重新组织为单一的融合输出，其核心是利用泰勒展开的线性可加性。</p>
<p>根据泰勒定理，多阶导数项的线性组合可以近似原函数，因此多个融合分支的加权求和能够恢复高保真的融合结果。FusionModel通过以下方式实现逆泰勒重构：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi>f</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac><mo>⋅</mo><msub><mi>F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msubsup><mi>y</mi><mi>i</mi><mrow><mi>i</mi><mi>r</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mi>i</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\hat{I}_f = \sum_{i=0}^{n} \frac{1}{i!} \cdot F_i(y_i^{ir}, y_i^{vis})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2329em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1389em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>

<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">F_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>阶的融合网络（DBFF），<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mi>i</mi><mrow><mi>i</mi><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">y_i^{ir}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0833em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mi>i</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">y_i^{vis}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0833em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span>分别是红外和可见光的第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>阶泰勒分解特征，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{i!}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>是阶乘归一化系数，确保高阶项的贡献逐步衰减，保持数值稳定性。</p>
<p>对应代码（FusionModel中的多阶加权融合与重构）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/FusionNet.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FusionModel</span>(nn.Module):  <span class="comment"># 逆泰勒重构模型</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kwargs</span>) -&gt; <span class="literal">None</span>:  <span class="comment"># 初始化</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwargs)  <span class="comment"># 调用父类初始化</span></span><br><span class="line">        <span class="variable language_">self</span>.Net = FusionNetwork(output=<span class="number">1</span>)  <span class="comment"># DBFF 融合网络</span></span><br><span class="line">        <span class="variable language_">self</span>.device = torch.device(<span class="string">&quot;cuda:0&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)  <span class="comment"># 设备设置</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, ir, vis</span>):  <span class="comment"># 前向传播：逆泰勒重构</span></span><br><span class="line">        f_list = []  <span class="comment"># 保存各阶融合结果</span></span><br><span class="line">        n = <span class="built_in">len</span>(ir)  <span class="comment"># 获取泰勒分解的阶数</span></span><br><span class="line">        b, c, h, w = ir[<span class="number">0</span>].shape  <span class="comment"># 读取批次、通道、高、宽</span></span><br><span class="line">        result = torch.zeros([b, c, h, w]).to(<span class="variable language_">self</span>.device)  <span class="comment"># 初始化重建结果</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):  <span class="comment"># 逐阶处理泰勒分解特征</span></span><br><span class="line">            <span class="comment"># 每一阶都通过 DBFF 网络进行融合</span></span><br><span class="line">            f_list.append(<span class="variable language_">self</span>.Net(ir[i], vis[i]))  <span class="comment"># ir[i]、vis[i] 是第i阶特征</span></span><br><span class="line">            <span class="comment"># 按 1/i! 权重累加各阶融合结果</span></span><br><span class="line">            result += (<span class="number">1</span> / factorial(i)) * f_list[i].to(<span class="variable language_">self</span>.device)  <span class="comment"># 加权聚合</span></span><br><span class="line">        <span class="keyword">return</span> result  <span class="comment"># 返回重建的融合图像</span></span><br></pre></td></tr></table></figure>

<p><strong>维度追踪</strong>：</p>
<ul>
<li>输入：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>r</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>B</mi><mo>×</mo><mn>1</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow><annotation encoding="application/x-tex">ir[0] \in \mathbb{R}^{B \times 1 \times H \times W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mbin mtight">×</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span></span></span></span>（基础层），<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>r</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>B</mi><mo>×</mo><mn>1</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow><annotation encoding="application/x-tex">ir[1] \in \mathbb{R}^{B \times 1 \times H \times W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mbin mtight">×</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span></span></span></span>（一阶导数），…</li>
<li>经过DBFF融合（通道16→32→48→融合后48→解码回1）</li>
<li>输出：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi>f</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>B</mi><mo>×</mo><mn>1</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\hat{I}_f \in \mathbb{R}^{B \times 1 \times H \times W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2329em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1389em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mbin mtight">×</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span></span></span></span>（单通道融合图）</li>
</ul>
<p>这一设计保证了多阶泰勒特征能够被有效整合，同时通过阶乘系数的自然衰减，使高阶项（包含更多高频细节）的影响逐步减弱，避免过度放大噪声。</p>
<h2 id="4-4-维度变换与阶乘加权的理论依据"><a href="#4-4-维度变换与阶乘加权的理论依据" class="headerlink" title="4.4 维度变换与阶乘加权的理论依据"></a>4.4 维度变换与阶乘加权的理论依据</h2><h3 id="4-4-1-从多阶分解到单通道融合的维度变换"><a href="#4-4-1-从多阶分解到单通道融合的维度变换" class="headerlink" title="4.4.1 从多阶分解到单通道融合的维度变换"></a>4.4.1 从多阶分解到单通道融合的维度变换</h3><p>问题的本质：为什么TEA网络输出多个泰勒项（通道维度高），而DBFF融合后却能恢复为单通道高质量图像？</p>
<p><strong>核心原理</strong>：泰勒展开的各阶项虽然在特征维度上”平行”，但它们在数学上代表了同一个图像函数在不同”尺度”或”频率”的表示。这类似于傅里叶变换中不同频率分量的组合。</p>
<ul>
<li><strong>0阶项</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>：图像的全局亮度&#x2F;整体结构（低频）</li>
<li><strong>1阶项</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f&#x27;(x_0) \cdot (x-x_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>：一阶导数，代表图像边界&#x2F;梯度信息（中频）</li>
<li><strong>2阶项</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">f&#x27;&#x27;(x_0) \cdot (x-x_0)^2 / 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/2</span></span></span></span>：二阶导数，代表纹理细节&#x2F;曲率信息（高频）</li>
</ul>
<p><strong>维度变换流程</strong>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>(TEA提取的多阶特征)</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>:</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">]</mo><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>B</mi><mo>×</mo><mn>1</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup><mo>×</mo><mi>n</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>(DBFF各阶融合)</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>:</mo><mi>F</mi><mo stretchy="false">(</mo><msubsup><mi>y</mi><mi>i</mi><mrow><mi>i</mi><mi>r</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mi>i</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msubsup><mo stretchy="false">)</mo><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>B</mi><mo>×</mo><mn>1</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>(阶乘加权聚合)</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>:</mo><mover accent="true"><mi>I</mi><mo>^</mo></mover><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac><msub><mi>F</mi><mi>i</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>B</mi><mo>×</mo><mn>1</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\text{(TEA提取的多阶特征)} &amp;: [y_0, y_1, y_2, \ldots, y_n] \in \mathbb{R}^{B \times 1 \times H \times W} \times n\\
\text{(DBFF各阶融合)} &amp;: F(y_i^{ir}, y_i^{vis}) \in \mathbb{R}^{B \times 1 \times H \times W}\\
\text{(阶乘加权聚合)} &amp;: \hat{I} = \sum_{i=0}^n \frac{1}{i!} F_i \in \mathbb{R}^{B \times 1 \times H \times W}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.3317em;vertical-align:-2.9159em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.4159em;"><span style="top:-6.1759em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord text"><span class="mord">(TEA</span><span class="mord cjk_fallback">提取的多阶特征</span><span class="mord">)</span></span></span></span><span style="top:-4.6246em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord text"><span class="mord">(DBFF</span><span class="mord cjk_fallback">各阶融合</span><span class="mord">)</span></span></span></span><span style="top:-2.3132em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord text"><span class="mord">(</span><span class="mord cjk_fallback">阶乘加权聚合</span><span class="mord">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9159em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.4159em;"><span style="top:-6.1759em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mbin mtight">×</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">n</span></span></span><span style="top:-4.6246em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mbin mtight">×</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.3132em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1389em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mbin mtight">×</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9159em;"><span></span></span></span></span></span></span></span></span></span></span></span>

<p><strong>阶乘系数的作用</strong>：</p>
<ol>
<li><p><strong>数值稳定性</strong>：高阶泰勒项往往包含更多噪声，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{i!}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>的指数级衰减（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0.5</mn><mo separator="true">,</mo><mn>0.167</mn><mo separator="true">,</mo><mn>0.042</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">1, 1, 0.5, 0.167, 0.042, \ldots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.167</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.042</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span>）自然压制高阶噪声的影响。</p>
</li>
<li><p><strong>信息保留</strong>：0阶和1阶项的系数最大（1和1），确保基础亮度和梯度信息被充分融合；高阶项虽然权重小，但仍保留细微纹理。</p>
</li>
<li><p><strong>泰勒逼近的数学性质</strong>：根据泰勒定理，当展开阶数足够时，</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≈</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mfrac><mrow><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">
   f(x) \approx \sum_{i=0}^n \frac{f^{(i)}(x_0)}{i!}(x-x_0)^i
   </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.565em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span>
<p>其中阶乘分母正是泰勒级数的标准形式。因此，在融合层直接使用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{i!}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>权重是符合数学原理的。</p>
</li>
</ol>
<p>对应代码验证（阶乘衰减可视化）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 阶乘系数的衰减规律</span></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> factorial</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    coeff = <span class="number">1</span> / factorial(i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第<span class="subst">&#123;i&#125;</span>阶系数: <span class="subst">&#123;coeff:<span class="number">.4</span>f&#125;</span>&quot;</span>)  <span class="comment"># 输出: 1.0000, 1.0000, 0.5000, 0.1667, 0.0417</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 在融合中的应用</span></span><br><span class="line">result = torch.zeros([b, c, h, w]).to(device)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    weight = <span class="number">1</span> / factorial(i)  <span class="comment"># 自动衰减系数</span></span><br><span class="line">    result += weight * f_list[i]  <span class="comment"># 高阶项自然被压制</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4-2-output-1"><a href="#4-4-2-output-1" class="headerlink" title="4.4.2 output&#x3D;1"></a>4.4.2 output&#x3D;1</h3><p><strong>设计背景</strong>：红外和可见光融合的目标图像是灰度图（单通道）或YCbCr空间中的亮度通道（Y），这是因为：</p>
<ol>
<li><strong>任务要求</strong>：IR-VIS融合主要面向目标检测&#x2F;分割，这些任务对灰度融合图的判别性要求最高。</li>
<li><strong>数据集约定</strong>：MSRS、TNO等标准数据集的融合参考图均为单通道灰度。</li>
<li><strong>网络设计</strong>：DBFF网络最后一层为<code>ConvBnTanh2d(vis_ch[0], output=1)</code>，显式将多通道特征投影到1维。</li>
</ol>
<p><strong>维度流转细节</strong>：</p>
<table>
<thead>
<tr>
<th>阶段</th>
<th>输入维度</th>
<th>处理</th>
<th>输出维度</th>
</tr>
</thead>
<tbody><tr>
<td>DBFF编码</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 1, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
<td>vis_conv + vis_rgbd1&#x2F;2</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>48</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 48, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">48</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td>注意力融合</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>96</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 96, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">96</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
<td>concat + CBAM</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>96</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 96, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">96</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td>DBFF解码</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>96</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 96, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">96</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
<td>decode4&#x2F;3&#x2F;2</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>16</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 16, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">16</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td>输出投影</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>16</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 16, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">16</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
<td>decode1 (1x1卷积)</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 1, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td>多阶累加</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">(B, 1, H, W) \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></td>
<td>按<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>i</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">1/i!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord mathnormal">i</span><span class="mclose">!</span></span></span></span>加权求和</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, 1, H, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></td>
</tr>
</tbody></table>
<p>对应代码（输出维度的最终确定）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># network/FusionNet.py</span></span><br><span class="line"><span class="variable language_">self</span>.decode1 = ConvBnTanh2d(vis_ch[<span class="number">0</span>], output=<span class="number">1</span>)  <span class="comment"># 强制输出为1通道</span></span><br><span class="line"><span class="comment"># ConvBnTanh2d</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConvBnTanh2d</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>, stride=<span class="number">1</span>, dilation=<span class="number">1</span>, groups=<span class="number">1</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(ConvBnTanh2d, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.conv = nn.Conv2d(in_channels, out_channels, kernel_size=kernel_size, padding=padding, stride=stride, dilation=dilation, groups=groups)</span><br><span class="line">        <span class="variable language_">self</span>.bn = nn.BatchNorm2d(out_channels)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> torch.tanh(<span class="variable language_">self</span>.conv(x)) / <span class="number">2</span> + <span class="number">0.5</span>  <span class="comment"># Tanh 激活 + 缩放到 [0, 1]</span></span><br></pre></td></tr></table></figure>

<p><strong>Tanh激活的作用</strong>：将特征压缩到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-1, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，再通过线性变换映射到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，确保融合图像的像素值在合法范围内，这对下游分割&#x2F;检测网络的输入标准化至关重要。</p>
<h2 id="4-5-网络优化"><a href="#4-5-网络优化" class="headerlink" title="4.5 网络优化"></a>4.5 网络优化</h2><p>通过最小化上述损失函数，DBFF 网络能够在红外图像和可见光图像的特征之间找到最佳的融合方式。具体来说，网络会自动调整每个通道的权重，确保图像的亮度和细节得到合理的保留和增强。使用这种优化方法，DBFF 网络能够生成具有高质量细节和目标突出性的融合图像，适合后续的目标检测和图像分割任务。</p>
<p>对应代码（训练中计算融合损失并反向传播）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># train_Fusion.py</span></span><br><span class="line">_, ir_y = Net(ir, <span class="number">2</span>)  <span class="comment"># 生成红外泰勒分解特征（返回第0、1、2阶）</span></span><br><span class="line">_, vis_y = Net(vis, <span class="number">2</span>)  <span class="comment"># 生成可见光泰勒分解特征（返回第0、1、2阶）</span></span><br><span class="line">result = Model(ir_y, vis_y)  <span class="comment"># FusionModel 逆泰勒重构：sum(1/i! * F_i(ir_y[i], vis_y[i]))</span></span><br><span class="line">loss_int, loss_grad, loss = loss_ft(ir, vis, result)  <span class="comment"># 计算融合损失</span></span><br><span class="line">optimizer.zero_grad()  <span class="comment"># 清空梯度缓冲</span></span><br><span class="line">loss.backward()  <span class="comment"># 反向传播：梯度流经FusionModel</span></span><br><span class="line">optimizer.step()  <span class="comment"># 更新FusionModel参数</span></span><br></pre></td></tr></table></figure>

<p>此时TEA网络参数固定（已在Stage1预训练），DBFF参数通过融合损失的反向传播得到优化，使得多阶融合特征的组合更加贴近物理一致性目标（max(Ir, Ivis)的强度和梯度）。</p>
<h2 id="4-6-网络总结"><a href="#4-6-网络总结" class="headerlink" title="4.6 网络总结"></a>4.6 网络总结</h2><p>DBFF 网络通过双分支架构、注意力机制和优化损失函数，有效地融合了红外和可见光图像的多模态特征。该网络能够保持高质量的目标突出和图像细节，在多个视觉任务中表现出色，特别是在低光照和复杂场景中的目标检测和分割任务。</p>
<hr>
<h1 id="5-语义分割与目标优化"><a href="#5-语义分割与目标优化" class="headerlink" title="5. 语义分割与目标优化"></a>5. 语义分割与目标优化</h1><h2 id="5-1-语义分割网络"><a href="#5-1-语义分割网络" class="headerlink" title="5.1 语义分割网络"></a>5.1 语义分割网络</h2><p>语义分割网络（IBisNet）是T²EA网络的一个关键模块，它利用融合图像的高质量特征来优化目标检测和分割的效果。IBisNet通过专门设计的分割头，将图像中的各个目标区域提取出来，从而提高目标分割的精度。尤其在融合图像中，IBisNet能够更好地处理低光照或遮挡区域，使得目标能够更准确地从复杂背景中分离出来。</p>
<p>通过联合训练，IBisNet不仅优化了分割精度，还进一步增强了融合图像中目标的突出性，确保了在实际应用中，目标检测和目标分割能够在较为复杂的场景下表现出色。</p>
<p>为了进一步优化融合图像的目标突出性，采用<strong>IBisNet</strong>（改进版的双分支分割网络）进行训练。该网络通过语义分割来细化图像的目标区域，使得目标更易于检测和分割。</p>
<h2 id="5-2-损失函数"><a href="#5-2-损失函数" class="headerlink" title="5.2 损失函数"></a>5.2 损失函数</h2><p>联合损失函数包含<strong>融合损失</strong>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>F</mi></msub></mrow><annotation encoding="application/x-tex">L_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）和<strong>语义分割损失</strong>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>s</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{semantic}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight">man</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>），以优化目标检测和分割任务。</p>
<hr>
<h1 id="6-任务联合优化（目标感知）"><a href="#6-任务联合优化（目标感知）" class="headerlink" title="6. 任务联合优化（目标感知）"></a>6. 任务联合优化（目标感知）</h1><h2 id="6-1-思路"><a href="#6-1-思路" class="headerlink" title="6.1 思路"></a>6.1 思路</h2><p>冻结 TEA（Taylor.pt）与分割模型 BiSeNet，仅微调 FusionModel，使融合图同时满足物理一致性与分割友好性。</p>
<h2 id="6-2-损失函数"><a href="#6-2-损失函数" class="headerlink" title="6.2 损失函数"></a>6.2 损失函数</h2><p>实现：<code>FusionLoss</code> 依然做强度&#x2F;梯度最大对齐，<code>OhemCELoss</code> 在分割分支做难例采样，见<a href="T2EA/loss/Task.py">T2EA&#x2F;loss&#x2F;Task.py</a>：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>fusion</mtext></msub><mo>=</mo><mi mathvariant="normal">∥</mi><mover accent="true"><mi>I</mi><mo>^</mo></mover><mo>−</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>I</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msub><mo separator="true">,</mo><msub><mi>I</mi><mrow><mi>i</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub><mo>+</mo><mn>10</mn><mi mathvariant="normal">∥</mi><mi>g</mi><mo stretchy="false">(</mo><mover accent="true"><mi>I</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>−</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>I</mi><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>I</mi><mrow><mi>i</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text{fusion}} = \|\hat I - \max(I_{vis}, I_{ir})\|_1 + 10\|g(\hat I)-\max(g(I_{vis}), g(I_{ir}))\|_1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">fusion</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1389em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"></span><span class="mord">10∥</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1389em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>分割采用 OhemCELoss：主输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mtext>main</mtext></msub></mrow><annotation encoding="application/x-tex">L_{\text{main}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">main</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，辅助输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mtext>aux</mtext></msub></mrow><annotation encoding="application/x-tex">L_{\text{aux}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">aux</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p>
<h2 id="6-3-总损失与调度"><a href="#6-3-总损失与调度" class="headerlink" title="6.3 总损失与调度"></a>6.3 总损失与调度</h2><p><a href="T2EA/train_task.py">T2EA&#x2F;train_task.py</a> 中：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>total</mtext></msub><mo>=</mo><msub><mi mathvariant="script">L</mi><mtext>fusion</mtext></msub><mo>+</mo><mtext>num</mtext><mtext> </mtext><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msub><mi>L</mi><mtext>main</mtext></msub><mo>+</mo><mn>0.1</mn><mtext> </mtext><msub><mi>L</mi><mtext>aux</mtext></msub><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo separator="true">,</mo><mspace width="1em"/><mtext>num</mtext><mo>=</mo><mrow><mo fence="true">⌊</mo><mfrac><mtext>epoch</mtext><mn>10</mn></mfrac><mo fence="true">⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text{total}} = \mathcal{L}_{\text{fusion}} + \text{num}\,\big(L_{\text{main}} + 0.1\,L_{\text{aux}}\big),\quad \text{num}=\left\lfloor\frac{\text{epoch}}{10}\right\rfloor+1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">total</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">fusion</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord text"><span class="mord">num</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">main</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord">0.1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">aux</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">num</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">10</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">epoch</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">⌋</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>
<p>epoch 递增的 num 提升任务监督权重，使融合先收敛后适配分割。</p>
<h2 id="6-4-训练设置"><a href="#6-4-训练设置" class="headerlink" title="6.4 训练设置"></a>6.4 训练设置</h2><p>50 epoch，Adam(lr&#x3D;1e-5)、batch&#x3D;2；MSRS 带标签训练&#x2F;验证；最佳融合 loss 保存 Fusion_Seg.pt。</p>
<p>端到端前向（train_task.py）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1) 生成融合亮度（冻结 TEA &amp; Seg）</span></span><br><span class="line">_, ir_y = Taylor(ir, <span class="number">2</span>); _, vis_y = Taylor(vis_y_channel, <span class="number">2</span>)</span><br><span class="line">fused_y = FusionModel(ir_y, vis_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) 拼回彩色送分割</span></span><br><span class="line">fused_rgb = YCrCb2RGB(cat(fused_y, Cb, Cr))</span><br><span class="line">pred_main, pred_aux = SegModel(fused_rgb)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) 计算双任务损失</span></span><br><span class="line">loss_fusion = L_int + <span class="number">10</span> L_grad</span><br><span class="line">loss_seg = L_main + <span class="number">0.1</span> L_aux (OHEM)</span><br><span class="line">loss_total = loss_fusion + num * loss_seg</span><br></pre></td></tr></table></figure>
<p>这样梯度从分割头回传到 FusionModel，使“目标区域更亮&#x2F;更清晰”，而 TEA 的可解释分解保持冻结稳定。</p>
<hr>
<h1 id="7-实验结果与分析"><a href="#7-实验结果与分析" class="headerlink" title="7. 实验结果与分析"></a>7. 实验结果与分析</h1><p>论文将实验部分组织为：<strong>实验准备 → 消融（泰勒层数与融合策略）→ SOTA 对比与泛化 → 下游视觉任务（分割&#x2F;检测）→ 复杂度分析</strong>。</p>
<h2 id="7-1-实验准备"><a href="#7-1-实验准备" class="headerlink" title="7.1 实验准备"></a>7.1 实验准备</h2><h3 id="7-1-1-数据集与划分方式"><a href="#7-1-1-数据集与划分方式" class="headerlink" title="7.1.1 数据集与划分方式"></a>7.1.1 数据集与划分方式</h3><ul>
<li><strong>主训练&#x2F;验证来源：MSRS 数据集</strong>。论文在 MSRS 中选取 <strong>1038 对红外-可见光图像</strong>用于训练（共 <strong>2076 张</strong>图像，分辨率 <strong>640×480</strong>）。</li>
<li><strong>对比实验&#x2F;消融测试：MSRS 的 361 对图像</strong>。在讨论融合策略与 SOTA 对比时，论文均以 MSRS 中选取的 <strong>361 对可见光与红外图像</strong>进行测试与统计。</li>
<li><strong>跨数据集泛化测试：TNO + LLVIP</strong>。论文分别从 <strong>TNO Human Factors</strong> 与 <strong>LLVIP</strong> 中选取 <strong>21 对</strong>与 <strong>177 对</strong>红外-可见光图像，用于测试方法的<strong>图像适应性与泛化能力</strong>。</li>
</ul>
<h3 id="7-1-2-实验环境与关键超参"><a href="#7-1-2-实验环境与关键超参" class="headerlink" title="7.1.2 实验环境与关键超参"></a>7.1.2 实验环境与关键超参</h3><ul>
<li><strong>实现环境</strong>：PyTorch；硬件为 Intel Xeon E5-2620 V3 @ 2.40GHz、16GB 内存、NVIDIA Tesla P100 GPU。</li>
<li><strong>训练策略</strong>：按论文所述采用三阶段训练流程；Stage 1 使用 2076 张图像训练 TEA，Stage 2 与 Stage 3 使用同一批图像训练 DBFF（具体阶段定义引用论文 III-C2）。</li>
<li><strong>优化器与参数设置</strong>：Adam，学习率 <strong>0.00001</strong>；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span>（式(3)）取 <strong>0.3</strong>；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>（式(5)）在消融中讨论；参考文献[76]设置 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\alpha=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>（式(6)）与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\beta=0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.1</span></span></span></span>（式(10)）。</li>
</ul>
<h3 id="7-1-3-对比方法与评价指标"><a href="#7-1-3-对比方法与评价指标" class="headerlink" title="7.1.3 对比方法与评价指标"></a>7.1.3 对比方法与评价指标</h3><ul>
<li><strong>对比方法</strong>：DenseFuse、DRF、FusionGAN、MFIFusion、SeAFusion、UMF-CMGR、CDDFuse、LRR-Net、CrossFuse（论文说明这些方法在相同数据集与训练环境下对比）。</li>
<li><strong>客观指标</strong>：EN、SD、MI、AG、VIF、SSIM。论文同时解释了这些指标的直观含义：  <ul>
<li>EN&#x2F;AG 越大 → 细节越丰富；  </li>
<li>MI&#x2F;SSIM 越高 → 融合图与源图相关性越强；  </li>
<li>SD&#x2F;VIF 越高 → 视觉对比度越高（更利于可视化）。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="7-2-消融研究"><a href="#7-2-消融研究" class="headerlink" title="7.2 消融研究"></a>7.2 消融研究</h2><h3 id="7-2-1-泰勒展开层数-n-的选择"><a href="#7-2-1-泰勒展开层数-n-的选择" class="headerlink" title="7.2.1 泰勒展开层数 n 的选择"></a>7.2.1 泰勒展开层数 n 的选择</h3><p>为获得更优的泰勒展开特征，论文用 <strong>SSIM</strong>评估 TEA 输出、用 <strong>EN</strong>评估最终融合结果，并给出了随 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 变化的曲线（Fig. 4）。结论非常明确：当 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></strong> 时，TEA 的 SSIM 与最终融合的 EN 表现最优，且此时输出特征“细节最丰富”，因此后续实验统一取 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></strong>。</p>
<h3 id="7-2-2-不同融合策略对比"><a href="#7-2-2-不同融合策略对比" class="headerlink" title="7.2.2 不同融合策略对比"></a>7.2.2 不同融合策略对比</h3><p>论文讨论了三种融合训练&#x2F;组合策略，并在 MSRS 的 <strong>361 对图像</strong>上进行验证：</p>
<ol>
<li><strong>DBFF + Segmentation（DBFFSeg）</strong>：先用式(6)训练，再用式(9)微调 DBFF 参数；  </li>
<li><strong>TEA + DBFF（TEADBFF）</strong>：对应论文的 Stage 2 策略；  </li>
<li><strong>TEA + DBFF + Segmentation（T2EA）</strong>：对应论文的 Stage 3 策略（论文最终选择该方案作为报告方法）。</li>
</ol>
<p><strong>现象与分析</strong>：三者都能突出目标，但缺陷不同：  </p>
<ul>
<li>DBFFSeg 用“单一特征集”生成融合图，容易出现<strong>过曝</strong>，导致过曝区域的细节丢失；  </li>
<li>TEADBFF 通过引入 TEA 缓解过曝，但会产生<strong>低对比度</strong>融合图，并且暗区细节仍不足；  </li>
<li>T2EA 同时利用 TEA 与分割网络，对融合图照度进行自适应调节，能<strong>抑制过曝</strong>并提升<strong>低照区域对比度</strong>，尤其在可见光强度不均匀时更明显。</li>
</ul>
<p><img data-src="/./../images/image-20251222091814505.png" alt="image-20251222091814505"></p>
<p>论文指出：Table I 的定量结果与可视化结论一致，<strong>T2EA 的综合定量表现最佳</strong>。  </p>
<p>同时，论文还给出了使用分割方法[76]在融合结果上的 <strong>mIoU</strong>，并强调 <strong>T2EA 的融合结果因 mIoU 最佳而更利于分割任务</strong>。最终论文选择 <strong>T2EA</strong> 作为后续与 SOTA 方法对比的报告方案。</p>
<hr>
<h2 id="7-3-MSRS-上的-SOTA-方法对比"><a href="#7-3-MSRS-上的-SOTA-方法对比" class="headerlink" title="7.3 MSRS 上的 SOTA 方法对比"></a>7.3 MSRS 上的 SOTA 方法对比</h2><h3 id="7-3-1-定性对比"><a href="#7-3-1-定性对比" class="headerlink" title="7.3.1 定性对比"></a>7.3.1 定性对比</h3><p><img data-src="/./../images/image-20251222093912768.png" alt="image-20251222093912768"></p>
<p><img data-src="/./../images/image-20251222093927621.png" alt="image-20251222093927621"></p>
<p>论文在 MSRS 的 “<strong>00016N</strong>” 与 “<strong>00024N</strong>” 两幅图像上展示对比结果，并逐一分析各方法在“保细节 vs 突目标”上的权衡：</p>
<ul>
<li><strong>DRF &#x2F; FusionGAN</strong>：能生成高对比度并突出目标，但<strong>纹理缺失</strong>导致结果偏模糊。  </li>
<li><strong>DenseFuse &#x2F; MFIFusion</strong>：倾向从可见光迁移细节，但对暗区结构易<strong>过度平滑</strong>，整体对比度偏低。  </li>
<li><strong>SeAFusion</strong>：引入语义网络后目标更显著，但仍会丢失大量可见光细节，导致对比度不佳。  </li>
<li><strong>UMF-CMGR</strong>：目标突出、对比度提升明显，但代价是低亮区域细节损失。  </li>
<li><strong>CDDFuse</strong>：兼顾红外目标与可见细节，但局部（论文红框处）对比度提升仍不理想。  </li>
<li><strong>LRRNet &#x2F; CrossFuse</strong>：更偏向保留可见光细节，导致红外细节损失，尤其目标出现欠曝光。  </li>
<li><strong>T2EA（论文方法）</strong>：在保留可见光细节的同时维持红外目标突出，使结果更“舒适可视化”。</li>
</ul>
<h3 id="7-3-2-定量对比"><a href="#7-3-2-定量对比" class="headerlink" title="7.3.2 定量对比"></a>7.3.2 定量对比</h3><p>论文将 361 对 MSRS 图像上的客观指标汇总于 Table II，并指出：<strong>T2EA 在所有定量指标上取得最优值</strong>，进一步说明其在“保细节 + 突目标”上的综合能力更强。</p>
<p><img data-src="/./../images/image-20251222091837609.png" alt="image-20251222091837609"></p>
<hr>
<h2 id="7-4-跨数据集泛化实验（TNO-LLVIP）"><a href="#7-4-跨数据集泛化实验（TNO-LLVIP）" class="headerlink" title="7.4 跨数据集泛化实验（TNO &amp; LLVIP）"></a>7.4 跨数据集泛化实验（TNO &amp; LLVIP）</h2><h3 id="7-4-1-实验设置与可视化样例"><a href="#7-4-1-实验设置与可视化样例" class="headerlink" title="7.4.1 实验设置与可视化样例"></a>7.4.1 实验设置与可视化样例</h3><p>为评估泛化能力，论文从 <strong>TNO Human Factors</strong> 与 <strong>LLVIP</strong> 分别选取 <strong>21 对</strong>与 <strong>177 对</strong>红外&#x2F;可见光图像，进行定性与定量评估。  </p>
<p>可视化对比覆盖：TNO 的 “Bunker”“Meeting_016”，LLVIP 的 “230024”“200090”。</p>
<h3 id="7-4-2-定性结论"><a href="#7-4-2-定性结论" class="headerlink" title="7.4.2 定性结论"></a>7.4.2 定性结论</h3><p>论文对跨域结果的总结要点如下：</p>
<ul>
<li><strong>DRF</strong>：高对比度，但可见光重要细节缺失（如白色目标、人体边缘等）。  </li>
<li><strong>FusionGAN &#x2F; MFIFusion</strong>：融合结果偏“过平滑”，暗区结构与目标边缘被模糊。  </li>
<li><strong>SeAFusion</strong>：目标突出，但因过度强调大尺度物体，小尺度结构容易被抹平。  </li>
<li><strong>DenseFuse &#x2F; UMF-CMGR</strong>：能突出目标，但白天场景可能带来对比度下降；夜间低亮区域细节也可能被过度平滑。  </li>
<li><strong>CDDFuse</strong>：尽力兼顾目标与细节，但在过曝区域的细节保持不佳。  </li>
<li><strong>LRRNet &#x2F; CrossFuse</strong>：整体偏低对比度，低照区域细节难以分辨。  </li>
<li><strong>T2EA</strong>：在跨域场景下依然能兼顾<strong>保细节、提对比、突目标</strong>，体现出更强的图像自适应能力。</li>
</ul>
<h3 id="7-4-3-定量结论"><a href="#7-4-3-定量结论" class="headerlink" title="7.4.3 定量结论"></a>7.4.3 定量结论</h3><p>论文在 Table III 与 Table IV 中给出了 TNO 与 LLVIP 的平均指标，并指出：<strong>T2EA 在 EN 与 SSIM 两项指标上均取得最优</strong>，与定性观察一致，从而验证其跨数据集的细节保留能力与泛化优势。</p>
<p><img data-src="/./../images/image-20251222091859232.png" alt="image-20251222091859232"></p>
<p><img data-src="/./../images/image-20251222091916114.png" alt="image-20251222091916114"></p>
<hr>
<h2 id="7-5-融合结果用于下游视觉任务"><a href="#7-5-融合结果用于下游视觉任务" class="headerlink" title="7.5 融合结果用于下游视觉任务"></a>7.5 融合结果用于下游视觉任务</h2><p>论文强调：仅做融合质量对比还不够，融合图是否“任务友好”同样关键，因此进一步在<strong>分割</strong>与<strong>检测</strong>任务上测试融合结果的可用性。</p>
<h3 id="7-5-1-语义分割（IBisNet）"><a href="#7-5-1-语义分割（IBisNet）" class="headerlink" title="7.5.1 语义分割（IBisNet）"></a>7.5.1 语义分割（IBisNet）</h3><ul>
<li><strong>设置</strong>：采用改进 BisNet（IBisNet）预训练模型，在 MSRS（包含 ground-truth classification dataset）上对融合结果进行目标分割；分割可视化见 Fig. 12 与 Fig. 13。</li>
<li><strong>现象</strong>：多数方法能分割出目标，但常见问题是目标区域不完整，甚至出现曲线、凸起或自行车等结构缺失；对比之下，论文指出 <strong>T2EA 的分割结果更接近 GT</strong>，原因是融合策略显式利用了语义信息。</li>
<li><strong>指标</strong>：Table V 统计了 <strong>9 个类别</strong>的 IoU 与 mIoU；论文结论是：相较其他融合结果，IBisNet 在 <strong>T2EA 融合图</strong>上取得<strong>各类别最优</strong>，且 mIoU 也最好，进一步说明 T2EA 更利于分割任务。</li>
</ul>
<p><img data-src="/./../images/image-20251222091947263.png" alt="image-20251222091947263"></p>
<h3 id="7-5-2-目标检测（YOLOv5）"><a href="#7-5-2-目标检测（YOLOv5）" class="headerlink" title="7.5.2 目标检测（YOLOv5）"></a>7.5.2 目标检测（YOLOv5）</h3><ul>
<li><strong>设置</strong>：使用 YOLOv5 在融合结果上进行检测；</li>
</ul>
<p><img data-src="/./../images/image-20251222092022748.png" alt="image-20251222092022748"></p>
<p><img data-src="/./../images/image-20251222092043840.png" alt="image-20251222092043840"></p>
<ul>
<li><strong>现象</strong>：论文指出，尽管多数融合算法能提升画面质量，但其融合图仍会导致检测端出现<strong>低精度</strong>或<strong>漏检</strong>（例如自行车仅在 T2EA 融合结果中被正确检出等），说明“融合质量 ≠ 任务友好”。</li>
<li><strong>指标</strong>：Table VI 给出 precision、recall、mAP，并定义了 <a href="mailto:&#x6d;&#x41;&#x50;&#x40;&#x30;&#x2e;&#53;">mAP@0.5</a>&#x2F;0.7&#x2F;0.9 等阈值；论文结论是：YOLOv5 在 <strong>T2EA 融合结果</strong>上，各 IoU 阈值下的指标均为最高，同时指出<strong>语义分割是提升融合性能的重要贡献因素</strong>。</li>
</ul>
<p><img data-src="/./../images/image-20251222092103910.png" alt="image-20251222092103910"></p>
<hr>
<h2 id="7-6-计算复杂度与效率"><a href="#7-6-计算复杂度与效率" class="headerlink" title="7.6 计算复杂度与效率"></a>7.6 计算复杂度与效率</h2><p>论文在三套数据上统计<strong>平均运行时间（秒）与参数量</strong>，并在 Table VII 中对比各方法效率：  </p>
<ul>
<li><strong>LRRNet</strong> 参数量最小，且除 LLVIP 外总体效率最好；  </li>
<li>相比之下，<strong>T2EA 的速度略慢于 LRRNet 与 SeAFusion（但在 LLVIP 上例外）</strong>；  </li>
<li>论文强调：结合其在分割&#x2F;检测等视觉任务上的融合优势，T2EA 依然是面向广泛应用的有竞争力方案。</li>
</ul>
<p><img data-src="/./../images/image-20251222092119850.png" alt="image-20251222092119850"></p>
<h1 id="8-计算复杂度"><a href="#8-计算复杂度" class="headerlink" title="8. 计算复杂度"></a>8. 计算复杂度</h1><p>T²EA网络的计算复杂度相比纯深度学习融合方法（如U2Fusion）略高，但引入的可解释性、泛化能力和任务友好性使其成本合理。具体而言：</p>
<ul>
<li><strong>模型参数量</strong>：TEA (0.82M) + DBFF (2.34M) + 分割头(1.48M) &#x3D; 4.64M，相比U2Fusion的2.15M增加<strong>116%</strong>，但整体仍为轻量级模型</li>
<li><strong>显存占用</strong>：P100 GPU上4.1GB（batch&#x3D;2），相比U2Fusion的3.2GB增加28%</li>
<li><strong>推理速度</strong>：31.2ms @640×512分辨率，满足实时性要求（≥25FPS）</li>
</ul>
<p>该权衡是值得的，因为额外的计算成本换来了：</p>
<ol>
<li><strong>可解释性</strong>：每一阶泰勒项有明确的数学含义，便于调试和改进</li>
<li><strong>泛化性</strong>：跨域迁移性能优于黑箱型深度学习模型</li>
<li><strong>任务友好性</strong>：通过联合优化显著提升下游检测&#x2F;分割精度</li>
</ol>
<h1 id="9-结论"><a href="#9-结论" class="headerlink" title="9. 结论"></a>9. 结论</h1><p>本研究提出的T²EA网络，通过<strong>目标感知的泰勒展开近似方法</strong>，在红外和可见光图像融合中取得了显著的改进：</p>
<h2 id="9-1-主要贡献"><a href="#9-1-主要贡献" class="headerlink" title="9.1 主要贡献"></a>9.1 主要贡献</h2><ol>
<li><strong>泰勒多阶特征分解</strong>：用可解释的数学框架替代黑箱型特征提取，使融合过程可审计、可优化</li>
<li><strong>阶乘加权逆重构</strong>：证明了固定的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{i!}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>权重比学习权重更优，这是理论与实践的完美结合</li>
<li><strong>双分支注意融合</strong>：CBAM在多模态特征融合中的应用显著提升了目标显著性和训练稳定性</li>
<li><strong>任务联合优化</strong>：通过分割梯度反传，使融合结果天然适配下游检测&#x2F;分割任务</li>
</ol>
<h2 id="9-2-性能总结"><a href="#9-2-性能总结" class="headerlink" title="9.2 性能总结"></a>9.2 性能总结</h2><ul>
<li><strong>量化指标</strong>：MSRS上<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mrow><mi>A</mi><mi>B</mi><mi mathvariant="normal">/</mi><mi>F</mi></mrow></msup><mo>=</mo><mn>0.768</mn></mrow><annotation encoding="application/x-tex">Q^{AB/F}=0.768</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.768</span></span></span></span>、SSIM&#x3D;0.891，领先SOTA 4-5%</li>
<li><strong>跨域泛化</strong>：MSRS→TNO零样本迁移精度下降仅2%，体现强泛化能力</li>
<li><strong>下游任务</strong>：分割mIoU提升8.1%，检测AP提升6.5%，充分验证融合质量的实用价值</li>
<li><strong>运行效率</strong>：32 FPS吞吐量满足实时需求，计算成本与性能收益高度均衡</li>
</ul>
<h2 id="9-3-适用场景与展望"><a href="#9-3-适用场景与展望" class="headerlink" title="9.3 适用场景与展望"></a>9.3 适用场景与展望</h2><p><strong>适用场景</strong>：</p>
<ul>
<li>安全监控（特别是夜间或复杂光照）</li>
<li>自动驾驶感知（多模态传感器融合）</li>
<li>医学影像（多光谱融合）</li>
</ul>
<p><strong>未来方向</strong>：</p>
<ul>
<li>引入自适应配准模块，处理现实中的IR&#x2F;VIS位置偏差</li>
<li>通过知识蒸馏降低计算成本，使其更易部署在边缘设备</li>
<li>扩展到视频帧序列，利用时序一致性进一步增强融合质量</li>
<li>探索更高阶的泰勒分解（≥3阶）与自适应阶数选择机制</li>
</ul>
]]></content>
      <categories>
        <category>论文阅读</category>
      </categories>
      <tags>
        <tag>红外可见光融合</tag>
        <tag>Taylor展开</tag>
        <tag>目标感知</tag>
        <tag>双分支融合</tag>
        <tag>分割联合优化</tag>
      </tags>
  </entry>
  <entry>
    <title>数学建模方法0001</title>
    <url>/2025/11/07/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E6%96%B9%E6%B3%950001/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p> 网课来源<br><a href="https://www.bilibili.com/video/BV1p14y1U7Nr/">【胎教级入门数学建模】持续更新！可能是B站大学最良心的数学建模课程了，包含全套数学模型、算法、编程、写作、MATLAB教学视频</a></p>
<h1 id="整数规划"><a href="#整数规划" class="headerlink" title="整数规划"></a>整数规划</h1><h2 id="AI总结的"><a href="#AI总结的" class="headerlink" title="AI总结的"></a>AI总结的</h2><p>在数学建模中，<strong>整数规划（Integer Programming, IP）</strong> 是一种非常重要的优化方法，主要用于解决那些<strong>决策变量必须取整数值</strong>的问题。它是线性规划（Linear Programming, LP）的一个特例或扩展。</p>
<h3 id="🧩-一、整数规划的基本概念"><a href="#🧩-一、整数规划的基本概念" class="headerlink" title="🧩 一、整数规划的基本概念"></a>🧩 一、整数规划的基本概念</h3><p>整数规划是一类<strong>优化问题</strong>，其一般形式为：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right left" columnspacing="0em 1em 0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>minimize</mtext><mspace width="1em"/></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>c</mi><mi>T</mi></msup><mi>x</mi><mtext> subject to</mtext><mspace width="1em"/></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>A</mi><mi>x</mi><mo>≤</mo><mi>b</mi><mtext> </mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi mathvariant="double-struck">Z</mi><mtext> 或 </mtext><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow><mo separator="true">,</mo><mtext> 对某些或全部 </mtext><mi>i</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\text{minimize} \quad &amp; c^T x \
\text{subject to} \quad &amp; A x \le b \
&amp; x_i \in \mathbb{Z} \text{ 或 } x_i \in {0,1}, \text{ 对某些或全部 } i
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5513em;vertical-align:-0.5257em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">minimize</span></span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace"> </span><span class="mord text"><span class="mord">subject to</span></span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">b</span><span class="mspace"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mord text"><span class="mord"> </span><span class="mord cjk_fallback">或</span><span class="mord"> </span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord"> </span><span class="mord cjk_fallback">对某些或全部</span><span class="mord"> </span></span><span class="mord mathnormal">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span></span></span></span></span></span></span>

<p>其中：</p>
<ul>
<li>( x )：决策变量；</li>
<li>( c )：目标函数的系数向量；</li>
<li>( A )、( b )：约束条件；</li>
<li>要求部分或全部变量 ( x_i ) 必须是<strong>整数</strong>。</li>
</ul>
<hr>
<h3 id="🧮-二、整数规划的主要类型"><a href="#🧮-二、整数规划的主要类型" class="headerlink" title="🧮 二、整数规划的主要类型"></a>🧮 二、整数规划的主要类型</h3><ol>
<li><p><strong>纯整数规划（Pure Integer Programming）</strong><br>所有决策变量都是整数。<br>例：</p>
<ul>
<li>生产数量、车辆数、工人数等必须是整数。</li>
</ul>
</li>
<li><p><strong>混合整数规划（Mixed Integer Programming, MIP）</strong><br>只有部分变量要求是整数，其他可以是实数。<br>例：</p>
<ul>
<li>工厂选址（0&#x2F;1决策） + 运输量（连续变量）。</li>
</ul>
</li>
<li><p><strong>0-1整数规划（Binary Integer Programming）</strong><br>决策变量只取0或1，常用于<strong>选址、调度、分配、路径规划</strong>等问题。<br>例：</p>
<ul>
<li>( x_i &#x3D; 1 ) 表示选择方案i，( x_i &#x3D; 0 ) 表示不选择。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="⚙️-三、常见应用场景"><a href="#⚙️-三、常见应用场景" class="headerlink" title="⚙️ 三、常见应用场景"></a>⚙️ 三、常见应用场景</h3><table>
<thead>
<tr>
<th>应用领域</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>选址问题</td>
<td>选择哪些工厂或仓库建成，以最小化成本</td>
</tr>
<tr>
<td>任务分配</td>
<td>员工与任务的最优匹配</td>
</tr>
<tr>
<td>路径规划</td>
<td>旅行商问题（TSP）、物流配送</td>
</tr>
<tr>
<td>生产计划</td>
<td>不同产品的产量决策</td>
</tr>
<tr>
<td>投资组合</td>
<td>选择投资项目的最优组合</td>
</tr>
</tbody></table>
<hr>
<h3 id="🔍-四、求解方法"><a href="#🔍-四、求解方法" class="headerlink" title="🔍 四、求解方法"></a>🔍 四、求解方法</h3><p>由于整数规划属于 <strong>NP难问题</strong>，不能像线性规划那样用单纯形法直接求解。常见算法包括：</p>
<ol>
<li><p><strong>分支定界法（Branch and Bound）</strong><br>将问题分解成若干子问题，通过界限剪枝减少计算。</p>
</li>
<li><p><strong>割平面法（Cutting Plane）</strong><br>在连续解上添加“割平面”逐步逼近整数最优解。</p>
</li>
<li><p><strong>启发式与元启发式算法</strong>（用于大规模问题）<br>如：遗传算法、模拟退火、禁忌搜索、粒子群算法等。</p>
</li>
</ol>
<hr>
<h3 id="📘-五、建模技巧提示"><a href="#📘-五、建模技巧提示" class="headerlink" title="📘 五、建模技巧提示"></a>📘 五、建模技巧提示</h3><ul>
<li><p><strong>整数约束</strong>可用来表示逻辑关系，例如：</p>
<ul>
<li>“要么选A，要么选B” → ( x_A + x_B &#x3D; 1 )</li>
<li>“选A则必须选B” → ( x_A \le x_B )</li>
</ul>
</li>
<li><p>可以与线性规划、非线性规划结合，用于复杂决策模型。</p>
</li>
<li><p>常用求解器：<strong>Lingo、CPLEX、Gurobi、Excel Solver、Python PuLP&#x2F;OR-Tools</strong> 等。</p>
</li>
</ul>
<h2 id="简单来说"><a href="#简单来说" class="headerlink" title="简单来说"></a>简单来说</h2><p>有的时候那你肯定不能把人、物啥的分开啊，也就是怎么可能有0.5个人这样的形式awa</p>
<p>所以我们既要保证最优解，又要保证是整数，这就用到了整数规划</p>
<p>但需要注意的是，整数规划并非一味地取整，而是根据实际问题来判断</p>
<h2 id="如何用？"><a href="#如何用？" class="headerlink" title="如何用？"></a>如何用？</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x = intlinprog(f, intcon, A, b, Aeq, beq, lb, ub)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>f</code></td>
<td>目标函数的系数向量 ( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> )，即最小化 ( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">f^T x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span> )</td>
</tr>
<tr>
<td><code>intcon</code></td>
<td>指定哪些变量是整数（输入变量的索引）</td>
</tr>
<tr>
<td><code>A</code>, <code>b</code></td>
<td>不等式约束 ( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">A x \le b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> )</td>
</tr>
<tr>
<td><code>Aeq</code>, <code>beq</code></td>
<td>等式约束 ( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mi>x</mi><mo>=</mo><msub><mi>b</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_{eq} x = b_{eq}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> )</td>
</tr>
<tr>
<td><code>lb</code>, <code>ub</code></td>
<td>变量的下界和上界</td>
</tr>
<tr>
<td>返回值 <code>x</code></td>
<td>最优解向量（整数解）</td>
</tr>
</tbody></table>
<h2 id="🧮-二、整数规划的基本形式"><a href="#🧮-二、整数规划的基本形式" class="headerlink" title="🧮 二、整数规划的基本形式"></a>🧮 二、整数规划的基本形式</h2><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right left right left" columnspacing="0em 1em 0em 1em 0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>minimize</mtext><mspace width="1em"/></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>f</mi><mi>T</mi></msup><mi>x</mi><mtext> subject to</mtext><mspace width="1em"/></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>A</mi><mi>x</mi><mo>≤</mo><mi>b</mi><mtext> </mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>A</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mi>x</mi><mo>=</mo><msub><mi>b</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mtext> </mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>l</mi><mi>b</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>u</mi><mi>b</mi><mtext> </mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi mathvariant="double-struck">Z</mi><mo separator="true">,</mo><mo separator="true">,</mo><mi>i</mi><mo>∈</mo><mtext>intcon</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
 \text{minimize} \quad &amp; f^T x \
 \text{subject to} \quad &amp; A x \le b \
 &amp; A_{eq} x = b_{eq} \
 &amp; lb \le x \le ub \
 &amp; x_i \in \mathbb{Z}, , i \in \text{intcon}
 \end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5513em;vertical-align:-0.5257em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">minimize</span></span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace"> </span><span class="mord text"><span class="mord">subject to</span></span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">b</span><span class="mspace"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">u</span><span class="mord mathnormal">b</span><span class="mspace"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0257em;"><span style="top:-3.1343em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mpunct">,,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">intcon</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5257em;"><span></span></span></span></span></span></span></span></span></span></span></span>





<h1 id="非线性规划"><a href="#非线性规划" class="headerlink" title="非线性规划"></a>非线性规划</h1><h1 id="图论与最短路径算法"><a href="#图论与最短路径算法" class="headerlink" title="图论与最短路径算法"></a>图论与最短路径算法</h1><h1 id="网络最大流问题"><a href="#网络最大流问题" class="headerlink" title="网络最大流问题"></a>网络最大流问题</h1><h1 id="最小费用最大流"><a href="#最小费用最大流" class="headerlink" title="最小费用最大流"></a>最小费用最大流</h1><h1 id="旅行商问题"><a href="#旅行商问题" class="headerlink" title="旅行商问题"></a>旅行商问题</h1>]]></content>
      <categories>
        <category>笔记</category>
      </categories>
      <tags>
        <tag>数学建模</tag>
      </tags>
  </entry>
</search>
